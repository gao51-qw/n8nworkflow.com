{
  "id": 8336,
  "slug": "8336",
  "title": "Automatic email categorization and organization with Outlook and GPT-4o",
  "description": "# n8n ‚Äì Outlook AI Categorization & Labeling (Fully Automated)\n\n&gt; **Zero manual mapping.** The workflow automatically discovers your Outlook folders, understands the context, assigns the correct category, and moves the email into the right folder. It uses the original **Microsoft Outlook nodes** plus an **AI Agent**. You can connect OpenAI or any other LLM provider.\n\n---\n\n## ‚ú® Features\n\n- **Self-Discovery:** Scans your Outlook folders automatically ‚Äì no manual mapping required.\n- **AI-Powered Decisions:** Considers sender, subject, content, links, attachments, timing, and business context.\n- **Label + Move:** Assigns the right Outlook category and moves the email into the correct folder.\n- **Dual Category Logic:** Can apply both a primary and a secondary category (e.g., `Action` + `Project`).\n- **Error Handling:** Captures errors and continues without breaking the workflow.\n- **Flexible AI Backend:** Replace OpenAI with your own LLM if preferred.\n\n---\n\n## üöÄ Setup (5 Steps)\n\n1. **Connect Outlook**  \n   In *n8n ‚Üí Credentials ‚Üí Microsoft Outlook*, grant at least `Mail.ReadWrite`.\n\n2. **Connect AI**  \n   In *n8n ‚Üí Credentials*, set up OpenAI (or another model). Works best with GPT-4.x or GPT-4o.\n\n3. **Import the Workflow**  \n   *n8n ‚Üí Workflows ‚Üí Import from File/Clipboard* and paste the provided JSON.\n\n4. **Enable Trigger**  \n   Adjust the *Schedule Trigger* (e.g., every 5 minutes).\n\n5. **Run & Verify**  \n   Test run and watch emails get categorized and moved automatically.\n\n---\n\n## üß† How It Works\n\n1. **Schedule Trigger** pulls new emails  \n2. **Loop Over Items** processes them one by one  \n3. **Markdown / varEmail** cleans the content  \n4. **Get Many Folders** fetches Outlook categories and folders  \n5. **Summarize + Code** prepare category IDs  \n6. **AI Agent** applies deep categorization logic  \n7. **Update Category** applies the Outlook category  \n8. **Move Folder** places the email in the right folder  \n9. **Error Handling** ensures workflow stability  \n\n---\n\n## üß© System Prompt Example\n\n```text\nYou are an advanced AI email categorization system. Your mission is to intelligently analyze and categorize emails with maximum accuracy and context awareness.\n\nINTELLIGENT CATEGORIZATION ENGINE:\n\n- Parse all available categories: {{ $json.category }}\n- Multi-layer analysis: Sender, Subject, Body, Links, Attachments\n- Prioritize: Security threats, Action Required, Business Context\n- Specialized: SaaS, Hosting, E-commerce, Finance, Support, Corporate\n- Anti-Spam: Pattern detection, spoofing, red-flag subjects\n- Dual Logic: Primary + Secondary categories when applicable\n\nOUTPUT FORMAT (JSON only):\n{\n  \"subject\": \"EXACT_EMAIL_SUBJECT\",\n  \"category\": \"PRIMARY_CATEGORY_FROM_AVAILABLE_LIST\",\n  \"subCategory\": \"SECONDARY_CATEGORY_IF_APPLICABLE\",\n  \"analysis\": \"Reasoning\",\n  \"confidence\": \"HIGH/MEDIUM/LOW\"\n}\n\nAvailable Categories: {{ $json.category }}\n```\n\n---\n\n## ‚öôÔ∏è Parameters & Notes\n\n- Uses only **existing Outlook categories** (never invents new ones).  \n- Works with any LLM that supports Chat Completions.  \n- Requires `Mail.ReadWrite` permissions.  \n- Safe fallback: if unsure, it uses the **Action** category.  \n\n---\n\n## üõ°Ô∏è Security\n\n- Processes only what is needed for classification.  \n- No external logging of email content unless you configure it.  \n- AI provider can be swapped for self-hosted LLMs for compliance.  \n\n---\n\n## üìÑ License & Sharing\n\n- **License:** MIT (or your choice).  \n- **Tags:** `n8n`, `Outlook`, `Email`, `AI`, `Automation`, `Categorization`  \n- **Import Method:** Copy/paste workflow JSON into n8n.  \n\n---\n\n## ‚úÖ Summary\n\n**Connect ‚Üí Import ‚Üí Run.**  \nNo manual mapping. AI-powered categorization that **labels and organizes your Outlook mailbox automatically**.\n",
  "featuredImage": "/data/workflows/8336/8336.webp",
  "author": {
    "id": 101,
    "slug": "ubden",
    "name": "Can KURT",
    "avatar": ""
  },
  "categories": [
    "Ticket Management",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1813,
  "downloads": 181,
  "createdAt": "2025-09-06T22:26:29.285Z",
  "updatedAt": "2026-01-16T08:55:19.084Z",
  "publishedAt": "2025-09-06T22:26:29.285Z",
  "nodes": 23,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8336"
}