{
  "id": 10119,
  "slug": "10119",
  "title": "AI-powered web research in Google Sheets with GPT and Bright Data",
  "description": "# üîç AI-Powered Web Research in Google Sheets with Bright Data\n\n## üìã Overview\n\nTransform any Google Sheets cell into an intelligent web scraper! Type `=BRIGHTDATA(\"cell\", \"search prompt\")` and get AI-filtered result from every website in ~20 seconds.\n\n**What happens automatically:**\n- AI optimizes your search query\n- Bright Data scrapes the web (bypasses bot detection)\n- AI analyzes and filters result\n- Returns clean data directly to your cell\n- Completes in &lt;25 seconds\n\n**Cost:** ~$0.02-0.05 per search | **Time saved:** 3-5 minutes per search\n\n---\n\n## üë• Who's it for\n\n- Market researchers needing competitive intelligence\n- E-commerce teams tracking prices\n- Sales teams doing lead prospecting\n- SEO specialists gathering content research\n- Real estate agents monitoring listings\n- Anyone tired of manual copy-paste\n\n---\n\n## ‚öôÔ∏è How it works\n\n1. **Webhook Call** - Google Sheets function sends POST request\n2. **Data Preparation** - Organizes input structure\n3. **AI Query Optimization** - GPT-4.1 Mini refines search query\n4. **Web Scraping** - Bright Data fetches data while bypassing blocks\n5. **AI Analysis** - GPT-4o Mini filters and summarizes result\n6. **Response** - Returns plain text to your cell\n8. **Logging** - Updates logs for monitoring\n\n---\n\n## üõ†Ô∏è Setup Instructions\n\n**Time to deploy:** 20 minutes\n\n### Requirements\n\n- n8n instance with public URL\n- Bright Data account + API key\n- OpenAI API key\n- Google account for Apps Script\n\n### Part 1: n8n Workflow Setup\n\n1. Import this template into your n8n instance\n2. **Configure Webhook node:**\n   - Copy your webhook URL: `https://n8n.yourdomain.com/webhook/brightdata-search`\n   - Set authentication: Header Auth\n   - Set API key: `12312346` (or create your own)\n3. **Add OpenAI credentials** to AI nodes.\n4. **Configure Bright Data:** Add API credentials\n5. **Configure Output Language:** Manually edit the \"Set Variables\" Node.\n6. Test workflow with manual execution\n7. Activate the workflow\n\n### Part 2: Google Sheets Function\n\n1. Open Google Sheet ‚Üí **Extensions** ‚Üí **Apps Script**\n2. Paste this code:\n\n```javascript\nfunction BRIGHTDATA(prompt, source) {\n  if (!prompt || prompt === \"\") {\n    return \"‚ùå Must enter prompt\";\n  }\n \n  source = source || \"google\";\n \n  // Update with YOUR webhook URL\n  const N8N_WEBHOOK_URL = \"https://your-n8n-domain.com/webhook/brightdata-search\";\n  \n  // Update with YOUR password\n  const API_KEY = \"12312346\";\n \n  let spreadsheetId, sheetName, cellAddress;\n \n  try {\n    const sheet = SpreadsheetApp.getActiveSheet();\n    const activeCell = sheet.getActiveCell();\n    spreadsheetId = SpreadsheetApp.getActiveSpreadsheet().getId();\n    sheetName = sheet.getName();\n    cellAddress = activeCell.getA1Notation();\n  } catch (e) {\n    return \"‚ùå Cannot identify cell\";\n  }\n \n  const payload = {\n    prompt: prompt,\n    source: source.toLowerCase(),\n    context: {\n      spreadsheetId: spreadsheetId,\n      sheetName: sheetName,\n      cellAddress: cellAddress,\n      timestamp: new Date().toISOString()\n    }\n  };\n \n  const options = {\n    method: \"post\",\n    contentType: \"application/json\",\n    payload: JSON.stringify(payload),\n    muteHttpExceptions: true,\n    headers: {\n      \"Accept\": \"text/plain\",\n      \"key\": API_KEY\n    }\n  };\n \n  try {\n    const response = UrlFetchApp.fetch(N8N_WEBHOOK_URL, options);\n    const responseCode = response.getResponseCode();\n   \n    if (responseCode !== 200) {\n      Logger.log(\"Error response: \" + response.getContentText());\n      return \"‚ùå Error \" + responseCode;\n    }\n   \n    return response.getContentText();\n   \n  } catch (error) {\n    Logger.log(\"Exception: \" + error.toString());\n    return \"‚ùå Connection error: \" + error.toString();\n  }\n}\n\nfunction doGet(e) {\n  return ContentService.createTextOutput(JSON.stringify({\n    status: \"alive\",\n    message: \"Apps Script is running\",\n    timestamp: new Date().toISOString()\n  })).setMimeType(ContentService.MimeType.JSON);\n}\n```\n\n3. Update `N8N_WEBHOOK_URL` with your webhook\n4. Update `API_KEY` with your password\n5. **Save** (Ctrl+S / Cmd+S) - Important!\n6. Close Apps Script editor\n\n---\n\n## üí° Usage Examples\n\n\n```\n=BRIGHTDATA(\"C3\", \"What is the current price of the product?\")\n=BRIGHTDATA(\"D30\", \"What is the size of this company?\")\n=BRIGHTDATA(\"A4\", \"Do this comapny is hiring Developers?\")\n```\n---\n\n## üé® Customization\n\n### Easy Tweaks\n- **AI Models** - Switch to GPT-4o for better optimization\n- **Response Format** - Modify prompt for specific outputs\n- **Speed** - Optimize AI prompts to reduce time\n- **Language** - Change prompts for any language\n\n### Advanced Options\n- Implement rate limiting\n- Add data validation\n- Create async mode for long queries\n- Add Slack notifications\n\n---\n\n## üöÄ Pro Tips\n\n- **Be Specific** - \"What is iPhone 15 Pro 256GB US price?\" beats \"What is iPhone price?\"\n- **Speed Matters** - Keep prompts concise (30s timeout limit)\n- **Monitor Costs** - Track Bright Data usage\n- **Debug** - Check workflow logs for errors\n\n---\n\n## ‚ö†Ô∏è Important Notes\n\n- **Timeout:** 30-second Google Sheets limit (aim for &lt;20s)\n- **Plain Text Only:** No JSON responses\n- **Costs:** Monitor Bright Data at console.brightdata.com\n- **Security:** Keep API keys secret\n- **No Browser Storage:** Don't use localStorage/sessionStorage\n\n---\n\n## üîß Troubleshooting\n\n| Error | Solution |\n|-------|----------|\n| \"Exceeded maximum execution time\" | Optimize AI prompts or use async mode |\n| \"Could not fetch data\" | Verify Bright Data credentials |\n| Empty cell | Check n8n logs for AI parsing issues |\n| Broken characters | Verify UTF-8 encoding in webhook node |\n\n---\n\n## üìö Resources\n\n- [Bright Data API Docs](https://docs.brightdata.com/)\n- [n8n Webhook Documentation](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/)\n- [Google Apps Script Reference](https://developers.google.com/apps-script/reference/spreadsheet)\n\n---\n\n**Built with ‚ù§Ô∏è by [Elay Guez](https://www.linkedin.com/in/elay-g)**",
  "featuredImage": "/data/workflows/10119/10119.webp",
  "author": {
    "id": 101,
    "slug": "elay96",
    "name": "Elay Guez",
    "avatar": ""
  },
  "categories": [
    "Market Research",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 3482,
  "downloads": 348,
  "createdAt": "2025-10-24T11:10:49.455Z",
  "updatedAt": "2026-01-16T09:03:31.108Z",
  "publishedAt": "2025-10-24T11:10:49.455Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10119"
}