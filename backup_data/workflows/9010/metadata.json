{
  "id": 9010,
  "slug": "9010",
  "title": "Import E.ON W1000 energy meter data to Home Assistant with Spook integration",
  "description": "### UPDATES:\n* 2025-12-03 fix JS code in `calculate hourly sum` node\n\n## E.ON W1000 → n8n → Home Assistant (Spook) “Integration”\n\nThis workflow processes emails from the E.ON portal containing 15-minute `+A` `-A` (import/export) data and daily `1.8.0`  `2.8.0` meter readings.  \nIt extracts the required columns from the attached XLSX file, groups the 15-minute values by hour, then:\n\n* updates the Spook/Recorder statistics under the IDs `sensor.grid_energy_import` and `sensor.grid_energy_export`, and  \n* sets the current meter readings for the entities `input_number.grid_import_meter` and `input_number.grid_export_meter`.\n\n&gt; **You may need to modify the workflow if there are changes in how E.ON sends scheduled exports. If the exported data format changes, please report it on [Github](https://github.com/Netesfiu/EON-W1000-n8n)!**\n\n## Requirements\n\n* n8n (cloud or self-hosted)\n  * HACS addon available here: [Rbillon59/home-assistant-addons](https://github.com/Rbillon59/home-assistant-addons)\n  * [Official n8n Docker Compose template](https://docs.n8n.io/hosting/installation/server-setups/docker-compose/#6-create-docker-compose-file)\n  * Simplified n8n Docker Compose template available on [Github](https://github.com/Netesfiu/EON-W1000-n8n/blob/main/n8n-docker-compose.yaml)\n* (For Gmail) Gmail API authentication (OAuth2) **read-only** email access to the account receiving the messages  \n  * Setup guide available [here](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/)\n* (For IMAP) IMAP provider credentials\n* Home Assistant access via **Long-Lived Access Token** or API key  \n  * Setup guide available [here](https://docs.n8n.io/integrations/builtin/credentials/homeassistant/)\n* Spook integration  \n  * Documentation and installation guide available [here](https://spook.boo)\n\n## E.ON Portal Setup\n\n1. Create a scheduled export on the E.ON portal with the following parameters:  \n   * Under the *Remote Meter Reading* menu, click on the `+ new scheduled export setting` button.  \n     * `Specify POD identifier(s)`: choose one of the PODs you want to query.  \n     * `Specify meter variables`: select the following:\n       * `+A Active Power Consumption`\n       * `-A Active Power Feed-In`\n       * `DP_1-1:1.8.0*0 Active Power Consumption Daily Reading`\n       * `DP_1-1:2.8.0*0 Active Power Feed-In Daily Reading`\n     * `Export sending frequency`: daily  \n     * `Days of historical data to include`: recommended 7 days to backfill missed data.  \n     * `Email subject`: by default, use `[EON-W1000]`. If processing multiple PODs with the workflow, give each a unique identifier.\n\n## Home Assistant Preparation\n\n1. Create the following `input_number` entities in `configuration.yaml` or via Helpers:\n\n[![Helpers](https://my.home-assistant.io/badges/helpers.svg)](https://my.home-assistant.io/redirect/helpers/)\n\n```yaml\ninput_number:\n  grid_import_meter:\n    name: grid_import_meter\n    mode: box\n    initial: 0\n    min: 0\n    max: 9999999999\n    step: 0.001\n    unit_of_measurement: kWh\n  grid_export_meter:\n    name: grid_export_meter\n    mode: box\n    initial: 0\n    min: 0\n    max: 9999999999\n    step: 0.001\n    unit_of_measurement: kWh\n```\n&gt; If you name the entities differently, make sure to reflect these changes in the workflow.\n\n2. Create the following `template_sensor` entities in `configuration.yaml` or via Helpers:\n\n[![Segéd entitások](https://my.home-assistant.io/badges/helpers.svg)](https://my.home-assistant.io/redirect/helpers/)\n```yaml\ninput_number:\n  grid_import_meter:\n    name: grid_import_meter\n    mode: box\n    initial: 0\n    min: 0\n    max: 9999999999\n    step: 0.001\n    unit_of_measurement: kWh\n  grid_export_meter:\n    name: grid_export_meter\n    mode: box\n    initial: 0\n    min: 0\n    max: 9999999999\n    step: 0.001\n    unit_of_measurement: kWh\n```\n&gt;If you name the entities differently, make sure to reflect these changes in the workflow.\n\n2. create the following `template_sensor` entities in config.yaml or via Helpers:\n\n  [![Segéd entitások](https://my.home-assistant.io/badges/helpers.svg)](https://my.home-assistant.io/redirect/helpers/)\n\n```yaml\ntemplate:\n  - sensor:\n      - name: \"grid_energy_import\"\n        state: \"{{ states('input_number.grid_import_meter') | float(0) }}\"\n        unit_of_measurement: \"kWh\"\n        device_class: energy\n        state_class: total_increasing\n      - name: \"grid_energy_export\"\n        state: \"{{ states('input_number.grid_export_meter') | float(0) }}\"\n        unit_of_measurement: \"kWh\"\n        device_class: energy\n        state_class: total_increasing\n```\n&gt; If you name the entities differently, make sure to reflect these changes in the workflow.\n\n## n8n import and authentication\n\n1. **importing the workflow**\n\n   * In n8n → *Workflows* → *Import from File/Clipboard* → paste the JSON.\n   * Select the downloaded JSON and paste it into a new workflow using Ctrl+V.\n2. **Set up n8n Credentials**\n   The credentials must be configured in the Home Assistant and Gmail nodes. The setup process is described in the **Requirements** section.",
  "featuredImage": "/data/workflows/9010/9010.webp",
  "author": {
    "id": 101,
    "slug": "netesfiu",
    "name": "András Farkas",
    "avatar": ""
  },
  "categories": [
    "File Management"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 190,
  "downloads": 19,
  "createdAt": "2025-09-27T13:32:01.805Z",
  "updatedAt": "2026-01-16T08:58:42.867Z",
  "publishedAt": "2025-09-27T13:32:01.805Z",
  "nodes": 46,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9010"
}