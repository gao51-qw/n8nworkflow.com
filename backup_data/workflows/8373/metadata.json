{
  "id": 8373,
  "slug": "8373",
  "title": "Merge multiple Excel files into a single multi-sheet file with summary page",
  "description": "## Overview\n\nThis workflow automates the process of merging multiple `.xlsx` files from a designated folder into a single, well-organized Excel workbook. Each input file is converted into its own sheet within the output file. Additionally, a summary sheet is generated at the beginning, providing a convenient overview of all merged files, including their original names and the number of records in each.\n\nThis is particularly useful for consolidating reports, combining data from different sources, or archiving multiple spreadsheets into one manageable file.\n\n## How It Works\n\nThe workflow follows these key steps:\n\n1.  **Trigger**: The process begins when you manually execute the workflow.\n2.  **Read Files**: It reads all files ending with the `.xlsx` extension from the `/n8n_files/` directory (ensure your volume is mapped correctly).\n3.  **Process Each File**: The workflow iterates through each file one by one. For each file, it extracts the data from the first sheet.\n4.  **Collect and Clean Data**: A custom code node gathers the data from all files. It cleans the data by removing any completely empty rows and prepares it for the final Excel generation. The original filename is used to name the new sheet.\n5.  **Generate Multi-Sheet Excel**: The core logic resides in a code node that uses the `xlsx` library. It creates a new Excel workbook in memory, adds a sheet for each processed file, and populates it with the corresponding data. It also creates a \"Summary\" sheet that lists all the source files and their record counts.\n6.  **Save the Result**: The final workbook is saved as a new `.xlsx` file in the `/n8n_files/output/` directory with a timestamped filename (e.g., `合并文件_20250908T123000.xlsx`).\n\n## Setup & Prerequisites\n\nTo use this workflow, you need to configure your n8n instance to allow and use the external `xlsx` npm module.\n\n1.  **Place Your Files**: Put all the Excel files you want to merge into the folder that is mapped to `/n8n_files/` in your n8n container.\n2.  **Enable External Module**:\n      * Set the following environment variable for your n8n service in your `docker-compose.yml` file:\n        ```yaml\n        environment:\n          - NODE_FUNCTION_ALLOW_EXTERNAL=xlsx\n        ```\n3.  **Install the Module**: You must build a custom Docker image for n8n that includes the `xlsx` library.\n      * In the same directory as your `docker-compose.yml`, create a file named `Dockerfile`.\n      * Add the following content to the `Dockerfile`:\n        ```dockerfile\n        FROM n8nio/n8n:latest\n        USER root\n        RUN npm install xlsx\n        USER node\n        ```\n      * In your `docker-compose.yml`, replace the `image: n8nio/n8n...` line with `build: .` for the n8n service.\n      * Rebuild and restart your n8n container using `docker-compose up --build -d`.\n\n## Nodes Used\n\n  * **Manual Trigger**: To start the workflow.\n  * **Read Write File**: To read source files and save the final output file.\n  * **Split In Batches**: To process files one by one.\n  * **Extract From File**: To read the data from each `.xlsx` file.\n  * **Code**: For custom JavaScript logic to process data and generate the final multi-sheet Excel file using the `xlsx` library.",
  "featuredImage": "/data/workflows/8373/8373.webp",
  "author": {
    "id": 101,
    "slug": "c1499",
    "name": "Simone",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 727,
  "downloads": 72,
  "createdAt": "2025-09-08T13:36:27.227Z",
  "updatedAt": "2026-01-16T08:55:28.336Z",
  "publishedAt": "2025-09-08T13:36:27.227Z",
  "nodes": 11,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8373"
}