{
  "id": 4835,
  "slug": "4835",
  "title": "Enrich company firmographic data in Google Sheets with Explorium MCP",
  "description": "Google Sheets Company Enrichment with Explorium MCP\n\n# Template\n\nDownload the following json file and import it to a new n8n workflow:\n\n[google\\_sheets\\_enrichment.json](https://drive.usercontent.google.com/u/0/uc?id=1SxlqU2hVn41e0XTjPx12Ryrx_yil3TUq\\&export=download)\n\n![](https://files.readme.io/47bf118229ab009f2b78df40f3c1cac4d0a965d5a01b12ec1b3cd4d34f1c466e-image.png)\n\n# Overview\n\nThis n8n workflow template enables automatic enrichment of company information in your Google Sheets. When you add a new company or update existing company details (name or website), the workflow automatically fetches additional business intelligence data using Explorium MCP and updates your sheet with:\n\n* Business ID\n* NAICS industry code\n* Number of employees (range)\n* Annual revenue (range)\n\n# Key Features\n\n* **Automatic Triggering**: Monitors your Google Sheet for new rows or updates to company name/website fields\n* **Smart Processing**: Only processes new or modified rows, not the entire sheet\n* **Data Validation**: Ensures both company name and website are present before processing\n* **Error Handling**: Processes each row individually to prevent one failure from affecting others\n* **Powered by AI**: Uses Claude Sonnet 4 with Explorium MCP for intelligent data enrichment\n\n# Prerequisites\n\nBefore setting up this workflow, ensure you have:\n\n1. **n8n instance** (self-hosted or cloud)\n2. **Google account** with access to Google Sheets\n3. **Anthropic API key** for Claude\n4. ***Explorium MCP API key***\n\n<br />\n\n# Installation & Setup\n\n## Step 1: Import the Workflow\n\n1. Create a new workflow.\n2. Download the workflow JSON from above.\n3. In your n8n instance, go to **Workflows** → **Add Workflow** → **Import from File**\n4. Select the JSON file and click **Import**\n\n## Step 2: Create Google Sheet\n\n1. Create a new google sheet (or make a copy of this [template](https://docs.google.com/spreadsheets/d/14PypuKFWkMftiCtPrekpbav63tEGmgGgUP3cDwv7wXE/edit?usp=sharing))\n2. Your Google Sheet must have the following columns (exact names):\n\n* `name` - Company name\n* `website` - Company website URL\n* `business_id` - Will be populated by the workflow\n* `naics` - Will be populated by the workflow\n* `number_of_employees_range` - Will be populated by the workflow\n* `yearly_revenue_range` - Will be populated by the workflow\n\n<br />\n\n## Step 3: Configure Google Sheets Credentials\n\nYou'll need to set up two Google credentials:\n\n#### Google Sheets Trigger Credentials:\n\n1. Click on the **Google Sheets Trigger** node\n2. Under Credentials, click **Create New**\n3. If working on n8n Cloud, Click the 'Sign in with Google' button\n\n   ![](https://files.readme.io/200aac6aa2ac8e4d671f50d8d6c2186e4c571449ec57610d5209a036c968caf1-image.png)\n\n4. Grant permissions to read and monitor your Google Sheets\n5. If working on n8n Instance, Follow the OAuth2 authentication process [here](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-generic/#finish-your-n8n-credential)\n6. Fill the Client ID and Client Secret fields\n\n![](https://files.readme.io/789e2e7e6f7921533ac90c703b4307f90d6b913b187632b61f2f0957687739c7-image.png)\n\n#### Google Sheets Update Credentials:\n\n1. Click on the **Update Company Row** node\n2. Under Credentials, select the same credentials or create new ones (The same you did above)\n3. Ensure permissions include write access to your sheets\n\n## Step 4: Configure Anthropic Credentials\n\n1. Click on the **Anthropic Chat Model** node\n2. Under Credentials, click **Create New**\n3. Enter your Anthropic API key\n\n![](https://files.readme.io/d5647de529ef23690408c6633136648999496c573dfac31e135868f2d1e3e30e-image.png)\n\n4. Save the credentials\n\n## Step 5: Configure Explorium MCP Credentials\n\n1. Click on the **MCP Client** node\n2. Under Credentials, click **Create New** (Header Auth)\n3. Fill the Name field with `api_key`\n4. Fill the Value field with your Explorium API Key\n\n![](https://files.readme.io/8b89ad77232f806faab6590caca7dacc7a673f61ba10275f75e5bfec202fdbd5-image.png)\n\n4. Save the credentials\n\n## Step 6: Link Your Google Sheet\n\n1. In the **Google Sheets Trigger** node:\n\n   * Select your Google Sheet from the dropdown\n   * Select the worksheet (usually \"Sheet1\")\n\n   ![](https://files.readme.io/a8b6a167d9bc140714c7bdd08af5c08597f0a58af73231d239a46c95410cf051-image.png)\n\n2. In the **Update Company Row** node:\n   * Select the same Google Sheet and worksheet\n   * Ensure the matching column is set to `row_number`\n\n   ![](https://files.readme.io/10bfafaaa3572bc805d5482d038348d41bced7b03bf94c8f04a377218d7dcaa3-image.png)\n\n## Step 7: Activate the Workflow\n\n1. Click the **Active** toggle in the top right to activate the workflow\n2. The workflow will now monitor your sheet every minute for changes\n\n# How It Works\n\n## Workflow Process Flow\n\n1. **Google Sheets Trigger**: Polls your sheet every minute for new rows or changes to name/website fields\n2. **Filter Valid Rows**: Validates that both company name and website are present\n3. **Loop Over Items**: Processes each company individually\n4. **AI Agent**: Uses Explorium MCP to:\n   * Find the company's business ID\n   * Retrieve firmographic data (revenue, employees, NAICS code)\n5. **Format Output**: Structures the data for Google Sheets\n6. **Update Company Row**: Writes the enriched data back to the original row\n\n## Trigger Behavior\n\n* **First Activation**: May process all existing rows to establish a baseline\n* **Ongoing Operation**: Only processes new rows or rows where name/website fields change\n* **Polling Frequency**: Checks for changes every minute\n\n# Usage\n\n## Adding New Companies\n\n1. Add a new row to your Google Sheet\n2. Fill in the `name` and `website` columns\n3. Within 1 minute, the workflow will automatically:\n   * Detect the new row\n   * Enrich the company data\n   * Update the remaining columns\n\n## Updating Existing Companies\n\n1. Modify the `name` or `website` field of an existing row\n2. The workflow will re-process that row with the updated information\n3. All enrichment data will be refreshed\n\n## Monitoring Executions\n\n1. In n8n, go to **Executions** to see workflow runs\n2. Each execution shows:\n   * Which rows were processed\n   * Success/failure status\n   * Detailed logs for troubleshooting\n\n# Troubleshooting\n\n## Common Issues\n\n**All rows are processed instead of just new/updated ones**\n\n* Ensure the workflow is **activated**, not just run manually\n* Manual test runs will process all rows\n* First activation may process all rows once\n\n**No data is returned for a company**\n\n* Verify the company name and website are correct\n* Check if the company exists in Explorium's database\n* Some smaller or newer companies may not have data available\n\n**Workflow isn't triggering**\n\n* Confirm the workflow is activated (Active toggle is ON)\n* Check that changes are made to the `name` or `website` columns\n* Verify Google Sheets credentials have proper permissions\n\n**Authentication errors**\n\n* Re-authenticate Google Sheets credentials\n* Verify Anthropic API key is valid and has credits\n* Check Explorium Bearer token is correct and active\n\n## Error Handling\n\nThe workflow processes each row individually, so if one company fails to enrich:\n\n* Other rows will still be processed\n* The failed row will retain its original data\n* Check the execution logs for specific error details\n\n# Best Practices\n\n1. **Data Quality**: Ensure company names and websites are accurate for best results\n2. **Website Format**: Include full URLs ([https://example.com](https://example.com)) rather than just domain names\n3. **Batch Processing**: The workflow handles multiple updates efficiently, so you can add several companies at once\n4. **Regular Monitoring**: Periodically check execution logs to ensure smooth operation\n\n# API Limits & Considerations\n\n* **Google Sheets API**: Subject to Google's API quotas\n* **Anthropic API**: Each enrichment uses Claude Sonnet 4 tokens\n* **Explorium MCP**: Rate limits may apply based on your subscription\n\n# Support\n\nFor issues specific to:\n\n* **n8n platform**: Consult n8n documentation or community\n* **Google Sheets integration**: Check n8n's Google Sheets node documentation\n* **Explorium MCP**: Contact Explorium support for API-related issues\n* **Anthropic/Claude**: Refer to Anthropic's documentation for API issues\n\n# Example Use Cases\n\n1. **Sales Prospecting**: Automatically enrich lead lists with company size and revenue data\n2. **Market Research**: Build comprehensive databases of companies in specific industries\n3. **Competitive Analysis**: Track and monitor competitor information\n4. **Investment Research**: Gather firmographic data for potential investment targets",
  "featuredImage": "/data/workflows/4835/4835.webp",
  "author": {
    "id": 101,
    "slug": "explorium",
    "name": "explorium",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "AI Summarization"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1296,
  "downloads": 129,
  "createdAt": "2025-06-10T06:35:10.916Z",
  "updatedAt": "2026-01-16T08:36:27.570Z",
  "publishedAt": "2025-06-10T06:35:10.916Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4835"
}