{
  "workflow": {
    "id": 9689,
    "name": "Parse & track orders from email with Gemini/GPT & Notion database sync",
    "views": 86,
    "recentViews": 0,
    "totalViews": 86,
    "createdAt": "2025-10-15T08:37:51.200Z",
    "description": "# **Automated Email Order Tracking System with AI Classification and Notion Sync**\n\n## Overview\n\n**‚ö†Ô∏è Self-Hosted Solution Required**  \nThis workflow requires a self-hosted n8n instance with active integrations for Gmail, Google Gemini AI, OpenAI, and Notion. API credentials and database IDs must be configured before use.\n\n---\n\n## Template Image\n\n![image.png](fileId:3011)\n---\n\n## Description\n\nThis intelligent automation system monitors your Gmail inbox for order-related emails, extracts key order information using AI, and automatically syncs the data to a Notion database for centralized order tracking. Perfect for individuals managing multiple e-commerce accounts or small businesses tracking customer orders across various platforms (Amazon, Noon, Namshi, etc.).\n\n### **What This Workflow Does**\n\n1. **Email Monitoring**: Continuously monitors Gmail inbox for new incoming emails\n2. **Smart Classification**: Uses AI to identify order-related emails (confirmations, shipping notifications, delivery updates)\n3. **Intelligent Extraction**: Parses email content to extract order details (order number, items, prices, status, delivery info)\n4. **Database Synchronization**: Automatically creates or updates Notion database records with order information\n5. **Status Tracking**: Monitors order progression through stages (Ordered ‚Üí Shipped ‚Üí Out for Delivery ‚Üí Delivered)\n\n### **Key Features**\n\n- **Multi-vendor support**: Works with any e-commerce platform (Amazon, Noon, Carrefour, Namshi, etc.)\n- **Duplicate prevention**: Searches existing records before creating new entries\n- **Smart updates**: Only modifies records when order status actually changes\n- **Status validation**: Detects backward status changes (potential returns/reshipments)\n- **Graceful error handling**: Handles missing data and optional fields intelligently\n- **Timestamped history**: Maintains audit trail of all status changes\n\n### **Technologies Used**\n\n- **Gmail Trigger**: Email monitoring\n- **JavaScript Code**: Email content classification with pattern matching\n- **Google Gemini AI / OpenAI**: Natural language processing for order extraction\n- **Structured Output Parser**: JSON formatting and validation\n- **Notion API**: Database search, create, and update operations\n\n---\n\n## Prerequisites\n\nBefore setting up this workflow, ensure you have:\n\n1. **Self-hosted n8n instance** (version 1.0.0 or higher)\n2. **Gmail account** with IMAP access enabled\n3. **Google Gemini API key** OR **OpenAI API key**\n4. **Notion workspace** with:\n   - Integration access configured\n   - Database created with the required schema (see below)\n   - Integration token/API key\n\n---\n\n## Notion Database Schema\n\nCreate a Notion database with the following properties:\n\n### **Required Properties**\n| Property Name | Type | Description |\n|--------------|------|-------------|\n| Name of the Item | Title | Product/item name |\n| Order Number | Text | Unique order identifier |\n| Quantity | Number | Number of items |\n| Expected Date | Date or Text | Expected delivery date |\n| Order Status | Select | Options: `Ordered`, `Shipped`, `Out for Delivery`, `Delivered` |\n\n### **Optional Properties** (Recommended)\n| Property Name | Type | Description |\n|--------------|------|-------------|\n| Vendor | Select | E-commerce platform (Amazon, Noon, etc.) |\n| Customer Name | Rich Text | Order recipient name |\n| Price | Number or Rich Text | Item price |\n| Order Total | Number | Total order amount |\n| Currency | Select | Currency code (AED, USD, SAR, etc.) |\n| Delivery Location | Rich Text | Delivery city/address |\n| Notes | Rich Text | Status change history |\n| Created Date | Created Time | Auto-populated by Notion |\n| Last Updated | Last Edited Time | Auto-populated by Notion |\n\n---\n\n## Setup Instructions\n\n### **Step 1: Import the Workflow**\n\n1. Copy the workflow JSON from this template\n2. In your n8n instance, go to **Workflows** ‚Üí **Add Workflow** ‚Üí **Import from File/URL**\n3. Paste the JSON and click **Import**\n\n---\n\n### **Step 2: Configure Gmail Trigger**\n\n1. Click on the **Gmail Trigger** node\n2. Click **Create New Credential**\n3. Follow the OAuth authentication flow to connect your Gmail account\n4. Configure trigger settings:\n   - **Trigger On**: `Message Received`\n   - **Filters**: (Optional) Add label filters to monitor specific folders\n\n---\n\n### **Step 3: Configure AI Model (Choose One)**\n\n#### **Option A: Google Gemini AI**\n\n1. Click on the **Google Gemini AI Model** node\n2. Click **Create New Credential**\n3. Enter your Gemini API key (obtain from [Google AI Studio](https://makersuite.google.com/app/apikey))\n4. Select model: `gemini-1.5-pro` or `gemini-1.5-flash`\n\n#### **Option B: OpenAI**\n\n1. Click on the **OpenAI Chat Model** node\n2. Click **Create New Credential**\n3. Enter your OpenAI API key (obtain from [OpenAI Platform](https://platform.openai.com/api-keys))\n4. Select model: `gpt-4o` or `gpt-4-turbo`\n\n---\n\n### **Step 4: Update Email Classification Node**\n\n1. Click on the **Check Email Type** node (JavaScript code)\n2. Review the classification patterns (pre-configured for common e-commerce emails)\n3. (Optional) Add custom keywords specific to your vendors\n\n---\n\n### **Step 5: Configure Notion Integration**\n\n#### **5.1: Create Notion Integration**\n\n1. Go to [Notion Integrations](https://www.notion.so/my-integrations)\n2. Click **New Integration**\n3. Name it (e.g., \"n8n Order Tracker\")\n4. Select your workspace\n5. Copy the **Internal Integration Token**\n\n#### **5.2: Share Database with Integration**\n\n1. Open your Notion order database\n2. Click **Share** ‚Üí **Invite**\n3. Search for your integration name and select it\n4. Grant **Edit** permissions\n\n#### **5.3: Get Database ID**\n\n1. Open your Notion database in browser\n2. Copy the database ID from the URL:\n   ```\n   https://notion.so/workspace/DATABASE_ID?v=...\n                              ^^^^^^^^^^^^\n   ```\n\n#### **5.4: Configure Notion Nodes**\n\n1. Click on **Search a database in Notion** node\n2. Click **Create New Credential**\n3. Paste your Integration Token\n4. In the node parameters:\n   - **Database ID**: Paste your database ID\n   - **Filter**: Set to search by `Order Number` property\n\n5. Repeat credential setup for **Create a database page in Notion** and **Update a database page in Notion** nodes\n\n---\n\n### **Step 6: Update Agent Prompts**\n\n1. Click on the **Email Classification and Extraction Agent** node\n2. Review the system prompt (pre-configured for common order emails)\n3. Update the `{{$now}}` variable if using a different timezone\n4. (Optional) Customize extraction rules for specific vendors\n\n5. Click on the **Order Database Sync Agent** node\n6. Replace `{{notion_database_id}}` with your actual database ID in the prompt\n7. Review status handling logic\n\n---\n\n### **Step 7: Test the Workflow**\n\n1. Click **Execute Workflow** to activate it\n2. Send yourself a test order confirmation email\n3. Monitor the execution:\n   - Check if email was classified correctly\n   - Verify extraction output in the AI agent node\n   - Confirm Notion database was updated\n4. Review your Notion database for the new/updated record\n\n---\n\n### **Step 8: Activate for Production**\n\n1. Click **Active** toggle in the top-right corner\n2. The workflow will now run automatically for new emails\n3. Monitor executions in the **Executions** tab\n\n---\n\n## Workflow Node Descriptions\n\n### **Email Trigger**\nMonitors Gmail inbox for new incoming emails and triggers the workflow when a message is received.\n\n### **Check Email Type**\nJavaScript code node that analyzes email content using pattern matching to identify order-related emails based on keywords, order numbers, and shipping terminology.\n\n### **Email Router (IF Node)**\nRoutes emails based on classification results:\n- **TRUE branch**: Order-related emails proceed to extraction\n- **FALSE branch**: Non-order emails are filtered out (no action)\n\n### **Email Classification and Extraction Agent**\nAI-powered parser using Google Gemini or OpenAI to extract structured order information:\n- Order number, items, prices, quantities\n- Order status (Ordered/Shipped/Out for Delivery/Delivered)\n- Customer name, delivery location, expected dates\n- Vendor identification\n\n### **Structured Output Parser**\nValidates and formats AI extraction output into clean JSON for downstream processing.\n\n### **Search a database in Notion**\nQueries the Notion database by order number to check if a record already exists, preventing duplicates.\n\n### **Order Database Sync Agent**\nIntelligent database manager that decides whether to create new records or update existing ones based on search results and status comparison.\n\n### **Create a database page in Notion**\nAdds new order records to Notion when no existing record is found.\n\n### **Update a database page in Notion**\nModifies existing records when order status changes, appending timestamped notes for audit history.\n\n### **No Action Taken**\nTerminates workflow branch for non-order emails with no further processing.\n\n---\n\n## Customization Options\n\n### **Add More Vendors**\nEdit the **Check Email Type** node to add vendor-specific keywords:\n```javascript\nconst customVendors = [\n  'your-vendor-name',\n  'vendor-domain.com'\n];\n```\n\n### **Modify Status Values**\nUpdate the **Email Classification and Extraction Agent** prompt to add custom status values or change status progression logic.\n\n### **Add Email Notifications**\nInsert a **Send Email** node after database sync to receive notifications for status changes.\n\n### **Filter by Labels**\nConfigure Gmail Trigger to monitor only specific labels (e.g., \"Orders\", \"Shopping\").\n\n### **Multi-Database Support**\nDuplicate the Notion sync section to route different vendors to separate databases.\n\n---\n\n## Troubleshooting\n\n### **Email not being classified as order**\n- Check the **Check Email Type** node output\n- Add vendor-specific keywords to the classification patterns\n- Review email content for order indicators\n\n### **AI extraction returning empty data**\n- Verify AI model credentials are valid\n- Check if email content is being passed correctly\n- Review the extraction prompt for compatibility with email format\n\n### **Notion database not updating**\n- Confirm integration has edit permissions on the database\n- Verify database ID is correct in all Notion nodes\n- Check that property names in the workflow match your Notion schema exactly\n\n### **Duplicate records being created**\n- Ensure **Search a database in Notion** node is filtering by `Order Number`\n- Verify the search results are being evaluated correctly in the sync agent\n\n### **Status not updating**\n- Check if the **Order Database Sync Agent** is comparing current vs new status\n- Review the status comparison logic in the agent prompt\n\n---\n\n## Performance Considerations\n\n- **Email Volume**: This workflow processes each email individually. For high-volume inboxes, consider adding filters or label-based routing.\n- **AI Costs**: Each email classification uses AI tokens. Monitor your API usage and costs.\n- **Rate Limits**: Notion API has rate limits (3 requests/second). The workflow handles this gracefully with built-in error handling.\n\n---\n\n## Privacy & Security\n\n- All email content is processed through AI APIs (Google/OpenAI) - review their privacy policies\n- Notion data is stored in your workspace with your configured permissions\n- No data is stored or logged outside your n8n instance, AI provider, and Notion workspace\n- Consider using self-hosted AI models for sensitive order information\n\n---\n\n## Support & Contributions\n\nFound a bug or have a suggestion? Please open an issue or contribute improvements to this template!\n\n---\n\n## License\n\nThis template is provided as-is under the MIT License. Feel free to modify and distribute as needed.\n\n---\n\n## Credits\n\nCreated for the n8n community to streamline e-commerce order tracking across multiple platforms.",
    "workflow": {
      "id": "tSvYrl1nDEQAakeo",
      "meta": {
        "instanceId": "4004e259d7c32fb84e7e989ad65605c716ae645dcc01b59c6472fbe27f19fc08",
        "templateCredsSetupCompleted": true
      },
      "name": "order management template",
      "tags": [],
      "nodes": [
        {
          "id": "97df5595-af92-4547-a481-69005279badb",
          "name": "Gmail Trigger",
          "type": "n8n-nodes-base.gmailTrigger",
          "position": [
            -1264,
            1280
          ],
          "parameters": {
            "filters": {},
            "pollTimes": {
              "item": [
                {
                  "mode": "everyMinute"
                }
              ]
            }
          },
          "credentials": {
            "gmailOAuth2": {
              "id": "credential-id",
              "name": "gmailOAuth2 Credential"
            }
          },
          "typeVersion": 1.3
        },
        {
          "id": "68518ec5-5b68-4ffc-8f6a-4735290337bc",
          "name": "Google Gemini Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "position": [
            -560,
            1248
          ],
          "parameters": {
            "options": {},
            "modelName": "models/gemini-2.5-pro"
          },
          "credentials": {
            "googlePalmApi": {
              "id": "credential-id",
              "name": "googlePalmApi Credential"
            }
          },
          "typeVersion": 1
        },
        {
          "id": "3d21f84e-cf1c-4057-9a3d-b52f4c7dbb3e",
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            -432,
            1248
          ],
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "credential-id",
              "name": "openAiApi Credential"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "b406d6a9-169a-4942-98b5-e80d125e2a68",
          "name": "Structured Output Parser",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            -272,
            1248
          ],
          "parameters": {
            "jsonSchemaExample": "{\n  \"extraction_success\": true,\n  \"vendor\": \"Amazon\",\n  \"customer_name\": \"Jim\",\n  \"order_number\": \"408-0237654-1573974\",\n  \"order_status\": \"Ordered\",\n  \"delivery_info\": {\n    \"location\": \"Dubai\",\n    \"expected_date\": \"2025-10-15\",\n    \"status_description\": \"Arriving Wednesday\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Pilot Automotive Wh553-16S-Bs Black 16 Inch Wheel Cover\",\n      \"quantity\": 1,\n      \"price\": \"AED120.00\",\n      \"currency\": \"AED\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"AED127.00\",\n    \"currency\": \"AED\"\n  },\n  \"confidence\": \"High\",\n  \"notes\": \"Order details extracted successfully\"\n}"
          },
          "typeVersion": 1.3
        },
        {
          "id": "ec6e8b1e-7510-4a21-989b-c2f602bc0d7a",
          "name": "Create a database page in Notion",
          "type": "n8n-nodes-base.notionTool",
          "position": [
            -128,
            1344
          ],
          "parameters": {
            "options": {},
            "resource": "databasePage",
            "databaseId": {
              "__rl": true,
              "mode": "list",
              "value": "28accb46-01db-808b-833b-db3c006c2c4d",
              "cachedResultUrl": "https://www.notion.so/28accb4601db808b833bdb3c006c2c4d",
              "cachedResultName": "Order Managment"
            },
            "propertiesUi": {
              "propertyValues": [
                {
                  "key": "Order Number|title",
                  "title": "={{ $json.output.order_number }}"
                },
                {
                  "key": "Name of the Item|rich_text",
                  "textContent": "={{ $json.output.items[0].item_name }}"
                },
                {
                  "key": "Expected Date|rich_text",
                  "textContent": "={{ $json.output.delivery_info.expected_date }}"
                },
                {
                  "key": "Order Status|select",
                  "selectValue": "={{ $json.output.order_status }}"
                },
                {
                  "key": "Quantity|number",
                  "numberValue": "={{ $json.output.items[0].quantity }}"
                }
              ]
            }
          },
          "credentials": {
            "notionApi": {
              "id": "credential-id",
              "name": "notionApi Credential"
            }
          },
          "typeVersion": 2.2
        },
        {
          "id": "87446742-940c-47ea-8509-5ca4b7c95403",
          "name": "Update a database page in Notion",
          "type": "n8n-nodes-base.notionTool",
          "position": [
            272,
            1344
          ],
          "parameters": {
            "pageId": {
              "__rl": true,
              "mode": "url",
              "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Database_Page', ``, 'string') }}"
            },
            "options": {},
            "resource": "databasePage",
            "operation": "update",
            "propertiesUi": {
              "propertyValues": [
                {
                  "key": "Order Status|select",
                  "selectValue": "={{ $fromAI('property_order_status') }}"
                }
              ]
            }
          },
          "credentials": {
            "notionApi": {
              "id": "credential-id",
              "name": "notionApi Credential"
            }
          },
          "typeVersion": 2.2
        },
        {
          "id": "90f2d910-6a08-44a0-98ef-0874c3a0b2b4",
          "name": "Send a message",
          "type": "n8n-nodes-base.gmail",
          "position": [
            368,
            1136
          ],
          "webhookId": "81de3c05-975e-45ab-a36e-cd8a7b939066",
          "parameters": {
            "sendTo": "user@example.com",
            "message": "={{ $json.output }}",
            "options": {
              "appendAttribution": false
            },
            "subject": "ORDER CHANGE",
            "emailType": "text"
          },
          "credentials": {
            "gmailOAuth2": {
              "id": "credential-id",
              "name": "gmailOAuth2 Credential"
            }
          },
          "typeVersion": 2.1
        },
        {
          "id": "160b8d42-a23a-4645-9455-b9074bb9bfd9",
          "name": "Email Classification and Extraction Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            -528,
            1024
          ],
          "parameters": {
            "text": "=subject:{{ $json.Subject }}\n\n{{ $json.snippet }}",
            "options": {
              "systemMessage": "=# Email Order Extraction Agent\n\n## Role\nYou are an intelligent email parsing assistant specialized in extracting order information from e-commerce confirmation and shipping notification emails. Your task is to accurately identify and extract key order details from emails sent by various online retailers and vendors.\n\n## Current Context\n**Current Date & Time**: {{$now}}\n**Timezone**: UAE (GMT+4)\n\n## Supported Vendors\nWhile you should be able to parse emails from any e-commerce vendor, common sources include:\n- Amazon\n- Noon\n- Namshi\n- Sharaf DG\n- Carrefour\n- Other online retailers and marketplaces\n\n## Information to Extract\n\nYou must extract the following fields from each order confirmation or shipping email:\n\n### 1. **Order Number** (Required)\n- Field names to look for: \"Order #\", \"Order Number\", \"Order ID\", \"Reference Number\", \"Tracking Number\"\n- Format varies by vendor (e.g., \"408-0237654-1573974\", \"ORD-2024-12345\", \"NM-567890\")\n- Extract the complete alphanumeric identifier\n\n### 2. **Item Name(s)** (Required)\n- Extract the full product name/title\n- If multiple items in one order, extract all items as a list\n- Include relevant details like brand, model, size, color if visible\n- Remove unnecessary text like \"View product\" or \"Buy again\"\n\n### 3. **Price** (Required)\n- Extract the price for each item\n- Always include currency (AED, USD, SAR, etc.)\n- Look for: \"AED\", \"$\", \"SAR\", \"QAR\", or other currency symbols\n- Note if it's a subtotal, total, or per-item price\n- If multiple items, extract individual prices AND total if available\n\n### 4. **Order Status** (Required)\n- Must be one of these standardized values:\n  - **\"Ordered\"** - Order placed but not yet shipped\n  - **\"Shipped\"** - Order has been dispatched\n  - **\"Out for Delivery\"** - Order is with delivery courier for final delivery\n  - **\"Delivered\"** - Order has been delivered to customer\n- Look for visual indicators: progress bars, checkmarks, status badges\n- Check for status keywords: \"confirmed\", \"dispatched\", \"in transit\", \"arriving\", \"delivered\"\n\n### 5. **Additional Information** (Optional but Recommended)\n- **Customer Name**: Recipient or account holder name\n- **Delivery Address**: City or full address if visible\n- **Expected Delivery Date**: \"Arriving Wednesday\", \"Expected by Oct 15\", etc.\n- **Quantity**: Number of units per item\n- **Vendor/Retailer**: Who sent the email (Amazon, Noon, etc.)\n\n## Extraction Process\n\n### Step 1: Identify Email Type\nDetermine if the email is:\n- Order confirmation (just placed)\n- Shipping notification (order dispatched)\n- Delivery update (out for delivery)\n- Delivery confirmation (completed)\n\n### Step 2: Locate Order Number\n- Scan for \"Order #\", \"Order Number\", \"Order ID\", or similar\n- Usually found near the top of email or in header\n- May be preceded by vendor code (e.g., \"Order # 408-0237654-1273974\")\n\n### Step 3: Extract Item Details\n- Look for product names, usually as links or bold text\n- Find associated prices (may be in table format or listed items)\n- Note quantities if multiple units of same item\n\n### Step 4: Determine Order Status\n- Check for progress indicators (visual timeline, checkmarks, status bars)\n- Read status text: \"Your order has been shipped\", \"Arriving Wednesday\"\n- Map to one of four standard statuses: Ordered, Shipped, Out for Delivery, Delivered\n- Use contextual clues:\n  - \"Thanks for your order\" + no shipping info = **Ordered**\n  - \"Has been shipped\" / \"Dispatched\" = **Shipped**\n  - \"Arriving today\" / \"With courier\" / \"Out for delivery\" = **Out for Delivery**\n  - \"Was delivered\" / \"Completed\" = **Delivered**\n\n### Step 5: Extract Supporting Details\n- Customer name (usually in greeting or shipping address)\n- Delivery location\n- Expected delivery date\n- Total order value\n\n## Status Determination Rules\n\nUse these guidelines to map various status descriptions to the four standard statuses:\n\n### **Ordered** üõí\n- \"Order confirmed\"\n- \"Order placed\"\n- \"Order received\"\n- \"Processing\"\n- \"Preparing for shipment\"\n- First stage of progress indicator active\n\n### **Shipped** üì¶\n- \"Shipped\"\n- \"Dispatched\"\n- \"On its way\"\n- \"In transit\"\n- \"Left facility\"\n- Second stage of progress indicator active\n\n### **Out for Delivery** üöö\n- \"Out for delivery\"\n- \"With delivery partner\"\n- \"Arriving today\"\n- \"Last mile delivery\"\n- Third stage of progress indicator active\n\n### **Delivered** ‚úÖ\n- \"Delivered\"\n- \"Completed\"\n- \"Received\"\n- \"Handed to resident\"\n- Final stage of progress indicator complete\n\n## Output Format\n\nYou MUST respond with ONLY valid JSON in this exact structure. Do not include any markdown code blocks, explanatory text, or formatting - just raw JSON:\n\n```json\n{\n  \"extraction_success\": true,\n  \"vendor\": \"string\",\n  \"customer_name\": \"string\",\n  \"order_number\": \"string\",\n  \"order_status\": \"string\",\n  \"delivery_info\": {\n    \"location\": \"string\",\n    \"expected_date\": \"string\",\n    \"status_description\": \"string\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"string\",\n      \"quantity\": 1,\n      \"price\": \"string\",\n      \"currency\": \"string\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"string\",\n    \"currency\": \"string\"\n  },\n  \"confidence\": \"string\",\n  \"notes\": \"string\"\n}\n```\n\n## Example Outputs\n\n### Example 1: Amazon Order Out for Delivery\n\n**Email Content:**\n```\nYour package is out for delivery!\n\nOrder # 408-0237654-1273974\nArriving today\nJameson - Dubai\n\nProgress: [‚úì] Ordered ‚Üí [‚úì] Shipped ‚Üí [‚úì] Out for delivery ‚Üí [ ] Delivered\n\nPilot Automotive Wh553-16S-Bs Black 16 Inch Wheel Cover\nQuantity: 1\nAED120.00\n\nTotal: AED127.00\n```\n\n**Expected Output:**\n```json\n{\n  \"extraction_success\": true,\n  \"vendor\": \"Amazon\",\n  \"customer_name\": \"Jim\",\n  \"order_number\": \"408-0237654-1573974\",\n  \"order_status\": \"Out for Delivery\",\n  \"delivery_info\": {\n    \"location\": \"Dubai\",\n    \"expected_date\": \"today\",\n    \"status_description\": \"Arriving today\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Pilot Automotive Wh553-16S-Bs Black 16 Inch Wheel Cover\",\n      \"quantity\": 1,\n      \"price\": \"120.00\",\n      \"currency\": \"AED\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"127.00\",\n    \"currency\": \"AED\"\n  },\n  \"confidence\": \"High\",\n  \"notes\": \"Complete order information with clear delivery status\"\n}\n```\n\n### Example 2: Noon Shipped Order\n\n**Email Content:**\n```\nYour order has been shipped!\n\nOrder ID: NM-2024-556677\nExpected delivery: Tomorrow, Oct 15\n\nStatus: Shipped ‚úì\n\nSamsung 55\" Crystal UHD Smart TV\nPrice: AED1,899.00\nQty: 1\n\nOrder Total: AED1,899.00\nDelivering to: Ahmed Hassan - Abu Dhabi\n```\n\n**Expected Output:**\n```json\n{\n  \"extraction_success\": true,\n  \"vendor\": \"Noon\",\n  \"customer_name\": \"Ahmed Hassan\",\n  \"order_number\": \"NM-2024-556677\",\n  \"order_status\": \"Shipped\",\n  \"delivery_info\": {\n    \"location\": \"Abu Dhabi\",\n    \"expected_date\": \"2025-10-15\",\n    \"status_description\": \"Shipped - Arriving tomorrow\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Samsung 55\\\" Crystal UHD Smart TV\",\n      \"quantity\": 1,\n      \"price\": \"1899.00\",\n      \"currency\": \"AED\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"1899.00\",\n    \"currency\": \"AED\"\n  },\n  \"confidence\": \"High\",\n  \"notes\": \"Clear shipping notification with delivery date\"\n}\n```\n\n### Example 3: Multiple Items Order\n\n**Email Content:**\n```\nThanks for your order!\n\nOrder # ORD-2024-12345\nArriving Oct 16, 2025\n\nItems:\n1. Samsung Galaxy Buds Pro 2 - AED599.00 (Qty: 1)\n2. Anker PowerBank 20000mAh - AED149.00 (Qty: 2)\n\nSubtotal: AED897.00\nShipping: AED15.00\nTotal: AED912.00\n\nShip to: Sarah Ahmed - Sharjah\n```\n\n**Expected Output:**\n```json\n{\n  \"extraction_success\": true,\n  \"vendor\": \"Unknown\",\n  \"customer_name\": \"Sarah Ahmed\",\n  \"order_number\": \"ORD-2024-12345\",\n  \"order_status\": \"Ordered\",\n  \"delivery_info\": {\n    \"location\": \"Sharjah\",\n    \"expected_date\": \"2025-10-16\",\n    \"status_description\": \"Arriving Oct 16, 2025\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Samsung Galaxy Buds Pro 2\",\n      \"quantity\": 1,\n      \"price\": \"599.00\",\n      \"currency\": \"AED\"\n    },\n    {\n      \"item_name\": \"Anker PowerBank 20000mAh\",\n      \"quantity\": 2,\n      \"price\": \"149.00\",\n      \"currency\": \"AED\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"912.00\",\n    \"currency\": \"AED\"\n  },\n  \"confidence\": \"High\",\n  \"notes\": \"Multiple items in single order\"\n}\n```\n\n## Edge Cases & Error Handling\n\n### Missing Information\nIf any required field cannot be found:\n```json\n{\n  \"extraction_success\": false,\n  \"error\": \"Missing required field: order_number\",\n  \"partial_data\": {\n    \"vendor\": \"Unknown\",\n    \"items\": []\n  },\n  \"confidence\": \"Low\",\n  \"notes\": \"Order number could not be located in email content\"\n}\n```\n\n### Ambiguous Status\nIf status is unclear, use best judgment and note uncertainty:\n```json\n{\n  \"extraction_success\": true,\n  \"order_status\": \"Shipped\",\n  \"confidence\": \"Medium\",\n  \"notes\": \"Status not explicitly stated. Inferred from 'dispatched from warehouse' language.\"\n}\n```\n\n### Multiple Currencies\nIf email contains multiple currencies (e.g., international order):\n```json\n{\n  \"order_total\": {\n    \"amount\": \"367.00\",\n    \"currency\": \"AED\",\n    \"original_amount\": \"100.00\",\n    \"original_currency\": \"USD\"\n  }\n}\n```\n\n## Important Rules\n\n1. **Always extract the complete order number** - Don't truncate or modify it\n2. **Use exact item names** - Copy the product title as written\n3. **Standardize status** - Always map to one of the four standard statuses\n4. **Include currency** - Never provide price without currency code\n5. **Handle multiple items** - Extract each item separately with individual prices\n6. **Be vendor-agnostic** - Don't make assumptions based on vendor formatting\n7. **Note confidence level** - Flag when extraction is uncertain (High/Medium/Low)\n8. **Preserve data integrity** - Don't invent information that isn't present\n9. **Extract totals carefully** - Distinguish between item price, subtotal, and total\n10. **Use context clues** - Leverage email subject, sender, and content together\n11. **Return ONLY valid JSON** - No markdown, no code blocks, no explanatory text\n\n## Processing Instructions\n\nWhen you receive email content:\n\n1. **Read the entire email** to understand context\n2. **Identify the vendor** from sender address or branding\n3. **Extract required fields** using the guidelines above\n4. **Determine order status** using visual and textual indicators\n5. **Format output** as valid JSON following the structure provided\n6. **Include confidence level** based on clarity of information\n7. **Add notes** for any ambiguities or extraction challenges\n\n## CRITICAL OUTPUT REQUIREMENTS\n\n**Your response must be ONLY valid JSON. Follow these rules strictly:**\n\n- ‚úÖ Return raw JSON without any markdown code blocks\n- ‚úÖ Use double quotes for all strings\n- ‚úÖ No trailing commas\n- ‚úÖ All values must be actual data, not placeholder text like \"string\" or \"High | Medium | Low\"\n- ‚úÖ Choose ONE value for fields like order_status (e.g., \"Out for Delivery\" not \"Ordered | Shipped | Out for Delivery | Delivered\")\n- ‚úÖ Use consistent string format for prices (numbers as strings without currency symbols)\n- ‚úÖ Date format should be YYYY-MM-DD when possible, or natural language like \"today\", \"tomorrow\"\n- ‚ùå Never include pipe characters (|) in values\n- ‚ùå Never include \"or\" between values\n- ‚ùå Never wrap JSON in ```json``` code blocks\n- ‚ùå Never add explanatory text before or after JSON\n\nYour goal is to provide accurate, structured data that can be used to track orders across multiple vendors in a unified system."
            },
            "promptType": "define",
            "needsFallback": true,
            "hasOutputParser": true
          },
          "typeVersion": 2.2
        },
        {
          "id": "17a2afdf-9d75-4ce3-988a-6d7aac982781",
          "name": "Order Database Sync Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            -32,
            1136
          ],
          "parameters": {
            "text": "={{ $json.output }}",
            "options": {
              "systemMessage": "=# Notion Order Database Sync Agent\n\n## Role\nYou are a database synchronization specialist responsible for managing order records in a Notion database. Your task is to receive order information from the email extraction agent, search for existing orders, and either update existing records or create new ones based on what you find.\n\n## Current Context\n**Current Date & Time**: {{$now}}  \n**Timezone**: UAE (GMT+4)\n**Notion Database ID**: `{{notion_database_id}}`\n\n---\n\n## Workflow Overview\n\n```\n1. Receive Order Data from Email Extraction Agent\n                    ‚Üì\n2. Search Notion Database by Order Number\n                    ‚Üì\n3. Evaluate Search Response\n                    ‚Üì\n        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n        ‚Üì                           ‚Üì\n    Found Records           No Response OR Empty Results\n        ‚Üì                           ‚Üì\n    UPDATE Record              CREATE New Record\n        ‚Üì                           ‚Üì\n        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n                    ‚Üì\n4. Return Operation Confirmation\n```\n\n---\n\n## Input Data Structure\n\nYou will receive order data in this exact format from the email extraction agent:\n\n```json\n{\n  \"extraction_success\": true,\n  \"vendor\": \"Amazon\",\n  \"customer_name\": \"Jameson\",\n  \"order_number\": \"408-0237654-1273974\",\n  \"order_status\": \"Shipped\",\n  \"delivery_info\": {\n    \"location\": \"Dubai\",\n    \"expected_date\": \"Wednesday\",\n    \"status_description\": \"Arriving Wednesday\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Pilot Automotive Wh553-16S-Bs Black\",\n      \"quantity\": 1,\n      \"price\": \"AED120.00\",\n      \"currency\": \"AED\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"AED127.00\",\n    \"currency\": \"AED\"\n  }\n}\n```\n\n---\n\n## Notion Database Schema\n\n### Required Properties (ONLY these are mandatory):\n| Property | Type | Description | Example |\n|----------|------|-------------|---------|\n| **Name of the Item** | Title | Item/Product name | `Pilot Automotive Wh553-16S-Bs Black` |\n| **Order Number** | Text | Unique order identifier | `408-0237654-1273974` |\n| **Quantity** | Number | Number of items | `1`, `2` |\n| **Expected Date** | Date or Text | Expected delivery date | `Wednesday`, `2025-10-15` |\n| **Order Status** | Select | Order status | `Ordered`, `Shipped`, `Out for Delivery`, `Delivered` |\n\n### Optional Properties (Use if available in input data):\n| Property | Type | Description | Example |\n|----------|------|-------------|---------|\n| **Vendor** | Select | E-commerce platform | `Amazon`, `Noon`, `Namshi` |\n| **Customer Name** | Rich Text | Order recipient | `Jameson` |\n| **Price** | Number or Rich Text | Item price | `AED120.00`, `120.00` |\n| **Order Total** | Number | Total amount | `127.00` |\n| **Currency** | Select | Currency code | `AED`, `USD`, `SAR` |\n| **Delivery Location** | Rich Text | Delivery city/address | `Dubai` |\n| **Notes** | Rich Text | Status change history and additional information | ‚Äî |\n| **Tracking URL** | URL | Link to order tracking page | ‚Äî |\n| **Created Date** | Created Time | Auto-populated by Notion | ‚Äî |\n| **Last Updated** | Last Edited Time | Auto-populated by Notion | ‚Äî |\n\n### Critical Field Handling Rules:\n- **REQUIRED fields must ALWAYS be included** - Cannot create/update without these\n- **OPTIONAL fields should be included ONLY if data is available** - Never fail due to missing optional fields\n- **Price/Order Total are OPTIONAL** - Create order even if price information is missing\n- **If field is missing from input, skip it** - Do not ask for it, do not fail, just omit it\n\n---\n\n## Operation Flow\n\n### Step 1: Validate Input Data\n\n**CRITICAL:** Before proceeding, verify you have received the REQUIRED fields only:\n- ‚úÖ Valid `order_number` (required)\n- ‚úÖ Valid `order_status` (required - must be one of: Ordered, Shipped, Out for Delivery, Delivered)\n- ‚úÖ At least one item with `item_name` in `items` array (required)\n- ‚úÖ Valid `quantity` for at least one item (required)\n\n**OPTIONAL fields (do NOT fail if missing):**\n- ‚≠ï `price` - Include if available, skip if not\n- ‚≠ï `order_total` - Include if available, skip if not\n- ‚≠ï `vendor` - Include if available, skip if not\n- ‚≠ï `customer_name` - Include if available, skip if not\n- ‚≠ï `delivery_location` - Include if available, skip if not\n- ‚≠ï `currency` - Include if available, skip if not\n\n**If validation fails (missing REQUIRED fields only):**\nReturn error message only if Order Number, Order Status, Item Name, or Quantity is missing.\n\n**Example validation pass:**\n```json\n{\n  \"order_number\": \"408-0237654-1273974\",  // ‚úÖ Required - Present\n  \"order_status\": \"Shipped\",               // ‚úÖ Required - Present\n  \"items\": [\n    {\n      \"item_name\": \"Pilot Automotive Wh553-16S-Bs Black\",  // ‚úÖ Required - Present\n      \"quantity\": 1                         // ‚úÖ Required - Present\n    }\n  ]\n  // price missing - ‚≠ï OPTIONAL - No problem!\n  // order_total missing - ‚≠ï OPTIONAL - No problem!\n  // vendor missing - ‚≠ï OPTIONAL - No problem!\n}\n```\n\n---\n\n### Step 2: Search Notion Database\n\n**Search Method:** Use the \"Search a database in Notion\" tool\n\n**Database Configuration:**\n- **Database ID**: Use `{{notion_database_id}}` (provided in context above)\n- **NEVER ask for database ID** - It is always available in the context\n\n**Search Criteria:**\n- Property: `Order Number` (Title field)\n- Match type: Exact match\n- Case handling: Case-insensitive recommended\n- Query: Use the exact order number from input data\n\n**Search Query Example:**\n```javascript\nnotion.databases.query({\n  database_id: \"{{notion_database_id}}\", // Use the database ID from context\n  filter: {\n    property: \"Order Number\",\n    title: {\n      equals: \"408-0237654-1573974\"\n    }\n  }\n})\n```\n\n---\n\n### Step 3: Evaluate Search Response ‚ö†Ô∏è CRITICAL LOGIC\n\n**üî¥ IMPORTANT: Handle All Search Response Scenarios**\n\nThe search tool may return three possible outcomes:\n\n#### **Scenario A: Search Returns No Response**\n- **Indicator:** Search tool throws error OR returns null/undefined OR workflow doesn't return data\n- **Reason:** Order does not exist in database\n- **Action:** **IMMEDIATELY CREATE NEW ORDER** - Do NOT treat as error\n- **Logic:** `if (no response OR error OR null) ‚Üí CREATE`\n\n#### **Scenario B: Search Returns Empty Results**\n- **Indicator:** `results.length === 0` OR empty array `[]`\n- **Reason:** Order not found in database\n- **Action:** **CREATE NEW ORDER**\n- **Logic:** `if (results.length === 0) ‚Üí CREATE`\n\n#### **Scenario C: Search Returns Results**\n- **Indicator:** `results.length === 1` - Single record found\n- **Action:** **UPDATE EXISTING ORDER**\n- **Logic:** `if (results.length === 1) ‚Üí UPDATE`\n\n#### **Scenario D: Search Returns Multiple Results**\n- **Indicator:** `results.length > 1` - Duplicate records\n- **Action:** **ERROR - Manual intervention required**\n- **Logic:** `if (results.length > 1) ‚Üí ERROR`\n\n**Decision Tree:**\n```\nSearch Executed\n      ‚Üì\nIs Response Valid?\n      ‚Üì\n  ‚îå‚îÄ‚îÄ‚îÄNO‚îÄ‚îÄ‚îÄ‚îê         YES\n  ‚Üì         ‚Üì          ‚Üì\nERROR?   NULL?    Check Results\n  ‚Üì         ‚Üì          ‚Üì\n  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò    results.length?\n       ‚Üì               ‚Üì\n   CREATE NEW    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n                 0    1    >1\n                 ‚Üì    ‚Üì     ‚Üì\n             CREATE UPDATE ERROR\n```\n\n**üö® CRITICAL RULE:**\n**IF the search tool fails, returns no response, returns null, or throws any error ‚Üí TREAT IT AS \"ORDER NOT FOUND\" and immediately CREATE a new order.**\n\n**DO NOT return failure messages for search errors. Instead, proceed directly to creating a new order.**\n\n---\n\n### Step 4A: UPDATE Existing Order\n\n**‚ö†Ô∏è ONLY execute this if search returned exactly 1 result**\n\n**Extract from search results:**\n- `page_id` - Notion page identifier\n- `url` - Database page URL (format: `https://www.notion.so/[order-number]-[page-id]`)\n- Current property values for comparison\n\n**üîç CRITICAL: Status Comparison Logic**\n\n**BEFORE making any updates, you MUST:**\n\n1. **Extract current status** from the search results\n2. **Compare** with new status from extraction agent\n3. **Decide action** based on comparison:\n\n```\nIF current_status == new_status:\n   ‚Üí NO UPDATE NEEDED\n   ‚Üí Return \"no_action\" response\n   ‚Üí Skip all update operations\n\nELSE IF current_status != new_status:\n   ‚Üí UPDATE REQUIRED\n   ‚Üí Proceed with status update\n   ‚Üí Add timestamped note\n   ‚Üí Update related fields\n```\n\n**Update Priority Matrix:**\n\n| Field | Action | Condition |\n|-------|--------|-----------|\n| **Status** | ‚úÖ Update ONLY if different | **REQUIRED:** Must compare first |\n| **Expected Delivery** | ‚úÖ Update | Only if status changed AND provided |\n| **Delivery Location** | ‚úÖ Update | Only if status changed AND provided |\n| **Notes** | ‚úÖ Append | Only if status changed |\n| **Last Updated** | ‚úÖ Auto-updated | By Notion (only if any field changed) |\n| **Order Number** | ‚ùå Never update | Immutable identifier |\n| **Customer Name** | ‚ùå Never update | Original data preserved |\n| **Items** | ‚ùå Never update | Original data preserved |\n| **Order Total** | ‚ùå Never update | Original data preserved |\n| **Vendor** | ‚ùå Never update | Original data preserved |\n| **Created Date** | ‚ùå Never update | Original timestamp preserved |\n\n**Update Logic Flow:**\n```\n1. Extract current_status from Notion search results\n2. Extract new_status from extraction agent input\n3. Compare: current_status vs new_status\n4. Decision:\n   \n   A. IF current_status == new_status:\n      - Log: \"Status unchanged - no action needed\"\n      - Return no_action response\n      - DO NOT call Notion update API\n      - DO NOT modify any fields\n   \n   B. IF current_status != new_status:\n      - Log: \"Status changed - update required\"\n      - Update Status field to new_status\n      - Append timestamped note to Notes field\n      - Update Expected Delivery if provided\n      - Call Notion update API\n   \n5. Preserve all other original order data\n```\n\n**Example Update Request:**\n```json\n{\n  \"page_url\": \"https://www.notion.so/405-0237654-1573974-28accb4601db810e9fdcd7a29d1a8b1b\",\n  \"properties\": {\n    \"Status\": {\n      \"select\": {\n        \"name\": \"Shipped\"\n      }\n    },\n    \"Expected Delivery\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Wednesday, Oct 16\"\n          }\n        }\n      ]\n    },\n    \"Notes\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"[2025-10-12 14:30 UAE] Status updated: Ordered ‚Üí Shipped | Expected delivery: Wednesday\"\n          }\n        }\n      ]\n    }\n  }\n}\n```\n\n**Status Change Note Format:**\n```\n[YYYY-MM-DD HH:MM UAE] Status updated: [Old Status] ‚Üí [New Status] | Expected delivery: [Date]\n```\n\n---\n\n### Step 4B: CREATE New Order\n\n**üü¢ Execute this when:**\n- Search returns no response (error/null/undefined)\n- Search returns empty results (`results.length === 0`)\n- Order does not exist in database\n\n**Database Configuration:**\n- **Database ID**: Use `{{notion_database_id}}` from context\n- **Tool**: Use \"Create a database page in Notion\"\n- **CRITICAL**: NEVER ask for database ID - it's always provided in context\n- **Action**: Immediately proceed with page creation using the database ID\n\n**Field Population Rules:**\n- **ALWAYS include**: Name of the Item (from first item in array), Order Number, Quantity, Expected Date, Order Status\n- **INCLUDE IF AVAILABLE**: Vendor, Customer Name, Price, Order Total, Currency, Delivery Location, Notes\n- **NEVER fail due to missing optional fields** - Just omit them from the creation request\n\n**Example Create Request (All fields available):**\n```json\n{\n  \"parent\": {\n    \"database_id\": \"{{notion_database_id}}\"\n  },\n  \"properties\": {\n    \"Name of the Item\": {\n      \"title\": [\n        {\n          \"text\": {\n            \"content\": \"Pilot Automotive Wh553-16S-Bs Black\"\n          }\n        }\n      ]\n    },\n    \"Order Number\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"408-0237654-1273974\"\n          }\n        }\n      ]\n    },\n    \"Quantity\": {\n      \"number\": 1\n    },\n    \"Expected Date\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Wednesday\"\n          }\n        }\n      ]\n    },\n    \"Order Status\": {\n      \"select\": {\n        \"name\": \"Shipped\"\n      }\n    },\n    \"Vendor\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Amazon\"\n          }\n        }\n      ]\n    },\n    \"Customer Name\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Jameson\"\n          }\n        }\n      ]\n    },\n    \"Price\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"AED120.00\"\n          }\n        }\n      ]\n    },\n    \"Order Total\": {\n      \"number\": 127.00\n    },\n    \"Currency\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"AED\"\n          }\n        }\n      ]\n    },\n    \"Delivery Location\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Dubai\"\n          }\n        }\n      ]\n    },\n    \"Notes\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"[2025-10-12 14:30 UAE] Order created from email with status: Shipped\"\n          }\n        }\n      ]\n    }\n  }\n}\n```\n\n**Example Create Request (Minimal - only required fields):**\n```json\n{\n  \"parent\": {\n    \"database_id\": \"{{notion_database_id}}\"\n  },\n  \"properties\": {\n    \"Name of the Item\": {\n      \"title\": [\n        {\n          \"text\": {\n            \"content\": \"Pilot Automotive Wh553-16S-Bs Black\"\n          }\n        }\n      ]\n    },\n    \"Order Number\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"408-0237654-1573974\"\n          }\n        }\n      ]\n    },\n    \"Quantity\": {\n      \"number\": 1\n    },\n    \"Expected Date\": {\n      \"rich_text\": [\n        {\n          \"text\": {\n            \"content\": \"Wednesday\"\n          }\n        }\n      ]\n    },\n    \"Order Status\": {\n      \"select\": {\n        \"name\": \"Shipped\"\n      }\n    }\n  }\n}\n```\n\n**üî¥ CRITICAL: Handle Missing Optional Fields**\n```\nIF price is missing:\n   ‚Üí Skip Price field (do NOT fail)\n   \nIF order_total is missing:\n   ‚Üí Skip Order Total field (do NOT fail)\n   \nIF vendor is missing:\n   ‚Üí Skip Vendor field (do NOT fail)\n   \nIF customer_name is missing:\n   ‚Üí Skip Customer Name field (do NOT fail)\n\nONLY fail if: Order Number, Order Status, Item Name, or Quantity is missing\n```\n\n---\n\n## Output Format\n\n**CRITICAL:** Your output must be a clear, concise paragraph in human-readable format. Keep it SHORT and natural.\n\n### ‚úÖ Successful Update (Status Changed):\n\n**Format:**\n```\nThe order [order_number] has changed from [old_status] to [new_status]. [Customer_name]'s order from [vendor] for [item_count] item(s) totaling [order_total] is now [new_status]. Expected delivery: [delivery_date].\n```\n\n**Example:**\n```\nThe order 408-0237654-1573974 has changed from Ordered to Shipped. Jameson's order from Amazon for 1 item totaling AED127.00 is now Shipped. Expected delivery: Wednesday.\n```\n\n---\n\n### ‚è∏Ô∏è No Action Needed (Status Unchanged):\n\n**Format:**\n```\nNo changes needed for order [order_number]. [Customer_name]'s order from [vendor] is already marked as [status]. Expected delivery: [delivery_date].\n```\n\n**Example:**\n```\nNo changes needed for order 408-0237654-1273974. Jameson's order from Amazon is already marked as Shipped. Expected delivery: Wednesday.\n```\n\n---\n\n### ‚úÖ Successful Create (New Order):\n\n**Format:**\n```\nNew order [order_number] created for [customer_name] from [vendor]. Status: [status]. [Item_count] item(s) totaling [order_total]. Delivering to [location] by [delivery_date].\n```\n\n**Example:**\n```\nNew order 408-0237654-1573974 created for Jameson from Amazon. Status: Ordered. 1 item totaling AED127.00. Delivering to Dubai by Wednesday.\n```\n\n---\n\n### ‚úÖ Successful Create (After Search Failure):\n\n**Format:**\n```\nNew order [order_number] created for [customer_name] from [vendor]. Status: [status]. [Item_count] item(s) totaling [order_total]. Delivering to [location] by [delivery_date]. (Created as order was not found in database)\n```\n\n**Example:**\n```\nNew order 408-0237654-1273974 created for Jameson from Amazon. Status: Shipped. 1 item totaling AED127.00. Delivering to Dubai by Wednesday. (Created as order was not found in database)\n```\n\n---\n\n### ‚ùå Failed Operation (Only for Create/Update failures, NOT search failures):\n\n**Format:**\n```\nFailed to create/update order [order_number]: [error_description]. [Action_needed].\n```\n\n**Example:**\n```\nFailed to create order 408-0237654-1573974: Unable to connect to Notion database. Please retry in 30 seconds.\n```\n\n---\n\n### ‚ö†Ô∏è Warning Messages (when applicable):\n\n**Status Regression:**\n```\nWarning: Order [order_number] status moved backward from [old_status] to [new_status]. This may indicate a return or reshipment.\n```\n\n**Duplicate Detected:**\n```\nError: Multiple records found for order [order_number]. Manual review required to resolve duplicate entries.\n```\n\n---\n\n## Detailed Examples\n\n### Example 1: Search Returns No Response ‚Üí Create New Order\n\n**Input from Extraction Agent:**\n```json\n{\n  \"order_number\": \"408-0237654-1573974\",\n  \"order_status\": \"Shipped\",\n  \"vendor\": \"Amazon\",\n  \"customer_name\": \"Jim\",\n  \"delivery_info\": {\n    \"location\": \"Dubai\",\n    \"expected_date\": \"Wednesday\"\n  },\n  \"items\": [\n    {\n      \"item_name\": \"Pilot Automotive Wh553-16S-Bs Black\",\n      \"quantity\": 1,\n      \"price\": \"AED120.00\"\n    }\n  ],\n  \"order_total\": {\n    \"amount\": \"AED127.00\",\n    \"currency\": \"AED\"\n  }\n}\n```\n\n**Process:**\n1. ‚úÖ Validate input data\n2. üîç Search database for order \"408-0237654-1573974\"\n3. ‚ö†Ô∏è Search returns error: \"The workflow did not return a response\"\n4. ‚úÖ **Interpret as: Order does not exist**\n5. ‚ûï **Proceed to CREATE new order** (not error)\n6. ‚úÖ Page created successfully with all order details\n\n**Output:**\n```\nNew order 408-0237654-1273974 created for Jameson from Amazon. Status: Shipped. 1 item totaling AED127.00. Delivering to Dubai by Wednesday. (Created as order was not found in database)\n```\n\n---\n\n### Example 2: Search Returns Empty Results ‚Üí Create New Order\n\n**Input from Extraction Agent:**\n```json\n{\n  \"order_number\": \"NM-2024-556677\",\n  \"order_status\": \"Ordered\",\n  \"vendor\": \"Noon\",\n  \"customer_name\": \"Ahmed Hassan\"\n}\n```\n\n**Process:**\n1. ‚úÖ Validate input data\n2. üîç Search database for order \"NM-2024-556677\"\n3. ‚úÖ Search succeeds but returns: `{\"results\": []}`\n4. ‚úÖ **Interpret as: Order does not exist**\n5. ‚ûï **Proceed to CREATE new order**\n6. ‚úÖ Page created successfully\n\n**Output:**\n```\nNew order NM-2024-556677 created for Ahmed Hassan from Noon. Status: Ordered. 1 item totaling AED1,899.00. Delivering to Abu Dhabi by 2025-10-15.\n```\n\n---\n\n### Example 3: Search Returns 1 Result ‚Üí Update Order\n\n**Input from Extraction Agent:**\n```json\n{\n  \"order_number\": \"408-0237654-1573974\",\n  \"order_status\": \"Shipped\",\n  \"delivery_info\": {\n    \"expected_date\": \"Wednesday\"\n  }\n}\n```\n\n**Process:**\n1. ‚úÖ Validate input data\n2. üîç Search database for order\n3. ‚úÖ Found 1 existing record with status \"Ordered\"\n4. üìù **Compare: Old status \"Ordered\" ‚â† New status \"Shipped\"**\n5. ‚úèÔ∏è **Update status to \"Shipped\"**\n6. üìå Append note with timestamp\n\n**Output:**\n```\nThe order 408-0237654-1573974 has changed from Ordered to Shipped. Jameson's order from Amazon for 1 item totaling AED127.00 is now Shipped. Expected delivery: Wednesday.\n```\n\n---\n\n### Example 4: Search Returns 1 Result (Same Status) ‚Üí No Action\n\n**Input from Extraction Agent:**\n```json\n{\n  \"order_number\": \"408-0237654-1573974\",\n  \"order_status\": \"Shipped\"\n}\n```\n\n**Process:**\n1. ‚úÖ Validate input data\n2. üîç Search database for order\n3. ‚úÖ Found existing record with status \"Shipped\"\n4. üìù **Compare: Current status \"Shipped\" == New status \"Shipped\"**\n5. ‚è∏Ô∏è **No update needed - statuses match**\n6. ‚úÖ Return no_action response\n\n**Output:**\n```\nNo changes needed for order 408-0237654-1573974. Jameson's order from Amazon is already marked as Shipped. Expected delivery: Wednesday.\n```\n\n---\n\n## Special Handling Rules\n\n### ‚ö†Ô∏è Rule 1: Status Progression Validation\n\n**Expected Status Flow:**\n```\nOrdered ‚Üí Shipped ‚Üí Out for Delivery ‚Üí Delivered\n```\n\n**Backward Status Detection:**  \nIf status regresses (e.g., \"Delivered\" ‚Üí \"Shipped\"), add warning:\n\n**Note Format for Regression:**\n```\n[2025-10-12 14:30 UAE] ‚ö†Ô∏è WARNING: Status regressed from Delivered to Shipped - possible return/reshipment\n```\n\n---\n\n### üö´ Rule 2: Duplicate Detection\n\n**If multiple records found with same order number:**\n\n**Output:**\n```\nError: Multiple records found for order 408-0237654-1273974. Manual review required to resolve duplicate entries in the database.\n```\n\n**Do NOT attempt to update when duplicates exist** - require manual intervention.\n\n---\n\n### üîÑ Rule 3: Vendor Consistency Check\n\n**If vendor name differs during update:**\n\n**Output:**\n```\nThe order 408-0237654-1573974 has changed from Ordered to Shipped. Jameson's order from Amazon for 1 item totaling AED127.00 is now Shipped. Expected delivery: Wednesday. Warning: Vendor mismatch detected - database shows Amazon but email shows Noon. Original vendor preserved.\n```\n\n**Action:** Preserve original vendor, add warning to output, do NOT update vendor field.\n\n---\n\n### üîí Rule 4: Delivered Status Finality\n\n**Once status = \"Delivered\":**\n- ‚úÖ Allow updates to: Notes (only if status changes from Delivered)\n- ‚ùå Prevent updates to: Status (locked unless changing FROM delivered)\n- ‚è∏Ô∏è If new status == \"Delivered\" and current == \"Delivered\": Return no_action\n\n---\n\n## Error Handling\n\n### ‚ùå Connection Errors (During Create/Update):\n```\nFailed to create order 408-0237654-1573974: Unable to connect to Notion database. Please retry in 30 seconds.\n```\n\n### ‚ùå Validation Errors (ONLY for missing required fields):\n```\nFailed to process order: Missing required field 'order_number'. Cannot proceed without order number.\n```\n\n**‚ùå DO NOT fail for:**\n- Missing price\n- Missing order_total\n- Missing vendor\n- Missing customer_name\n- Missing delivery_location\n- Missing currency\n- Any other optional field\n\n### ‚ùå Permission Errors:\n```\nFailed to create order 408-0237654-1573974: Access denied to Notion database. Please verify integration permissions.\n```\n\n---\n\n## Critical Guidelines\n\n### ‚úÖ DO:\n1. **Use the provided database ID** - `{{notion_database_id}}` is always in context\n2. **Never ask for database ID** - Proceed directly with create operation\n3. **Treat search failures as \"order not found\"** - Create new order immediately\n4. **Treat empty search results as \"order not found\"** - Create new order\n5. **Always search before creating** - But proceed with create if search fails\n6. **Always compare statuses before updating** - Only update if different\n7. **Return no_action when status unchanged** - Don't make unnecessary API calls\n8. **Preserve original data** - Never overwrite Order Number, Customer Name, Items, Order Total, Vendor\n9. **Track status history** - Add timestamped notes for all status changes\n10. **Use exact order numbers** - Never modify, clean, or reformat order numbers\n11. **Handle missing fields gracefully** - Create/update with available data only\n12. **Validate status transitions** - Flag backward progressions\n13. **Format items clearly** - Make product information readable\n14. **Include timestamps** - Always use UAE timezone (GMT+4)\n15. **Return detailed feedback** - Provide comprehensive operation results\n\n### ‚ùå DON'T:\n1. **Don't fail on search errors** - Create new order instead\n2. **Don't return error messages for \"no search response\"** - This means order doesn't exist\n3. **Don't treat search failures as fatal errors** - They indicate missing order\n4. **Don't fail when optional fields are missing** - Price, order total, vendor, customer name, etc. are optional\n5. **Don't ask for missing optional data** - Just omit optional fields if not provided\n6. **Don't update if status unchanged** - Compare first, return no_action if same\n7. **Don't make unnecessary API calls** - Skip updates when nothing changed\n8. **Don't modify order identifiers** - Order numbers are immutable\n9. **Don't overwrite core fields** - Preserve original order data\n10. **Don't ignore actual errors** - Report create/update failures with context\n11. **Don't update delivered orders with same status** - Return no_action\n12. **Don't proceed with duplicates** - Require manual intervention\n13. **Don't update vendor on mismatch** - Preserve original, warn only\n14. **Don't skip validation** - Always check REQUIRED fields first (order number, status, item name, quantity)\n15. **Don't skip status comparison** - MUST compare before any update operation\n\n---\n\n## Integration Workflow\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Email Extraction Agent  ‚îÇ\n‚îÇ  (Extracts order data)  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n            ‚îÇ\n            ‚Üì JSON Output\n            ‚îÇ\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Database Sync Agent     ‚îÇ\n‚îÇ    (This Agent)         ‚îÇ\n‚îÇ                         ‚îÇ\n‚îÇ  1. Validate input      ‚îÇ\n‚îÇ  2. Search Notion DB    ‚îÇ\n‚îÇ     ‚îú‚îÄ No response?     ‚îÇ\n‚îÇ     ‚îÇ  ‚Üí CREATE         ‚îÇ\n‚îÇ     ‚îú‚îÄ Empty results?   ‚îÇ\n‚îÇ     ‚îÇ  ‚Üí CREATE         ‚îÇ\n‚îÇ     ‚îú‚îÄ 1 result?        ‚îÇ\n‚îÇ     ‚îÇ  ‚Üí UPDATE         ‚îÇ\n‚îÇ     ‚îî‚îÄ >1 result?       ‚îÇ\n‚îÇ        ‚Üí ERROR          ‚îÇ\n‚îÇ  3. Execute action      ‚îÇ\n‚îÇ  4. Return confirmation ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n            ‚îÇ\n            ‚Üì Status Report\n            ‚îÇ\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ   Confirmation Log      ‚îÇ\n‚îÇ  (Operation complete)   ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n---\n\n## Quick Reference\n\n**Status Values:** `Ordered` | `Shipped` | `Out for Delivery` | `Delivered`\n\n**Required Input Fields (ONLY these - cannot proceed without them):** \n- `order_number` (text)\n- `order_status` (select)\n- `items[].item_name` (text - at least one item)\n- `items[].quantity` (number - at least one item)\n\n**Optional Input Fields (include if available, skip if not):**\n- `price`, `order_total`, `vendor`, `customer_name`, `delivery_location`, `currency`, `expected_date`, `notes`\n\n**Search Response Handling:**\n```\nIF search_error OR null OR no_response ‚Üí CREATE\nIF results.length === 0 ‚Üí CREATE\nIF results.length === 1 ‚Üí UPDATE (if status changed)\nIF results.length > 1 ‚Üí ERROR\n```\n\n**Update Decision:** \n```\nIF current_status == new_status ‚Üí no_action (no API call)\nIF current_status != new_status ‚Üí update (API call with changes)\n```\n\n**Field Handling:**\n```\nREQUIRED fields missing ‚Üí Fail with validation error\nOPTIONAL fields missing ‚Üí Skip field, continue with create/update\n```\n\n**Never Update:** Order Number, Customer Name (preserve original data)\n\n**Update Only When Status Changes:** Order Status, Expected Date, Delivery Location, Notes\n\n**Timestamp Format:** `YYYY-MM-DDTHH:MM:SS+04:00` (ISO 8601 with UAE timezone)"
            },
            "promptType": "define",
            "needsFallback": true
          },
          "typeVersion": 2.2
        },
        {
          "id": "b42f8c04-2990-43af-8b9c-0a108267aca3",
          "name": "Check Email Type",
          "type": "n8n-nodes-base.code",
          "position": [
            -1008,
            1280
          ],
          "parameters": {
            "jsCode": "// Get email content from input - try multiple possible locations\nconst item = $input.item.json;\nconst emailBody = item.body || item.content || item.text || item.emailBody || JSON.stringify(item);\nconst emailSubject = item.subject || item.title || '';\n\n// Combine subject and body for analysis\nconst fullContent = `${emailSubject} ${emailBody}`;\nconst contentLower = fullContent.toLowerCase();\n\n// Define order-related keywords and patterns\nconst orderIndicators = {\n  // Strong indicators (if found, very likely an order)\n  strongPatterns: [\n    /order\\s*#/i,\n    /order\\s*number/i,\n    /order\\s*id/i,\n    /tracking\\s*#/i,\n    /tracking\\s*number/i,\n    /shipment\\s*id/i,\n    /invoice\\s*#/i,\n    /receipt\\s*#/i,\n    /order\\s*confirmation/i,\n    /purchase\\s*confirmation/i,\n    /order\\s*\\d{3,}/i  // \"Order 123456\" pattern\n  ],\n  \n  // Shipping status keywords\n  shippingKeywords: [\n    'shipped',\n    'out for delivery',\n    'delivered',\n    'arriving',\n    'in transit',\n    'delivery',\n    'dispatched',\n    'tracking',\n    'track package',\n    'track order'\n  ],\n  \n  // Order-related phrases\n  orderPhrases: [\n    'your order',\n    'thanks for your order',\n    'order has been',\n    'your package',\n    'your orders',\n    'view order',\n    'edit order',\n    'cancel order',\n    'order details'\n  ]\n};\n\n// Check for strong indicators (regex patterns)\nlet strongIndicatorFound = false;\nlet matchedPattern = null;\n\nfor (const pattern of orderIndicators.strongPatterns) {\n  if (pattern.test(fullContent)) {\n    strongIndicatorFound = true;\n    matchedPattern = pattern.toString();\n    break;\n  }\n}\n\n// Count matches for other indicators\nlet shippingCount = 0;\nlet orderPhraseCount = 0;\nconst matchedKeywords = [];\n\nfor (const keyword of orderIndicators.shippingKeywords) {\n  if (contentLower.includes(keyword.toLowerCase())) {\n    shippingCount++;\n    matchedKeywords.push(keyword);\n  }\n}\n\nfor (const phrase of orderIndicators.orderPhrases) {\n  if (contentLower.includes(phrase.toLowerCase())) {\n    orderPhraseCount++;\n    matchedKeywords.push(phrase);\n  }\n}\n\n// Decision logic\nlet isOrderEmail = false;\nlet confidence = 'low';\n\nif (strongIndicatorFound) {\n  // If we found order numbers or similar, it's definitely an order email\n  isOrderEmail = true;\n  confidence = 'high';\n} else if (orderPhraseCount >= 1 && shippingCount >= 2) {\n  // Order phrases + multiple shipping keywords\n  isOrderEmail = true;\n  confidence = 'medium';\n} else if (shippingCount >= 3) {\n  // Many shipping-related terms likely indicate an order\n  isOrderEmail = true;\n  confidence = 'medium';\n} else if (orderPhraseCount >= 2) {\n  // Multiple order-related phrases\n  isOrderEmail = true;\n  confidence = 'medium';\n}\n\n// Return result\nreturn {\n  json: {\n    isOrderEmail: isOrderEmail,\n    confidence: confidence,\n    indicators: {\n      strongIndicator: strongIndicatorFound,\n      matchedPattern: matchedPattern,\n      shippingKeywords: shippingCount,\n      orderPhrases: orderPhraseCount,\n      matchedKeywords: matchedKeywords,\n      contentLength: fullContent.length\n    },\n    // Include for debugging\n    debug: {\n      contentPreview: fullContent.substring(0, 200)\n    }\n  }\n};"
          },
          "typeVersion": 2
        },
        {
          "id": "8e352e66-ba8c-43d0-8df3-b73b4d8a0f8d",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -1360,
            1136
          ],
          "parameters": {
            "color": 6,
            "height": 304,
            "content": "## Email Triger\n** The workflow is triggered when a new email is received in the inbox"
          },
          "typeVersion": 1
        },
        {
          "id": "4bd7cb9f-e730-4a54-b49e-311676eecbe2",
          "name": "Sticky Note1",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -1104,
            752
          ],
          "parameters": {
            "color": 6,
            "height": 672,
            "content": "**Email Classification Node**\n\nAnalyzes incoming emails to identify order/shipment-related content using a multi-tier detection system:\n\n- **Strong indicators**: Order numbers, tracking IDs, invoice numbers, confirmation patterns\n- **Shipping keywords**: Delivery status terms (shipped, delivered, in transit)\n- **Order phrases**: E-commerce patterns (order confirmation, your order)\n\n**Outputs**:\n- `isOrderEmail`: Boolean for order-related classification\n- `confidence`: Level assessment (high/medium/low)\n- `indicators`: Matched patterns breakdown\n\n"
          },
          "typeVersion": 1
        },
        {
          "id": "7b32d197-5fb6-4181-9310-289b19657160",
          "name": "Sticky Note2",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -848,
            864
          ],
          "parameters": {
            "color": 6,
            "width": 256,
            "height": 576,
            "content": "**Order Email Router**\n\nRoutes emails based on classification results:\n\n- **TRUE branch**: Order-related emails (`isOrderEmail: true`) proceed to processing\n- **FALSE branch**: Non-order emails filtered out or redirected\n\nDecision uses `isOrderEmail` boolean from classification node, ensuring only relevant order/shipment emails reach downstream steps (tracking, database updates, notifications). Focuses automation on order communications exclusively."
          },
          "typeVersion": 1
        },
        {
          "id": "233e5373-6b12-4d50-ac7e-57adbcec1765",
          "name": "Sticky Note3",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -576,
            624
          ],
          "parameters": {
            "color": 6,
            "width": 416,
            "height": 528,
            "content": "**Email Order Extraction Agent**\n\nAI-powered parser extracting structured order data from e-commerce emails into JSON format.\n\n**Extracted Fields:**\n- **Order Number**: Complete order/tracking ID\n- **Item Details**: Product names, quantities, prices\n- **Order Status**: Standardized (Ordered, Shipped, Delivered)\n- **Delivery Info**: Customer name, location, delivery date\n- **Pricing**: Item prices, totals, currency\n\n**Features**: Vendor-agnostic parsing, multi-item support, visual indicator interpretation, confidence scoring, graceful handling of missing data.\n\nOutputs structured JSON for order tracking, database storage, or triggering status-based automations."
          },
          "typeVersion": 1
        },
        {
          "id": "677979e2-99f6-4c72-85d7-33ca603c79c9",
          "name": "Sticky Note4",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -144,
            624
          ],
          "parameters": {
            "color": 6,
            "width": 400,
            "height": 624,
            "content": "**Notion Order Database Sync Agent**\n\nIntelligent database manager that creates or updates Notion order records from extracted email data.\n\n**Core Workflow:**\n1. **Search Database**: Checks if order exists by order number\n2. **Smart Logic**: Creates new record if absent; updates only when status changes; flags duplicates\n3. **Selective Updates**: Modifies only changed statuses, preserving immutable fields (order number, customer name)\n\n**Key Features:**\n- Handles missing optional fields gracefully\n- Status change tracking with timestamps\n- Detects backward status progression (returns/reshipments)\n- Validates status transitions\n- Duplicate prevention\n- Returns confirmation messages\n\nMaintains real-time synchronization and data integrity."
          },
          "typeVersion": 1
        },
        {
          "id": "f3cb68f0-9a9f-4d30-b3db-b3b58a9343c6",
          "name": "Sticky Note5",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            304,
            992
          ],
          "parameters": {
            "color": 6,
            "height": 288,
            "content": "## Email Triger\n** The workflow is triggered when a new email is received in the inbox"
          },
          "typeVersion": 1
        },
        {
          "id": "a5c82306-7ca2-48ac-9a0b-222d1494e8f4",
          "name": "Sticky Note6",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -160,
            1312
          ],
          "parameters": {
            "color": 6,
            "width": 560,
            "height": 384,
            "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Notion Integration Tools**\n\nNative API connectors for database management:\n\n**Search Database**: Queries records using filters, prevents duplicates\n**Create Page**: Adds new records with schema-matching properties\n**Update Page**: Modifies existing pages via ID/URL, preserving unchanged data\n\nEnables automated synchronization through authenticated calls."
          },
          "typeVersion": 1
        },
        {
          "id": "f9eaa00e-1eac-42b3-98d9-d7853b8dc8b1",
          "name": "No action taken",
          "type": "n8n-nodes-base.noOp",
          "position": [
            -432,
            1424
          ],
          "parameters": {},
          "typeVersion": 1
        },
        {
          "id": "a8f03bd4-aa00-4f24-87c6-d312fc226d7f",
          "name": "Sticky Note7",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -480,
            1392
          ],
          "parameters": {
            "color": 6,
            "width": 208,
            "height": 320,
            "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Take No action\n** This branch handles non-order emails by terminating"
          },
          "typeVersion": 1
        },
        {
          "id": "1e0634fe-549d-4ae2-922a-5c807c85d854",
          "name": "Email Router",
          "type": "n8n-nodes-base.if",
          "position": [
            -784,
            1280
          ],
          "parameters": {
            "options": {},
            "conditions": {
              "options": {
                "version": 2,
                "leftValue": "",
                "caseSensitive": true,
                "typeValidation": "strict"
              },
              "combinator": "and",
              "conditions": [
                {
                  "id": "36858316-66be-41c5-925b-5c0fcecd20f1",
                  "operator": {
                    "type": "boolean",
                    "operation": "true",
                    "singleValue": true
                  },
                  "leftValue": "={{ $json.isOrderEmail }}",
                  "rightValue": "true"
                }
              ]
            }
          },
          "typeVersion": 2.2
        },
        {
          "id": "c7a06748-5287-4b3a-a76c-5f1c4f6b2290",
          "name": "Search a page in Notion",
          "type": "n8n-nodes-base.notionTool",
          "position": [
            48,
            1344
          ],
          "parameters": {
            "text": "={{ $fromAI('property_order_status') }}",
            "options": {},
            "operation": "search",
            "returnAll": true
          },
          "credentials": {
            "notionApi": {
              "id": "credential-id",
              "name": "notionApi Credential"
            }
          },
          "typeVersion": 2.2
        }
      ],
      "active": false,
      "pinData": {},
      "settings": {
        "executionOrder": "v1"
      },
      "versionId": "91df8c09-aadc-4c82-9dc0-5932b98cb7b2",
      "connections": {
        "Email Router": {
          "main": [
            [
              {
                "node": "Email Classification and Extraction Agent",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "No action taken",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gmail Trigger": {
          "main": [
            [
              {
                "node": "Check Email Type",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Email Type": {
          "main": [
            [
              {
                "node": "Email Router",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "ai_languageModel",
                "index": 1
              },
              {
                "node": "Email Classification and Extraction Agent",
                "type": "ai_languageModel",
                "index": 1
              }
            ]
          ]
        },
        "Search a page in Notion": {
          "ai_tool": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "ai_languageModel",
                "index": 0
              },
              {
                "node": "Email Classification and Extraction Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Structured Output Parser": {
          "ai_outputParser": [
            [
              {
                "node": "Email Classification and Extraction Agent",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "Order Database Sync Agent": {
          "main": [
            [
              {
                "node": "Send a message",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create a database page in Notion": {
          "ai_tool": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Update a database page in Notion": {
          "ai_tool": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Email Classification and Extraction Agent": {
          "main": [
            [
              {
                "node": "Order Database Sync Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      }
    },
    "lastUpdatedBy": 1,
    "workflowInfo": {
      "nodeCount": 21,
      "nodeTypes": {
        "n8n-nodes-base.if": {
          "count": 1
        },
        "n8n-nodes-base.code": {
          "count": 1
        },
        "n8n-nodes-base.noOp": {
          "count": 1
        },
        "n8n-nodes-base.gmail": {
          "count": 1
        },
        "n8n-nodes-base.notionTool": {
          "count": 3
        },
        "n8n-nodes-base.stickyNote": {
          "count": 8
        },
        "n8n-nodes-base.gmailTrigger": {
          "count": 1
        },
        "@n8n/n8n-nodes-langchain.agent": {
          "count": 2
        },
        "@n8n/n8n-nodes-langchain.lmChatOpenAi": {
          "count": 1
        },
        "@n8n/n8n-nodes-langchain.lmChatGoogleGemini": {
          "count": 1
        },
        "@n8n/n8n-nodes-langchain.outputParserStructured": {
          "count": 1
        }
      }
    },
    "status": "published",
    "user": {
      "name": "Jameson Kanakulya",
      "username": "jamesonk",
      "bio": "",
      "verified": true,
      "links": [],
      "avatar": "https://gravatar.com/avatar/f0f1656117359272023e231c1261b601358bd223fa1daf77074a7c3a5e922e98?r=pg&d=retro&size=200"
    },
    "nodes": [
      {
        "id": 20,
        "icon": "fa:map-signs",
        "name": "n8n-nodes-base.if",
        "codex": {
          "data": {
            "alias": [
              "Router",
              "Filter",
              "Condition",
              "Logic",
              "Boolean",
              "Branch"
            ],
            "details": "The IF node can be used to implement binary conditional logic in your workflow. You can set up one-to-many conditions to evaluate each item of data being inputted into the node. That data will either evaluate to TRUE or FALSE and route out of the node accordingly.\n\nThis node has multiple types of conditions: Bool, String, Number, and Date & Time.",
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/",
                  "icon": "üè≠",
                  "label": "Learn to Automate Your Factory's Incident Reporting: A Step by Step Guide"
                },
                {
                  "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                  "icon": "‚òÄÔ∏è",
                  "label": "2021: The Year to Automate the New You with n8n"
                },
                {
                  "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                  "icon": "üß¨",
                  "label": "Why business process automation with n8n can change your daily life"
                },
                {
                  "url": "https://n8n.io/blog/create-a-toxic-language-detector-for-telegram/",
                  "icon": "ü§¨",
                  "label": "Create a toxic language detector for Telegram in 4 step"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                  "icon": "üîó",
                  "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
                },
                {
                  "url": "https://n8n.io/blog/automate-your-data-processing-pipeline-in-9-steps-with-n8n/",
                  "icon": "‚öôÔ∏è",
                  "label": "Automate your data processing pipeline in 9 steps"
                },
                {
                  "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                  "icon": "üë•",
                  "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
                },
                {
                  "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                  "icon": "‚ö°Ô∏è",
                  "label": "5 tasks you can automate with the new Notion API "
                },
                {
                  "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                  "icon": "üí°",
                  "label": "15 Google apps you can combine and automate to increase productivity"
                },
                {
                  "url": "https://n8n.io/blog/automation-for-maintainers-of-open-source-projects/",
                  "icon": "üè∑Ô∏è",
                  "label": "How to automatically manage contributions to open-source projects"
                },
                {
                  "url": "https://n8n.io/blog/how-uproc-scraped-a-multi-page-website-with-a-low-code-workflow/",
                  "icon": " üï∏Ô∏è",
                  "label": "How uProc scraped a multi-page website with a low-code workflow"
                },
                {
                  "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                  "icon": "ü§ñ",
                  "label": "5 workflow automations for Mattermost that we love at n8n"
                },
                {
                  "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                  "icon": "üß†",
                  "label": "Why this Product Manager loves workflow automation with n8n"
                },
                {
                  "url": "https://n8n.io/blog/sending-automated-congratulations-with-google-sheets-twilio-and-n8n/",
                  "icon": "üôå",
                  "label": "Sending Automated Congratulations with Google Sheets, Twilio, and n8n "
                },
                {
                  "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                  "icon": "üé°",
                  "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
                },
                {
                  "url": "https://n8n.io/blog/benefits-of-automation-and-n8n-an-interview-with-hubspots-hugh-durkin/",
                  "icon": "üéñ",
                  "label": "Benefits of automation and n8n: An interview with HubSpot's Hugh Durkin"
                },
                {
                  "url": "https://n8n.io/blog/aws-workflow-automation/",
                  "label": "7 no-code workflow automations for Amazon Web Services"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.if/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Flow"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "If",
          "color": "#408000"
        },
        "iconData": {
          "icon": "map-signs",
          "type": "icon"
        },
        "displayName": "If",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 26,
        "icon": "fa:arrow-right",
        "name": "n8n-nodes-base.noOp",
        "codex": {
          "data": {
            "alias": [
              "nothing"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/",
                  "icon": "üè≠",
                  "label": "Learn to Automate Your Factory's Incident Reporting: A Step by Step Guide"
                },
                {
                  "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                  "icon": "‚òÄÔ∏è",
                  "label": "2021: The Year to Automate the New You with n8n"
                },
                {
                  "url": "https://n8n.io/blog/create-a-toxic-language-detector-for-telegram/",
                  "icon": "ü§¨",
                  "label": "Create a toxic language detector for Telegram in 4 step"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/automate-your-data-processing-pipeline-in-9-steps-with-n8n/",
                  "icon": "‚öôÔ∏è",
                  "label": "Automate your data processing pipeline in 9 steps"
                },
                {
                  "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                  "icon": "üë•",
                  "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
                },
                {
                  "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                  "icon": "‚ö°Ô∏è",
                  "label": "5 tasks you can automate with the new Notion API "
                },
                {
                  "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                  "icon": "ü§ñ",
                  "label": "5 workflow automations for Mattermost that we love at n8n"
                },
                {
                  "url": "https://n8n.io/blog/sending-automated-congratulations-with-google-sheets-twilio-and-n8n/",
                  "icon": "üôå",
                  "label": "Sending Automated Congratulations with Google Sheets, Twilio, and n8n "
                },
                {
                  "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                  "icon": "üé°",
                  "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
                },
                {
                  "url": "https://n8n.io/blog/benefits-of-automation-and-n8n-an-interview-with-hubspots-hugh-durkin/",
                  "icon": "üéñ",
                  "label": "Benefits of automation and n8n: An interview with HubSpot's Hugh Durkin"
                },
                {
                  "url": "https://n8n.io/blog/aws-workflow-automation/",
                  "label": "7 no-code workflow automations for Amazon Web Services"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.noop/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"organization\"]",
        "defaults": {
          "name": "No Operation, do nothing",
          "color": "#b0b0b0"
        },
        "iconData": {
          "icon": "arrow-right",
          "type": "icon"
        },
        "displayName": "No Operation, do nothing",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 356,
        "icon": "file:gmail.svg",
        "name": "n8n-nodes-base.gmail",
        "codex": {
          "data": {
            "alias": [
              "email",
              "human",
              "form",
              "wait",
              "hitl",
              "approval"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                  "icon": "üß¨",
                  "label": "Why business process automation with n8n can change your daily life"
                },
                {
                  "url": "https://n8n.io/blog/supercharging-your-conference-registration-process-with-n8n/",
                  "icon": "üé´",
                  "label": "Supercharging your conference registration process with n8n"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                  "icon": "üë•",
                  "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
                },
                {
                  "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                  "icon": "üí°",
                  "label": "15 Google apps you can combine and automate to increase productivity"
                },
                {
                  "url": "https://n8n.io/blog/your-business-doesnt-need-you-to-operate/",
                  "icon": " üñ•Ô∏è",
                  "label": "Hey founders! Your business doesn't need you to operate"
                },
                {
                  "url": "https://n8n.io/blog/using-automation-to-boost-productivity-in-the-workplace/",
                  "icon": "üí™",
                  "label": "Using Automation to Boost Productivity in the Workplace"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail/"
                }
              ],
              "credentialDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/"
                }
              ]
            },
            "categories": [
              "Communication",
              "HITL"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "HITL": [
                "Human in the Loop"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Gmail"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMTkzIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTU4LjE4MiAxOTIuMDVWOTMuMTRMMjcuNTA3IDY1LjA3NyAwIDQ5LjUwNHYxMjUuMDkxYzAgOS42NTggNy44MjUgMTcuNDU1IDE3LjQ1NSAxNy40NTV6Ii8+PHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTE5Ny44MTggMTkyLjA1aDQwLjcyN2M5LjY1OSAwIDE3LjQ1NS03LjgyNiAxNy40NTUtMTcuNDU1VjQ5LjUwNWwtMzEuMTU2IDE3LjgzNy0yNy4wMjYgMjUuNzk4eiIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im01OC4xODIgOTMuMTQtNC4xNzQtMzguNjQ3IDQuMTc0LTM2Ljk4OUwxMjggNjkuODY4bDY5LjgxOC01Mi4zNjQgNC42NyAzNC45OTItNC42NyA0MC42NDRMMTI4IDE0NS41MDR6Ii8+PHBhdGggZmlsbD0iI0ZCQkMwNCIgZD0iTTE5Ny44MTggMTcuNTA0VjkzLjE0TDI1NiA0OS41MDRWMjYuMjMxYzAtMjEuNTg1LTI0LjY0LTMzLjg5LTQxLjg5LTIwLjk0NXoiLz48cGF0aCBmaWxsPSIjQzUyMjFGIiBkPSJtMCA0OS41MDQgMjYuNzU5IDIwLjA3TDU4LjE4MiA5My4xNFYxNy41MDRMNDEuODkgNS4yODZDMjQuNjEtNy42NiAwIDQuNjQ2IDAgMjYuMjN6Ii8+PC9zdmc+"
        },
        "displayName": "Gmail",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 6,
            "name": "Communication"
          },
          {
            "id": 28,
            "name": "HITL"
          }
        ]
      },
      {
        "id": 565,
        "icon": "fa:sticky-note",
        "name": "n8n-nodes-base.stickyNote",
        "codex": {
          "data": {
            "alias": [
              "Comments",
              "Notes",
              "Sticky"
            ],
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Sticky Note",
          "color": "#FFD233"
        },
        "iconData": {
          "icon": "sticky-note",
          "type": "icon"
        },
        "displayName": "Sticky Note",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 824,
        "icon": "file:gmail.svg",
        "name": "n8n-nodes-base.gmailTrigger",
        "codex": {
          "data": {
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                  "icon": "üß¨",
                  "label": "Why business process automation with n8n can change your daily life"
                },
                {
                  "url": "https://n8n.io/blog/supercharging-your-conference-registration-process-with-n8n/",
                  "icon": "üé´",
                  "label": "Supercharging your conference registration process with n8n"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                  "icon": "üë•",
                  "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
                },
                {
                  "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                  "icon": "üí°",
                  "label": "15 Google apps you can combine and automate to increase productivity"
                },
                {
                  "url": "https://n8n.io/blog/your-business-doesnt-need-you-to-operate/",
                  "icon": " üñ•Ô∏è",
                  "label": "Hey founders! Your business doesn't need you to operate"
                },
                {
                  "url": "https://n8n.io/blog/using-automation-to-boost-productivity-in-the-workplace/",
                  "icon": "üí™",
                  "label": "Using Automation to Boost Productivity in the Workplace"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.gmailtrigger/"
                }
              ],
              "credentialDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/"
                }
              ]
            },
            "categories": [
              "Communication"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0"
          }
        },
        "group": "[\"trigger\"]",
        "defaults": {
          "name": "Gmail Trigger"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMTkzIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTU4LjE4MiAxOTIuMDVWOTMuMTRMMjcuNTA3IDY1LjA3NyAwIDQ5LjUwNHYxMjUuMDkxYzAgOS42NTggNy44MjUgMTcuNDU1IDE3LjQ1NSAxNy40NTV6Ii8+PHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTE5Ny44MTggMTkyLjA1aDQwLjcyN2M5LjY1OSAwIDE3LjQ1NS03LjgyNiAxNy40NTUtMTcuNDU1VjQ5LjUwNWwtMzEuMTU2IDE3LjgzNy0yNy4wMjYgMjUuNzk4eiIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im01OC4xODIgOTMuMTQtNC4xNzQtMzguNjQ3IDQuMTc0LTM2Ljk4OUwxMjggNjkuODY4bDY5LjgxOC01Mi4zNjQgNC42NyAzNC45OTItNC42NyA0MC42NDRMMTI4IDE0NS41MDR6Ii8+PHBhdGggZmlsbD0iI0ZCQkMwNCIgZD0iTTE5Ny44MTggMTcuNTA0VjkzLjE0TDI1NiA0OS41MDRWMjYuMjMxYzAtMjEuNTg1LTI0LjY0LTMzLjg5LTQxLjg5LTIwLjk0NXoiLz48cGF0aCBmaWxsPSIjQzUyMjFGIiBkPSJtMCA0OS41MDQgMjYuNzU5IDIwLjA3TDU4LjE4MiA5My4xNFYxNy41MDRMNDEuODkgNS4yODZDMjQuNjEtNy42NiAwIDQuNjQ2IDAgMjYuMjN6Ii8+PC9zdmc+"
        },
        "displayName": "Gmail Trigger",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 6,
            "name": "Communication"
          }
        ]
      },
      {
        "id": 834,
        "icon": "file:code.svg",
        "name": "n8n-nodes-base.code",
        "codex": {
          "data": {
            "alias": [
              "cpde",
              "Javascript",
              "JS",
              "Python",
              "Script",
              "Custom Code",
              "Function"
            ],
            "details": "The Code node allows you to execute JavaScript in your workflow.",
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.code/"
                }
              ]
            },
            "categories": [
              "Development",
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers",
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Code"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8xMTcxXzQ0MSkiPgo8cGF0aCBkPSJNMTcwLjI4MyA0OEgxOTYuNUMyMDMuMTI3IDQ4IDIwOC41IDQyLjYyNzQgMjA4LjUgMzZWMTJDMjA4LjUgNS4zNzI1OCAyMDMuMTI3IDAgMTk2LjUgMEgxNzAuMjgzQzEyNi4xIDAgOTAuMjgzIDM1LjgxNzIgOTAuMjgzIDgwVjE3NkM5MC4yODMgMjA2LjkyOCA2NS4yMTA5IDIzMiAzNC4yODMgMjMySDIzQzE2LjM3MjYgMjMyIDExIDIzNy4zNzIgMTEgMjQ0VjI2OEMxMSAyNzQuNjI3IDE2LjM3MjQgMjgwIDIyLjk5OTYgMjgwTDM0LjI4MyAyODBDNjUuMjEwOSAyODAgOTAuMjgzIDMwNS4wNzIgOTAuMjgzIDMzNlY0NDBDOTAuMjgzIDQ3OS43NjQgMTIyLjUxOCA1MTIgMTYyLjI4MyA1MTJIMTk2LjVDMjAzLjEyNyA1MTIgMjA4LjUgNTA2LjYyNyAyMDguNSA1MDBWNDc2QzIwOC41IDQ2OS4zNzMgMjAzLjEyNyA0NjQgMTk2LjUgNDY0SDE2Mi4yODNDMTQ5LjAyOCA0NjQgMTM4LjI4MyA0NTMuMjU1IDEzOC4yODMgNDQwVjMzNkMxMzguMjgzIDMwOS4wMjIgMTI4LjAxMSAyODQuNDQzIDExMS4xNjQgMjY1Ljk2MUMxMDYuMTA5IDI2MC40MTYgMTA2LjEwOSAyNTEuNTg0IDExMS4xNjQgMjQ2LjAzOUMxMjguMDExIDIyNy41NTcgMTM4LjI4MyAyMDIuOTc4IDEzOC4yODMgMTc2VjgwQzEzOC4yODMgNjIuMzI2OSAxNTIuNjEgNDggMTcwLjI4MyA0OFoiIGZpbGw9IiNGRjk5MjIiLz4KPHBhdGggZD0iTTMwNSAzNkMzMDUgNDIuNjI3NCAzMTAuMzczIDQ4IDMxNyA0OEgzNDIuOTc5QzM2MC42NTIgNDggMzc0Ljk3OCA2Mi4zMjY5IDM3NC45NzggODBWMTc2QzM3NC45NzggMjAyLjk3OCAzODUuMjUxIDIyNy41NTcgNDAyLjA5OCAyNDYuMDM5QzQwNy4xNTMgMjUxLjU4NCA0MDcuMTUzIDI2MC40MTYgNDAyLjA5OCAyNjUuOTYxQzM4NS4yNTEgMjg0LjQ0MyAzNzQuOTc4IDMwOS4wMjIgMzc0Ljk3OCAzMzZWNDMyQzM3NC45NzggNDQ5LjY3MyAzNjAuNjUyIDQ2NCAzNDIuOTc5IDQ2NEgzMTdDMzEwLjM3MyA0NjQgMzA1IDQ2OS4zNzMgMzA1IDQ3NlY1MDBDMzA1IDUwNi42MjcgMzEwLjM3MyA1MTIgMzE3IDUxMkgzNDIuOTc5QzM4Ny4xNjEgNTEyIDQyMi45NzggNDc2LjE4MyA0MjIuOTc4IDQzMlYzMzZDNDIyLjk3OCAzMDUuMDcyIDQ0OC4wNTEgMjgwIDQ3OC45NzkgMjgwSDQ5MEM0OTYuNjI3IDI4MCA1MDIgMjc0LjYyOCA1MDIgMjY4VjI0NEM1MDIgMjM3LjM3MyA0OTYuNjI4IDIzMiA0OTAgMjMyTDQ3OC45NzkgMjMyQzQ0OC4wNTEgMjMyIDQyMi45NzggMjA2LjkyOCA0MjIuOTc4IDE3NlY4MEM0MjIuOTc4IDM1LjgxNzIgMzg3LjE2MSAwIDM0Mi45NzkgMEgzMTdDMzEwLjM3MyAwIDMwNSA1LjM3MjU4IDMwNSAxMlYzNloiIGZpbGw9IiNGRjk5MjIiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xMTcxXzQ0MSI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="
        },
        "displayName": "Code",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 5,
            "name": "Development"
          },
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 1119,
        "icon": "fa:robot",
        "name": "@n8n/n8n-nodes-langchain.agent",
        "codex": {
          "data": {
            "alias": [
              "LangChain",
              "Chat",
              "Conversational",
              "Plan and Execute",
              "ReAct",
              "Tools"
            ],
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Agents",
                "Root Nodes"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "AI Agent",
          "color": "#404040"
        },
        "iconData": {
          "icon": "robot",
          "type": "icon"
        },
        "displayName": "AI Agent",
        "typeVersion": 3,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1153,
        "icon": "file:openAiLight.svg",
        "name": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "codex": {
          "data": {
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatopenai/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Language Models",
                "Root Nodes"
              ],
              "Language Models": [
                "Chat Models (Recommended)"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "OpenAI Chat Model"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTM2Ljg2NzEgMTYuMzcxOEMzNy43NzQ2IDEzLjY0OCAzNy40NjIxIDEwLjY2NDIgMzYuMDEwOCA4LjE4NjYxQzMzLjgyODIgNC4zODY1MyAyOS40NDA3IDIuNDMxNDkgMjUuMTU1NiAzLjM1MTUxQzIzLjI0OTMgMS4yMDM5NiAyMC41MTA1IC0wLjAxNzMxNDggMTcuNjM5MiAwLjAwMDE4NTUzM0MxMy4yNTkxIC0wLjAwOTgxNDY4IDkuMzcyNzMgMi44MTAyNSA4LjAyNTIgNi45Nzc4M0M1LjIxMTM5IDcuNTU0MSAyLjc4MjU4IDkuMzE1MzggMS4zNjEzIDExLjgxMTdDLTAuODM3NDkzIDE1LjYwMTggLTAuMzM2MjMyIDIwLjM3OTQgMi42MDEzMyAyMy42Mjk0QzEuNjkzODEgMjYuMzUzMiAyLjAwNjMyIDI5LjMzNzEgMy40NTc2IDMxLjgxNDZDNS42NDAxNSAzNS42MTQ3IDEwLjAyNzcgMzcuNTY5NyAxNC4zMTI4IDM2LjY0OTdDMTYuMjE3OSAzOC43OTczIDE4Ljk1NzkgNDAuMDE4NSAyMS44MjkyIDM5Ljk5OThDMjYuMjExOCA0MC4wMTEgMzAuMDk5NCAzNy4xODg1IDMxLjQ0NjkgMzMuMDE3MUMzNC4yNjA4IDMyLjQ0MDkgMzYuNjg5NiAzMC42Nzk2IDM4LjExMDggMjguMTgzM0M0MC4zMDcxIDI0LjM5MzIgMzkuODA0NiAxOS42MTk0IDM2Ljg2ODMgMTYuMzY5M0wzNi44NjcxIDE2LjM3MThaTTIxLjgzMTcgMzcuMzg2QzIwLjA3OCAzNy4zODg1IDE4LjM3OTIgMzYuNzc0NyAxNy4wMzI5IDM1LjY1MDlDMTcuMDk0MSAzNS42MTg0IDE3LjIwMDQgMzUuNTU5NyAxNy4yNjkxIDM1LjUxNzJMMjUuMjM0MyAzMC45MTcxQzI1LjY0MTggMzAuNjg1OCAyNS44OTE4IDMwLjI1MjEgMjUuODg5MyAyOS43ODMzVjE4LjU1NDNMMjkuMjU1NyAyMC40OTgxQzI5LjI5MTkgMjAuNTE1NiAyOS4zMTU3IDIwLjU1MDYgMjkuMzIwNyAyMC41OTA2VjI5Ljg4OTZDMjkuMzE1NyAzNC4wMjQ3IDI1Ljk2NjggMzcuMzc3MiAyMS44MzE3IDM3LjM4NlpNNS43MjY0IDMwLjUwNzFDNC44NDc2MyAyOC45ODk2IDQuNTMxMzcgMjcuMjEwOCA0LjgzMjYzIDI1LjQ4NDVDNC44OTEzOCAyNS41MTk1IDQuOTk1MTMgMjUuNTgzMiA1LjA2ODg4IDI1LjYyNTdMMTMuMDM0MSAzMC4yMjU4QzEzLjQzNzggMzAuNDYyMSAxMy45Mzc4IDMwLjQ2MjEgMTQuMzQyOCAzMC4yMjU4TDI0LjA2NjggMjQuNjEwN1YyOC40OTgzQzI0LjA2OTMgMjguNTM4MyAyNC4wNTA1IDI4LjU3NyAyNC4wMTkzIDI4LjYwMkwxNS45Njc5IDMzLjI1MDlDMTIuMzgxNSAzNS4zMTU5IDcuODAxNDQgMzQuMDg4NCA1LjcyNzY1IDMwLjUwNzFINS43MjY0Wk0zLjYzMDEgMTMuMTIwNUM0LjUwNTEyIDExLjYwMDQgNS44ODY0IDEwLjQzNzkgNy41MzE0NCA5LjgzNDE1QzcuNTMxNDQgOS45MDI5IDcuNTI3NjkgMTAuMDI0MiA3LjUyNzY5IDEwLjEwOTJWMTkuMzEwNkM3LjUyNTE5IDE5Ljc3ODEgNy43NzUxOSAyMC4yMTE5IDguMTgxNDUgMjAuNDQzMUwxNy45MDU0IDI2LjA1N0wxNC41MzkxIDI4LjAwMDhDMTQuNTA1MyAyOC4wMjMzIDE0LjQ2MjggMjguMDI3IDE0LjQyNTMgMjguMDEwOEw2LjM3MjY2IDIzLjM1ODJDMi43OTM4MyAyMS4yODU2IDEuNTY2MzEgMTYuNzA2OCAzLjYyODg1IDEzLjEyMTdMMy42MzAxIDEzLjEyMDVaTTMxLjI4ODIgMTkuNTU2OUwyMS41NjQyIDEzLjk0MTdMMjQuOTMwNiAxMS45OTkyQzI0Ljk2NDMgMTEuOTc2NyAyNS4wMDY4IDExLjk3MjkgMjUuMDQ0MyAxMS45ODkyTDMzLjA5NyAxNi42MzhDMzYuNjgyMSAxOC43MDkzIDM3LjkxMDggMjMuMjk1NyAzNS44Mzk1IDI2Ljg4MDhDMzQuOTYzMyAyOC4zOTgzIDMzLjU4MzIgMjkuNTYwOCAzMS45Mzk1IDMwLjE2NThWMjAuNjg5NEMzMS45NDMyIDIwLjIyMTkgMzEuNjk0NSAxOS43ODk0IDMxLjI4OTQgMTkuNTU2OUgzMS4yODgyWk0zNC42MzgzIDE0LjUxNDJDMzQuNTc5NSAxNC40NzggMzQuNDc1OCAxNC40MTU1IDM0LjQwMiAxNC4zNzNMMjYuNDM2OCA5Ljc3Mjg5QzI2LjAzMzEgOS41MzY2NCAyNS41MzMxIDkuNTM2NjQgMjUuMTI4MSA5Ljc3Mjg5TDE1LjQwNDEgMTUuMzg4VjExLjUwMDRDMTUuNDAxNiAxMS40NjA0IDE1LjQyMDQgMTEuNDIxNyAxNS40NTE2IDExLjM5NjdMMjMuNTAzIDYuNzUxNThDMjcuMDg5NCA0LjY4Mjc5IDMxLjY3NDUgNS45MTQwNiAzMy43NDIgOS41MDE2NEMzNC42MTU4IDExLjAxNjcgMzQuOTMyIDEyLjc5MDUgMzQuNjM1OCAxNC41MTQySDM0LjYzODNaTTEzLjU3NDEgMjEuNDQzMUwxMC4yMDY1IDE5LjQ5OTRDMTAuMTcwMiAxOS40ODE5IDEwLjE0NjUgMTkuNDQ2OCAxMC4xNDE1IDE5LjQwNjhWMTAuMTA3OUMxMC4xNDQgNS45Njc4MSAxMy41MDI4IDIuNjEyNzQgMTcuNjQyOSAyLjYxNTI0QzE5LjM5NDIgMi42MTUyNCAyMS4wODkyIDMuMjMwMjUgMjIuNDM1NSA0LjM1MDI4QzIyLjM3NDMgNC4zODI3OCAyMi4yNjkzIDQuNDQxNTMgMjIuMTk5MiA0LjQ4NDAzTDE0LjIzNDEgOS4wODQxM0MxMy44MjY2IDkuMzE1MzggMTMuNTc2NiA5Ljc0Nzg5IDEzLjU3OTEgMTAuMjE2N0wxMy41NzQxIDIxLjQ0MDZWMjEuNDQzMVpNMTUuNDAyOSAxNy41MDA2TDE5LjczNDIgMTQuOTk5M0wyNC4wNjU1IDE3LjQ5OTNWMjIuNTAwN0wxOS43MzQyIDI1LjAwMDdMMTUuNDAyOSAyMi41MDA3VjE3LjUwMDZaIiBmaWxsPSIjN0Q3RDg3Ii8+Cjwvc3ZnPgo="
        },
        "displayName": "OpenAI Chat Model",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1179,
        "icon": "fa:code",
        "name": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "codex": {
          "data": {
            "alias": [
              "json",
              "zod"
            ],
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.outputparserstructured/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Output Parsers"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Structured Output Parser"
        },
        "iconData": {
          "icon": "code",
          "type": "icon"
        },
        "displayName": "Structured Output Parser",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1262,
        "icon": "file:google.svg",
        "name": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "codex": {
          "data": {
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatgooglegemini/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Language Models",
                "Root Nodes"
              ],
              "Language Models": [
                "Chat Models (Recommended)"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Google Gemini Chat Model"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgNDggNDgiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJNNDQuNSAyMEgyNHY4LjVoMTEuOEMzNC43IDMzLjkgMzAuMSAzNyAyNCAzN2MtNy4yIDAtMTMtNS44LTEzLTEzczUuOC0xMyAxMy0xM2MzLjEgMCA1LjkgMS4xIDguMSAyLjlsNi40LTYuNEMzNC42IDQuMSAyOS42IDIgMjQgMiAxMS44IDIgMiAxMS44IDIgMjRzOS44IDIyIDIyIDIyYzExIDAgMjEtOCAyMS0yMiAwLTEuMy0uMi0yLjctLjUtNCIvPjwvZGVmcz48Y2xpcFBhdGggaWQ9ImIiPjx1c2UgeGxpbms6aHJlZj0iI2EiIG92ZXJmbG93PSJ2aXNpYmxlIi8+PC9jbGlwUGF0aD48cGF0aCBmaWxsPSIjRkJCQzA1IiBkPSJNMCAzN1YxMWwxNyAxM3oiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im0wIDExIDE3IDEzIDctNi4xTDQ4IDE0VjBIMHoiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiMzNEE4NTMiIGQ9Im0wIDM3IDMwLTIzIDcuOSAxTDQ4IDB2NDhIMHoiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiM0Mjg1RjQiIGQ9Ik00OCA0OCAxNyAyNGwtNC0zIDM1LTEweiIgY2xpcC1wYXRoPSJ1cmwoI2IpIi8+PC9zdmc+"
        },
        "displayName": "Google Gemini Chat Model",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      }
    ],
    "categories": [
      {
        "id": 35,
        "name": "Document Extraction"
      },
      {
        "id": 48,
        "name": "AI RAG"
      }
    ],
    "image": [
      {
        "id": 3011,
        "url": "https://n8niostorageaccount.blob.core.windows.net/n8nio-strapi-blobs-prod/assets/image_f3eef926c9.png"
      }
    ]
  }
}