{
  "id": 7289,
  "slug": "7289",
  "title": "Secure web form to Odoo CRM lead creation with UTM tracking",
  "description": "# Web-to-Odoo Lead Funnel (UTM-ready)\n\nCreate `crm.lead` records in Odoo from any webform via a secure webhook.  \nThe workflow validates required fields, resolves UTMs **by name** (source, medium, campaign) and writes standard lead fields in Odoo. Clean, portable, and production-ready.\n\n## Key features\n- ✅ **Secure Webhook** with Header Auth (`x-webhook-token`)\n- ✅ **Required fields validation** (`firstname`, `lastname`, `email`)\n- ✅ **UTM lookup by name** (`utm.source`, `utm.medium`, `utm.campaign`)\n- ✅ **Clean consolidation** before create (`name`, `contact_name`, `email_from`, `phone`, `description`, `type`, UTM IDs)\n- ✅ **Clear HTTP responses**: `200` success / `400` bad request\n\n## Prerequisites\n- Odoo with **Leads** enabled (CRM → Settings → Leads)\n- **Odoo API Key** for your user (use it as the password)\n- n8n **Odoo credentials**: URL, DB name, Login, API Key\n- **Public URL** for the webhook (ngrok/Cloudflare/reverse proxy). Ensure `WEBHOOK_URL` / `N8N_HOST` / `N8N_PROTOCOL` / `N8N_PORT` are consistent\n- **Header Auth secret** (e.g., `x-webhook-token: &lt;your-secret&gt;`)\n\n## How it works\n1. **Ingest** – The Webhook receives a POST at `/webhook(-test)/lead-webform` with Header Auth.  \n2. **Validate** – An IF node checks required fields; if missing → respond with `400 Bad Request`.  \n3. **UTM lookup** – Three Odoo `getAll` queries fetch IDs by `name`:\n   - `utm.source` → `source_id`\n   - `utm.medium` → `medium_id`\n   - `utm.campaign` → `campaign_id`  \n   If a record is not found, the corresponding ID remains `null`.\n4. **Consolidate** – Merge + Code nodes produce a single clean object:  \n   `{ name, contact_name, email_from, phone, description, type: \"lead\", campaign_id, source_id, medium_id }`\n5. **Create in Odoo** – Odoo node (`crm.lead → create`) writes the lead with standard fields + UTM Many2one IDs.\n6. **Respond** – Success node returns `200` with `{ status: \"ok\", lead_id }`.\n\n## Payload (JSON)\n**Required:** `firstname`, `lastname`, `email`  \n**Optional:** `phone`, `notes`, `source`, `medium`, `campaign`\n\n```json\n{\n  \"firstname\": \"John\",\n  \"lastname\": \"Doe\",\n  \"email\": \"john.doe@example.com\",\n  \"phone\": \"+393331234567\",\n  \"notes\": \"Wants a demo\",\n  \"source\": \"Ads\",\n  \"medium\": \"Website\",\n  \"campaign\": \"Spring 2025\"\n}\n```\n\n## Quick test\n```bash\ncurl -X POST \"https://&lt;host&gt;/webhook-test/lead-webform\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"x-webhook-token: &lt;secret&gt;\" \\\n  -d '{\"firstname\":\"John\",\"lastname\":\"Doe\",\"email\":\"john@ex.com\",\n       \"phone\":\"+39333...\", \"notes\":\"Demo\",\n       \"source\":\"Ads\",\"medium\":\"Website\",\"campaign\":\"Spring 2025\"}'\n```\n\n## Notes\n- Recent Odoo versions do not use the `mobile` field on leads/partners: use `phone` instead.\n- Keep **secrets and credentials** out of the template; the user will set their own after import.\n- If you want to **auto-create** missing UTM records, add an IF after each `getAll` and a `create` on `utm.*`.\n",
  "featuredImage": "/data/workflows/7289/7289.webp",
  "author": {
    "id": 101,
    "slug": "castaldosolutions",
    "name": "Gaetano Castaldo",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1712,
  "downloads": 171,
  "createdAt": "2025-08-12T12:13:37.443Z",
  "updatedAt": "2026-01-16T08:49:30.387Z",
  "publishedAt": "2025-08-12T12:13:37.443Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7289"
}