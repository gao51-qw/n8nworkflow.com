# Who Is This For?
This n8n automation workflow is designed for sales teams, client managers, consultants, or anyone who regularly schedules and follows up on meetings — and wants to save time doing it.
If you often find yourself juggling between Google Sheets, Google Calendar, email, and WhatsApp just to manage your meetings, confirmations, and follow-ups — this workflow is for you.


## What This Workflow Does
This workflow is structured into two main, independently scheduled branches:
### 1. Create Event (Schedule Meetings)
* **Trigger:** Starts automatically on a schedule (e.g., every minute).
* **Data Source:** Fetches new meeting data from a **Google Sheet**.
* **Event Creation:** Creates a new event in **Google Calendar** using the data.
* **Confirmation:** Sends a confirmation message via **WhatsApp (Rapiwa)** and **Email (Gmail)**.
* **Status Update:** Updates the source **Google Sheet** to mark the meeting as 'sent'.

### 2. Reminder Event (Schedule Follow-ups)
* **Trigger:** Starts automatically on a schedule (e.g., every minute).
* **Past Events:** Retrieves recent past events from **Google Calendar**.
* **Deduplication:** Uses a "Mark as Seen" node to prevent processing the same event multiple times.
* **Filtering:** Filters for specific events that require a follow-up ("Only Follow Ups" node).
* **AI Follow-up:** An **AI Meeting Agent (using Gemini/LLM)** uses the details of the past meeting and the Calendar's **Availability** tool to find and suggest open slots for a future meeting.
* **Communication:** Sends a message with the suggested slots via **WhatsApp (Rapiwa)** and **Email (Gmail)**.


## Key Features
* **Scheduled Automation:** Both event creation and follow-up scheduling run on a recurring schedule.
* **Data Synchronization:** Reads meeting details from and updates a **Google Sheet**.
* **Google Calendar Integration:** Creates events and checks calendar availability.
* **Multi-Channel Communication:** Sends confirmations/follow-ups via **WhatsApp (Rapiwa)** and **Email (Gmail)**.
* **AI-Powered Follow-up:** Uses an **AI Agent (Gemini)** to intelligently find and format available slots for the next meeting, considering the details of the past meeting (day, time, duration).
* **Idempotency:** The "Mark as Seen" node prevents duplicate follow-up attempts for the same event.


## Requirements
* n8n instance with nodes: Schedule Trigger, Google Sheets, Split In Batches, Date & Time, Code, Google Calendar, Rapiwa, Gmail, Filter, Agent (LangChain), LLM Chat (Google Gemini), Structured Output Parser (LangChain), Set, Remove Duplicates, Wait.
* **Google Calendar** with an available calendar for event creation and availability checks.
* **Google Sheets** for storing meeting details.
* **Rapiwa** (WhatsApp API) account credentials.
* **Gmail** account credentials.
* **Google Gemini (PaLM) API** credentials for the AI agent.


## How to Use — Step-by-Step Setup
1.  **Credentials Setup**
    * **Google Sheets OAuth2:** Configure to allow the workflow to read from and write to your Sheet.
    * **Google Calendar OAuth2:** Configure to allow event creation and availability checks.
    * **Rapiwa API:** Set up credentials for sending WhatsApp messages.
    * **Gmail OAuth2:** Set up credentials for sending email confirmations/follow-ups.
    * **Google Gemini(PaLM) API:** Set up credentials for the AI agent functionality.

2.  **Configure "Create Event" Branch**
    * **Get in sheet:** Update the **Document ID** and **Sheet Name** to point to your meeting data spreadsheet. The node is set to filter by a `status` column.
    * **Create an event:** Verify the correct **Calendar ID** is selected. The `end` time is dynamically generated by the previous **Code** node.
    * **Rapiwa / Send a message1:** Update the recipient number/email address and customize the message templates.
    * **Update status in sheet:** Ensure the correct **Document ID**, **Sheet Name**, and matching column (`row\_number`) are configured to update the status to "sent".

3.  **Configure "Reminder Event" Branch**
    * **Get Past Events:** Verify the correct **Calendar ID** is selected.
    * **Only Follow Ups:** Customize the filter condition if only a subset of past meetings needs follow-up (e.g., if you have a "Follow-up Status" column to check).
    * **Meeting Agent:** Review the **System Message** to ensure the AI's logic for finding slots matches your business rules (e.g., preferred working hours, look-ahead period).
    * **Generate Message:** Customize the **message** template, which formats the AI-suggested slots.
    * **Rapiwa1 / Send a message:** Update the recipient number/email address for the follow-up messages.



## Google Sheet Required Columns
The workflow expects a Google Sheet with meeting data to have at least the following columns:
**A Google Sheet formatted like this** ➤ [Sample Sheet](https://docs.google.com/spreadsheets/d/1DSRrIDvw-Q9NugRK3eT7GMa0kwe0QnGhdySnqq1_kJU/edit?usp=sharing)

| title                                   | description                                                                                                                                                                                                                                                  | location          | color_number | start time         | end time           | reminder status | status  |
| :-------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------- | :----------- | :----------------- | :----------------- | :-------------- | :------ |
| 2025 Personal Planner & Events Calendar | Stay organized and never miss an important date! This calendar helps........ | Dhaka, Bangladesh | 4            | 10/28/2025 3:50:00 | 10/29/2025 5:30:00 | sent            | checked |
| 2026 Personal Planner & Events Calendar | Stay organized and never miss an important date! This calendar helps........ | Dhaka, Bangladesh | 2            | 10/29/2025 3:50:00 | 10/30/2025 5:30:00 | sent            | checked |




## Useful Links
- **Dashboard:** [https://app.rapiwa.com](https://app.rapiwa.com/login)
- **Official Website:** [https://rapiwa.com](https://rapiwa.com/)
- **Documentation:** [https://docs.rapiwa.com](https://docs.rapiwa.com/)

## Support & Help
- **WhatsApp**: [Chat on WhatsApp](https://wa.me/8801322827799)
- **Discord**: [SpaGreen Community](https://discord.gg/SsCChWEP)
- **Facebook Group**: [SpaGreen Support](https://www.facebook.com/groups/spagreenbd)
- **Website**: [https://spagreen.net](https://spagreen.net)
- **Developer Portfolio**: [Codecanyon SpaGreen](https://codecanyon.net/user/spagreen/portfolio)
