{
  "id": 3453,
  "slug": "3453",
  "title": "Automated weekly project cost reports with MySQL and Outlook HTML emails",
  "description": "## Automated Weekly Project Cost Reports with MySQL and Outlook HTML Emails\n\n## ğŸ§  Use Case\n\nNeed to keep your finance or operations team updated on missing project costs?  \nThis practical **automated report workflow** does the job without AI â€” and saves hours weekly.\n\n- Runs on a **weekly schedule**\n- Queries your **MySQL** database for projects missing cost data\n- Filters by `budgeted_project_cost IS NULL`\n- Generates a clean **HTML email report**\n- Sends it through **Microsoft Outlook** to relevant teams\n\n## ğŸš€ How It Works\n\n1. **Schedule Trigger** â€“ Runs every Monday at 8 AM\n2. **MySQL Node** â€“ Connects and runs SQL to fetch project data missing `budgeted_project_cost`\n3. **Switch Node** â€“ Routes logic based on `cost_center` (e.g., Retail, Service, Projects)\n4. **Outlook Nodes** â€“ Sends formatted HTML emails; each node handles a specific group\n5. **Dynamic Content** â€“ Inject values using mustache tags like `{{ $json.project_name }}`\n\n## ğŸ”§ Setup Instructions\n\n1. **MySQL Setup**:\n   - Ensure the MySQL node is connected using a valid credential set:\n     - Hostname/IP\n     - Port (default: 3306)\n     - Database name\n     - Username with SELECT permissions\n     - Password\n   - Query Example:\n     ```sql\n     SELECT project_name, cost_center FROM tabProject \n     WHERE status = 'Open' AND project_type = 'External' AND budgeted_project_cost IS NULL;\n     ```\n\n2. **Outlook Configuration**:\n   - Connect your Microsoft Outlook node using OAuth2 credentials.\n   - Rename each Outlook node clearly (e.g., `Send Email - Retail`, `Send Email - Service`).\n\n3. **Switch Node**:\n   - Modify cost center values as needed to match your organization (e.g., `'Retail'`, `'Service'`, `'Projects'`).\n\n4. **HTML Email Formatting**:\n   - Customize the HTML message body using inline styles and mustache syntax.\n   - Sample:\n     ```html\n     <h3>Missing Budgeted Cost Report</h3>\n     <ul>\n       <li>Project: {{ $json.project_name }}</li>\n       <li>Cost Center: {{ $json.cost_center }}</li>\n     </ul>\n     ```\n\n5. **Recipients**:\n   - Replace `amjid@amjidali.com` with the actual email addresses of the concerned teams.\n\n\n## ğŸ“˜ Read More\n\nğŸ‘‰ [Why Simple Workflows Work](https://syncbricks.com/why-simple-n8n-workflows-often-deliver-more-value-than-complex-ones/)  \n\n## ğŸ“º Demo & Tutorial\n\nğŸ¥ Watch the video walkthrough:  \n[https://youtube.com/@syncbricks](https://youtube.com/@syncbricks)\n\n---\n\n## ğŸ‘¤ About the Creator\n\n**Amjid Ali**  \nğŸŒ [amjidali.com](https://amjidali.com)  \nğŸ“˜ [n8n Book](https://lms.syncbricks.com/books/n8n/)  \nğŸ“ [Learn n8n](https://www.udemy.com/course/mastering-n8n-ai-agents-api-automation-webhooks-no-code/?referralCode=0309FD70BE2D72630C09)\n\n&gt; â€œStart simple, scale smart. Even basic workflows like this can save your team hours!â€ â€” *Amjid Ali*",
  "featuredImage": "/data/workflows/3453/3453.webp",
  "author": {
    "id": 101,
    "slug": "amjid",
    "name": "Amjid Ali",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1829,
  "downloads": 182,
  "createdAt": "2025-04-07T05:56:27.085Z",
  "updatedAt": "2026-01-16T08:29:50.818Z",
  "publishedAt": "2025-04-07T05:56:27.085Z",
  "nodes": 6,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3453"
}