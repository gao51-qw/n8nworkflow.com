{
  "workflow": {
    "id": 7237,
    "name": "Detect cannibalized keywords and competing pages with Google Search Console",
    "views": 431,
    "recentViews": 0,
    "totalViews": 431,
    "createdAt": "2025-08-11T09:09:32.394Z",
    "description": "# Find Cannibalized Pages (Google Search Console)\n\nThis n8n template helps you **detect page cannibalization** in Google Search Console (GSC): situations where **multiple pages** on your site rank for the **same query** and **more than one page gets clicks**. Use it to spot competing URLs, consolidate content, improve internal linking, and protect your CTR/rankings.\n\n---\n\n## Good to know\n- **Data source:** Google Search Console Search Analytics (Dimensions: `query`, `page`).\n- **Scope:** Defaults to **last 12 months** and up to **10,000 rows** per run (adjustable).\n- **Logic:** Keeps only queries with **&gt;1 page** and where the **second page has clicks &gt; 0** ‚Üí higher confidence of true cannibalization.\n- **Privacy:** Template ships with a placeholder property (`sc-domain:example.com`) and a neutral credential name; replace both after import.\n- **Cost:** n8n nodes used here are free. GSC usage is also free (subject to Google limits).\n\n---\n\n## How it works\n1. **Manual Start** ‚Äî run the workflow on demand.  \n2. **Google Search Console** ‚Äî fetch last 12 months of query‚Äìpage rows.  \n3. **Summarize** ‚Äî group by `query`, building two arrays:  \n   - `appended_page[]` ‚Üí all pages seen for that query  \n   - `appended_clicks[]` ‚Üí clicks for each page-query row (aligned with `appended_page`)\n4. **Filter** ‚Äî pass only queries where:  \n   - `count_query &gt; 1` (more than one page involved), and  \n   - `appended_clicks[1] &gt; 0` (the second page also received clicks)\n5. **Output** ‚Äî list of **cannibalized queries** with the **competing pages** and their click counts.\n\n**Example output**\n```json\n{\n  \"query\": \"best running shoes\",\n  \"appended_page\": [\n    \"https://example.com/blog/best-running-shoes\",\n    \"https://example.com/guide/running-shoes-2025\"\n  ],\n  \"appended_clicks\": [124, 37],\n  \"count_query\": 3\n}\n```\n## How to use\n1. Import the JSON into n8n.  \n2. Open the **Google Search Console** node and:  \n   - Connect your **Google Search Console OAuth2** credential.  \n   - Replace `siteUrl` with your property (`sc-domain:your-domain.com`).  \n3. Press **Execute Workflow** on **Manual Start**.  \n4. Review the output ‚Äî focus on queries where the second page has meaningful clicks.  \n\nüí° **Tip:** If your site is large, start with a shorter date range (e.g., 90 days) or raise `rowLimit`.\n\n---\n\n## Requirements\n- Access to the target property in **Google Search Console**.  \n- One **Google Search Console OAuth2** credential in n8n.\n\n---\n\n## Customising this workflow\n- **More robust detection:** In the **Summarize** node, change `clicks` aggregation from `append` to `sum`. Then filter for ‚Äú**at least 2 pages with `sum_clicks &gt; 0`**‚Äù to avoid any dependency on row order.  \n- **Scoring & sorting:** Add a **Code/Function** node to sort competing pages by clicks or impressions and compute click-share per page.  \n- **Deeper analysis:** Include `impressions` and `position` in the GSC node and extend the summary to prioritize fixes (e.g., high impressions + split clicks).  \n- **Reporting:** Send results to **Google Sheets** or export a **CSV**; create a dashboard of top cannibalized queries.  \n- **Thresholds:** Expose minimum click thresholds as **workflow variables** (e.g., second page clicks ‚â• 3) to reduce noise.\n\n---\n\n## Troubleshooting\n- **Empty results:** Widen date range, increase `rowLimit`, or temporarily relax the filter (remove the second-page click condition to validate data flow).  \n- **No property data:** Ensure you used `sc-domain:` vs. `https://` property format correctly and that your user has GSC access.  \n- **Credential issues:** Reconnect the OAuth2 credential and reauthorize if needed.\n",
    "workflow": {
      "meta": {
        "instanceId": "642fa7950f5ab85714db52bdbeb05f43a1aee0f27abf59a2ec32ba62a327743f",
        "templateCredsSetupCompleted": true
      },
      "nodes": [
        {
          "id": "7c9a0add-4047-47e0-8d27-53bf9a0b3951",
          "name": "Workflow Description",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            0,
            0
          ],
          "parameters": {
            "width": 760,
            "height": 460,
            "content": "## üîé Find Query Cannibalization (Google Search Console)\n\n**Purpose**\nDetect queries where **multiple pages** on your site compete and both receive clicks (true cannibalization).\n\n**How it works**\n1) Fetch last 12 months from GSC with dimensions **query** + **page**.\n2) Summarize by **query** ‚Üí build arrays of pages and clicks per query.\n3) Filter ‚Üí keep queries with **>1 page** AND **second page has clicks > 0**.\n\n**Before running**\n- Connect a **Google Search Console OAuth2** credential to the GSC node.\n- Replace `sc-domain:example.com` with your property (e.g., `sc-domain:your-domain.com`).\n\n**Tips**\n- For more robust results, consider summing clicks per page (use `sum` instead of `append`) and then filter for **‚â• 2 pages with clicks > 0**.\n- You can run ad‚Äëhoc via **Manual Start** or automate via **Weekly Trigger**.\n\n**Output fields**\n- `query`, `appended_page[]`, `appended_clicks[]`, `count_query`\n\nTags: SEO, GSC, Cannibalization"
          },
          "typeVersion": 1
        },
        {
          "id": "fe090582-2798-4639-83e8-fd138e2f704d",
          "name": "Manual Start",
          "type": "n8n-nodes-base.start",
          "position": [
            304,
            512
          ],
          "parameters": {},
          "typeVersion": 1
        },
        {
          "id": "d2ea11e7-0342-4762-b338-d17254fa6a0d",
          "name": "Query Search Analytics",
          "type": "n8n-nodes-google-search-console.googleSearchConsole",
          "position": [
            528,
            512
          ],
          "parameters": {
            "siteUrl": "sc-domain:example.com",
            "rowLimit": 10000,
            "operation": "getPageInsights",
            "dimensions": [
              "query",
              "page"
            ],
            "dateRangeMode": "last12mo"
          },
          "credentials": {
            "googleSearchConsoleOAuth2Api": {
              "id": "credential-id",
              "name": "googleSearchConsoleOAuth2Api Credential"
            }
          },
          "typeVersion": 1
        },
        {
          "id": "345f7a46-c00a-44a1-87fa-f8b70cf795a3",
          "name": "Summarize by Query",
          "type": "n8n-nodes-base.summarize",
          "position": [
            752,
            512
          ],
          "parameters": {
            "options": {},
            "fieldsToSplitBy": "query",
            "fieldsToSummarize": {
              "values": [
                {
                  "field": "query"
                },
                {
                  "field": "page",
                  "aggregation": "append"
                },
                {
                  "field": "clicks",
                  "aggregation": "append"
                }
              ]
            }
          },
          "typeVersion": 1.1
        },
        {
          "id": "27038010-a800-4a33-b22a-fbfdf82b5e8e",
          "name": "Filter Cannibal Queries",
          "type": "n8n-nodes-base.filter",
          "position": [
            976,
            512
          ],
          "parameters": {
            "options": {},
            "conditions": {
              "options": {
                "version": 2,
                "caseSensitive": true,
                "typeValidation": "strict"
              },
              "combinator": "and",
              "conditions": [
                {
                  "operator": {
                    "type": "number",
                    "operation": "gt"
                  },
                  "leftValue": "={{ $json.count_query }}",
                  "rightValue": 1
                },
                {
                  "operator": {
                    "type": "number",
                    "operation": "gt"
                  },
                  "leftValue": "={{ $json.appended_clicks[1] }}",
                  "rightValue": 0
                }
              ]
            }
          },
          "typeVersion": 2.2
        }
      ],
      "pinData": {},
      "connections": {
        "Manual Start": {
          "main": [
            [
              {
                "node": "Query Search Analytics",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Summarize by Query": {
          "main": [
            [
              {
                "node": "Filter Cannibal Queries",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Query Search Analytics": {
          "main": [
            [
              {
                "node": "Summarize by Query",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      }
    },
    "lastUpdatedBy": 29,
    "workflowInfo": {
      "nodeCount": 5,
      "nodeTypes": {
        "n8n-nodes-base.start": {
          "count": 1
        },
        "n8n-nodes-base.filter": {
          "count": 1
        },
        "n8n-nodes-base.summarize": {
          "count": 1
        },
        "n8n-nodes-base.stickyNote": {
          "count": 1
        },
        "n8n-nodes-google-search-console.googleSearchConsole": {
          "count": 1
        }
      }
    },
    "status": "published",
    "user": {
      "name": "Mohammadreza azari",
      "username": "mrazari",
      "bio": "SEO & Automation Consultant focused on optimizing sales and marketing processes through n8n and smart workflow automation solutions.",
      "verified": true,
      "links": [
        "https://mrazari.com/"
      ],
      "avatar": "https://gravatar.com/avatar/07ca413e08043e29e9738f610062a2ee9c1993409290dbd45c0ef18488b00bd6?r=pg&d=retro&size=200"
    },
    "nodes": [
      {
        "id": 42,
        "icon": "fa:play",
        "name": "n8n-nodes-base.start",
        "codex": {
          "data": {
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                  "icon": "üß¨",
                  "label": "Why business process automation with n8n can change your daily life"
                },
                {
                  "url": "https://n8n.io/blog/why-i-chose-n8n-over-zapier-in-2020/",
                  "icon": "üòç",
                  "label": "Why I chose n8n over Zapier in 2020"
                },
                {
                  "url": "https://n8n.io/blog/automatically-pulling-and-visualizing-data-with-n8n/",
                  "icon": "üìà",
                  "label": "Automatically pulling and visualizing data with n8n"
                },
                {
                  "url": "https://n8n.io/blog/how-to-use-the-http-request-node-the-swiss-army-knife-for-workflow-automation/",
                  "icon": "üß∞",
                  "label": "How to use the HTTP Request Node - The Swiss Army Knife for Workflow Automation"
                },
                {
                  "url": "https://n8n.io/blog/sending-sms-the-low-code-way-with-airtable-twilio-programmable-sms-and-n8n/",
                  "icon": "üì±",
                  "label": "Sending SMS the Low-Code Way with Airtable, Twilio Programmable SMS, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/automating-conference-organization-processes-with-n8n/",
                  "icon": "üôã‚Äç‚ôÄÔ∏è",
                  "label": "Automating Conference Organization Processes with n8n"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.start/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0"
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Start",
          "color": "#00e000"
        },
        "iconData": {
          "icon": "play",
          "type": "icon"
        },
        "displayName": "Start",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 565,
        "icon": "fa:sticky-note",
        "name": "n8n-nodes-base.stickyNote",
        "codex": {
          "data": {
            "alias": [
              "Comments",
              "Notes",
              "Sticky"
            ],
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Sticky Note",
          "color": "#FFD233"
        },
        "iconData": {
          "icon": "sticky-note",
          "type": "icon"
        },
        "displayName": "Sticky Note",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 844,
        "icon": "fa:filter",
        "name": "n8n-nodes-base.filter",
        "codex": {
          "data": {
            "alias": [
              "Router",
              "Filter",
              "Condition",
              "Logic",
              "Boolean",
              "Branch"
            ],
            "details": "The Filter node can be used to filter items based on a condition. If the condition is met, the item will be passed on to the next node. If the condition is not met, the item will be omitted. Conditions can be combined together by AND(meet all conditions), or OR(meet at least one condition).",
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.filter/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Flow",
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Filter",
          "color": "#229eff"
        },
        "iconData": {
          "icon": "filter",
          "type": "icon"
        },
        "displayName": "Filter",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 1241,
        "icon": "file:summarize.svg",
        "name": "n8n-nodes-base.summarize",
        "codex": {
          "data": {
            "alias": [
              "Append",
              "Array",
              "Average",
              "Concatenate",
              "Count",
              "Group",
              "Item",
              "List",
              "Max",
              "Min",
              "Pivot",
              "Sum",
              "Summarise",
              "Summarize",
              "Transform",
              "Unique"
            ],
            "details": "",
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.summarize/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Summarize"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSJub25lIj48cGF0aCBmaWxsPSIjRjkyIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMzIgOTFjLTE1LjQ2NCAwLTI4IDEyLjUzNi0yOCAyOHYzMTdjMCAxNS40NjQgMTIuNTM2IDI4IDI4IDI4aDI0OGMxNS40NjQgMCAyOC0xMi41MzYgMjgtMjhWMTE5YzAtMTUuNDY0LTEyLjUzNi0yOC0yOC0yOGgtNmE2IDYgMCAwIDEtNi02VjQ5YTYgNiAwIDAgMSA2LTZoNmM0MS45NzQgMCA3NiAzNC4wMjYgNzYgNzZ2MzE3YzAgNDEuOTc0LTM0LjAyNiA3Ni03NiA3NkgxMzJjLTQxLjk3NCAwLTc2LTM0LjAyNi03Ni03NlYxMTljMC00MS45NzQgMzQuMDI2LTc2IDc2LTc2aDZhNiA2IDAgMCAxIDYgNnYzNmE2IDYgMCAwIDEtNiA2eiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iI0Y5MiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMjU2IDBjLTI3LjIzMiAwLTUwLjIyNyAxOC4xNDItNTcuNTU4IDQzSDE4MmE2IDYgMCAwIDAtNiA2djcwYTYgNiAwIDAgMCA2IDZoMTQ4YTYgNiAwIDAgMCA2LTZWNDlhNiA2IDAgMCAwLTYtNmgtMTYuNDQyQzMwNi4yMjcgMTguMTQyIDI4My4yMzIgMCAyNTYgMG0wIDQwYTE5LjkgMTkuOSAwIDAgMC0xMC41NDEgM0MyMzkuNzgxIDQ2LjUyOCAyMzYgNTIuODIzIDIzNiA2MGMwIDExLjA0NiA4Ljk1NCAyMCAyMCAyMHMyMC04Ljk1NCAyMC0yMGMwLTcuMTc3LTMuNzgxLTEzLjQ3Mi05LjQ1OS0xN0ExOS45IDE5LjkgMCAwIDAgMjU2IDQwbTEwMSAxNzljMCA2LjYyNy01LjM3MyAxMi0xMiAxMkgyMzNjLTYuNjI3IDAtMTItNS4zNzMtMTItMTJ2LTI0YzAtNi42MjcgNS4zNzMtMTIgMTItMTJoMTEyYzYuNjI3IDAgMTIgNS4zNzMgMTIgMTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSIjRjkyIiBkPSJNMTk3IDIwN2MwIDEzLjI1NS0xMC43NDUgMjQtMjQgMjRzLTI0LTEwLjc0NS0yNC0yNCAxMC43NDUtMjQgMjQtMjQgMjQgMTAuNzQ1IDI0IDI0Ii8+PHBhdGggZmlsbD0iI0Y5MiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMzU3IDM5NWMwIDYuNjI3LTUuMzczIDEyLTEyIDEySDIzM2MtNi42MjcgMC0xMi01LjM3My0xMi0xMnYtMjRjMC02LjYyNyA1LjM3My0xMiAxMi0xMmgxMTJjNi42MjcgMCAxMiA1LjM3MyAxMiAxMnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiNGOTIiIGQ9Ik0xOTcgMzgzYzAgMTMuMjU1LTEwLjc0NSAyNC0yNCAyNHMtMjQtMTAuNzQ1LTI0LTI0IDEwLjc0NS0yNCAyNC0yNCAyNCAxMC43NDUgMjQgMjQiLz48cGF0aCBmaWxsPSIjRjkyIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zNTcgMzA3YzAgNi42MjctNS4zNzMgMTItMTIgMTJIMjMzYy02LjYyNyAwLTEyLTUuMzczLTEyLTEydi0yNGMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDExMmM2LjYyNyAwIDEyIDUuMzczIDEyIDEyeiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iI0Y5MiIgZD0iTTE5NyAyOTVjMCAxMy4yNTUtMTAuNzQ1IDI0LTI0IDI0cy0yNC0xMC43NDUtMjQtMjQgMTAuNzQ1LTI0IDI0LTI0IDI0IDEwLjc0NSAyNCAyNCIvPjwvc3ZnPg=="
        },
        "displayName": "Summarize",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      }
    ],
    "categories": [
      {
        "id": 32,
        "name": "Market Research"
      },
      {
        "id": 51,
        "name": "Multimodal AI"
      }
    ],
    "image": []
  }
}