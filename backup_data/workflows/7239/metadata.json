{
  "id": 7239,
  "slug": "7239",
  "title": "Parse invoices & documents with Gemini AI, OCR, and Google Sheets integration",
  "description": "## Smart Document Parser for Invoices, Logs or Sensor Reports (PDF/Image to Google Sheets)\n\nThis n8n workflow automatically parses documents such as invoices, sensor logs or structured PDFs/images (including scanned docs or CSVs), extracts key fields like totals, dates and customer/vendor info using OCR and AI, and writes the structured output into Google Sheets.\n\n## Who’s it for\n\n* Finance or Ops teams automating invoice processing.\n* SaaS platforms parsing uploaded reports or documents.\n* Anyone needing a no-code backend for PDF/image/CSV document parsing.\n* AI-powered data capture pipelines.\n\n## How it works\n1. **Webhook Trigger** receives file uploads (`/uploadDoc`)\n2. **Switch Node** checks the file type:\n\t* If **image** → Use **Tesseract OCR**\n\t* If **PDF** → Use PDF parser\n\t* If **CSV** → Extract as-is\n3. Extracted text is passed to:\n\t* **Google Gemini or Gemini Flash AI** model\n\t* Prompt extracts fields like `invoice_id`, `total`, `customer_name`, etc.\n4. JSON string is parsed and cleaned\n5. Data is appended to **Google Sheets** using `appendOrUpdate`\n\n## How to set up\n1. Create a Google Sheet with columns like:\n\n`invoice_id`, `invoice_date`, `due_date`, `customer_name`, `vendor_name`, `subtotal`, `tax_total`, `total`, `currency`\n\n2. Connect:\n\t* Google Sheets OAuth\n\t* Google Gemini (PaLM API key) for LLM parsing\n3. Deploy the webhook endpoint: `/uploadDoc`\n4. Upload sample files (PDFs, images, CSVs) to test\n5. Review and map sheet columns in the `Invoice Data` node\n\n## Requirements\n\n| Tool | Purpose |\n| ------------- | --------------------------------- |\n| n8n | Automation framework |\n| Google Sheets | To store structured output |\n| Tesseract OCR | For scanned image text extraction |\n| Google Gemini | For natural language parsing |\n\n## How to customize\n\n* Add extraction for **line items** using structured prompts.\n* Change prompt to extract **sensor readings**, **log types**, or custom keys.\n* Add support for other file types (e.g., XLSX, DOCX).\n* Add Slack/Email notifications on success/failure.\n* Swap Gemini with OpenAI or Hugging Face if preferred.\n\n## Add‑ons\n\n* Save uploaded files to Google Drive or S3\n* Add auth for secure uploads\n* Use charting/dashboard nodes to visualize extracted data\n* Integrate with billing/accounting software\n\n## Use Case Examples\n\n| Scenario | What Happens |\n| ----------------------- | ------------------------------------------------------- |\n| Invoice Upload (PDF) | Extracts totals, customer, tax data into a Google Sheet |\n| Scanned Receipt (Image) | OCR + LLM extracts structured data |\n| Log File (CSV) | Parses and logs entries into Sheets |\n\n## Common troubleshooting\n\n| Issue | Possible Cause | Solution |\n| --------------------------------- | ----------------------- | ------------------------------------------- |\n| `Webhook not triggered` | URL or method mismatch | Use correct POST URL `/uploadDoc` |\n| `Text is blank` | OCR failed | Check image quality or Tesseract config |\n| `Gemini model not returning JSON` | Prompt formatting issue | Ensure prompt ends with valid JSON schema |\n| `Sheet not updated` | Invalid Sheet ID or tab | Double-check sheet credentials and tab name |\n\n## Need Help?\n\n- Need help fine-tuning the Gemini prompt for better field accuracy?\n- Want to extract full tables, multi-page invoices or convert PDFs to JSON lines?\n\nOur automation team at WeblineIndia can help you extend this into a full-blown document automation pipeline.",
  "featuredImage": "/data/workflows/7239/7239.webp",
  "author": {
    "id": 101,
    "slug": "weblineindia",
    "name": "WeblineIndia",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1311,
  "downloads": 131,
  "createdAt": "2025-08-11T11:01:37.132Z",
  "updatedAt": "2026-01-16T08:49:12.718Z",
  "publishedAt": "2025-08-11T11:01:37.132Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7239"
}