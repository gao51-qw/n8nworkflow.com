{
  "id": 9699,
  "slug": "9699",
  "title": "AI-Powered Contact Intelligence & Enrichment with OpenAI/Anthropic and Supabase",
  "description": "# AI Contact Enrichment\n\n## üìã Template Description\n\n### Overview\nAutomatically enhance and enrich contact data using AI to fill in missing information, generate insights, and create detailed buyer personas. Supports multiple AI providers (OpenAI, Anthropic, etc.) with automatic logging to Supabase.\n\n### Description\nThis workflow transforms incomplete contact records into rich, actionable profiles. By leveraging AI, it can infer job roles, company information, likely pain points, communication preferences, and buying motivations from minimal input data. Perfect for sales and marketing teams looking to improve data quality and personalize outreach.\n\n**Key Benefits:**\n- **Smart Data Completion**: Fill in missing contact fields using AI inference\n- **Buyer Persona Generation**: Create detailed profiles from basic information\n- **Universal AI Support**: Works with OpenAI, Anthropic Claude, or custom providers\n- **CRM Enhancement**: Automatically enrich contacts as they enter your system\n- **Lead Qualification**: Assess lead quality and fit based on enriched data\n- **Personalization Engine**: Generate insights for tailored outreach\n- **Data Quality**: Maintain clean, complete contact records\n\n**Use Cases:**\n- Sales prospecting and lead enrichment\n- Marketing persona development\n- CRM data cleansing and completion\n- Account-based marketing (ABM) research\n- Lead scoring and qualification\n- Personalized email campaign preparation\n- Contact segmentation and targeting\n\n---\n\n## ‚öôÔ∏è Setup Instructions\n\n### Prerequisites\n1. **n8n instance** (cloud or self-hosted)\n2. **AI Provider account** (OpenAI, Anthropic, or custom)\n3. **Supabase account** with database access\n\n### Step 1: Configure Environment Variables\nAdd these to your n8n environment settings:\n\n```bash\nAI_PROVIDER=openai              # or 'anthropic', 'custom'\nAI_API_KEY=your_api_key_here\nAI_MODEL=gpt-3.5-turbo         # or 'gpt-4', 'claude-3-sonnet-20240229'\nAI_ENDPOINT=                    # Only for custom providers\n```\n\n**Recommended Models:**\n- **Cost-effective**: `gpt-3.5-turbo` (fast, affordable, good for basic enrichment)\n- **High-quality**: `gpt-4` or `claude-3-sonnet-20240229` (better inference, deeper insights)\n- **Premium**: `claude-3-opus-20240229` (best for complex persona generation)\n\n**How to set environment variables:**\n- **n8n Cloud**: Go to Settings ‚Üí Environment Variables\n- **Self-hosted**: Add to your `.env` file or docker-compose configuration\n\n### Step 2: Set Up Supabase Database\nCreate the logging table in your Supabase database:\n\n```sql\nCREATE TABLE workflow_logs (\n  id BIGSERIAL PRIMARY KEY,\n  workflow_name TEXT NOT NULL,\n  data JSONB NOT NULL,\n  ai_response JSONB NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\nCREATE INDEX idx_workflow_logs_created_at ON workflow_logs(created_at);\nCREATE INDEX idx_workflow_logs_workflow_name ON workflow_logs(workflow_name);\n\n-- Optional: Create a view for enriched contacts\nCREATE VIEW enriched_contacts AS\nSELECT \n  id,\n  data-&gt;&gt;'email' as email,\n  data-&gt;&gt;'name' as name,\n  data-&gt;&gt;'company' as company,\n  ai_response as enrichment_data,\n  created_at\nFROM workflow_logs\nWHERE workflow_name = 'AI Contact Enrichment'\nORDER BY created_at DESC;\n```\n\n**To run this SQL:**\n1. Open your Supabase project dashboard\n2. Go to the SQL Editor\n3. Paste the SQL above and click \"Run\"\n\n### Step 3: Configure Supabase Credentials in n8n\n1. Go to **Settings** ‚Üí **Credentials**\n2. Click **Add Credential** ‚Üí **Supabase API**\n3. Enter your Supabase URL and API key (found in Project Settings ‚Üí API)\n4. Name it `Supabase API`\n5. Click **Save**\n\n### Step 4: Activate the Webhook\n1. Import this workflow into n8n\n2. Click the **Activate** toggle in the top-right corner\n3. Click on the \"Webhook Trigger\" node\n4. Copy the **Production URL** (this is your webhook endpoint)\n5. Save this URL for integration with your applications\n\n### Step 5: Test the Workflow\nSend a test POST request to the webhook:\n\n```bash\ncurl -X POST https://your-n8n-instance.com/webhook/contact-enrichment \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"john.doe@acmecorp.com\",\n    \"name\": \"John Doe\",\n    \"company\": \"Acme Corporation\",\n    \"linkedin_url\": \"https://linkedin.com/in/johndoe\"\n  }'\n```\n\n**Successful Response:**\n```json\n{\n  \"success\": true,\n  \"workflow\": \"AI Contact Enrichment\",\n  \"timestamp\": \"2025-01-14T12:00:00.000Z\"\n}\n```\n\n---\n\n## üì• Expected Payload Format\n\nThe webhook accepts JSON with basic contact information:\n\n### Minimal Input\n```json\n{\n  \"email\": \"string (required or name required)\",\n  \"name\": \"string (required or email required)\"\n}\n```\n\n### Recommended Input\n```json\n{\n  \"email\": \"string\",\n  \"name\": \"string\",\n  \"company\": \"string\",\n  \"job_title\": \"string\",\n  \"linkedin_url\": \"string\",\n  \"phone\": \"string\",\n  \"location\": \"string\",\n  \"website\": \"string\"\n}\n```\n\n### Complete Input Example\n```json\n{\n  \"email\": \"sarah.chen@techstartup.io\",\n  \"name\": \"Sarah Chen\",\n  \"company\": \"TechStartup Inc.\",\n  \"job_title\": \"VP of Marketing\",\n  \"linkedin_url\": \"https://linkedin.com/in/sarahchen\",\n  \"phone\": \"+1-555-0123\",\n  \"location\": \"San Francisco, CA\",\n  \"website\": \"https://techstartup.io\",\n  \"industry\": \"B2B SaaS\",\n  \"company_size\": \"50-200 employees\",\n  \"notes\": \"Met at SaaS conference 2024\"\n}\n```\n\n**Field Guidelines:**\n- At minimum, provide either `email` or `name`\n- More input fields = better AI enrichment quality\n- Include `linkedin_url` for best results\n- `company` helps with firmographic enrichment\n- Any additional context improves accuracy\n\n---\n\n## üîÑ Workflow Flow\n\n1. **Webhook Trigger**: Receives basic contact information from your application, form, or CRM\n2. **Process Data**: Adds unique ID and timestamp to the incoming data\n3. **Prepare AI Request**: Configures AI provider settings from environment variables\n4. **Call AI API**: Sends contact data to AI with enrichment prompt\n5. **Save to Supabase**: Archives original data and enrichment results\n6. **Format Response**: Returns success confirmation\n\n---\n\n## üéØ Customization Tips\n\n### Enhance AI Prompts for Better Enrichment\n\nModify the \"Prepare AI Request\" node to customize enrichment:\n\n```javascript\n// Enhanced prompt for contact enrichment\nconst systemPrompt = `You are an expert sales intelligence analyst. \nAnalyze the provided contact information and generate a comprehensive enrichment including:\n\n1. INFERRED DETAILS: Fill in missing information based on available data\n   - Full job title and seniority level\n   - Department and reporting structure\n   - Years of experience (estimated)\n   - Professional background\n\n2. COMPANY INSIGHTS: If company name provided\n   - Industry and sub-industry\n   - Company size and revenue (estimated)\n   - Key products/services\n   - Recent news or developments\n\n3. BUYER PERSONA: Create a detailed profile\n   - Primary responsibilities\n   - Likely pain points and challenges\n   - Key priorities and goals\n   - Decision-making authority\n   - Budget influence level\n\n4. ENGAGEMENT STRATEGY: Provide outreach recommendations\n   - Best communication channels\n   - Optimal outreach timing\n   - Key talking points\n   - Personalization suggestions\n   - Content interests\n\n5. LEAD SCORE: Rate 1-10 based on:\n   - Fit for product/service (specify your ICP)\n   - Seniority and decision power\n   - Company size and maturity\n   - Engagement potential\n\nReturn as structured JSON with clear sections.`;\n\nconst userMessage = `Contact Information:\\n${JSON.stringify($json.data, null, 2)}`;\n\nconst aiConfig = {\n  provider: $env.AI_PROVIDER || 'openai',\n  apiKey: $env.AI_API_KEY,\n  model: $env.AI_MODEL || 'gpt-3.5-turbo',\n  endpoint: $env.AI_ENDPOINT,\n  messages: [\n    { role: 'system', content: systemPrompt },\n    { role: 'user', content: userMessage }\n  ]\n};\n\nreturn { json: { aiConfig, data: $json } };\n```\n\n### Add External Data Sources\n\nEnhance enrichment with third-party APIs:\n\n**After \"Process Data\" node, add:**\n\n1. **Clearbit/Hunter.io Node**: Get verified company data\n2. **LinkedIn API**: Pull professional information\n3. **Company Database**: Query internal customer data\n4. **Web Scraping**: Extract data from company websites\n\n**Then merge all data before AI enrichment for best results**\n\n### Connect to Your CRM\n\nAuto-update contacts after enrichment:\n\n**Salesforce Integration:**\n```javascript\n// Add after \"Call AI API\" node\n// Update Salesforce contact with enriched data\nconst enrichedData = JSON.parse($json.ai_response);\nreturn {\n  json: {\n    contactId: $json.data.salesforce_id,\n    updates: {\n      Description: enrichedData.buyer_persona,\n      Custom_Score__c: enrichedData.lead_score,\n      Pain_Points__c: enrichedData.pain_points\n    }\n  }\n};\n```\n\n**HubSpot Integration:**\n- Add **HubSpot** node to update contact properties\n- Map enriched fields to custom HubSpot properties\n\n**Pipedrive Integration:**\n- Use **Pipedrive** node to update person records\n- Add custom fields for AI insights\n\n### Implement Lead Scoring\n\nAdd scoring logic after enrichment:\n\n```javascript\n// Calculate lead score based on enrichment\nconst enrichment = JSON.parse($json.ai_response);\n\nlet score = 0;\n\n// Job title scoring\nif (enrichment.seniority === 'C-Level') score += 30;\nelse if (enrichment.seniority === 'VP/Director') score += 20;\nelse if (enrichment.seniority === 'Manager') score += 10;\n\n// Company size scoring\nif (enrichment.company_size === 'Enterprise') score += 25;\nelse if (enrichment.company_size === 'Mid-Market') score += 15;\n\n// Decision authority scoring\nif (enrichment.decision_authority === 'High') score += 25;\nelse if (enrichment.decision_authority === 'Medium') score += 15;\n\n// Budget influence\nif (enrichment.budget_influence === 'Direct') score += 20;\n\nreturn { json: { ...enrichment, lead_score: score } };\n```\n\n### Add Compliance Checks\n\nInsert before AI processing:\n\n```javascript\n// Check for opt-out or compliance flags\nconst email = $json.email.toLowerCase();\n\n// Check against suppression list\nconst suppressedDomains = ['competitor.com', 'spam.com'];\nconst domain = email.split('@')[1];\n\nif (suppressedDomains.includes(domain)) {\n  throw new Error('Contact on suppression list');\n}\n\n// Verify email format\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nif (!emailRegex.test(email)) {\n  throw new Error('Invalid email format');\n}\n\nreturn { json: $json };\n```\n\n### Batch Enrichment\n\nProcess multiple contacts:\n\n1. Add **Spreadsheet File** trigger instead of webhook\n2. Add **Split In Batches** node (process 10-20 at a time)\n3. Run enrichment for each contact\n4. Combine results and export to CSV\n\n---\n\n## üõ†Ô∏è Troubleshooting\n\n### Common Issues\n\n**Issue**: \"Enrichment is too generic\"\n- **Solution**: Provide more input data (company, job title, LinkedIn)\n- Use GPT-4 or Claude models for better inference\n- Enhance the system prompt with specific instructions\n\n**Issue**: \"AI_API_KEY is undefined\"\n- **Solution**: Ensure environment variables are set correctly\n- Verify variable names match exactly (case-sensitive)\n\n**Issue**: \"Enrichment contradicts actual data\"\n- **Solution**: AI makes inferences - always validate critical information\n- Add validation step to check enriched data against known facts\n- Use external APIs for verification\n\n**Issue**: \"Too slow for real-time use\"\n- **Solution**: Implement queue system for async processing\n- Use faster models (gpt-3.5-turbo) for speed\n- Process in batches during off-peak hours\n\n**Issue**: \"Supabase credentials not found\"\n- **Solution**: Check credential name matches exactly: \"Supabase API\"\n- Verify Supabase URL and API key are correct\n\n### Debugging Tips\n1. Test with known contacts first to validate accuracy\n2. Compare AI enrichment against actual data\n3. Check execution logs for API errors\n4. Start with minimal prompt, then enhance gradually\n5. Use \"Execute Node\" to test individual steps\n\n---\n\n## üìä Analyzing Enriched Data\n\nQuery and analyze your enriched contacts:\n\n```sql\n-- Get all enriched contacts\nSELECT * FROM enriched_contacts\nORDER BY created_at DESC;\n\n-- Find high-value leads (assuming scoring implemented)\nSELECT \n  email,\n  name,\n  company,\n  ai_response-&gt;&gt;'lead_score' as score\nFROM enriched_contacts\nWHERE (ai_response-&gt;&gt;'lead_score')::int &gt; 70\nORDER BY (ai_response-&gt;&gt;'lead_score')::int DESC;\n\n-- Analyze enrichment by company\nSELECT \n  data-&gt;&gt;'company' as company,\n  COUNT(*) as contact_count,\n  AVG((ai_response-&gt;&gt;'lead_score')::int) as avg_score\nFROM workflow_logs\nWHERE workflow_name = 'AI Contact Enrichment'\n  AND ai_response-&gt;&gt;'lead_score' IS NOT NULL\nGROUP BY data-&gt;&gt;'company'\nORDER BY contact_count DESC;\n\n-- Find contacts needing follow-up\nSELECT \n  email,\n  name,\n  ai_response-&gt;&gt;'engagement_strategy' as strategy,\n  created_at\nFROM enriched_contacts\nWHERE created_at &gt; NOW() - INTERVAL '7 days'\nORDER BY created_at DESC;\n```\n\n### Export Enriched Data\n\n```sql\n-- Export to CSV\nCOPY (\n  SELECT \n    data-&gt;&gt;'email' as email,\n    data-&gt;&gt;'name' as name,\n    data-&gt;&gt;'company' as company,\n    ai_response-&gt;&gt;'job_title' as enriched_title,\n    ai_response-&gt;&gt;'seniority' as seniority,\n    ai_response-&gt;&gt;'lead_score' as score\n  FROM workflow_logs\n  WHERE workflow_name = 'AI Contact Enrichment'\n) TO '/tmp/enriched_contacts.csv' WITH CSV HEADER;\n```\n\n---\n\n## üìà Integration Ideas\n\n### Form Integration\nAutomatically enrich new leads from forms:\n- **Typeform**: Trigger on form submission\n- **Google Forms**: Use Google Sheets trigger\n- **Calendly**: Enrich after meeting booking\n- **Webflow Forms**: Webhook trigger from form\n\n### CRM Integration\nReal-time enrichment as contacts enter CRM:\n- **Salesforce**: Trigger on new lead/contact creation\n- **HubSpot**: Enrich on form submission or import\n- **Pipedrive**: Auto-enrich new persons\n- **Close**: Webhook on lead creation\n\n### Email Tools\nEnhance cold outreach campaigns:\n- **Instantly.ai**: Enrich before campaign launch\n- **Lemlist**: Generate personalization variables\n- **Apollo.io**: Supplement with AI insights\n- **Mailshake**: Enrich prospect lists\n\n### Marketing Automation\nPower ABM and segmentation:\n- **Marketo**: Enrich leads for scoring\n- **Pardot**: Enhance prospect profiles\n- **ActiveCampaign**: Personalization data\n- **Klaviyo**: E-commerce customer insights\n\n### Slack Integration\nTeam notifications and collaboration:\n- Send enrichment summaries to sales channel\n- Notify reps of high-value leads\n- Share persona insights with marketing\n- Alert on key account contacts\n\n---\n\n## üîí Security & Compliance Best Practices\n\n### Data Protection\n1. **Encrypt Sensitive Data**: Use environment variables for all credentials\n2. **Access Control**: Limit webhook access with authentication\n3. **Data Retention**: Set automatic deletion policies in Supabase\n4. **Audit Logging**: Track all enrichment activities\n\n### Privacy Compliance\n1. **GDPR Compliance**: \n   - Get consent before enriching personal data\n   - Allow contacts to request data deletion\n   - Document legal basis for processing\n2. **CCPA Compliance**: Honor do-not-sell requests\n3. **Data Minimization**: Only enrich necessary fields\n4. **Right to Access**: Allow contacts to view enriched data\n\n### AI Ethics\n1. **Bias Awareness**: Review AI inferences for bias\n2. **Accuracy Validation**: Verify critical information\n3. **Transparency**: Disclose use of AI enrichment\n4. **Human Oversight**: Review before critical decisions\n\n---\n\n## üí° Best Practices\n\n### Input Data Quality\n- **Always include email or full name** as anchor point\n- **Add LinkedIn URLs** for 50% better accuracy\n- **Provide company name** for firmographic insights\n- **Include any known details** - more data = better results\n\n### Prompt Engineering\n- **Be specific** about your ideal customer profile (ICP)\n- **Request structured output** (JSON format)\n- **Define scoring criteria** that match your business\n- **Ask for actionable insights** not just descriptions\n\n### Post-Enrichment Workflow\n- **Always validate** critical information before use\n- **Review AI inferences** for accuracy and bias\n- **Update CRM promptly** to maintain data freshness\n- **Track enrichment ROI** (conversion rates, time saved)\n\n### Performance Optimization\n- **Batch process** during off-peak hours\n- **Use appropriate models** (gpt-3.5 for speed, gpt-4 for quality)\n- **Cache common enrichments** to reduce API costs\n- **Set rate limits** to avoid API throttling\n\n---\n\n## üè∑Ô∏è Tags\n`sales-automation`, `lead-enrichment`, `ai-automation`, `crm-integration`, `data-enrichment`, `contact-intelligence`, `buyer-personas`, `lead-scoring`, `webhook`, `supabase`, `openai`, `anthropic`, `b2b-sales`\n\n---\n\n## üìù License\nThis workflow template is provided as-is for use with n8n.\n\n## ü§ù Support\nFor questions or issues:\n- n8n Community Forum: https://community.n8n.io\n- n8n Documentation: https://docs.n8n.io\n\n## üåü Example Output\n\n**Input:**\n```json\n{\n  \"email\": \"mike.johnson@cloudtech.com\",\n  \"name\": \"Mike Johnson\",\n  \"company\": \"CloudTech Solutions\",\n  \"job_title\": \"Director of IT\"\n}\n```\n\n**AI-Generated Enrichment:**\n```json\n{\n  \"full_title\": \"Director of Information Technology\",\n  \"seniority\": \"Director\",\n  \"department\": \"Technology/IT\",\n  \"experience_years\": \"10-15\",\n  \"company_insights\": {\n    \"industry\": \"Cloud Computing\",\n    \"size\": \"Mid-Market (100-500)\",\n    \"revenue_estimate\": \"$10M-$50M\"\n  },\n  \"buyer_persona\": {\n    \"responsibilities\": [\"Infrastructure management\", \"Vendor selection\", \"Security oversight\"],\n    \"pain_points\": [\"Legacy system migration\", \"Cost optimization\", \"Security compliance\"],\n    \"priorities\": [\"Scalability\", \"Cost reduction\", \"Team efficiency\"]\n  },\n  \"engagement_strategy\": {\n    \"best_channels\": [\"Email\", \"LinkedIn\"],\n    \"timing\": \"Tuesday-Thursday, 9-11 AM\",\n    \"talking_points\": [\"ROI and cost savings\", \"Security features\", \"Ease of implementation\"],\n    \"personalization\": \"Reference cloud migration challenges\"\n  },\n  \"lead_score\": 75\n}\n```\n\n---\n\n## üîÑ Version History\n- **v1.0.0** (2025-01-14): Initial release with universal AI provider support",
  "featuredImage": "/data/workflows/9699/9699.webp",
  "author": {
    "id": 101,
    "slug": "SheCodesFlow",
    "name": "Shelly-Ann Davy",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "AI RAG"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 38,
  "downloads": 3,
  "createdAt": "2025-10-15T10:50:20.116Z",
  "updatedAt": "2026-01-16T09:01:33.050Z",
  "publishedAt": "2025-10-15T10:50:20.116Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9699"
}