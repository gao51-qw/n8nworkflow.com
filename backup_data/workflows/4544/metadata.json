{
  "id": 4544,
  "slug": "4544",
  "title": "Create Dynamic Workflows Programmatically via Webhooks & n8n API",
  "description": "## Overview\n\nThis workflow exposes an HTTP endpoint (webhook) that accepts a JSON definition of an n8n workflow, validates it, and—if everything is correct—dynamically creates that workflow in the n8n instance via its internal API. If any validation fails or the API call encounters an error, an explanatory message with details is returned.\n\n## Workflow Diagram\n\n```text\nWebhook\n   │\n   ▼\nValidate JSON ── fails validation ──► Validation Error\n   │\n   └─ passes ─► Validation Successful?\n                           │\n                           ├─ true ─► Create Workflow ──► API Successful? ──► Success Response\n                           │                                 │\n                           │                                 └─ false ─► API Error\n                           └─ false ─► Validation Error\n```\n\n## Step-by-Step Details\n\n### 1. Webhook\n\n* **Type**: Webhook (POST)\n* **Path**: `/webhook/create-workflow`\n* **Purpose**: Expose a URL to receive a JSON definition of a workflow.\n* **Expected Input**: JSON containing the main workflow fields (`name`, `nodes`, `connections`, `settings`).\n\n### 2. Validate JSON\n\n* **Type**: Code Node (JavaScript)\n* **Validations Performed**:\n\n  * Ensure that `payload` exists and contains both `name` and `nodes`.\n  * Verify that `nodes` is an array with at least one item.\n  * Check that each node includes the required fields: `id`, `name`, `type`, `position`.\n  * If missing, initialize `connections`, `settings`, `parameters`, and `typeVersion`.\n* **Output if Error**:\n\n  ```json\n  { \"success\": false, \"message\": \"&lt;error description&gt;\" }\n  ```\n* **Output if Valid**:\n\n  ```json\n  {\n    \"success\": true,\n    \"apiWorkflow\": {\n      \"name\": payload.name,\n      \"nodes\": payload.nodes,\n      \"connections\": payload.connections,\n      \"settings\": payload.settings\n    }\n  }\n  ```\n\n### 3. Validation Successful?\n\n* **Type**: IF Node\n* **Condition**: `$json.success === true`\n* **Branches**:\n\n  * **true**: proceed to **Create Workflow**\n  * **false**: route to **Validation Error**\n\n### 4. Create Workflow\n\n* **Type**: HTTP Request (POST)\n* **URL**: `http://127.0.0.1:5678/api/v1/workflows`\n* **Authentication**: Header Auth with internal credentials\n* **Body**: The `apiWorkflow` object generated earlier\n* **Options**: `continueOnFail: true` (to handle failures in the next IF)\n\n### 5. API Successful?\n\n* **Type**: IF Node\n* **Condition**: `$response.statusCode &lt;= 299`\n* **Branches**:\n\n  * **true**: proceed to **Success Response**\n  * **false**: route to **API Error**\n\n### 6. Success Response\n\n* **Type**: SET Node\n* **Output**:\n\n  ```json\n  {\n    \"success\": \"true\",\n    \"message\": \"Workflow created successfully\",\n    \"workflowId\": \"{{ $json.data[0].id }}\",\n    \"workflowName\": \"{{ $json.data[0].name }}\",\n    \"createdAt\": \"{{ $json.data[0].createdAt }}\",\n    \"url\": \"http://localhost:5678/workflow/{{ $json.data[0].id }}\"\n  }\n  ```\n\n### 7. API Error\n\n* **Type**: SET Node\n* **Output**:\n\n  ```json\n  {\n    \"success\": \"false\",\n    \"message\": \"Error creating workflow\",\n    \"error\": \"{{ JSON.stringify($json) }}\",\n    \"statusCode\": \"{{ $response.statusCode }}\"\n  }\n  ```\n\n### 8. Validation Error\n\n* **Type**: SET Node\n* **Output**:\n\n  ```json\n  { \"success\": false, \"message\": \"{{ $json.message }}\" }\n  ```\n\n## Example Webhook Request\n\n```bash\ncurl --location --request POST 'http://localhost:5678/webhook/create-workflow' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\n  \"name\": \"My Dynamic Workflow\",\n  \"nodes\": [\n    {\n      \"id\": \"start-node\",\n      \"name\": \"Start\",\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"typeVersion\": 1,\n      \"position\": [100, 100],\n      \"parameters\": {}\n    },\n    {\n      \"id\": \"set-node\",\n      \"name\": \"Set\",\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 1,\n      \"position\": [300, 100],\n      \"parameters\": {\n        \"values\": {\n          \"string\": [\n            { \"name\": \"message\", \"value\": \"Hello from a webhook-created workflow!\" }\n          ]\n        }\n      }\n    }\n  ],\n  \"connections\": {\n    \"Start\": {\n      \"main\": [\n        [ { \"node\": \"Set\", \"type\": \"main\", \"index\": 0 } ]\n      ]\n    }\n  },\n  \"settings\": {}\n}'\n```\n\n### Expected Success Response\n\n```json\n{\n  \"success\": \"true\",\n  \"message\": \"Workflow created successfully\",\n  \"workflowId\": \"abcdef1234567890\",\n  \"workflowName\": \"My Dynamic Workflow\",\n  \"createdAt\": \"2025-05-31T12:34:56.789Z\",\n  \"url\": \"http://localhost:5678/workflow/abcdef1234567890\"\n}\n```\n\n### Validation Error Response\n\n```json\n{\n  \"success\": false,\n  \"message\": \"The 'name' field is required in the workflow\"\n}\n```\n\n### API Error Response\n\n```json\n{\n  \"success\": \"false\",\n  \"message\": \"Error creating workflow\",\n  \"error\": \"{ ...full API response details... }\",\n  \"statusCode\": 401\n}\n```\n",
  "featuredImage": "/data/workflows/4544/4544.webp",
  "author": {
    "id": 101,
    "slug": "rckflr",
    "name": "Mauricio Perera",
    "avatar": ""
  },
  "categories": [
    "DevOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1375,
  "downloads": 137,
  "createdAt": "2025-06-01T01:54:12.908Z",
  "updatedAt": "2026-01-16T08:34:53.344Z",
  "publishedAt": "2025-06-01T01:54:12.908Z",
  "nodes": 11,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4544"
}