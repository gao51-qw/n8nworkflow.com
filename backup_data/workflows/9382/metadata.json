{
  "id": 9382,
  "slug": "9382",
  "title": "Automated Gmail support agent with Gemini 2.5, RAG & Cohere reranking",
  "description": "# AI Email Support Agent with RAG & Cohere Reranking\n\nTransform your inbox into an intelligent support system: automatically detect new emails, retrieve relevant knowledge from Pinecone, rerank with Cohere for precision, generate contextual replies using Gemini AI, and respondâ€”all while maintaining conversation history.\n\n## What It Does\n\nThis workflow triggers on incoming Gmail messages, leverages a LangChain agent with PostgreSQL memory for context, queries a Pinecone vector store (RAG) enhanced by Cohere reranking and OpenAI embeddings, crafts personalized responses via Gemini 2.5, and auto-replies to keep support flowing.\n\n## Key Features\n\n- **Gmail Integration** - Real-time polling for new emails every minute\n- **RAG with Pinecone** - Retrieves top 10 relevant docs from \"agency-info\" index as agent tool\n- **Cohere Reranking** - Boosts retrieval accuracy by reordering results semantically\n- **Persistent Memory** - Postgres chat history keyed by email ID for ongoing threads\n- **Gemini-Powered Agent** - Handles queries with custom system prompt for agency support\n- **Seamless Auto-Reply** - Sends formatted text responses directly in Gmail\n\n## Perfect For\n\n- **Agencies**: Automate client FAQs on services, pricing, and ownership\n- **Support Teams**: Scale responses without losing conversation context\n- **Small Businesses**: Handle inquiries 24/7 with AI-driven accuracy\n- **Developers**: Prototype RAG agents with vector stores and rerankers\n- **Marketers**: Personalize outreach replies based on knowledge base\n- **Consultants**: Quick, informed answers from internal docs\n\n## Technical Highlights\n\nBuilt on n8n's LangChain ecosystem, this workflow highlights:\n- Trigger-to-response pipeline with polling and webhooks\n- Hybrid retrieval: Embeddings + vector search + semantic reranking\n- Stateful agents with database-backed memory for multi-turn chats\n- Multi-provider setup: OpenAI (embeddings), Cohere (rerank), Google (LLM)\n- Scalable for production with configurable topK and session keys\n\n## Setup Instructions\n\n### Prerequisites\n- n8n instance with LangChain nodes enabled\n- Accounts for: Gmail (OAuth2), OpenAI (API key), Cohere (API key), Google Gemini (API key), Pinecone (API key and index), Postgres (database connection, e.g., Neon or Supabase)\n\n### Required Credentials\n#### Gmail OAuth2\n1. Enable Gmail API in Google Cloud Console\n2. Create OAuth2 credential in n8n with scopes: `https://www.googleapis.com/auth/gmail.readonly`, `https://www.googleapis.com/auth/gmail.send`\n\n#### OpenAI API\n1. Get API key from platform.openai.com\n2. Add as OpenAI credential in n8n\n\n#### Cohere API\n1. Sign up at cohere.com\n2. Copy API key to n8n Cohere credential\n\n#### Google Gemini API\n1. Generate key at https://aistudio.google.com/\n2. Add as Google PaLM credential in n8n (compatible with Gemini)\n\n#### Pinecone API\n1. Create index \"agency-info\" with dimension 1024\n2. Add API key to n8n Pinecone credential\n\n#### Postgres\n1. Set up database (e.g., Neon/Supabase) with a table for chat history\n2. Add connection details (host, database, user, password) to n8n Postgres credential\n\n### Configuration Steps\n1. Import the workflow JSON into your n8n instance\n2. Assign all required credentials to the respective nodes\n3. Populate the Pinecone \"agency-info\" index with your knowledge base documents (use a separate upsert workflow or Pinecone dashboard)\n4. Customize the `tableName` in the Postgres Memory node if needed (default: \"email_support_agent_\")\n5. Adjust the agent's system prompt or topK retrieval if required for your use case\n6. Activate the workflow and test by sending a sample email to trigger it\n\n## Troubleshooting\n- **No trigger firing**: Verify Gmail scopes and polling interval\n- **Empty retrieval**: Check Pinecone index population, dimensions (must be 1024), and document embeddings\n- **Rerank errors**: Ensure Cohere API key is valid and has sufficient quota\n- **Memory issues**: Confirm Postgres connection and that `sessionKey` uses email ID\n\nPerfect for deploying hands-off email automation. Import, connect credentials, and activate!",
  "featuredImage": "/data/workflows/9382/9382.webp",
  "author": {
    "id": 101,
    "slug": "daniel-automates",
    "name": "Daniel Nkencho",
    "avatar": ""
  },
  "categories": [
    "Support Chatbot",
    "AI RAG"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 210,
  "downloads": 21,
  "createdAt": "2025-10-08T16:56:58.421Z",
  "updatedAt": "2026-01-16T09:00:14.873Z",
  "publishedAt": "2025-10-08T16:56:58.421Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9382"
}