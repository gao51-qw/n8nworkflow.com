{
  "id": 10602,
  "slug": "10602",
  "title": "Automatic Microsoft Outlook attachment storage to OneDrive with Excel logging",
  "description": "# üì• Save Email Attachments to OneDrive & Log Them in Excel\n\nThis workflow watches your Outlook inbox, automatically downloads file attachments (for example invoices), saves them into a specific OneDrive folder, and logs each file name into an Excel table. Optionally, it also posts a Microsoft Teams message to let you know that a new attachment has been processed.\n\n---\n\n## ‚ú® What this workflow does\n\n- Monitors a Microsoft Outlook mailbox for new emails.\n- Fetches **all attachments** from each incoming message.\n- Processes attachments one by one so every file is handled cleanly.\n- Downloads each attachment as binary data.\n- Uploads the file into a OneDrive folder (looked up by name).\n- Appends a new row with the filename to an Excel table for tracking.\n- Sends a Teams chat notification once an attachment has been uploaded (optional).\n\n---\n\n## üßë‚Äçüíº Who this is for\n\nThis workflow is ideal for:\n\n- Finance / accounting teams who receive invoices by email and want them stored centrally.\n- Anyone who wants an **‚Äúemail ‚Üí OneDrive ‚Üí Excel log‚Äù** pipeline without manual downloading and renaming.\n- n8n users who work in a Microsoft 365 environment (Outlook, OneDrive, Excel, Teams).\n\n---\n\n## ‚úÖ Requirements\n\nBefore you run the workflow, you‚Äôll need:\n\n- A **Microsoft Outlook** account with permissions to read emails and attachments.\n- A **OneDrive / SharePoint** drive with a target folder (the example uses a folder whose name matches the search in the `Get Folder ID` node, e.g. `Testn8n`).\n- An **Excel workbook** stored in OneDrive with:\n  - A worksheet and table already created.\n  - A column named `Filename` (or adjust the `Set Filename` + Excel node to match your column name).\n- n8n credentials set up for:\n  - Microsoft Outlook\n  - Microsoft OneDrive\n  - Microsoft Excel\n  - Microsoft Teams (optional but used in this template)\n\n---\n\n## üõ†Ô∏è Setup steps\n\n1. **Import the workflow JSON** into your n8n instance.\n2. **Configure credentials**:\n   - Set your Outlook, OneDrive, Excel, and Teams credentials on the respective nodes.\n3. **Adjust the mail trigger** (`On Mail Received`):\n   - Optionally add filters (subject, sender, folder) if you only want to process invoices or a specific mailbox/folder.\n4. **Set the OneDrive folder search** (`Get Folder ID`):\n   - Update the `query` parameter to the exact name of the folder where attachments should be stored.\n5. **Point the Excel node to your workbook** (`Append to Excel Log`):\n   - Use the dropdowns to select your workbook, worksheet and table.\n   - Ensure there‚Äôs a `Filename` column (or rename the field in `Set Filename` to match your actual column).\n6. **Activate the workflow**:\n   - Once active, every new email that hits the trigger will have its attachments stored in OneDrive and logged in Excel.\n\n---\n\n## üîó Integrations used\n\n- **Microsoft Outlook** ‚Äì trigger on incoming emails and download attachments.\n- **Microsoft OneDrive** ‚Äì search for folders and upload files.\n- **Microsoft Excel** ‚Äì append rows to a table in a workbook.\n- **Microsoft Teams** ‚Äì send notifications when attachments are processed.\n",
  "featuredImage": "/data/workflows/10602/10602.webp",
  "author": {
    "id": 101,
    "slug": "plemeo",
    "name": "plemeo",
    "avatar": ""
  },
  "categories": [
    "File Management"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 160,
  "downloads": 16,
  "createdAt": "2025-11-07T15:54:14.146Z",
  "updatedAt": "2026-01-16T09:05:39.829Z",
  "publishedAt": "2025-11-07T15:54:14.146Z",
  "nodes": 14,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10602"
}