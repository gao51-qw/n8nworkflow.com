{
  "id": 4749,
  "slug": "4749",
  "title": "Payment processing and order tracking with YooKassa and Google Sheets",
  "description": "# Accept YooKassa payments and log transactions in Google Sheets\n\n## üßæ Summary\n\nThis workflow allows you to accept online payments via **YooKassa** and log both orders and transactions in **Google Sheets** ‚Äî all without writing a single line of code. It supports full payment flow: product selection, payment initiation, webhook processing, refund updates, and payment status checks.\n\n---\n\n## üë• Who is this for?\n\nThis template is ideal for:\n\n* Online stores with simple checkout flows\n* Sellers of digital products or info-courses\n* Entrepreneurs using Telegram bots or web forms\n* Anyone needing quick payment integration with Google Sheets tracking\n\n---\n\n## üéØ What problem does this workflow solve?\n\nSetting up online payments usually requires backend infrastructure. This no-code solution automates the entire payment flow:\n\n* Handles product listing and price retrieval\n* Initiates payments with email and return URL\n* Listens for `payment.succeeded` and `refund.succeeded` events\n* Records every action into structured Google Sheets\n\n---\n\n## ‚öôÔ∏è What this workflow does\n\n### 1. **GET /products**\n\nReturns a sorted list of products from a Google Sheet (`products`).\n\n### 2. **POST /payment**\n\n* Validates required fields (`product_id`, `email`, `return_url`)\n* Checks email format\n* Fetches product data from `products`\n* Generates a unique idempotence key\n* Sends a request to YooKassa API\n* Saves the order into the `orders` sheet\n* Returns a payment confirmation link\n\n### 3. **POST /yoomoney**\n\nWebhook to process payment/refund events:\n\n* On `payment.succeeded`, adds entry to `transactions`\n* On `refund.succeeded`, updates transaction status\n\n### 4. **GET /status/\\:id**\n\nReturns real-time payment status from YooKassa\n\n---\n\n## üöÄ Setup\n\n1. **Connect credentials:**\n\n   * Google Sheets (OAuth2)\n   * YooKassa (Basic Auth using `shopId` and `secretKey`)\n\n2. **Update the following Google Sheets:**\n\n   * `products`: should contain `product_id`, `title`, `price`\n   * `orders`: for saving confirmed purchases\n   * `transactions`: for logging all successful or refunded payments\n\n3. **Test endpoints using any HTTP client**:\n\nExample payload for `/payment`:\n\n```json\n{\n  \"product_id\": \"abc123\",\n  \"email\": \"user@example.com\",\n  \"return_url\": \"https://your.site/success\"\n}\n```\n\n---\n\n## üîß How to customize this workflow\n\n* Add delivery logic (e.g., email with product link after successful payment)\n* Replace Google Sheets with a database (e.g., PostgreSQL)\n* Connect Telegram or other messengers for post-payment notifications\n* Add promo codes, discounts, or subscriptions logic\n\n---\n\n## üíº Use cases\n\n* Simple online checkouts\n* Telegram bots selling access\n* Educational product sales\n* MVP e-commerce flows\n* Donation or membership payments\n\n---\n\n## üìé Notes\n\n‚úÖ Includes Sticky Notes for sections\n‚úÖ Includes error handling and validation\n‚úÖ No custom code needed except UUID generation",
  "featuredImage": "/data/workflows/4749/4749.webp",
  "author": {
    "id": 101,
    "slug": "cepreusa",
    "name": "Sergey Skorobogatov",
    "avatar": ""
  },
  "categories": [
    "CRM"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 903,
  "downloads": 90,
  "createdAt": "2025-06-06T22:41:32.579Z",
  "updatedAt": "2026-01-16T08:35:59.512Z",
  "publishedAt": "2025-06-06T22:41:32.579Z",
  "nodes": 44,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4749"
}