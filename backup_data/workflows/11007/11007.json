{
  "workflow": {
    "id": 11007,
    "name": "Network vulnerability scanner with NMAP and automated CVE reporting",
    "views": 1295,
    "recentViews": 5,
    "totalViews": 1295,
    "createdAt": "2025-11-19T10:47:46.993Z",
    "description": "# Network Vulnerability Scanner (used NMAP as engine) with Automated CVE Report\n\n## Workflow Overview\n\nThis n8n workflow provides comprehensive network vulnerability scanning with automated CVE enrichment and professional report generation. It performs Nmap scans, queries the National Vulnerability Database (NVD) for CVE information, generates detailed HTML/PDF reports, and distributes them via Telegram and email.\n\n### Key Features\n\n- **Automated Network Scanning**: Full Nmap service and version detection scan\n- **CVE Enrichment**: Automatic vulnerability lookup using NVD API\n- **CVSS Scoring**: Vulnerability severity assessment with CVSS v3.1/v3.0 scores\n- **Professional Reporting**: HTML reports with detailed findings and recommendations\n- **PDF Generation**: Password-protected PDF reports using Prince XML\n- **Multi-Channel Distribution**: Telegram and email delivery\n- **Multiple Triggers**: Webhook API, web form, manual execution, scheduled scans\n- **Rate Limiting**: Respects NVD API rate limits\n- **Comprehensive Data**: Service detection, CPE matching, CVE details with references\n\n### Use Cases\n\n- Regular security audits of network infrastructure\n- Compliance scanning for vulnerability management\n- Penetration testing reconnaissance phase\n- Asset inventory with vulnerability context\n- Continuous security monitoring\n- Vulnerability assessment reporting for management\n- DevSecOps integration for infrastructure testing\n\n---\n\n## Setup Instructions\n\n### Prerequisites\n\nBefore setting up this workflow, ensure you have:\n\n#### System Requirements\n- n8n instance (self-hosted) with command execution capability\n- Alpine Linux base image (or compatible Linux distribution)\n- Minimum 2 GB RAM (4 GB recommended for large scans)\n- 2 GB free disk space for dependencies\n- Network access to scan targets\n- Internet connectivity for NVD API\n\n#### Required Knowledge\n- Basic networking concepts (IP addresses, ports, protocols)\n- Understanding of CVE/CVSS vulnerability scoring\n- Nmap scanning basics\n\n#### External Services\n- Telegram Bot (optional, for Telegram notifications)\n- Email server / SMTP credentials (optional, for email reports)\n- NVD API access (public, no API key required but rate-limited)\n\n### Step 1: Understanding the Workflow Components\n\n#### Core Dependencies\n\n**Nmap**: Network scanner\n- Purpose: Port scanning, service detection, version identification\n- Usage: Performs TCP SYN scan with service/version detection\n\n**nmap-helper**: JSON conversion tool\n- Repository: https://github.com/net-shaper/nmap-helper\n- Purpose: Converts Nmap XML output to JSON format\n\n**Prince XML**: HTML to PDF converter\n- Website: https://www.princexml.com\n- Version: 16.1 (Alpine 3.20)\n- Purpose: Generates professional PDF reports from HTML\n- Features: Password protection, print-optimized formatting\n\n**NVD API**: Vulnerability database\n- Endpoint: https://services.nvd.nist.gov/rest/json/cves/2.0\n- Purpose: CVE information, CVSS scores, vulnerability descriptions\n- Rate Limit: Public API allows limited requests per minute\n- Documentation: https://nvd.nist.gov/developers\n\n### Step 2: Telegram Bot Configuration (Optional)\n\nIf you want to receive reports via Telegram:\n\n#### Create Telegram Bot\n\n1. Open Telegram and search for **@BotFather**\n2. Start a chat and send `/newbot`\n3. Follow prompts:\n   - **Bot name**: Network Scanner Bot (or your choice)\n   - **Username**: network_scanner_bot (must end with 'bot')\n4. BotFather will provide:\n   - **Bot token**: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz` (save this)\n   - Bot URL: `https://t.me/your_bot_username`\n\n#### Get Your Chat ID\n\n1. Start a chat with your new bot\n2. Send any message to the bot\n3. Visit: `https://api.telegram.org/bot&lt;YOUR_BOT_TOKEN&gt;/getUpdates`\n4. Find your chat ID in the response\n5. Save this chat ID (e.g., `123456789`)\n\n#### Alternative: Group Chat ID\n\nFor sending to a group:\n1. Add bot to your group\n2. Send a message in the group\n3. Check getUpdates URL\n4. Group chat IDs are negative: `-1001234567890`\n\n#### Add Credentials to n8n\n\n1. Navigate to **Credentials** in n8n\n2. Click **Add Credential**\n3. Select **Telegram API**\n4. Fill in:\n   - **Access Token**: Your bot token from BotFather\n5. Click **Save**\n6. Test connection if available\n\n### Step 3: Email Configuration (Optional)\n\nIf you want to receive reports via email:\n\n#### Add SMTP Credentials to n8n\n\n1. Navigate to **Credentials** in n8n\n2. Click **Add Credential**\n3. Select **SMTP**\n4. Fill in:\n   - **Host**: SMTP server address (e.g., `smtp.gmail.com`)\n   - **Port**: SMTP port (587 for TLS, 465 for SSL, 25 for unencrypted)\n   - **User**: Your email username\n   - **Password**: Your email password or app password\n   - **Secure**: Enable for TLS/SSL\n5. Click **Save**\n\n**Gmail Users:**\n1. Enable 2-factor authentication\n2. Generate app-specific password: https://myaccount.google.com/apppasswords\n3. Use app password in n8n credential\n\n### Step 4: Import and Configure Workflow\n\n#### Configure Basic Parameters\n\n**Locate \"1. Set Parameters\" Node:**\n1. Click the node to open settings\n2. Default configuration:\n   - `network`: Input from webhook/form/manual trigger\n   - `timestamp`: Auto-generated (format: yyyyMMdd_HHmmss)\n   - `report_password`: `Almafa123456` (change this!)\n\n**Change Report Password:**\n1. Edit `report_password` assignment\n2. Set strong password: 12+ characters, mixed case, numbers, symbols\n3. This password will protect the PDF report\n4. Save changes\n\n### Step 5: Configure Notification Endpoints\n\n#### Telegram Configuration\n\n**Locate \"14/a. Send Report in Telegram\" Node:**\n\n1. Open node settings\n2. Update fields:\n   - **Chat ID**: Replace `-123456789012` with your actual chat ID\n   - **Credentials**: Select your Telegram credential\n3. Save changes\n\n**Message customization:**\n- Current: Sends PDF as document attachment\n- Automatic filename: `vulnerability_report_&lt;timestamp&gt;.pdf`\n- No caption by default (add if needed)\n\n#### Email Configuration\n\n**Locate \"14/b. Send Report in Email with SMTP\" Node:**\n\n1. Open node settings\n2. Update fields:\n   - **From Email**: `report.creator@example.com` → Your sender email\n   - **To Email**: `report.receiver@example.com` → Your recipient email\n   - **Subject**: Customize if needed (default includes network target)\n   - **Text**: Email body message\n   - **Credentials**: Select your SMTP credential\n3. Save changes\n\n**Multiple Recipients:**\nChange `toEmail` field to comma-separated list:\n```\nadmin@example.com, security@example.com, manager@example.com\n```\n\n**Add CC/BCC:**\nIn node options, add:\n- `cc`: Carbon copy recipients\n- `bcc`: Blind carbon copy recipients\n\n### Step 6: Configure Triggers\n\nThe workflow supports 4 trigger methods:\n\n#### Trigger 1: Webhook API (Production)\n\n**Locate \"Webhook\" Node:**\n- Path: `/vuln-scan`\n- Method: POST\n- Response: Immediate acknowledgment \"Process started!\"\n- Async: Scan runs in background\n\n#### Trigger 2: Web Form (User-Friendly)\n\n**Locate \"On form submission\" Node:**\n- Path: `/webhook-test/form/target`\n- Method: GET (form display), POST (form submit)\n- Form Title: \"Add scan parameters\"\n- Field: `network` (required)\n\n**Form URL:**\n```\nhttps://your-n8n-domain.com/webhook-test/form/target\n```\n\nUsers can:\n1. Open form URL in browser\n2. Enter target network/IP\n3. Click submit\n4. Receive confirmation\n\n#### Trigger 3: Manual Execution (Testing)\n\n**Locate \"Manual Trigger\" Node:**\n- Click to activate\n- Opens workflow with \"Pre-Set-Target\" node\n- Default target: `scanme.nmap.org` (Nmap's official test server)\n\n**To change default target:**\n1. Open \"Pre-Set-Target\" node\n2. Edit `network` value\n3. Enter your test target\n4. Save changes\n\n#### Trigger 4: Scheduled Scans (Automated)\n\n**Locate \"Schedule Trigger\" Node:**\n- Default: Daily at 1:00 AM\n- Uses \"Pre-Set-Target\" for network\n\n**To change schedule:**\n1. Open node settings\n2. Modify trigger time:\n   - **Hour**: 1 (1 AM)\n   - **Minute**: 0\n   - **Day of week**: All days (or select specific days)\n3. Save changes\n\n**Schedule Examples:**\n- Every day at 3 AM: Hour: 3, Minute: 0\n- Weekly on Monday at 2 AM: Hour: 2, Day: Monday\n- Twice daily (8 AM, 8 PM): Create two Schedule Trigger nodes\n\n### Step 7: Test the Workflow\n\n#### Recommended Test Target\n\nUse Nmap's official test server for initial testing:\n- **Target**: `scanme.nmap.org`\n- **Purpose**: Official Nmap testing server\n- **Safe**: Designed for scanning practice\n- **Permissions**: Public permission to scan\n\n**Important:** Never scan targets without permission. Unauthorized scanning is illegal.\n\n#### Manual Test Execution\n\n1. Open workflow in n8n editor\n2. Click **Manual Trigger** node to select it\n3. Click **Execute Workflow** button\n4. Workflow will start with `scanme.nmap.org` as target\n\n#### Monitor Execution\n\nWatch nodes turn green as they complete:\n1. **Need to Add Helper?**: Checks if nmap-helper installed\n2. **Add NMAP-HELPER**: Installs helper (if needed, ~2-3 minutes)\n3. **Optional Params Setter**: Sets scan parameters\n4. **2. Execute Nmap Scan**: Runs scan (5-30 minutes depending on target)\n5. **3. Parse NMAP JSON to Services**: Extracts services (~1 second)\n6. **5. CVE Enrichment Loop**: Queries NVD API (1 second per service)\n7. **8-10. Report Generation**: Creates HTML/PDF reports (~5-10 seconds)\n8. **12. Convert to PDF**: Generates password-protected PDF (~10 seconds)\n9. **14a/14b. Distribution**: Sends reports\n\n#### Check Outputs\n\nClick nodes to view outputs:\n- **3. Parse NMAP JSON**: View discovered services\n- **5. CVE Enrichment**: See vulnerabilities found\n- **8. Prepare Report Structure**: Check statistics\n- **13. Read Report PDF**: Download report to verify\n\n#### Verify Distribution\n\n**Telegram:**\n- Open Telegram chat with your bot\n- Check for PDF document\n- Download and open with password\n\n**Email:**\n- Check inbox for report email\n- Verify subject line includes target network\n- Download PDF attachment\n- Open with password\n\n---\n\n## How to Use\n\n### Understanding the Scan Process\n\n### Initiating Scans\n\n#### Method 1: Webhook API\n\nUse curl or any HTTP client and add \"network\" parameter in a POST request.\n\n**Response:**\n```\nProcess started!\n```\n\nScan runs asynchronously. You'll receive results via configured channels (Telegram/Email).\n\n#### Method 2: Web Form\n\n1. Open form URL in browser:\n   ```\n   https://your-n8n.com/webhook-test/form/target\n   ```\n\n2. Fill in form:\n   - **network**: Enter target (IP, range, domain)\n\n3. Click **Submit**\n\n4. Receive confirmation\n\n5. Wait for report delivery\n\n**Advantages:**\n- No command line needed\n- User-friendly interface\n- Input validation\n- Good for non-technical users\n\n#### Method 3: Manual Execution\n\nFor testing or one-off scans:\n\n1. Open workflow in n8n\n2. Edit \"Pre-Set-Target\" node:\n   - Change `network` value to your target\n3. Click **Manual Trigger** node\n4. Click **Execute Workflow**\n5. Monitor progress in real-time\n\n**Advantages:**\n- See execution in real-time\n- Debug issues immediately\n- Test configuration changes\n- View intermediate outputs\n\n#### Method 4: Scheduled Scans\n\nFor regular, automated security audits:\n\n1. Configure \"Schedule Trigger\" node with desired time\n2. Configure \"Pre-Set-Target\" node with default target\n3. Activate workflow\n4. Scans run automatically on schedule\n\n**Advantages:**\n- Automated security monitoring\n- Regular compliance scans\n- No manual intervention needed\n- Consistent scheduling\n\n### Scan Targets Explained\n\n#### Supported Target Formats\n\n**Single IP Address:**\n```\n192.168.1.100\n10.0.0.50\n```\n\n**CIDR Notation (Subnet):**\n```\n192.168.1.0/24         # Scans 192.168.1.0-255 (254 hosts)\n10.0.0.0/16            # Scans 10.0.0.0-255.255 (65534 hosts)\n172.16.0.0/12          # Scans entire 172.16-31.x.x range\n```\n\n**IP Range:**\n```\n192.168.1.1-50         # Scans 192.168.1.1 to 192.168.1.50\n10.0.0.1-10.0.0.100    # Scans across range\n```\n\n**Multiple Targets:**\n```\n192.168.1.1,192.168.1.2,192.168.1.3\n```\n\n**Hostname/Domain:**\n```\nscanme.nmap.org\nexample.com\nserver.local\n```\n\n#### Choosing Appropriate Targets\n\n**Development/Testing:**\n- Use `scanme.nmap.org` (official test target)\n- Use your own isolated lab network\n- Never scan public internet without permission\n\n**Internal Networks:**\n- Use CIDR notation for entire subnets\n- Scan DMZ networks separately from internal\n- Consider network segmentation in scan design\n\n### Understanding Report Contents\n\n#### Report Structure\n\nThe generated report includes:\n\n**1. Executive Summary:**\n- Total hosts discovered\n- Total services identified\n- Total vulnerabilities found\n- Severity breakdown (Critical, High, Medium, Low, Info)\n- Scan date and time\n- Target network\n\n**2. Overall Statistics:**\n- Visual dashboard with key metrics\n- Severity distribution chart\n- Quick risk assessment\n\n**3. Detailed Findings by Host:**\nFor each discovered host:\n- IP address\n- Hostname (if resolved)\n- List of open ports and services\n- Service details:\n  - Port number and protocol\n  - Service name (e.g., http, ssh, mysql)\n  - Product (e.g., Apache, OpenSSH, MySQL)\n  - Version (e.g., 2.4.41, 8.2p1, 5.7.33)\n  - CPE identifier\n\n**4. Vulnerability Details:**\nFor each vulnerable service:\n- **CVE ID**: Unique vulnerability identifier (e.g., CVE-2021-44228)\n- **Severity**: CRITICAL / HIGH / MEDIUM / LOW / INFO\n- **CVSS Score**: Numerical score (0.0-10.0)\n- **Published Date**: When vulnerability was disclosed\n- **Description**: Detailed vulnerability explanation\n- **References**: Links to advisories, patches, exploits\n\n**5. Recommendations:**\n- Immediate actions (patch critical/high severity)\n- Long-term improvements (security processes)\n- Best practices\n\n#### Vulnerability Severity Levels\n\n**CRITICAL (CVSS 9.0-10.0):**\n- Color: Red\n- Characteristics: Remote code execution, full system compromise\n- Action: Immediate patching required\n- Examples: Log4Shell, EternalBlue, Heartbleed\n\n**HIGH (CVSS 7.0-8.9):**\n- Color: Orange\n- Characteristics: Significant security impact, data exposure\n- Action: Patch within days\n- Examples: SQL injection, privilege escalation, authentication bypass\n\n**MEDIUM (CVSS 4.0-6.9):**\n- Color: Yellow\n- Characteristics: Moderate security impact\n- Action: Patch within weeks\n- Examples: Information disclosure, denial of service, XSS\n\n**LOW (CVSS 0.1-3.9):**\n- Color: Green\n- Characteristics: Minor security impact\n- Action: Patch during regular maintenance\n- Examples: Path disclosure, weak ciphers, verbose error messages\n\n**INFO (CVSS 0.0):**\n- Color: Blue\n- Characteristics: No vulnerability found or informational\n- Action: No action required, awareness only\n- Examples: Service version detected, no known CVEs\n\n#### Understanding CPE\n\n**CPE (Common Platform Enumeration):**\n- Standard naming scheme for IT products\n- Used for CVE lookup in NVD database\n\n**Workflow CPE Handling:**\n- Nmap detects service and version\n- Nmap provides CPE (if in database)\n- Workflow uses CPE to query NVD API\n- NVD returns CVEs associated with that CPE\n- Special case: nginx vendor fixed from `igor_sysoev` to `nginx`\n\n### Working with Reports\n\n#### Accessing HTML Report\n\n**Location:**\n```\n/tmp/vulnerability_report_&lt;timestamp&gt;.html\n```\n\n**Viewing:**\n- Open in web browser directly from n8n\n- Click \"11. Read Report for Output\" node\n- Download HTML file\n- Open locally in any browser\n\n**Advantages:**\n- Interactive (clickable links)\n- Searchable text\n- Easy to edit/customize\n- Smaller file size\n\n#### Accessing PDF Report\n\n**Location:**\n```\n/tmp/vulnerability_report_&lt;timestamp&gt;.pdf\n```\n\n**Password:**\n- Default: `Almafa123456` (configured in \"1. Set Parameters\")\n- Change in workflow before production use\n- Required to open PDF\n\n**Opening PDF:**\n1. Receive PDF via Telegram or Email\n2. Open with PDF reader (Adobe, Foxit, Browser)\n3. Enter password when prompted\n4. View, print, or share\n\n**Advantages:**\n- Professional appearance\n- Print-optimized formatting\n- Password protection\n- Portable (works anywhere)\n- Preserves formatting\n\n#### Report Customization\n\n**Change Report Title:**\n1. Open \"8. Prepare Report Structure\" node\n2. Find `metadata` object\n3. Edit `title` and `subtitle` fields\n\n**Customize Styling:**\n1. Open \"9. Generate HTML Report\" node\n2. Modify CSS in `&lt;style&gt;` section\n3. Change colors, fonts, layout\n\n**Add Company Logo:**\n1. Edit HTML generation code\n2. Add `<img>` tag in header section\n3. Include base64-encoded logo or URL\n\n**Modify Recommendations:**\n1. Open \"9. Generate HTML Report\" node\n2. Find `<h2>Recommendations</h2>` section\n3. Edit recommendation text\n\n### Scanning Ethics and Legality\n\n1. **Authorization is Mandatory:**\n   - Never scan networks without explicit written permission\n   - Unauthorized scanning is illegal in most jurisdictions\n   - Can result in criminal charges and civil liability\n\n2. **Scope Definition:**\n   - Document approved scan scope\n   - Exclude out-of-scope systems\n   - Maintain scan authorization documents\n\n3. **Notification:**\n   - Inform network administrators before scans\n   - Provide scan window and source IPs\n   - Have emergency contact procedures\n\n4. **Safe Targets for Testing:**\n   - `scanme.nmap.org`: Official Nmap test server\n   - Your own isolated lab network\n   - Cloud instances you own\n   - Explicitly authorized environments\n\n### Compliance Considerations\n\n**PCI DSS:**\n- Quarterly internal vulnerability scans required\n- Scan all system components\n- Re-scan after significant changes\n- Document scan results\n\n**HIPAA:**\n- Regular vulnerability assessments required\n- Risk analysis and management\n- Document remediation efforts\n\n**ISO 27001:**\n- Vulnerability management process\n- Regular technical vulnerability scans\n- Document procedures\n\n**NIST Cybersecurity Framework:**\n- Identify vulnerabilities (DE.CM-8)\n- Maintain inventory\n- Implement vulnerability management\n\n---\n\n## License and Credits\n\n**Workflow:**\n- Created for n8n workflow automation\n- Free for personal and commercial use\n- Modify and distribute as needed\n- No warranty provided\n\n**Dependencies:**\n- **Nmap**: GPL v2 - https://nmap.org\n- **nmap-helper**: Open source - https://github.com/net-shaper/nmap-helper\n- **Prince XML**: Commercial license required for production use - https://www.princexml.com\n- **NVD API**: Public API by NIST - https://nvd.nist.gov\n\n**Third-Party Services:**\n- Telegram Bot API: https://core.telegram.org/bots/api\n- SMTP: Standard email protocol\n\n---\n\n## Support\n\nFor Nmap issues:\n- Documentation: https://nmap.org/book/\n- Community: https://seclists.org/nmap-dev/\n\nFor NVD API issues:\n- Status page: https://nvd.nist.gov\n- Contact: https://nvd.nist.gov/general/contact\n\nFor Prince XML issues:\n- Documentation: https://www.princexml.com/doc/\n- Support: https://www.princexml.com/doc/help/\n\n---\n\n## Workflow Metadata\n\n- **External Dependencies**: Nmap, nmap-helper, Prince XML, NVD API\n- **License**: Open for modification and commercial use\n\n---\n\n## Security Disclaimer\n\nThis workflow is provided for legitimate security testing and vulnerability assessment purposes only. Users are solely responsible for ensuring they have proper authorization before scanning any network or system. Unauthorized network scanning is illegal and unethical. The authors assume no liability for misuse of this workflow or any damages resulting from its use. Always obtain written permission before conducting security assessments.",
    "workflow": {
      "meta": {
        "instanceId": "5c7ce220523e8664f49208a8be668a8dc6fab5f747ce4de865fa1309727919f1",
        "templateCredsSetupCompleted": true
      },
      "nodes": [
        {
          "id": "130cf806-eb72-40f6-9bcb-48cbb27ce486",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "position": [
            -640,
            -336
          ],
          "webhookId": "e1e1da83-efe3-4f81-8428-09f31ad3531a",
          "parameters": {
            "path": "e1e1da83-efe3-4f81-8428-09f31ad3531a",
            "options": {
              "responseData": "Process started!"
            },
            "httpMethod": "POST"
          },
          "typeVersion": 2
        },
        {
          "id": "6586f22d-fce5-49e4-ac61-c1da19c62938",
          "name": "Manual Trigger",
          "type": "n8n-nodes-base.manualTrigger",
          "position": [
            -976,
            240
          ],
          "parameters": {},
          "typeVersion": 1
        },
        {
          "id": "5cd295a5-26b1-471b-bdac-0cae05a4ea86",
          "name": "1. Set Parameters",
          "type": "n8n-nodes-base.set",
          "notes": "Configure scan parameters",
          "position": [
            -336,
            -48
          ],
          "parameters": {
            "options": {},
            "assignments": {
              "assignments": [
                {
                  "id": "1",
                  "name": "network",
                  "type": "string",
                  "value": "={{ $json.network }}{{ $json.body.network }}"
                },
                {
                  "id": "2",
                  "name": "timestamp",
                  "type": "string",
                  "value": "={{ $now.format('yyyyMMdd_HHmmss') }}"
                },
                {
                  "id": "0a15fc2e-83fa-4f10-bfc4-5031a2b3381c",
                  "name": "report_password",
                  "type": "string",
                  "value": "Almafa123456"
                }
              ]
            }
          },
          "typeVersion": 3.3
        },
        {
          "id": "2b694d9e-943d-446b-a03b-fbc42b7f8fc4",
          "name": "2. Execute Nmap Scan",
          "type": "n8n-nodes-base.executeCommand",
          "notes": "Run nmap version + script scan",
          "position": [
            352,
            -48
          ],
          "parameters": {
            "command": "=installdependencies=$(apk add util-linux-misc ncurses nmap nmap-scripts)\nrunnmapscan=$(script -q -c \"nmap -sV -sC -p- -sS {{ $json.timing }} {{ $json.setter }}{{ $json.setter }}{{ $json['min-parallelism'] }} {{ $json.setter }}{{ $json.setter }}{{ $json['max-parallelism'] }} {{ $json.setter }}{{ $json.setter }}{{ $json['max-retries'] }} -oX /tmp/nmap_{{ $('1. Set Parameters').item.json.timestamp }}.xml {{ $('1. Set Parameters').item.json.network }}\" /dev/null)\ncorrectxml=$(sed -i 's/type=\"user\"/type=\"USER\"/g' /tmp/nmap_{{ $('1. Set Parameters').item.json.timestamp }}.xml)\nconvertxmltojson=$(\n/tmp/nmap-helper/target/release/nmap-helper convert /tmp/nmap_{{ $('1. Set Parameters').item.json.timestamp }}.xml -o /tmp/nmap_{{ $('1. Set Parameters').item.json.timestamp }}.json)\ntput reset\ncat /tmp/nmap_{{ $('1. Set Parameters').item.json.timestamp }}.json"
          },
          "typeVersion": 1
        },
        {
          "id": "13896a62-80d9-4228-857a-6f81f782157d",
          "name": "4. Save Scan Data to File",
          "type": "n8n-nodes-base.readWriteFile",
          "notes": "Persist parsed scan data",
          "position": [
            912,
            -48
          ],
          "parameters": {
            "options": {},
            "fileName": "=/tmp/scan_data_{{ $('1. Set Parameters').item.json.timestamp }}.json",
            "operation": "write",
            "dataPropertyName": "=data"
          },
          "typeVersion": 1
        },
        {
          "id": "419ce6bb-f96a-4081-b4a8-0f4337650131",
          "name": "5. CVE Enrichment Loop",
          "type": "n8n-nodes-base.code",
          "notes": "Query NVD CVE API for each service with rate limiting",
          "position": [
            1216,
            -48
          ],
          "parameters": {
            "jsCode": "// CVE ENRICHMENT - Query NVD API for each service\nconst services = $input.first().json.services;\nconst enriched = [];\n\nconsole.log('=== CVE ENRICHMENT START ===');\nconsole.log(`Processing ${services.length} services`);\n\nfor (let i = 0; i < services.length; i++) {\n  const service = services[i];\n  const base = {\n    ip: service.ip,\n    port: service.port,\n    protocol: service.protocol,\n    service: service.service,\n    product: service.product,\n    version: service.version,\n    cpe: service.cpe,\n    serviceKey: service.serviceKey\n  };\n\n  // --- OVERRIDE: nginx vendor fix ---\nif (base.product && base.product.toLowerCase() === 'nginx' && base.cpe) {\n  base.cpe = base.cpe.replace('igor_sysoev', 'nginx');\n}\n\n  console.log(`[${i+1}/${services.length}] ${base.ip}:${base.port} ${base.service} ${base.product} ${base.version}`);\n\n  // Check if CPE exists\n  if (!base.cpe || base.cpe === '' || base.cpe === ':') {\n    console.log('  → No CPE, skipping CVE lookup');\n    enriched.push({\n      ...base,\n      cveId: 'N/A',\n      cveSummary: 'No CPE available for vulnerability lookup',\n      cvssScore: 0,\n      severity: 'INFO',\n      publishedDate: 'N/A',\n      references: []\n    });\n    continue;\n  }\n\n  console.log(`  → CPE: ${base.cpe}`);\n\n  try {\n    // Query NVD CVE API\n    const apiUrl = `https://services.nvd.nist.gov/rest/json/cves/2.0?cpeName=${encodeURIComponent(base.cpe)}&resultsPerPage=10&isVulnerable`;\n    console.log('  → Querying NVD API...');\n\nconst response = await this.helpers.httpRequest({\n  method: 'GET',\n  url: apiUrl,\n  timeout: 30000,\n  headers: {\n    'User-Agent': 'n8n-vulnerability-scanner/1.0'\n  }\n});\n\n\n    const vulnerabilities = response.vulnerabilities || [];\n    console.log(`  → Found ${vulnerabilities.length} CVEs`);\n\n    if (vulnerabilities.length === 0) {\n      enriched.push({\n        ...base,\n        cveId: 'N/A',\n        cveSummary: 'No known vulnerabilities found in NVD database',\n        cvssScore: 0,\n        severity: 'INFO',\n        publishedDate: 'N/A',\n        references: []\n      });\n    } else {\n      // Process each CVE\n      for (const vuln of vulnerabilities) {\n        const cve = vuln.cve || {};\n        const cveId = cve.id || 'UNKNOWN';\n\n        // Get English description\n        const descriptions = cve.descriptions || [];\n        const cveSummary = descriptions.find(d => d.lang === 'en')?.value || 'No description available';\n\n        // Get CVSS metrics\n        const metrics = cve.metrics || {};\n        const cvssV31 = metrics.cvssMetricV31?.[0]?.cvssData;\n        const cvssV30 = metrics.cvssMetricV30?.[0]?.cvssData;\n        const cvssData = cvssV31 || cvssV30 || {};\n\n        const cvssScore = cvssData.baseScore || 0;\n        const severity = cvssData.baseSeverity || 'UNKNOWN';\n\n        // Get published date\n        const publishedDate = cve.published || 'N/A';\n\n        // Get references (limit to 3)\n        const references = (cve.references || []).slice(0, 3).map(ref => ref.url);\n\n        enriched.push({\n          ...base,\n          cveId,\n          cveSummary,\n          cvssScore,\n          severity,\n          publishedDate,\n          references\n        });\n\n        console.log(`    - ${cveId} (${severity}, CVSS: ${cvssScore})`);\n      }\n    }\n\n    // Rate limiting: 1 seconds between requests\n    if (i < services.length - 1) {\n      console.log('  → Waiting 1s (rate limit)...');\n      await new Promise(resolve => setTimeout(resolve, 1000));\n    }\n\n  } catch (error) {\n    console.log(`  ✗ API ERROR: ${error.message}`);\n    enriched.push({\n      ...base,\n      cveId: 'N/A',\n      cveSummary: `API Error: ${error.message}`,\n      cvssScore: 0,\n      severity: 'ERROR',\n      publishedDate: 'N/A',\n      references: []\n    });\n  }\n}\n\nconsole.log(`=== CVE ENRICHMENT COMPLETE: ${enriched.length} results ===`);\n// return enriched.map(item => ({json: item}));\n\n\n// JSON string\nconst outputContent = JSON.stringify(enriched, null, 2);\n\n// Buffer\nconst buffer = Buffer.from(outputContent, 'utf-8');\n\n// Return \nreturn [{\n  json: { enriched: enriched },\n  binary: {\n    data: {\n      data: buffer.toString('base64'),\n      mimeType: 'application/json',\n      fileName: 'enriched.json'\n    }\n  }\n}];\n"
          },
          "typeVersion": 2
        },
        {
          "id": "ba2b5863-0124-41bf-a7ba-ddad989c1991",
          "name": "6. Save Enriched Data",
          "type": "n8n-nodes-base.readWriteFile",
          "notes": "Persist CVE-enriched data",
          "position": [
            1520,
            -48
          ],
          "parameters": {
            "options": {},
            "fileName": "=/tmp/enriched_data_{{ $('1. Set Parameters').item.json.timestamp }}.json",
            "operation": "write",
            "dataPropertyName": "=data"
          },
          "typeVersion": 1
        },
        {
          "id": "f1536f6c-e932-442d-81af-1a53a18ee3fc",
          "name": "7. Aggregate All Data",
          "type": "n8n-nodes-base.aggregate",
          "notes": "Collect all enriched items",
          "position": [
            1824,
            -48
          ],
          "parameters": {
            "include": "specifiedFields",
            "options": {},
            "aggregate": "aggregateAllItemData",
            "fieldsToInclude": "enriched, services"
          },
          "typeVersion": 1
        },
        {
          "id": "40b24046-c02f-4088-a1e3-83c2bac88f3f",
          "name": "8. Prepare Report Structure",
          "type": "n8n-nodes-base.code",
          "notes": "Group by IP, calculate statistics",
          "position": [
            2112,
            -48
          ],
          "parameters": {
            "jsCode": "// Prepare report data structure - FIXED for nested array structure\nconst input = $input.first().json;\nconst network = $('1. Set Parameters').first().json.network;\n\nconsole.log('=== PREPARING REPORT ===');\nconsole.log('Input type:', typeof input);\nconsole.log('Input keys:', Object.keys(input));\n\n// FIXED: Handle triple-nested structure [{ data: [{ enriched: [...] }] }]\nlet allData = [];\n\n// Step 1: Extract from data array\nif (input.data && Array.isArray(input.data)) {\n  console.log('Found data array, length:', input.data.length);\n\n  // Step 2: data is an array, get first element\n  if (input.data.length > 0) {\n    const dataFirstItem = input.data[0];\n    console.log('First data item keys:', Object.keys(dataFirstItem));\n\n    // Step 3: Extract enriched array\n    if (dataFirstItem.enriched && Array.isArray(dataFirstItem.enriched)) {\n      allData = dataFirstItem.enriched;\n      console.log('✓ Found enriched array in data[0].enriched, length:', allData.length);\n    } else {\n      console.log('ERROR: No enriched array in data[0]');\n    }\n  }\n} else {\n  console.log('ERROR: No data array found');\n}\n\n// Fallback: check other possible structures\nif (allData.length === 0) {\n  console.log('Trying fallback extraction methods...');\n\n  if (input.enriched && Array.isArray(input.enriched)) {\n    allData = input.enriched;\n    console.log('Found in input.enriched');\n  } else if (Array.isArray(input)) {\n    allData = input;\n    console.log('Input itself is array');\n  }\n}\n\nconsole.log(`Processing ${allData.length} enriched items`);\n\nif (allData.length === 0) {\n  console.log('ERROR: No data found! Full input:', JSON.stringify(input, null, 2));\n}\n\n// Group data by IP address\nconst hostsByIp = {};\n\nfor (const item of allData) {\n  console.log('Processing item:', item.ip, item.port, item.service);\n\n  const ip = item.ip;\n  const port = item.port;\n\n  // Skip undefined values\n  if (!ip || !port) {\n    console.log('Skipping item with undefined ip or port');\n    continue;\n  }\n\n  // Initialize host if not exists\n  if (!hostsByIp[ip]) {\n    hostsByIp[ip] = {\n      ip: ip,\n      hostname: ip,\n      services: {}\n    };\n    console.log(`Initialized host: ${ip}`);\n  }\n\n  // Initialize service/port if not exists\n  if (!hostsByIp[ip].services[port]) {\n    hostsByIp[ip].services[port] = {\n      port: port,\n      protocol: item.protocol,\n      service: item.service,\n      product: item.product,\n      version: item.version,\n      cpe: item.cpe,\n      vulnerabilities: []\n    };\n    console.log(`  Added service: ${port}/${item.protocol} ${item.service}`);\n  }\n\n  // Add vulnerability if CVE exists\n  if (item.cveId && item.cveId !== 'N/A') {\n    hostsByIp[ip].services[port].vulnerabilities.push({\n      cveId: item.cveId,\n      cveSummary: item.cveSummary,\n      cvssScore: item.cvssScore,\n      severity: item.severity,\n      publishedDate: item.publishedDate,\n      references: item.references\n    });\n    console.log(`    Added CVE: ${item.cveId} (${item.severity})`);\n  }\n}\n\nconsole.log('Hosts found:', Object.keys(hostsByIp));\n\n// Calculate statistics\nlet totalVulnerabilities = 0;\nlet criticalCount = 0;\nlet highCount = 0;\nlet mediumCount = 0;\nlet lowCount = 0;\nlet infoCount = 0;\nlet totalServices = 0;\n\nfor (const ip in hostsByIp) {\n  for (const port in hostsByIp[ip].services) {\n    totalServices++;\n    const vulns = hostsByIp[ip].services[port].vulnerabilities;\n    totalVulnerabilities += vulns.length;\n\n    for (const vuln of vulns) {\n      const severity = (vuln.severity || 'INFO').toLowerCase();\n      if (severity === 'critical') criticalCount++;\n      else if (severity === 'high') highCount++;\n      else if (severity === 'medium') mediumCount++;\n      else if (severity === 'low') lowCount++;\n      else infoCount++;\n    }\n  }\n}\n\nconst statistics = {\n  totalHosts: Object.keys(hostsByIp).length,\n  totalServices: totalServices,\n  totalVulnerabilities: totalVulnerabilities,\n  criticalCount: criticalCount,\n  highCount: highCount,\n  mediumCount: mediumCount,\n  lowCount: lowCount,\n  infoCount: infoCount,\n  scanDate: new Date().toISOString().split('T')[0],\n  scanTime: new Date().toISOString().split('T')[1].split('.')[0]\n};\n\nconsole.log(`✓ Statistics: ${statistics.totalHosts} hosts, ${statistics.totalServices} services, ${statistics.totalVulnerabilities} vulnerabilities`);\nconsole.log(`  - Critical: ${criticalCount}, High: ${highCount}, Medium: ${mediumCount}, Low: ${lowCount}, Info: ${infoCount}`);\n\nconst report = {\n  metadata: {\n    title: 'Network Infrastructure Vulnerability Assessment Report',\n    subtitle: 'Comprehensive Security Analysis',\n    version: '1.0.0',\n    scanDate: statistics.scanDate,\n    scanTime: statistics.scanTime,\n    scanNetwork: network\n  },\n  statistics: statistics,\n  executiveSummary: `This vulnerability assessment analyzed the network ${network}. ` +\n    `The scan identified ${statistics.totalHosts} active hosts with ${statistics.totalServices} exposed services. ` +\n    `A total of ${statistics.totalVulnerabilities} vulnerabilities were discovered, ` +\n    `including ${statistics.criticalCount} critical, ${statistics.highCount} high, ` +\n    `${statistics.mediumCount} medium, ${statistics.lowCount} low severity issues, ` +\n    `and ${statistics.infoCount} informational findings.`,\n  hostData: hostsByIp\n};\n\nconsole.log('✓ Report structure prepared successfully');\nconsole.log('Host IPs:', Object.keys(hostsByIp));\n\nreturn [{json: report}];"
          },
          "typeVersion": 2
        },
        {
          "id": "2b475881-2fb9-4a29-aa57-1de5ef91a194",
          "name": "9. Generate HTML Report",
          "type": "n8n-nodes-base.code",
          "notes": "Professional HTML report with styling",
          "position": [
            2416,
            -48
          ],
          "parameters": {
            "jsCode": "// Generate Professional HTML Report\nconst report = items[0].json;\nconst meta = report.metadata;\nconst stats = report.statistics;\nconst hosts = report.hostData;\n\nconsole.log('=== GENERATING HTML REPORT ===');\n\n// Helper functions\nfunction severityColor(severity) {\n  const colors = {\n    'critical': '#c62828',\n    'high': '#f57c00',\n    'medium': '#fbc02d',\n    'low': '#388e3c',\n    'info': '#1976d2',\n    'error': '#9e9e9e',\n    'unknown': '#757575'\n  };\n  return colors[(severity || 'info').toLowerCase()] || '#757575';\n}\n\nfunction severityBadge(severity) {\n  const color = severityColor(severity);\n  return `<span class=\"severity-badge\" style=\"background-color:${color}\">${(severity || 'INFO').toUpperCase()}</span>`;\n}\n\nfunction generateServiceTable(host) {\n  let html = '<table class=\"service-table\"><thead><tr>';\n  html += '<th>Port</th><th>Protocol</th><th>Service</th><th>Product</th><th>Version</th><th>CVE Count</th><th>Max Severity</th>';\n  html += '</tr></thead><tbody>';\n\n  for (const portKey in host.services) {\n    const svc = host.services[portKey];\n    const vulnCount = svc.vulnerabilities.length;\n\n    let maxSeverity = 'INFO';\n    if (vulnCount > 0) {\n      const severities = ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW', 'INFO'];\n      for (const sev of severities) {\n        if (svc.vulnerabilities.some(v => (v.severity || '').toUpperCase() === sev)) {\n          maxSeverity = sev;\n          break;\n        }\n      }\n    }\n\n    html += '<tr>';\n    html += `<td><strong>${svc.port}</strong></td>`;\n    html += `<td>${svc.protocol}</td>`;\n    html += `<td>${svc.service}</td>`;\n    html += `<td>${svc.product || '-'}</td>`;\n    html += `<td>${svc.version || '-'}</td>`;\n    html += `<td>${vulnCount}</td>`;\n    html += `<td>${severityBadge(maxSeverity)}</td>`;\n    html += '</tr>';\n  }\n\n  html += '</tbody></table>';\n  return html;\n}\n\nfunction generateVulnerabilityDetails(host) {\n  let html = '';\n\n  for (const portKey in host.services) {\n    const svc = host.services[portKey];\n\n    html += `<div class=\"port-section\">`;\n    html += `<h4 class=\"port-title\">Port ${svc.port}/${svc.protocol} - ${svc.service}</h4>`;\n    html += `<div class=\"service-info\">`;\n    html += `<strong>Product:</strong> ${svc.product || 'Unknown'} `;\n    html += `<strong>Version:</strong> ${svc.version || 'Unknown'}`;\n    if (svc.cpe) {\n      html += `<br><strong>CPE:</strong> <code>${svc.cpe}</code>`;\n    }\n    html += `</div>`;\n\n    if (svc.vulnerabilities.length === 0) {\n      html += `<div class=\"no-vuln\">No known vulnerabilities found for this service.</div>`;\n    } else {\n      html += `<div class=\"vulnerabilities\">`;\n      for (const vuln of svc.vulnerabilities) {\n        html += `<div class=\"vulnerability-card\">`;\n        html += `<div class=\"vuln-header\">`;\n        html += `<span class=\"cve-id\">${vuln.cveId}</span>`;\n        html += severityBadge(vuln.severity);\n        html += `<span class=\"cvss-score\">CVSS: ${vuln.cvssScore}</span>`;\n        html += `</div>`;\n        html += `<div class=\"vuln-published\">Published: ${vuln.publishedDate}</div>`;\n        html += `<div class=\"vuln-description\">${vuln.cveSummary}</div>`;\n        if (vuln.references && vuln.references.length > 0) {\n          html += `<div class=\"vuln-references\"><strong>References:</strong><ul>`;\n          for (const ref of vuln.references) {\n            html += `<li><a href=\"${ref}\" target=\"_blank\">${ref}</a></li>`;\n          }\n          html += `</ul></div>`;\n        }\n        html += `</div>`;\n      }\n      html += `</div>`;\n    }\n\n    html += `</div>`;\n  }\n\n  return html;\n}\n\n// Build HTML\nlet html = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>${meta.title}</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      line-height: 1.6;\n      color: #333;\n      background-color: #f5f5f5;\n    }\n    .container {\n      max-width: 1200px;\n      margin: 0 auto;\n      padding: 20px;\n      background-color: white;\n      box-shadow: 0 0 20px rgba(0,0,0,0.1);\n    }\n    .header {\n      background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);\n      color: white;\n      padding: 40px 30px;\n      margin: -20px -20px 30px -20px;\n    }\n    .header h1 {\n      font-size: 28px;\n      margin-bottom: 10px;\n    }\n    .header .subtitle {\n      font-size: 16px;\n      opacity: 0.9;\n    }\n    .meta-info {\n      background-color: #f9f9f9;\n      border-left: 4px solid #1976d2;\n      padding: 15px 20px;\n      margin-bottom: 30px;\n    }\n    .meta-info div {\n      margin: 5px 0;\n    }\n    h2 {\n      color: #1976d2;\n      font-size: 24px;\n      margin: 40px 0 20px 0;\n      padding-bottom: 10px;\n      border-bottom: 2px solid #e0e0e0;\n    }\n    h3 {\n      color: #424242;\n      font-size: 20px;\n      margin: 30px 0 15px 0;\n    }\n    h4 {\n      color: #616161;\n      font-size: 18px;\n      margin: 20px 0 10px 0;\n    }\n    .stats-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 20px;\n      margin: 20px 0;\n    }\n    .stat-card {\n      background-color: #f9f9f9;\n      padding: 20px;\n      border-radius: 8px;\n      border-left: 4px solid #1976d2;\n    }\n    .stat-card .label {\n      font-size: 14px;\n      color: #757575;\n      margin-bottom: 8px;\n    }\n    .stat-card .value {\n      font-size: 32px;\n      font-weight: bold;\n      color: #1976d2;\n    }\n    .severity-breakdown {\n      display: flex;\n      gap: 15px;\n      margin: 20px 0;\n      flex-wrap: wrap;\n    }\n    .severity-item {\n      flex: 1;\n      min-width: 120px;\n      padding: 15px;\n      background-color: #f9f9f9;\n      border-radius: 6px;\n      text-align: center;\n    }\n    .severity-item .count {\n      font-size: 28px;\n      font-weight: bold;\n      margin-bottom: 5px;\n    }\n    .severity-item .label {\n      font-size: 12px;\n      text-transform: uppercase;\n      font-weight: 600;\n    }\n    .severity-badge {\n      display: inline-block;\n      padding: 4px 12px;\n      border-radius: 4px;\n      color: white;\n      font-size: 12px;\n      font-weight: 600;\n      text-transform: uppercase;\n    }\n    .service-table {\n      width: 100%;\n      border-collapse: collapse;\n      margin: 20px 0;\n      background-color: white;\n      box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n    }\n    .service-table th,\n    .service-table td {\n      padding: 12px;\n      text-align: left;\n      border-bottom: 1px solid #e0e0e0;\n    }\n    .service-table th {\n      background-color: #f5f5f5;\n      font-weight: 600;\n      color: #424242;\n      text-transform: uppercase;\n      font-size: 12px;\n    }\n    .service-table tr:hover {\n      background-color: #fafafa;\n    }\n    .port-section {\n      margin: 30px 0;\n      padding: 20px;\n      background-color: #fafafa;\n      border-radius: 8px;\n    }\n    .port-title {\n      color: #1976d2;\n      margin-bottom: 10px;\n    }\n    .service-info {\n      margin: 10px 0;\n      padding: 10px;\n      background-color: white;\n      border-radius: 4px;\n      font-size: 14px;\n    }\n    .service-info code {\n      background-color: #f5f5f5;\n      padding: 2px 6px;\n      border-radius: 3px;\n      font-size: 12px;\n    }\n    .no-vuln {\n      margin: 15px 0;\n      padding: 15px;\n      background-color: #e8f5e9;\n      color: #388e3c;\n      border-radius: 4px;\n      border-left: 4px solid #4caf50;\n    }\n    .vulnerabilities {\n      margin: 15px 0;\n    }\n    .vulnerability-card {\n      margin: 15px 0;\n      padding: 20px;\n      background-color: white;\n      border-radius: 6px;\n      border-left: 4px solid #f57c00;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    .vuln-header {\n      display: flex;\n      gap: 15px;\n      align-items: center;\n      margin-bottom: 10px;\n    }\n    .cve-id {\n      font-size: 18px;\n      font-weight: bold;\n      color: #1976d2;\n    }\n    .cvss-score {\n      font-size: 14px;\n      font-weight: 600;\n      color: #757575;\n    }\n    .vuln-published {\n      font-size: 13px;\n      color: #757575;\n      margin-bottom: 10px;\n    }\n    .vuln-description {\n      margin: 15px 0;\n      line-height: 1.7;\n    }\n    .vuln-references {\n      margin-top: 15px;\n      font-size: 14px;\n    }\n    .vuln-references ul {\n      margin: 10px 0 0 20px;\n    }\n    .vuln-references a {\n      color: #1976d2;\n      text-decoration: none;\n      word-break: break-all;\n    }\n    .vuln-references a:hover {\n      text-decoration: underline;\n    }\n    .executive-summary {\n      background-color: #e3f2fd;\n      padding: 20px;\n      border-radius: 6px;\n      border-left: 4px solid #1976d2;\n      margin: 20px 0;\n      line-height: 1.8;\n    }\n    .recommendations {\n      background-color: #fff3e0;\n      padding: 20px;\n      border-radius: 6px;\n      border-left: 4px solid #f57c00;\n      margin: 20px 0;\n    }\n    .recommendations ul {\n      margin: 15px 0 0 20px;\n      line-height: 2;\n    }\n    @media print {\n      .container {\n        box-shadow: none;\n      }\n      .header {\n        background: #1976d2;\n        -webkit-print-color-adjust: exact;\n        print-color-adjust: exact;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>${meta.title}</h1>\n      <div class=\"subtitle\">${meta.subtitle}</div>\n    </div>\n\n    <div class=\"meta-info\">\n      <div><strong>Target Network:</strong> ${meta.scanNetwork}</div>\n      <div><strong>Scan Date:</strong> ${meta.scanDate} ${meta.scanTime}</div>\n      <div><strong>Report Version:</strong> ${meta.version}</div>\n    </div>\n\n    <h2>Executive Summary</h2>\n    <div class=\"executive-summary\">\n      ${report.executiveSummary}\n    </div>\n\n    <h2>Overall Statistics</h2>\n    <div class=\"stats-grid\">\n      <div class=\"stat-card\">\n        <div class=\"label\">Total Hosts</div>\n        <div class=\"value\">${stats.totalHosts}</div>\n      </div>\n      <div class=\"stat-card\">\n        <div class=\"label\">Total Services</div>\n        <div class=\"value\">${stats.totalServices}</div>\n      </div>\n      <div class=\"stat-card\">\n        <div class=\"label\">Total Vulnerabilities</div>\n        <div class=\"value\">${stats.totalVulnerabilities}</div>\n      </div>\n    </div>\n\n    <h3>Vulnerability Breakdown by Severity</h3>\n    <div class=\"severity-breakdown\">\n      <div class=\"severity-item\" style=\"border-top: 4px solid ${severityColor('critical')}\">\n        <div class=\"count\" style=\"color: ${severityColor('critical')}\">${stats.criticalCount}</div>\n        <div class=\"label\" style=\"color: ${severityColor('critical')}\">Critical</div>\n      </div>\n      <div class=\"severity-item\" style=\"border-top: 4px solid ${severityColor('high')}\">\n        <div class=\"count\" style=\"color: ${severityColor('high')}\">${stats.highCount}</div>\n        <div class=\"label\" style=\"color: ${severityColor('high')}\">High</div>\n      </div>\n      <div class=\"severity-item\" style=\"border-top: 4px solid ${severityColor('medium')}\">\n        <div class=\"count\" style=\"color: ${severityColor('medium')}\">${stats.mediumCount}</div>\n        <div class=\"label\" style=\"color: ${severityColor('medium')}\">Medium</div>\n      </div>\n      <div class=\"severity-item\" style=\"border-top: 4px solid ${severityColor('low')}\">\n        <div class=\"count\" style=\"color: ${severityColor('low')}\">${stats.lowCount}</div>\n        <div class=\"label\" style=\"color: ${severityColor('low')}\">Low</div>\n      </div>\n      <div class=\"severity-item\" style=\"border-top: 4px solid ${severityColor('info')}\">\n        <div class=\"count\" style=\"color: ${severityColor('info')}\">${stats.infoCount}</div>\n        <div class=\"label\" style=\"color: ${severityColor('info')}\">Info</div>\n      </div>\n    </div>\n\n    <h2>Detailed Findings by Host</h2>`;\n\n// Generate per-host sections\nfor (const ip in hosts) {\n  const host = hosts[ip];\n  html += `\n    <h3>Host: ${host.ip}</h3>\n    <h4>Discovered Services</h4>\n    ${generateServiceTable(host)}\n    <h4>Vulnerability Details</h4>\n    ${generateVulnerabilityDetails(host)}\n  `;\n}\n\nhtml += `\n    <h2>Recommendations</h2>\n    <div class=\"recommendations\">\n      <p><strong>Immediate Actions:</strong></p>\n      <ul>\n        <li>Prioritize patching of CRITICAL and HIGH severity vulnerabilities</li>\n        <li>Review and update all services showing outdated versions</li>\n        <li>Disable or restrict access to unnecessary services</li>\n        <li>Implement network segmentation to limit exposure</li>\n      </ul>\n      <p><strong>Long-term Improvements:</strong></p>\n      <ul>\n        <li>Establish regular vulnerability scanning schedule (weekly/monthly)</li>\n        <li>Implement automated patch management processes</li>\n        <li>Deploy intrusion detection/prevention systems (IDS/IPS)</li>\n        <li>Conduct security awareness training for staff</li>\n        <li>Maintain asset inventory and track software versions</li>\n      </ul>\n    </div>\n  </div>\n</body>\n</html>`;\n\nconsole.log('HTML report generated successfully');\n\n// Return as both JSON and binary\nconst buffer = Buffer.from(html, 'utf-8');\nreturn [{\n  json: { html: html },\n  binary: {\n    data: {\n      data: buffer.toString('base64'),\n      mimeType: 'text/html',\n      fileName: 'vulnerability_report.html'\n    }\n  }\n}];"
          },
          "typeVersion": 2
        },
        {
          "id": "bc0271d6-751b-4ce0-984c-0d38a13802ae",
          "name": "10. Save Report to File",
          "type": "n8n-nodes-base.readWriteFile",
          "notes": "Write HTML report to /tmp",
          "position": [
            2720,
            -48
          ],
          "parameters": {
            "options": {},
            "fileName": "=/tmp/vulnerability_report_{{ $('1. Set Parameters').item.json.timestamp }}.html",
            "operation": "write",
            "dataPropertyName": "=data"
          },
          "typeVersion": 1
        },
        {
          "id": "1eee0642-57ec-4846-8354-fc37f5b8a988",
          "name": "11. Read Report for Output",
          "type": "n8n-nodes-base.readWriteFile",
          "notes": "Return report file",
          "position": [
            3024,
            -48
          ],
          "parameters": {
            "options": {},
            "fileSelector": "=/tmp/vulnerability_report_{{ $('1. Set Parameters').item.json.timestamp }}.html"
          },
          "typeVersion": 1
        },
        {
          "id": "f447bad9-718e-4ad4-bd43-1cca0a5fad57",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1168,
            -224
          ],
          "parameters": {
            "color": 5,
            "width": 816,
            "height": 128,
            "content": "## Get CVE datas\n**CPE Search** : https://nvd.nist.gov/products/cpe/search\n**CVE Search** : https://services.nvd.nist.gov/rest/json/cves/2.0?cpeName={CPE Tag}&resultsPerPage=10&isVulnerable"
          },
          "typeVersion": 1
        },
        {
          "id": "552fec50-fb88-4214-9536-97d5b6b95212",
          "name": "12. Convert the Report to PDF from HTML",
          "type": "n8n-nodes-base.executeCommand",
          "position": [
            3280,
            -48
          ],
          "parameters": {
            "command": "=apk add --no-cache wget tar giflib libwebp libwebpdemux libavif lcms2 fontconfig\ncd /tmp\nwget https://www.princexml.com/download/prince-16.1-alpine3.20-x86_64.tar.gz\ntar -xf prince-16.1-alpine3.20-x86_64.tar.gz\n\n/tmp/prince-16.1-alpine3.20-x86_64/lib/prince/bin/prince /tmp/vulnerability_report_{{ $('1. Set Parameters').item.json.timestamp }}.html -o /tmp/vulnerability_report_{{ $('1. Set Parameters').item.json.timestamp }}.pdf --media=print --encrypt --user-password={{ $('1. Set Parameters').item.json.report_password }} --css-dpi=128\n\n"
          },
          "typeVersion": 1
        },
        {
          "id": "3adf22b0-cb68-4065-8ef4-482491881275",
          "name": "13. Read Report PDF for Output",
          "type": "n8n-nodes-base.readWriteFile",
          "position": [
            3504,
            -48
          ],
          "parameters": {
            "options": {
              "dataPropertyName": "=vulnerability_report"
            },
            "fileSelector": "=/tmp/vulnerability_report_{{ $('1. Set Parameters').item.json.timestamp }}.pdf"
          },
          "typeVersion": 1
        },
        {
          "id": "23c3aee7-d384-4a95-9369-3649a3c7b49d",
          "name": "On form submission",
          "type": "n8n-nodes-base.formTrigger",
          "position": [
            -640,
            240
          ],
          "webhookId": "663716a5-77e7-4290-bb94-3f73460e312d",
          "parameters": {
            "options": {
              "path": "target"
            },
            "formTitle": "Add scan parameters",
            "formFields": {
              "values": [
                {
                  "fieldLabel": "network",
                  "placeholder": "Add target ip,ip-range,fqdn",
                  "requiredField": true
                }
              ]
            }
          },
          "typeVersion": 2.3
        },
        {
          "id": "9a2a64ea-a996-4ead-b5cf-5de8218bd40f",
          "name": "Add NMAP-HELPER",
          "type": "n8n-nodes-base.executeCommand",
          "position": [
            -112,
            -48
          ],
          "parameters": {
            "command": "=apk add --no-cache git make rust cargo\ncd /tmp\ngit clone https://github.com/net-shaper/nmap-helper.git\ncd nmap-helper\nmake\nmake install\n"
          },
          "typeVersion": 1
        },
        {
          "id": "2c0b7dcc-176a-4c72-a228-496078fb4a07",
          "name": "Pre-Set-Target",
          "type": "n8n-nodes-base.set",
          "position": [
            -640,
            -48
          ],
          "parameters": {
            "options": {},
            "assignments": {
              "assignments": [
                {
                  "id": "5767d8e7-5746-4713-8a22-9b2cea985269",
                  "name": "network",
                  "type": "string",
                  "value": "scanme.nmap.org"
                }
              ]
            }
          },
          "typeVersion": 3.4
        },
        {
          "id": "fc2c83f8-f167-47be-9700-9cc018d70cb3",
          "name": "Schedule Trigger",
          "type": "n8n-nodes-base.scheduleTrigger",
          "position": [
            -976,
            -336
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "triggerAtHour": 1
                }
              ]
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "08f20486-655b-4cf0-a287-e643df9ec96d",
          "name": "3. Parse NMAP JSON to Services",
          "type": "n8n-nodes-base.code",
          "notes": "Extract all services with details",
          "position": [
            624,
            -48
          ],
          "parameters": {
            "jsCode": "const raw = $input.first().json;\n\nconst nmapJson = raw.stdout ? JSON.parse(raw.stdout) : raw;\n\nlet services = [];\n\nconst hosts = nmapJson.host || [];\nfor (const host of hosts) {\n  const ip = host.address?.[0]?.addr || 'unknown';\n  const ports = host.ports?.port || [];\n\n  for (const portObj of ports) {\n    if (portObj.state?.state !== 'open') continue;\n\n    const serviceObj = portObj.service || {};\n    services.push({\n      ip,\n      port: portObj.portid,\n      protocol: portObj.protocol,\n      service: serviceObj.name || 'unknown',\n      product: serviceObj.product || '',\n      version: serviceObj.version || '',\n      cpe: Array.isArray(serviceObj.cpe) && serviceObj.cpe.length > 0\n        ? serviceObj.cpe[0].replace(/^cpe:\\//, 'cpe:2.3:') + ':'\n        : '',\n      serviceKey: `${ip}:${portObj.portid}`\n    });\n  }\n}\n\nconst outputContent = JSON.stringify(services, null, 2);\nconst buffer = Buffer.from(outputContent, 'utf-8');\n\nreturn [{\n  json: { services: services },\n  binary: {\n    data: {\n      data: buffer.toString('base64'),\n      mimeType: 'application/json',\n      fileName: 'services.json'\n    }\n  }\n}];\n"
          },
          "typeVersion": 2
        },
        {
          "id": "ca7d013a-e407-46bf-8bd1-c5b0256a477a",
          "name": "Sticky Note7",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3264,
            -192
          ],
          "parameters": {
            "color": 5,
            "width": 352,
            "height": 96,
            "content": "## HTML to PDF\nhttps://www.princexml.com/doc/intro-userguide/"
          },
          "typeVersion": 1
        },
        {
          "id": "1564f1df-b1d4-4683-aad1-4bb2a77f16c1",
          "name": "14/a. Send Report in Telegram",
          "type": "n8n-nodes-base.telegram",
          "position": [
            3856,
            -336
          ],
          "webhookId": "5e17520f-66c7-4b4f-ac1e-9251beb4dd7c",
          "parameters": {
            "chatId": "=-123456789012",
            "operation": "sendDocument",
            "binaryData": true,
            "additionalFields": {},
            "binaryPropertyName": "=vulnerability_report"
          },
          "credentials": {
            "telegramApi": {
              "id": "credential-id",
              "name": "telegramApi Credential"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "2dca7335-376a-4f2d-ab0f-4566366904a7",
          "name": "14/b. Send Report in Email with SMTP (example POSTFIX)",
          "type": "n8n-nodes-base.emailSend",
          "position": [
            3856,
            256
          ],
          "webhookId": "6c9d2bb4-6caf-474e-a058-dcb5b6cba5a7",
          "parameters": {
            "text": "=The requested Automatic NMAP Scan finished, we attached the Report for '{{ $('1. Set Parameters').item.json.network }}'",
            "options": {
              "attachments": "=vulnerability_report",
              "allowUnauthorizedCerts": true
            },
            "subject": "=Automatic NMAP Report for '{{ $('1. Set Parameters').item.json.network }}'",
            "toEmail": "=report.receiver@example.com",
            "fromEmail": "=report.creator@example.com"
          },
          "credentials": {
            "smtp": {
              "id": "credential-id",
              "name": "smtp Credential"
            }
          },
          "typeVersion": 2
        },
        {
          "id": "813b1c02-20d6-455e-abbc-863f60d8acb2",
          "name": "Optional Params Setter",
          "type": "n8n-nodes-base.set",
          "position": [
            112,
            -48
          ],
          "parameters": {
            "options": {},
            "assignments": {
              "assignments": [
                {
                  "id": "993bd434-83d3-4c09-b9c9-d80ed1273802",
                  "name": "setter",
                  "type": "string",
                  "value": "-"
                },
                {
                  "id": "cd15bd15-9e15-4cd4-852b-fa3ab0ccbdf8",
                  "name": "max-retries",
                  "type": "string",
                  "value": "max-retries 2"
                },
                {
                  "id": "7906c4b3-05e6-4660-a22f-0a5ac056d42e",
                  "name": "min-parallelism",
                  "type": "string",
                  "value": "min-parallelism 40"
                },
                {
                  "id": "65ece4fd-13bd-4b94-b281-f2d1d5109e03",
                  "name": "max-parallelism",
                  "type": "string",
                  "value": "max-parallelism 250"
                },
                {
                  "id": "4c963160-4085-49ce-baaa-209f8b76ba81",
                  "name": "timing",
                  "type": "string",
                  "value": "-T4"
                }
              ]
            }
          },
          "typeVersion": 3.4
        },
        {
          "id": "218eb838-e1db-4014-a99e-9ebdf415788b",
          "name": "Sticky Note - Overview",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -1792,
            -288
          ],
          "parameters": {
            "width": 480,
            "height": 568,
            "content": "## How it works\n\nThis workflow scans network targets using Nmap, enriches findings with CVE data from the NVD API, and generates password-protected PDF reports. It detects services, matches them to CPE identifiers, queries vulnerabilities with CVSS scores, and outputs professional reports via Telegram and email.\n\n## Setup steps\n\n1. **Triggers**: Choose webhook (API), form (web UI), manual, or scheduled execution\n2. **Configure targets**: Edit 'Pre-Set-Target' node for manual/scheduled runs, or submit via webhook/form\n3. **Set report password**: Update 'report_password' in '1. Set Parameters' node\n4. **Add credentials**: Configure Telegram bot token and SMTP settings in n8n credentials\n5. **Update recipients**: Set Telegram chat ID and email addresses in distribution nodes (14/a and 14/b)\n6. **Dependencies**: First run auto-installs nmap-helper; PrinceXML downloads on PDF conversion\n\nNVD API queries are rate-limited (1 second between requests). Scan duration depends on target size."
          },
          "typeVersion": 1
        },
        {
          "id": "50ec880a-44ee-489e-a390-6fdf224fa619",
          "name": "Sticky Note - Triggers",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -1200,
            -80
          ],
          "parameters": {
            "color": 4,
            "width": 400,
            "height": 144,
            "content": "## Triggers\n\nFour ways to start scans: webhook API for automation, web form for users, manual button for testing, or scheduled cron for routine scans."
          },
          "typeVersion": 1
        },
        {
          "id": "4dfbda37-2e01-4b63-9914-e5f3c22057cb",
          "name": "Sticky Note - Dependency",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            -144,
            -320
          ],
          "parameters": {
            "color": 5,
            "width": 392,
            "height": 220,
            "content": "## Dependency Check\n\nVerifies nmap-helper installation (converts Nmap XML to JSON). First run installs from GitHub; subsequent runs skip this step.\n\nhttps://github.com/net-shaper/nmap-helper\n\nhttps://crates.io/crates/nmap-helper"
          },
          "typeVersion": 1
        },
        {
          "id": "8afde198-d3c2-46b2-bc67-df6745e23a52",
          "name": "Sticky Note - Scanning",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            80,
            160
          ],
          "parameters": {
            "color": 7,
            "width": 360,
            "height": 136,
            "content": "## Nmap Scanning\n\nExecutes full port scan with service/version detection. Configure timing and parallelism in 'Optional Params Setter' node."
          },
          "typeVersion": 1
        },
        {
          "id": "2b0abc7e-ae05-4ff4-b9e6-09ce4ca8df22",
          "name": "Sticky Note - CVE",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1200,
            160
          ],
          "parameters": {
            "color": 7,
            "width": 420,
            "height": 144,
            "content": "## CVE Enrichment\n\nQueries NVD API for each detected service using CPE identifiers. Returns CVE IDs, CVSS scores, severity levels, and references. Rate-limited to 1 req/sec."
          },
          "typeVersion": 1
        },
        {
          "id": "22463e33-b06b-4ac4-8db9-c4f5c71a90b5",
          "name": "Sticky Note - Report Gen",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2432,
            160
          ],
          "parameters": {
            "color": 7,
            "width": 360,
            "height": 140,
            "content": "## Report Generation\n\nGroups findings by host, calculates statistics, and generates HTML report with severity breakdown and detailed vulnerability info."
          },
          "typeVersion": 1
        },
        {
          "id": "ff4d8b95-d992-4b1c-97ca-598f329febcf",
          "name": "Sticky Note - PDF",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3280,
            160
          ],
          "parameters": {
            "color": 7,
            "width": 320,
            "height": 136,
            "content": "## PDF Conversion\n\nUses PrinceXML to convert HTML report to password-protected PDF. Password set in '1. Set Parameters' node."
          },
          "typeVersion": 1
        },
        {
          "id": "eff61d08-4360-446d-b57b-71634c8d09d0",
          "name": "Sticky Note - Distribution",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3840,
            -48
          ],
          "parameters": {
            "color": 4,
            "width": 320,
            "height": 136,
            "content": "## Distribution\n\nSends PDF reports via Telegram and email. Update credentials and recipients in these nodes before first use."
          },
          "typeVersion": 1
        }
      ],
      "pinData": {},
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "1. Set Parameters",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Manual Trigger": {
          "main": [
            [
              {
                "node": "Pre-Set-Target",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Pre-Set-Target": {
          "main": [
            [
              {
                "node": "1. Set Parameters",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add NMAP-HELPER": {
          "main": [
            [
              {
                "node": "Optional Params Setter",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Trigger": {
          "main": [
            [
              {
                "node": "Pre-Set-Target",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "1. Set Parameters": {
          "main": [
            [
              {
                "node": "Add NMAP-HELPER",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "On form submission": {
          "main": [
            [
              {
                "node": "1. Set Parameters",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "2. Execute Nmap Scan": {
          "main": [
            [
              {
                "node": "3. Parse NMAP JSON to Services",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "6. Save Enriched Data": {
          "main": [
            [
              {
                "node": "7. Aggregate All Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "7. Aggregate All Data": {
          "main": [
            [
              {
                "node": "8. Prepare Report Structure",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "5. CVE Enrichment Loop": {
          "main": [
            [
              {
                "node": "6. Save Enriched Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Optional Params Setter": {
          "main": [
            [
              {
                "node": "2. Execute Nmap Scan",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "10. Save Report to File": {
          "main": [
            [
              {
                "node": "11. Read Report for Output",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "9. Generate HTML Report": {
          "main": [
            [
              {
                "node": "10. Save Report to File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "4. Save Scan Data to File": {
          "main": [
            [
              {
                "node": "5. CVE Enrichment Loop",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "11. Read Report for Output": {
          "main": [
            [
              {
                "node": "12. Convert the Report to PDF from HTML",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "8. Prepare Report Structure": {
          "main": [
            [
              {
                "node": "9. Generate HTML Report",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "13. Read Report PDF for Output": {
          "main": [
            [
              {
                "node": "14/a. Send Report in Telegram",
                "type": "main",
                "index": 0
              },
              {
                "node": "14/b. Send Report in Email with SMTP (example POSTFIX)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "3. Parse NMAP JSON to Services": {
          "main": [
            [
              {
                "node": "4. Save Scan Data to File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "12. Convert the Report to PDF from HTML": {
          "main": [
            [
              {
                "node": "13. Read Report PDF for Output",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      }
    },
    "lastUpdatedBy": 29,
    "workflowInfo": {
      "nodeCount": 32,
      "nodeTypes": {
        "n8n-nodes-base.set": {
          "count": 3
        },
        "n8n-nodes-base.code": {
          "count": 4
        },
        "n8n-nodes-base.webhook": {
          "count": 1
        },
        "n8n-nodes-base.telegram": {
          "count": 1
        },
        "n8n-nodes-base.aggregate": {
          "count": 1
        },
        "n8n-nodes-base.emailSend": {
          "count": 1
        },
        "n8n-nodes-base.stickyNote": {
          "count": 10
        },
        "n8n-nodes-base.formTrigger": {
          "count": 1
        },
        "n8n-nodes-base.manualTrigger": {
          "count": 1
        },
        "n8n-nodes-base.readWriteFile": {
          "count": 5
        },
        "n8n-nodes-base.executeCommand": {
          "count": 3
        },
        "n8n-nodes-base.scheduleTrigger": {
          "count": 1
        }
      }
    },
    "status": "published",
    "user": {
      "name": "Vigh Sandor",
      "username": "vighsandor",
      "bio": "I'm a DevOps engineer and automation enthusiast who builds smart, practical workflows using n8n.io. \n\nI focus on creating reliable, open-source solutions that connect tools and simplify everyday operations — whether it’s infrastructure management, workflow automation, or integrating AI into existing systems.",
      "verified": true,
      "links": [
        ""
      ],
      "avatar": "https://gravatar.com/avatar/d3e779d3134c3771dea12479456a9caf0821cd3b6aa6d9c6802bd7e0ee0c1469?r=pg&d=retro&size=200"
    },
    "nodes": [
      {
        "id": 11,
        "icon": "fa:envelope",
        "name": "n8n-nodes-base.emailSend",
        "codex": {
          "data": {
            "alias": [
              "SMTP",
              "email",
              "human",
              "form",
              "wait",
              "hitl",
              "approval"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                  "icon": "☀️",
                  "label": "2021: The Year to Automate the New You with n8n"
                },
                {
                  "url": "https://n8n.io/blog/build-your-own-virtual-assistant-with-n8n-a-step-by-step-guide/",
                  "icon": "👦",
                  "label": "Build your own virtual assistant with n8n: A step by step guide"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.sendemail/"
                }
              ],
              "credentialDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/credentials/sendemail/"
                }
              ]
            },
            "categories": [
              "Communication",
              "HITL",
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "HITL": [
                "Human in the Loop"
              ]
            }
          }
        },
        "group": "[\"output\"]",
        "defaults": {
          "name": "Send Email",
          "color": "#00bb88"
        },
        "iconData": {
          "icon": "envelope",
          "type": "icon"
        },
        "displayName": "Send Email",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 6,
            "name": "Communication"
          },
          {
            "id": 9,
            "name": "Core Nodes"
          },
          {
            "id": 28,
            "name": "HITL"
          }
        ]
      },
      {
        "id": 13,
        "icon": "fa:terminal",
        "name": "n8n-nodes-base.executeCommand",
        "codex": {
          "data": {
            "alias": [
              "Shell",
              "Command",
              "OS",
              "Bash"
            ],
            "details": "Execute command allows you to run terminal commands on the computer/server hosting your n8n instance. Useful for executing a shell script or interacting with your n8n instance programmatically via the CLI.",
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/how-uproc-scraped-a-multi-page-website-with-a-low-code-workflow/",
                  "icon": " 🕸️",
                  "label": "How uProc scraped a multi-page website with a low-code workflow"
                },
                {
                  "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                  "icon": "🧠",
                  "label": "Why this Product Manager loves workflow automation with n8n"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.executecommand/"
                }
              ]
            },
            "categories": [
              "Development",
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Execute Command",
          "color": "#886644"
        },
        "iconData": {
          "icon": "terminal",
          "type": "icon"
        },
        "displayName": "Execute Command",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 5,
            "name": "Development"
          },
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 38,
        "icon": "fa:pen",
        "name": "n8n-nodes-base.set",
        "codex": {
          "data": {
            "alias": [
              "Set",
              "JS",
              "JSON",
              "Filter",
              "Transform",
              "Map"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/",
                  "icon": "🏭",
                  "label": "Learn to Automate Your Factory's Incident Reporting: A Step by Step Guide"
                },
                {
                  "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                  "icon": "☀️",
                  "label": "2021: The Year to Automate the New You with n8n"
                },
                {
                  "url": "https://n8n.io/blog/automatically-pulling-and-visualizing-data-with-n8n/",
                  "icon": "📈",
                  "label": "Automatically pulling and visualizing data with n8n"
                },
                {
                  "url": "https://n8n.io/blog/database-monitoring-and-alerting-with-n8n/",
                  "icon": "📡",
                  "label": "Database Monitoring and Alerting with n8n"
                },
                {
                  "url": "https://n8n.io/blog/automatically-adding-expense-receipts-to-google-sheets-with-telegram-mindee-twilio-and-n8n/",
                  "icon": "🧾",
                  "label": "Automatically Adding Expense Receipts to Google Sheets with Telegram, Mindee, Twilio, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                  "icon": "🔗",
                  "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
                },
                {
                  "url": "https://n8n.io/blog/automate-your-data-processing-pipeline-in-9-steps-with-n8n/",
                  "icon": "⚙️",
                  "label": "Automate your data processing pipeline in 9 steps"
                },
                {
                  "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                  "icon": "👥",
                  "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
                },
                {
                  "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                  "icon": "⚡️",
                  "label": "5 tasks you can automate with the new Notion API "
                },
                {
                  "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                  "icon": "💡",
                  "label": "15 Google apps you can combine and automate to increase productivity"
                },
                {
                  "url": "https://n8n.io/blog/how-uproc-scraped-a-multi-page-website-with-a-low-code-workflow/",
                  "icon": " 🕸️",
                  "label": "How uProc scraped a multi-page website with a low-code workflow"
                },
                {
                  "url": "https://n8n.io/blog/building-an-expense-tracking-app-in-10-minutes/",
                  "icon": "📱",
                  "label": "Building an expense tracking app in 10 minutes"
                },
                {
                  "url": "https://n8n.io/blog/the-ultimate-guide-to-automate-your-video-collaboration-with-whereby-mattermost-and-n8n/",
                  "icon": "📹",
                  "label": "The ultimate guide to automate your video collaboration with Whereby, Mattermost, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                  "icon": "🤖",
                  "label": "5 workflow automations for Mattermost that we love at n8n"
                },
                {
                  "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                  "icon": "🧰",
                  "label": "Learn to Build Powerful API Endpoints Using Webhooks"
                },
                {
                  "url": "https://n8n.io/blog/how-a-membership-development-manager-automates-his-work-and-investments/",
                  "icon": "📈",
                  "label": "How a Membership Development Manager automates his work and investments"
                },
                {
                  "url": "https://n8n.io/blog/a-low-code-bitcoin-ticker-built-with-questdb-and-n8n-io/",
                  "icon": "📈",
                  "label": "A low-code bitcoin ticker built with QuestDB and n8n.io"
                },
                {
                  "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                  "icon": "🎡",
                  "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
                },
                {
                  "url": "https://n8n.io/blog/benefits-of-automation-and-n8n-an-interview-with-hubspots-hugh-durkin/",
                  "icon": "🎖",
                  "label": "Benefits of automation and n8n: An interview with HubSpot's Hugh Durkin"
                },
                {
                  "url": "https://n8n.io/blog/how-goomer-automated-their-operations-with-over-200-n8n-workflows/",
                  "icon": "🛵",
                  "label": "How Goomer automated their operations with over 200 n8n workflows"
                },
                {
                  "url": "https://n8n.io/blog/aws-workflow-automation/",
                  "label": "7 no-code workflow automations for Amazon Web Services"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Edit Fields"
        },
        "iconData": {
          "icon": "pen",
          "type": "icon"
        },
        "displayName": "Edit Fields (Set)",
        "typeVersion": 3,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 47,
        "icon": "file:webhook.svg",
        "name": "n8n-nodes-base.webhook",
        "codex": {
          "data": {
            "alias": [
              "HTTP",
              "API",
              "Build",
              "WH"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/learn-how-to-automatically-cross-post-your-content-with-n8n/",
                  "icon": "✍️",
                  "label": "Learn how to automatically cross-post your content with n8n"
                },
                {
                  "url": "https://n8n.io/blog/running-n8n-on-ships-an-interview-with-maranics/",
                  "icon": "🛳",
                  "label": "Running n8n on ships: An interview with Maranics"
                },
                {
                  "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                  "icon": "🔗",
                  "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
                },
                {
                  "url": "https://n8n.io/blog/what-are-apis-how-to-use-them-with-no-code/",
                  "icon": " 🪢",
                  "label": "What are APIs and how to use them with no code"
                },
                {
                  "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                  "icon": "⚡️",
                  "label": "5 tasks you can automate with the new Notion API "
                },
                {
                  "url": "https://n8n.io/blog/how-a-digital-strategist-uses-n8n-for-online-marketing/",
                  "icon": "💻",
                  "label": "How a digital strategist uses n8n for online marketing"
                },
                {
                  "url": "https://n8n.io/blog/the-ultimate-guide-to-automate-your-video-collaboration-with-whereby-mattermost-and-n8n/",
                  "icon": "📹",
                  "label": "The ultimate guide to automate your video collaboration with Whereby, Mattermost, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/how-to-automatically-give-kudos-to-contributors-with-github-slack-and-n8n/",
                  "icon": "👏",
                  "label": "How to automatically give kudos to contributors with GitHub, Slack, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                  "icon": "🤖",
                  "label": "5 workflow automations for Mattermost that we love at n8n"
                },
                {
                  "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                  "icon": "🧠",
                  "label": "Why this Product Manager loves workflow automation with n8n"
                },
                {
                  "url": "https://n8n.io/blog/creating-custom-incident-response-workflows-with-n8n/",
                  "label": "How to automate every step of an incident response workflow"
                },
                {
                  "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                  "icon": "🧰",
                  "label": "Learn to Build Powerful API Endpoints Using Webhooks"
                },
                {
                  "url": "https://n8n.io/blog/learn-how-to-use-webhooks-with-mattermost-slash-commands/",
                  "icon": "🦄",
                  "label": "Learn how to use webhooks with Mattermost slash commands"
                },
                {
                  "url": "https://n8n.io/blog/how-goomer-automated-their-operations-with-over-200-n8n-workflows/",
                  "icon": "🛵",
                  "label": "How Goomer automated their operations with over 200 n8n workflows"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/"
                }
              ]
            },
            "categories": [
              "Development",
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"trigger\"]",
        "defaults": {
          "name": "Webhook"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCI+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTM1IDM3Yy0yLjIgMC00LTEuOC00LTRzMS44LTQgNC00IDQgMS44IDQgNC0xLjggNC00IDQiLz48cGF0aCBmaWxsPSIjMzc0NzRmIiBkPSJNMzUgNDNjLTMgMC01LjktMS40LTcuOC0zLjdsMy4xLTIuNWMxLjEgMS40IDIuOSAyLjMgNC43IDIuMyAzLjMgMCA2LTIuNyA2LTZzLTIuNy02LTYtNmMtMSAwLTIgLjMtMi45LjdsLTEuNyAxTDIzLjMgMTZsMy41LTEuOSA1LjMgOS40YzEtLjMgMi0uNSAzLS41IDUuNSAwIDEwIDQuNSAxMCAxMFM0MC41IDQzIDM1IDQzIi8+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTE0IDQzQzguNSA0MyA0IDM4LjUgNCAzM2MwLTQuNiAzLjEtOC41IDcuNS05LjdsMSAzLjlDOS45IDI3LjkgOCAzMC4zIDggMzNjMCAzLjMgMi43IDYgNiA2czYtMi43IDYtNnYtMmgxNXY0SDIzLjhjLS45IDQuNi01IDgtOS44IDgiLz48cGF0aCBmaWxsPSIjZTkxZTYzIiBkPSJNMTQgMzdjLTIuMiAwLTQtMS44LTQtNHMxLjgtNCA0LTQgNCAxLjggNCA0LTEuOCA0LTQgNCIvPjxwYXRoIGZpbGw9IiMzNzQ3NGYiIGQ9Ik0yNSAxOWMtMi4yIDAtNC0xLjgtNC00czEuOC00IDQtNCA0IDEuOCA0IDQtMS44IDQtNCA0Ii8+PHBhdGggZmlsbD0iI2U5MWU2MyIgZD0ibTE1LjcgMzQtMy40LTIgNS45LTkuN2MtMi0xLjktMy4yLTQuNS0zLjItNy4zIDAtNS41IDQuNS0xMCAxMC0xMHMxMCA0LjUgMTAgMTBjMCAuOS0uMSAxLjctLjMgMi41bC0zLjktMWMuMS0uNS4yLTEgLjItMS41IDAtMy4zLTIuNy02LTYtNnMtNiAyLjctNiA2YzAgMi4xIDEuMSA0IDIuOSA1LjFsMS43IDF6Ii8+PC9zdmc+"
        },
        "displayName": "Webhook",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 5,
            "name": "Development"
          },
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 49,
        "icon": "file:telegram.svg",
        "name": "n8n-nodes-base.telegram",
        "codex": {
          "data": {
            "alias": [
              "human",
              "form",
              "wait",
              "hitl",
              "approval"
            ],
            "resources": {
              "generic": [
                {
                  "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                  "icon": "🧬",
                  "label": "Why business process automation with n8n can change your daily life"
                },
                {
                  "url": "https://n8n.io/blog/create-a-toxic-language-detector-for-telegram/",
                  "icon": "🤬",
                  "label": "Create a toxic language detector for Telegram in 4 step"
                },
                {
                  "url": "https://n8n.io/blog/automatically-adding-expense-receipts-to-google-sheets-with-telegram-mindee-twilio-and-n8n/",
                  "icon": "🧾",
                  "label": "Automatically Adding Expense Receipts to Google Sheets with Telegram, Mindee, Twilio, and n8n"
                },
                {
                  "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                  "icon": "store",
                  "label": "6 e-commerce workflows to power up your Shopify s"
                },
                {
                  "url": "https://n8n.io/blog/world-poetry-day-workflow/",
                  "icon": "📜",
                  "label": "Celebrating World Poetry Day with a daily poem in Telegram"
                },
                {
                  "url": "https://n8n.io/blog/using-automation-to-boost-productivity-in-the-workplace/",
                  "icon": "💪",
                  "label": "Using Automation to Boost Productivity in the Workplace"
                },
                {
                  "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                  "icon": "🎡",
                  "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
                },
                {
                  "url": "https://n8n.io/blog/creating-scheduled-text-affirmations-with-n8n/",
                  "icon": "🤟",
                  "label": "Creating scheduled text affirmations with n8n"
                },
                {
                  "url": "https://n8n.io/blog/creating-telegram-bots-with-n8n-a-no-code-platform/",
                  "icon": "💬",
                  "label": "Creating Telegram Bots with n8n, a No-Code Platform"
                },
                {
                  "url": "https://n8n.io/blog/aws-workflow-automation/",
                  "label": "7 no-code workflow automations for Amazon Web Services"
                }
              ],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.telegram/"
                }
              ],
              "credentialDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/credentials/telegram/"
                }
              ]
            },
            "categories": [
              "Communication",
              "HITL"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "HITL": [
                "Human in the Loop"
              ]
            }
          }
        },
        "group": "[\"output\"]",
        "defaults": {
          "name": "Telegram"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiB2aWV3Qm94PSIwIDAgNjYgNjYiPjx1c2UgeGxpbms6aHJlZj0iI2EiIHg9Ii41IiB5PSIuNSIvPjxzeW1ib2wgaWQ9ImEiIG92ZXJmbG93PSJ2aXNpYmxlIj48ZyBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZT0ibm9uZSI+PHBhdGggZmlsbD0iIzM3YWVlMiIgZD0iTTAgMzJjMCAxNy42NzMgMTQuMzI3IDMyIDMyIDMyczMyLTE0LjMyNyAzMi0zMlM0OS42NzMgMCAzMiAwIDAgMTQuMzI3IDAgMzIiLz48cGF0aCBmaWxsPSIjYzhkYWVhIiBkPSJtMjEuNjYxIDM0LjMzOCAzLjc5NyAxMC41MDhzLjQ3NS45ODMuOTgzLjk4MyA4LjA2OC03Ljg2NCA4LjA2OC03Ljg2NGw4LjQwNy0xNi4yMzctMjEuMTE5IDkuODk4eiIvPjxwYXRoIGZpbGw9IiNhOWM2ZDgiIGQ9Im0yNi42OTUgMzcuMDM0LS43MjkgNy43NDZzLS4zMDUgMi4zNzMgMi4wNjggMGw0LjY0NC00LjIwMyIvPjxwYXRoIGQ9Im0yMS43MyAzNC43MTItNy44MDktMi41NDVzLS45MzItLjM3OC0uNjMzLTEuMjM3Yy4wNjItLjE3Ny4xODYtLjMyOC41NTktLjU4OCAxLjczMS0xLjIwNiAzMi4wMjgtMTIuMDk2IDMyLjAyOC0xMi4wOTZzLjg1Ni0uMjg4IDEuMzYxLS4wOTdjLjIzMS4wODguMzc4LjE4Ny41MDMuNTQ4LjA0NS4xMzIuMDcxLjQxMS4wNjguNjg5LS4wMDMuMjAxLS4wMjcuMzg2LS4wNDUuNjc4LS4xODQgMi45NzgtNS43MDYgMjUuMTk4LTUuNzA2IDI1LjE5OHMtLjMzIDEuMy0xLjUxNCAxLjM0NWMtLjQzMi4wMTYtLjk1Ni0uMDcxLTEuNTgyLS42MS0yLjMyMy0xLjk5OC0xMC4zNTItNy4zOTQtMTIuMTI2LTguNThhLjM0LjM0IDAgMCAxLS4xNDYtLjIzOWMtLjAyNS0uMTI1LjEwOC0uMjguMTA4LS4yOHMxMy45OC0xMi40MjcgMTQuMzUyLTEzLjczMWMuMDI5LS4xMDEtLjA3OS0uMTUxLS4yMjYtLjEwNy0uOTI5LjM0Mi0xNy4wMjUgMTAuNTA2LTE4LjgwMSAxMS42MjktLjEwNC4wNjYtLjM5NS4wMjMtLjM5NS4wMjMiLz48L2c+PC9zeW1ib2w+PC9zdmc+"
        },
        "displayName": "Telegram",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 6,
            "name": "Communication"
          },
          {
            "id": 28,
            "name": "HITL"
          }
        ]
      },
      {
        "id": 565,
        "icon": "fa:sticky-note",
        "name": "n8n-nodes-base.stickyNote",
        "codex": {
          "data": {
            "alias": [
              "Comments",
              "Notes",
              "Sticky"
            ],
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers"
              ]
            }
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Sticky Note",
          "color": "#FFD233"
        },
        "iconData": {
          "icon": "sticky-note",
          "type": "icon"
        },
        "displayName": "Sticky Note",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 834,
        "icon": "file:code.svg",
        "name": "n8n-nodes-base.code",
        "codex": {
          "data": {
            "alias": [
              "cpde",
              "Javascript",
              "JS",
              "Python",
              "Script",
              "Custom Code",
              "Function"
            ],
            "details": "The Code node allows you to execute JavaScript in your workflow.",
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.code/"
                }
              ]
            },
            "categories": [
              "Development",
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Helpers",
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Code"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8xMTcxXzQ0MSkiPgo8cGF0aCBkPSJNMTcwLjI4MyA0OEgxOTYuNUMyMDMuMTI3IDQ4IDIwOC41IDQyLjYyNzQgMjA4LjUgMzZWMTJDMjA4LjUgNS4zNzI1OCAyMDMuMTI3IDAgMTk2LjUgMEgxNzAuMjgzQzEyNi4xIDAgOTAuMjgzIDM1LjgxNzIgOTAuMjgzIDgwVjE3NkM5MC4yODMgMjA2LjkyOCA2NS4yMTA5IDIzMiAzNC4yODMgMjMySDIzQzE2LjM3MjYgMjMyIDExIDIzNy4zNzIgMTEgMjQ0VjI2OEMxMSAyNzQuNjI3IDE2LjM3MjQgMjgwIDIyLjk5OTYgMjgwTDM0LjI4MyAyODBDNjUuMjEwOSAyODAgOTAuMjgzIDMwNS4wNzIgOTAuMjgzIDMzNlY0NDBDOTAuMjgzIDQ3OS43NjQgMTIyLjUxOCA1MTIgMTYyLjI4MyA1MTJIMTk2LjVDMjAzLjEyNyA1MTIgMjA4LjUgNTA2LjYyNyAyMDguNSA1MDBWNDc2QzIwOC41IDQ2OS4zNzMgMjAzLjEyNyA0NjQgMTk2LjUgNDY0SDE2Mi4yODNDMTQ5LjAyOCA0NjQgMTM4LjI4MyA0NTMuMjU1IDEzOC4yODMgNDQwVjMzNkMxMzguMjgzIDMwOS4wMjIgMTI4LjAxMSAyODQuNDQzIDExMS4xNjQgMjY1Ljk2MUMxMDYuMTA5IDI2MC40MTYgMTA2LjEwOSAyNTEuNTg0IDExMS4xNjQgMjQ2LjAzOUMxMjguMDExIDIyNy41NTcgMTM4LjI4MyAyMDIuOTc4IDEzOC4yODMgMTc2VjgwQzEzOC4yODMgNjIuMzI2OSAxNTIuNjEgNDggMTcwLjI4MyA0OFoiIGZpbGw9IiNGRjk5MjIiLz4KPHBhdGggZD0iTTMwNSAzNkMzMDUgNDIuNjI3NCAzMTAuMzczIDQ4IDMxNyA0OEgzNDIuOTc5QzM2MC42NTIgNDggMzc0Ljk3OCA2Mi4zMjY5IDM3NC45NzggODBWMTc2QzM3NC45NzggMjAyLjk3OCAzODUuMjUxIDIyNy41NTcgNDAyLjA5OCAyNDYuMDM5QzQwNy4xNTMgMjUxLjU4NCA0MDcuMTUzIDI2MC40MTYgNDAyLjA5OCAyNjUuOTYxQzM4NS4yNTEgMjg0LjQ0MyAzNzQuOTc4IDMwOS4wMjIgMzc0Ljk3OCAzMzZWNDMyQzM3NC45NzggNDQ5LjY3MyAzNjAuNjUyIDQ2NCAzNDIuOTc5IDQ2NEgzMTdDMzEwLjM3MyA0NjQgMzA1IDQ2OS4zNzMgMzA1IDQ3NlY1MDBDMzA1IDUwNi42MjcgMzEwLjM3MyA1MTIgMzE3IDUxMkgzNDIuOTc5QzM4Ny4xNjEgNTEyIDQyMi45NzggNDc2LjE4MyA0MjIuOTc4IDQzMlYzMzZDNDIyLjk3OCAzMDUuMDcyIDQ0OC4wNTEgMjgwIDQ3OC45NzkgMjgwSDQ5MEM0OTYuNjI3IDI4MCA1MDIgMjc0LjYyOCA1MDIgMjY4VjI0NEM1MDIgMjM3LjM3MyA0OTYuNjI4IDIzMiA0OTAgMjMyTDQ3OC45NzkgMjMyQzQ0OC4wNTEgMjMyIDQyMi45NzggMjA2LjkyOCA0MjIuOTc4IDE3NlY4MEM0MjIuOTc4IDM1LjgxNzIgMzg3LjE2MSAwIDM0Mi45NzkgMEgzMTdDMzEwLjM3MyAwIDMwNSA1LjM3MjU4IDMwNSAxMlYzNloiIGZpbGw9IiNGRjk5MjIiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xMTcxXzQ0MSI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="
        },
        "displayName": "Code",
        "typeVersion": 2,
        "nodeCategories": [
          {
            "id": 5,
            "name": "Development"
          },
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 838,
        "icon": "fa:mouse-pointer",
        "name": "n8n-nodes-base.manualTrigger",
        "codex": {
          "data": {
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.manualworkflowtrigger/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0"
          }
        },
        "group": "[\"trigger\"]",
        "defaults": {
          "name": "When clicking ‘Execute workflow’",
          "color": "#909298"
        },
        "iconData": {
          "icon": "mouse-pointer",
          "type": "icon"
        },
        "displayName": "Manual Trigger",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 839,
        "icon": "fa:clock",
        "name": "n8n-nodes-base.scheduleTrigger",
        "codex": {
          "data": {
            "alias": [
              "Time",
              "Scheduler",
              "Polling",
              "Cron",
              "Interval"
            ],
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0"
          }
        },
        "group": "[\"trigger\",\"schedule\"]",
        "defaults": {
          "name": "Schedule Trigger",
          "color": "#31C49F"
        },
        "iconData": {
          "icon": "clock",
          "type": "icon"
        },
        "displayName": "Schedule Trigger",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 1225,
        "icon": "file:form.svg",
        "name": "n8n-nodes-base.formTrigger",
        "codex": {
          "data": {
            "alias": [
              "table",
              "submit",
              "post"
            ],
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.formtrigger/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Other Trigger Nodes"
              ]
            }
          }
        },
        "group": "[\"trigger\"]",
        "defaults": {
          "name": "On form submission"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NiIgaGVpZ2h0PSI0MCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwQjdCQyIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMzQuOTc4IDM3LjczMmExLjU2IDEuNTYgMCAwIDEtMS41NjIgMS41NjNINi4yNmExLjU2IDEuNTYgMCAwIDEtMS41NjMtMS41NjNWOS42MDdjMC0uNDA1LjE1Ny0uNzk0LjQzOC0xLjA4Nmw2LjMwNC02LjUzMXY1LjM0NEg4LjIxM2ExLjE3MiAxLjE3MiAwIDEgMCAwIDIuMzQzaDQuNDNhMS4xNyAxLjE3IDAgMCAwIDEuMTcxLTEuMTcxVi4yMzJoMTkuNjAyYTEuNTYgMS41NiAwIDAgMSAxLjU2MiAxLjU2M3YxMC4zMjdsLTIuODYgMi44Ni04LjI1MiA4LjI3NmE0MTMuMDA2IDQxMy4wMDYgMCAwIDEtMS42NTQgMS42NjJsLS4zMzcuMzM3YTIgMiAwIDAgMC0uNTU3IDEuMDhMMjAuMyAzMS45MjJjLS4xMDguNjM4LS4yMTUgMS4wNzkuMjExIDEuNDE4LjQwMy4zMi45LjE3NCAxLjU0LjA2Nmw1LjQwOC0uOTI4YTIgMiAwIDAgMCAxLjA4LS41NTZsNi40NC02LjQyOXptLTI0LjAzLTIxLjI2NWExLjE4IDEuMTggMCAwIDAgMS4xNzEgMS4xNzJoMTMuMTYzYTEuMTcyIDEuMTcyIDAgMSAwIDAtMi4zNDRIMTIuMTE5YTEuMTcgMS4xNyAwIDAgMC0xLjE3MiAxLjE3Mm03LjI5NCAxNC43NjZhMS4xNyAxLjE3IDAgMCAwLTEuMTcyLTEuMTcySDEyLjEyYTEuMTcyIDEuMTcyIDAgMSAwIDAgMi4zNDNoNC45NTFhMS4xNyAxLjE3IDAgMCAwIDEuMTcyLTEuMTcybS44Ni03LjM5MWExLjE3IDEuMTcgMCAwIDAtMS4xNzItMS4xNzJoLTUuODExYTEuMTcyIDEuMTcyIDAgMSAwIDAgMi4zNDNoNS44MWExLjE2NCAxLjE2NCAwIDAgMCAxLjE3My0xLjE3MSIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwQjdCQyIgZD0ibTMzLjUzMiAxNi4zOTcgNC4yODktNC4yODkgMy43NTggMy43MSAxLjYxNy0xLjYxNiAyLjI1OCAyLjI1N2MuMjE4LjIxOC4zNC41MTMuMzQzLjgyLS4wMDIuMzExLS4xMjUuNjA4LS4zNDQuODNsLTYuODA0IDYuNzk2YTEuMTMgMS4xMyAwIDAgMS0uODI4LjM0MyAxLjE1IDEuMTUgMCAwIDEtLjgyOC0uMzQzIDEuMTggMS4xOCAwIDAgMSAwLTEuNjU3bDUuOTc2LTUuOTY4LTEuMzEyLTEuMzEzLTEuMzgzIDEuNDE0LTEzLjE0OSAxMy4xMjUtNC42MTcuNzgyLjc4Mi00LjYxNy4zMzYtLjMzNyAyLjU2MiAyLjU1NWExLjEgMS4xIDAgMCAwIC44MjguMzQ0Yy4zMTIuMDA1LjYxMi0uMTIuODI4LS4zNDRhMS4xOCAxLjE4IDAgMCAwIDAtMS42NTZsLTIuNTYyLTIuNTYyek00NC43MzYgMTIuMjRjMCAuNDE0LS4xNjMuODEtLjQ1NCAxLjEwMmwtLjkyMi45MTQtMy44NTItMy44MjguOTMtLjkzYTEuNTYzIDEuNTYzIDAgMCAxIDIuMjAzIDBsMS42NCAxLjY0MWMuMjkxLjI5My40NTUuNjkuNDU1IDEuMTAyIi8+PC9zdmc+"
        },
        "displayName": "n8n Form Trigger",
        "typeVersion": 3,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 1233,
        "icon": "file:readWriteFile.svg",
        "name": "n8n-nodes-base.readWriteFile",
        "codex": {
          "data": {
            "alias": [
              "Binary",
              "File",
              "Text",
              "Open",
              "Import",
              "Save",
              "Export",
              "Disk",
              "Transfer"
            ],
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.readwritefile/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Files"
              ]
            }
          }
        },
        "group": "[\"input\"]",
        "defaults": {
          "name": "Read/Write Files from Disk"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8xMTQxXzE1NDcpIj4KPHBhdGggZD0iTTAgMTJDMCA1LjM3MjU4IDUuMzcyNTggMCAxMiAwSDE1OVYxNTRDMTU5IDE2MC42MjcgMTY0LjM3MyAxNjYgMTcxIDE2NkgzMjVWMjQySDIyOC41NjJDMjEwLjg5NSAyNDIgMTk0LjY1NiAyNTEuNzA1IDE4Ni4yODggMjY3LjI2NEwxMjkuMjAzIDM3My40MDdDMTI1LjEzMSAzODAuOTc4IDEyMyAzODkuNDQgMTIzIDM5OC4wMzdWNDM0SDEyQzUuMzcyNTcgNDM0IDAgNDI4LjYyNyAwIDQyMlYxMloiIGZpbGw9IiM0NEFBNDQiLz4KPHBhdGggZD0iTTMyNSAxMzRWMTI3LjQwMUMzMjUgMTI0LjIyMyAzMjMuNzQgMTIxLjE3NSAzMjEuNDk1IDExOC45MjVMMjA2LjM2OSAzLjUyNDgxQzIwNC4xMTggMS4yNjgyIDIwMS4wNjEgMCAxOTcuODczIDBIMTkxVjEzNEgzMjVaIiBmaWxsPSIjNDRBQTQ0Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjI4LjU2MyAyNzRDMjIyLjY3NCAyNzQgMjE3LjI2MSAyNzcuMjM1IDIxNC40NzIgMjgyLjQyMUwxNzIuMjExIDM2MUg0OTIuNjRMNDQ0LjY3IDI4MS43MTdDNDQxLjc3MiAyNzYuOTI3IDQzNi41OCAyNzQgNDMwLjk4MSAyNzRIMjI4LjU2M1oiIGZpbGw9IiM0NEFBNDQiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNTUgNDA5QzE1NSA0MDAuMTYzIDE2Mi4xNjMgMzkzIDE3MSAzOTNINDk2QzUwNC44MzcgMzkzIDUxMiA0MDAuMTYzIDUxMiA0MDlWNDk2QzUxMiA1MDQuODM3IDUwNC44MzcgNTEyIDQ5NiA1MTJIMTcxQzE2Mi4xNjMgNTEyIDE1NSA1MDQuODM3IDE1NSA0OTZWNDA5Wk0zOTcgNDUzQzM5NyA0NjYuMjU1IDM4Ni4yNTUgNDc3IDM3MyA0NzdDMzU5Ljc0NSA0NzcgMzQ5IDQ2Ni4yNTUgMzQ5IDQ1M0MzNDkgNDM5Ljc0NSAzNTkuNzQ1IDQyOSAzNzMgNDI5QzM4Ni4yNTUgNDI5IDM5NyA0MzkuNzQ1IDM5NyA0NTNaTTQ0NSA0NzdDNDU4LjI1NSA0NzcgNDY5IDQ2Ni4yNTUgNDY5IDQ1M0M0NjkgNDM5Ljc0NSA0NTguMjU1IDQyOSA0NDUgNDI5QzQzMS43NDUgNDI5IDQyMSA0MzkuNzQ1IDQyMSA0NTNDNDIxIDQ2Ni4yNTUgNDMxLjc0NSA0NzcgNDQ1IDQ3N1oiIGZpbGw9IiM0NEFBNDQiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xMTQxXzE1NDciPgo8cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K"
        },
        "displayName": "Read/Write Files from Disk",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      },
      {
        "id": 1236,
        "icon": "file:aggregate.svg",
        "name": "n8n-nodes-base.aggregate",
        "codex": {
          "data": {
            "alias": [
              "Aggregate",
              "Combine",
              "Flatten",
              "Transform",
              "Array",
              "List",
              "Item"
            ],
            "details": "",
            "resources": {
              "generic": [],
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.aggregate/"
                }
              ]
            },
            "categories": [
              "Core Nodes"
            ],
            "nodeVersion": "1.0",
            "codexVersion": "1.0",
            "subcategories": {
              "Core Nodes": [
                "Data Transformation"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Aggregate"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSJub25lIj48ZyBmaWxsPSIjRkY2RDVBIiBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTMyIDE0OGMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDE0NmM2LjYyNyAwIDEyIDUuMzczIDEyIDEydjI0YzAgNi42MjctNS4zNzMgMTItMTIgMTJINDRjLTYuNjI3IDAtMTItNS4zNzMtMTItMTJ6bTAgOTZjMC02LjYyNyA1LjM3My0xMiAxMi0xMmgxNDZjNi42MjcgMCAxMiA1LjM3MyAxMiAxMnYyNGMwIDYuNjI3LTUuMzczIDEyLTEyIDEySDQ0Yy02LjYyNyAwLTEyLTUuMzczLTEyLTEyem0wIDk2YzAtNi42MjcgNS4zNzMtMTIgMTItMTJoMTQ2YzYuNjI3IDAgMTIgNS4zNzMgMTIgMTJ2MjRjMCA2LjYyNy01LjM3MyAxMi0xMiAxMkg0NGMtNi42MjcgMC0xMi01LjM3My0xMi0xMnoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGQ9Ik03NCA3NmMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDExNi4yMTdjMTcuNjczIDAgMzIgMTQuMzI3IDMyIDMydjU2YzAgMjYuOTc4IDEwLjI3MiA1MS41NTcgMjcuMTE5IDcwLjAzOSA1LjA1NSA1LjU0NSA1LjA1NSAxNC4zNzcgMCAxOS45MjItMTYuODQ3IDE4LjQ4Mi0yNy4xMTkgNDMuMDYxLTI3LjExOSA3MC4wMzl2NTZjMCAxNy42NzMtMTQuMzI3IDMyLTMyIDMySDg2Yy02LjYyNyAwLTEyIDUuMzczLTEyIDEydjI0YzAgNi42MjcgNS4zNzMgMTIgMTIgMTJoMTE2LjIxN2M0NC4xODMgMCA4MC0zNS44MTcgODAtODB2LTU2YzAtMzAuOTI4IDI1LjA3Mi01NiA1Ni01NmE1Ljc4MyA1Ljc4MyAwIDAgMCA1Ljc4My01Ljc4M3YtMzYuNDM0YTUuNzgzIDUuNzgzIDAgMCAwLTUuNzgzLTUuNzgzYy0zMC45MjggMC01Ni0yNS4wNzItNTYtNTZ2LTU2YzAtNDQuMTgzLTM1LjgxNy04MC04MC04MEg4NmMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnoiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zNzYgMjQ0YzAtNi42MjcgNS4zNzMtMTIgMTItMTJoMTEyYzYuNjI3IDAgMTIgNS4zNzMgMTIgMTJ2MjRjMCA2LjYyNy01LjM3MyAxMi0xMiAxMkgzODhjLTYuNjI3IDAtMTItNS4zNzMtMTItMTJ6IiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L2c+PGRlZnM+PGNsaXBQYXRoIGlkPSJhIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDUxMnY1MTJIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L3N2Zz4="
        },
        "displayName": "Aggregate",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          }
        ]
      }
    ],
    "categories": [
      {
        "id": 29,
        "name": "SecOps"
      }
    ],
    "image": []
  }
}