{
  "id": 9151,
  "slug": "9151",
  "title": "Complete backup solution for n8n workflows & credentials (local/FTP)",
  "description": "## Automated n8n Workflows & Credentials Backup to Local/Server Disk & FTP\n\nComplete backup solution that saves both workflows and credentials to local/server disk with optional FTP upload for off-site redundancy.\n\n**What makes this workflow different:**\n* Backs up workflows AND credentials together\n* Saves to **local/server** disk (not Git, GitHub, or any cloud services)\n* Optional **FTP upload** for redundancy (disabled by default)\n* Comprehensive error handling and email notifications\n* **Timezone-aware** scheduling\n* Ready to use with minimal configuration\n\n### How it works\n\n**Backup Process (Automated Daily at 4 AM):**\n1. **Initialisation** - Sets up timezone-aware timestamps and configurable backup paths for both local/server disk and FTP destinations\n2. **Folder Creation** - Creates date-stamped backup directories (YYYY-MM-DD format) on local/server disk\n3. **Dual Backup Operations** - Processes credentials and workflows in two separate branches:\n   - **Credentials Branch**:\n     - Exports n8n credentials using the built-in CLI command with backup flag\n     - Lists exported credential files in the credentials folder\n     - Reads each credential file from disk\n     - *Optional*: Uploads to FTP server (disabled by default)\n     - *Optional*: Logs FTP upload results for credentials\n   - **Workflows Branch**:\n     - Retrieves all workflows via n8n API\n     - Cleans workflow names for cross-platform compatibility\n     - Converts workflows to formatted JSON files\n     - Writes files to local/server disk\n     - *Optional*: Uploads to FTP server (disabled by default)\n     - *Optional*: Logs FTP upload results for workflows\n4. **Data Aggregation** - Combines all workflow data with binary attachments for comprehensive reporting\n5. **Results Merging** - Consolidates credentials FTP logs, workflows FTP logs, and aggregated workflow data\n6. **Summary Generation** - Creates detailed backup logs including:\n   - Statistics (file counts, sizes, durations)\n   - Success/failure tracking for local and FTP operations\n   - Error tracking with detailed messages\n   - Timezone-aware timestamps\n7. **Notifications** - Sends comprehensive email reports with log files attached and saves execution logs to disk\n\n### How to use\n\n**Initial Setup:**\n\n1. **Configure the Init Node** - Open the \"Init\" node and customize these key parameters in the \"Workflow Standard Configuration\" section:\n   ```javascript\n   // Admin email for notifications\n   const N8N_ADMIN_EMAIL = $env.N8N_ADMIN_EMAIL || 'youremail@world.com';\n   \n   // Workflow name (auto-detected)\n   const WORKFLOW_NAME = $workflow.name;\n   \n   // Projects root directory on your server\n   const N8N_PROJECTS_DIR = $env.N8N_PROJECTS_DIR || '/files/n8n-projects-data';\n   // projects-root-folder/\n   //   └── Your-project-folder-name/\n   //       ├── logs/\n   //       ├── reports/\n   //       ├── ...\n   //       └── [other project files]\n   \n   // Project folder name for this backup workflow\n   const PROJECT_FOLDER_NAME = \"Workflow-backups\";\n   ```\n   \n   Then customize these parameters in the \"Workflow Custom Configuration\" section:\n   ```javascript\n   // Local backup folder (must exist on your server)\n   const BACKUP_FOLDER = $env.N8N_BACKUP_FOLDER || '/files/n8n-backups';\n   \n   // FTP backup folder (root path on your FTP server)\n   const FTP_BACKUP_FOLDER = $env.N8N_FTP_BACKUP_FOLDER || '/n8n-backups';\n   \n   // FTP server name for logging (display purposes only)\n   const FTPName = 'Synology NAS 2To';\n   ```\n   \n   These variables can also be set as environment variables in your n8n configuration.\n\n2. **Set Up Credentials:**\n   - Configure n8n API credentials for the \"Fetch Workflows\" node\n   - Configure SMTP credentials for email notifications\n   - *Optional*: Configure FTP credentials if you want to enable off-site backups\n\n3. **Configure Backup Folder:**\n   - Ensure the backup folder path exists on your server\n   - Verify proper write permissions for the n8n process\n   - If running in Docker, ensure volume mapping is correctly configured\n\n4. **Customize Email Settings:**\n   - Update the \"Send email\" node with your recipient email address or your \"N8N_ADMIN_EMAIL\" environment value\n   - Adjust email subject and body text as needed\n\n**Enabling FTP Upload (Optional):**\n\nBy default, FTP upload nodes are disabled for easier setup. To enable off-site FTP backups:\n\n1. **Simply activate these 4 nodes** (no other changes needed):\n   - \"Upload Credentials To FTP\"\n   - \"FTP Logger (credentials)\"\n   - \"Upload Workflows To FTP\"  \n   - \"FTP Logger (workflows)\"\n\n2. **Configure FTP credentials** in the two upload nodes\n\n3. The workflow will automatically handle FTP operations and include upload status in reports\n\n### Requirements\n- n8n API credentials (for workflow fetching)\n- SMTP server configuration (for email notifications)\n- Adequate disk space for local backup storage\n- Proper file system permissions for backup folder access\n- Docker environment with volume mapping (if running n8n in Docker)\n- *Optional*: FTP server access and credentials (for off-site backups)\n\n### Good to know\n\n- **Security**: Credentials are exported using n8n's secure backup format - actual credential values are not exposed in plain text\n- **Timezone Handling**: All timestamps respect configured timezone settings (defaults to Europe/Paris, configurable in Init node)\n- **File Naming**: Automatic sanitization ensures backup files work across different operating systems (removes forbidden characters, limits length to 180 characters)\n- **FTP Upload**: Disabled by default for easier setup - simply activate 4 nodes to enable off-site backups without any code changes\n- **Connection Resilience**: FTP operations include error handling for timeout and connection issues without failing the entire backup\n- **Graceful Degradation**: If FTP nodes are disabled, the workflow completes successfully with local backups only and indicates FTP status in logs\n- **Error Handling**: Comprehensive error catching with detailed logging and email notifications\n- **Dual Logging**: Creates both JSON logs (for programmatic parsing) and plain text logs (for human readability)\n- **Storage**: Individual workflow JSON files allow for selective restore and easier version control integration\n- **Scalability**: Handles any number of workflows efficiently with detailed progress tracking\n---\n\n*This automated backup workflow saves your n8n data to both local disk and FTP server. To restore your backups, use:*\n- [*\"n8n Restore from Disk - Self-Hosted Solution\" for local/server disk restores*](https://n8n.io/workflows/9154-automated-workflow-and-credential-restoration-system-for-self-hosted-environments/)\n- [*\"n8n Restore from FTP - Remote Backup Solution\" for FTP remote restores*](https://n8n.io/workflows/9156-restore-workflows-and-credentials-from-remote-ftp-backup-storage/)\n",
  "featuredImage": "/data/workflows/9151/9151.webp",
  "author": {
    "id": 101,
    "slug": "florent",
    "name": "Florent",
    "avatar": ""
  },
  "categories": [
    "DevOps"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1513,
  "downloads": 151,
  "createdAt": "2025-10-01T12:05:26.763Z",
  "updatedAt": "2026-01-16T08:59:14.830Z",
  "publishedAt": "2025-10-01T12:05:26.763Z",
  "nodes": 28,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9151",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Complete backup solution for n8n workflows & credentials (local/FTP)",
    "workflowName": "Complete backup solution for n8n workflows & credentials (local/FTP)",
    "description": "## Automated n8n Workflows & Credentials Backup to Local/Server Disk & FTP\n\nComplete backup solution that saves both workflows and credentials to local/server disk with optional FTP upload for off-site redundancy.\n\n**What makes this workflow different:**\n* Backs up workflows AND credentials together\n* Saves to **local/server** disk (not Git, GitHub, or any cloud services)\n* Optional **FTP upload** for redundancy (disabled by default)\n* Comprehensive error handling and email notifications\n* **Timezone-aware** scheduling\n* Ready to use with minimal configuration\n\n### How it works\n\n**Backup Process (Automated Daily at 4 AM):**\n1. **Initialisation** - Sets up timezone-aware timestamps and configurable backup paths for both local/server disk and FTP destinations\n2. **Folder Creation** - Creates date-stamped backup directories (YYYY-MM-DD format) on local/server disk\n3. **Dual Backup Operations** - Processes credentials and workflows in two separate branches:\n   - **Credentials Branch**:\n     - Exports n8n credentials using the built-in CLI command with backup flag\n     - Lists exported credential files in the credentials folder\n     - Reads each credential file from disk\n     - *Optional*: Uploads to FTP server (disabled by default)\n     - *Optional*: Logs FTP upload results for credentials\n   - **Workflows Branch**:\n     - Retrieves all workflows via n8n API\n     - Cleans workflow names for cross-platform compatibility\n     - Converts workflows to formatted JSON files\n     - Writes files to local/server disk\n     - *Optional*: Uploads to FTP server (disabled by default)\n     - *Optional*: Logs FTP upload results for workflows\n4. **Data Aggregation** - Combines all workflow data with binary attachments for comprehensive reporting\n5. **Results Merging** - Consolidates credentials FTP logs, workflows FTP logs, and aggregated workflow data\n6. **Summary Generation** - Creates detailed backup logs including:\n   - Statistics (file counts, sizes, durations)\n   - Success/failure tracking for local and FTP operations\n   - Error tracking with detailed messages\n   - Timezone-aware timestamps\n7. **Notifications** - Sends comprehensive email reports with log files attached and saves execution logs to disk\n\n### How to use\n\n**Initial Setup:**\n\n1. **Configure the Init Node** - Open the \"Init\" node and customize these key parameters in the \"Workflow Standard Configuration\" section:\n   ```javascript\n   // Admin email for notifications\n   const N8N_ADMIN_EMAIL = $env.N8N_ADMIN_EMAIL || 'youremail@world.com';\n   \n   // Workflow name (auto-detected)\n   const WORKFLOW_NAME = $workflow.name;\n   \n   // Projects root directory on your server\n   const N8N_PROJECTS_DIR = $env.N8N_PROJECTS_DIR || '/files/n8n-projects-data';\n   // projects-root-folder/\n   //   └── Your-project-folder-name/\n   //       ├── logs/\n   //       ├── reports/\n   //       ├── ...\n   //       └── [other project files]\n   \n   // Project folder name for this backup workflow\n   const PROJECT_FOLDER_NAME = \"Workflow-backups\";\n   ```\n   \n   Then customize these parameters in the \"Workflow Custom Configuration\" section:\n   ```javascript\n   // Local backup folder (must exist on your server)\n   const BACKUP_FOLDER = $env.N8N_BACKUP_FOLDER || '/files/n8n-backups';\n   \n   // FTP backup folder (root path on your FTP server)\n   const FTP_BACKUP_FOLDER = $env.N8N_FTP_BACKUP_FOLDER || '/n8n-backups';\n   \n   // FTP server name for logging (display purposes only)\n   const FTPName = 'Synology NAS 2To';\n   ```\n   \n   These variables can also be set as environment variables in your n8n configuration.\n\n2. **Set Up Credentials:**\n   - Configure n8n API credentials for the \"Fetch Workflows\" node\n   - Configure SMTP credentials for email notifications\n   - *Optional*: Configure FTP credentials if you want to enable off-site backups\n\n3. **Configure Backup Folder:**\n   - Ensure the backup folder path exists on your server\n   - Verify proper write permissions for the n8n process\n   - If running in Docker, ensure volume mapping is correctly configured\n\n4. **Customize Email Settings:**\n   - Update the \"Send email\" node with your recipient email address or your \"N8N_ADMIN_EMAIL\" environment value\n   - Adjust email subject and body text as needed\n\n**Enabling FTP Upload (Optional):**\n\nBy default, FTP upload nodes are disabled for easier setup. To enable off-site FTP backups:\n\n1. **Simply activate these 4 nodes** (no other changes needed):\n   - \"Upload Credentials To FTP\"\n   - \"FTP Logger (credentials)\"\n   - \"Upload Workflows To FTP\"  \n   - \"FTP Logger (workflows)\"\n\n2. **Configure FTP credentials** in the two upload nodes\n\n3. The workflow will automatically handle FTP operations and include upload status in reports\n\n### Requirements\n- n8n API credentials (for workflow fetching)\n- SMTP server configuration (for email notifications)\n- Adequate disk space for local backup storage\n- Proper file system permissions for backup folder access\n- Docker environment with volume mapping (if running n8n in Docker)\n- *Optional*: FTP server access and credentials (for off-site backups)\n\n### Good to know\n\n- **Security**: Credentials are exported using n8n's secure backup format - actual credential values are not exposed in plain text\n- **Timezone Handling**: All timestamps respect configured timezone settings (defaults to Europe/Paris, configurable in Init node)\n- **File Naming**: Automatic sanitization ensures backup files work across different operating systems (removes forbidden characters, limits length to 180 characters)\n- **FTP Upload**: Disabled by default for easier setup - simply activate 4 nodes to enable off-site backups without any code changes\n- **Connection Resilience**: FTP operations include error handling for timeout and connection issues without failing the entire backup\n- **Graceful Degradation**: If FTP nodes are disabled, the workflow completes successfully with local backups only and indicates FTP status in logs\n- **Error Handling**: Comprehensive error catching with detailed logging and email notifications\n- **Dual Logging**: Creates both JSON logs (for programmatic parsing) and plain text logs (for human readability)\n- **Storage**: Individual workflow JSON files allow for selective restore and easier version control integration\n- **Scalability**: Handles any number of workflows efficiently with detailed progress tracking\n---\n\n*This automated backup workflow saves your n8n data to both local disk and FTP server. To restore your backups, use:*\n- [*\"n8n Restore from Disk - Self-Hosted Solution\" for local/server disk restores*](https://n8n.io/workflows/9154-automated-workflow-and-credential-restoration-system-for-self-hosted-environments/)\n- [*\"n8n Restore from FTP - Remote Backup Solution\" for FTP remote restores*](https://n8n.io/workflows/9156-restore-workflows-and-credentials-from-remote-ftp-backup-storage/)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Backup Summary",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Write Backup Log",
      "type": "n8n-nodes-base.readWriteFile",
      "role": "readWriteFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Send email",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Write Email Log",
      "type": "n8n-nodes-base.readWriteFile",
      "role": "readWriteFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Create Date Folder",
      "type": "n8n-nodes-base.executeCommand",
      "role": "executeCommand",
      "configDescription": "Version 1"
    },
    {
      "name": "Init",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Daily Backup",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Fetch Workflows",
      "type": "n8n-nodes-base.n8n",
      "role": "n8n",
      "configDescription": "Version 1"
    },
    {
      "name": "Clean Filename",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Write Each Workflow To Disk",
      "type": "n8n-nodes-base.readWriteFile",
      "role": "readWriteFile",
      "configDescription": "Version 1"
    },
    {
      "name": "ERROR: Backup Summary",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "ERROR: Clean Filename",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "Read/Write Files from Disk",
      "type": "n8n-nodes-base.readWriteFile",
      "role": "readWriteFile",
      "configDescription": "Version 1"
    },
    {
      "name": "List Credential Files",
      "type": "n8n-nodes-base.executeCommand",
      "role": "executeCommand",
      "configDescription": "Version 1"
    },
    {
      "name": "Output Credential Items",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Upload Credentials To FTP",
      "type": "n8n-nodes-base.ftp",
      "role": "ftp",
      "configDescription": "Version 1"
    },
    {
      "name": "FTP Logger (credentials)",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "FTP Logger (workflows)",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Export Credentials",
      "type": "n8n-nodes-base.executeCommand",
      "role": "executeCommand",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload Workflows To FTP",
      "type": "n8n-nodes-base.ftp",
      "role": "ftp",
      "configDescription": "Version 1"
    }
  ]
}