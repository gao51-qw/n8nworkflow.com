{
  "id": 4797,
  "slug": "4797",
  "title": "Track CVE vulnerability details & history with NVD API and Google Sheets",
  "description": "## Who is this for?\n\nNVD (National Vulnerability Database) data is essential for security analysts, vulnerability managers, and DevSecOps professionals who need to perform both CVE lookups and monitor historical change logs. This workflow helps streamline those efforts by providing structured outputs for audit, triage, or compliance tracking purposes.\n\nüìù Note: While this example uses Google Sheets as the destination, you can easily modify the final destination node (e.g., send to Slack, email, database, etc.) based on your specific automation needs.?\n\n## What problem is this solving?\n\nSecurity teams often manually look up CVE data and track changes across multiple tools. This process is inefficient and error-prone. This workflow automates the CVE lookup and historical change tracking by logging enriched vulnerability data into Google Sheets in real-time.\n\n## What this workflow does\n\nThis workflow is designed for CVE API lookup and change history tracking. In many vulnerability automation pipelines, it is essential to determine not only the metadata of a CVE but also how it has evolved over time. Based on the operational need‚Äîwhether it's enrichment, risk scoring, or remediation validation‚Äîthis workflow becomes particularly handy in surfacing both current and historical CVE data. This template performs the following actions:\n\n* Accepts incoming webhook requests containing a CVE ID\n* Queries the NVD CVE Lookup API to fetch vulnerability metadata\n* Queries the NVD CVE History API to retrieve all historical changes\n* Flattens both datasets into a sheet-compatible structure\n* Appends vulnerability metadata to one sheet and change history to another within the same Google Spreadsheet\n\n## Setup\n\nüîë Request an NVD API Key\n\nTo request an NVD API Key, please provide your organization name, a valid email address, and indicate your organization type at [NVD API Key Request](https://nvd.nist.gov/developers/request-an-api-key). You must scroll to the end of the Terms of Use Agreement and check \"I agree to the Terms of Use\" to obtain an API Key. After submission, you will receive a single-use hyperlink via email to activate and view your API Key. If not activated within seven days, a new request must be submitted.\n\nüìä API Rate Limits\n\nWithout an API key, you're limited to 5 requests per 30-second window. With an API key, you‚Äôre allowed up to 50 requests in the same period. To prevent request throttling, it's recommended to introduce slight delays between consecutive API calls in production setups.\n\n1. Clone or import this workflow into your n8n instance.\n2. Set up the following credentials:\n   * Google Sheets OAuth2\n   * NVD API Key (via HTTP Header Auth)\n3. The workflow logs data to a Google Sheet titled **NVD Database**, with Sheet 1 named **CVE Lookup** and Sheet 2 named **CVE History**.\n4. Trigger each workflow using the respective webhook URL, appending `?cveId=CVE-XXXX-XXXX` as a query parameter.\n\n### üîç Example Webhook Request (CVE Change History)\n\nYou can test this workflow with the following example:\n\n```\nGET https://your-domain.com/webhook/cve-history?cveId=CVE-2023-34362\n```\n\n## How to customize this workflow\n\n* Use the `Edit Fields` node (optional) to centralize configuration like sheet name or query input\n* Extend the CVE flattening logic to include more nested metadata if needed\n* Integrate notification systems (e.g., Slack or email) by branching from the processing nodes\n* Modify webhook paths for better endpoint organization\n\n## üîê Production Security Tips\n\n* Use **HTTP Header Auth** on the webhook for secure access\n\n&gt; ‚ö†Ô∏è **This template uses webhooks and NVD API access with authentication headers.**\n\n---\n\nThis template uses two flows:\n\n* **Webhook 1:** `NVD CVE Lookup` ‚Äî Lookup CVE vulnerability metadata from NVD and sync to Google Sheet\n* **Webhook 2:** `NVD CVE Change History` ‚Äî Track change history for CVEs via NVD and log each update\n\nEach flow:\n\n* Hits NVD‚Äôs respective endpoint\n* Uses custom JS Code node to flatten the nested JSON\n* Syncs data to dedicated Google Sheet tabs\n* üß© 4 nodes: Webhook ‚Üí API Call ‚Üí Parse ‚Üí Sheet Sync\n\nMake sure both flows are activated and webhooks exposed for external access. Based on your needs, ensure you have a secure setup‚Äîwhether hosted internally or in a cloud environment‚Äîwhen running n8n in production.",
  "featuredImage": "/data/workflows/4797/4797.webp",
  "author": {
    "id": 101,
    "slug": "niranjan",
    "name": "Niranjan G",
    "avatar": ""
  },
  "categories": [
    "SecOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 3405,
  "downloads": 340,
  "createdAt": "2025-06-08T15:14:27.731Z",
  "updatedAt": "2026-01-16T08:36:16.312Z",
  "publishedAt": "2025-06-08T15:14:27.731Z",
  "nodes": 13,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4797",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Track CVE vulnerability details & history with NVD API and Google Sheets",
    "workflowName": "Track CVE vulnerability details & history with NVD API and Google Sheets",
    "description": "## Who is this for?\n\nNVD (National Vulnerability Database) data is essential for security analysts, vulnerability managers, and DevSecOps professionals who need to perform both CVE lookups and monitor historical change logs. This workflow helps streamline those efforts by providing structured outputs for audit, triage, or compliance tracking purposes.\n\nüìù Note: While this example uses Google Sheets as the destination, you can easily modify the final destination node (e.g., send to Slack, email, database, etc.) based on your specific automation needs.?\n\n## What problem is this solving?\n\nSecurity teams often manually look up CVE data and track changes across multiple tools. This process is inefficient and error-prone. This workflow automates the CVE lookup and historical change tracking by logging enriched vulnerability data into Google Sheets in real-time.\n\n## What this workflow does\n\nThis workflow is designed for CVE API lookup and change history tracking. In many vulnerability automation pipelines, it is essential to determine not only the metadata of a CVE but also how it has evolved over time. Based on the operational need‚Äîwhether it's enrichment, risk scoring, or remediation validation‚Äîthis workflow becomes particularly handy in surfacing both current and historical CVE data. This template performs the following actions:\n\n* Accepts incoming webhook requests containing a CVE ID\n* Queries the NVD CVE Lookup API to fetch vulnerability metadata\n* Queries the NVD CVE History API to retrieve all historical changes\n* Flattens both datasets into a sheet-compatible structure\n* Appends vulnerability metadata to one sheet and change history to another within the same Google Spreadsheet\n\n## Setup\n\nüîë Request an NVD API Key\n\nTo request an NVD API Key, please provide your organization name, a valid email address, and indicate your organization type at [NVD API Key Request](https://nvd.nist.gov/developers/request-an-api-key). You must scroll to the end of the Terms of Use Agreement and check \"I agree to the Terms of Use\" to obtain an API Key. After submission, you will receive a single-use hyperlink via email to activate and view your API Key. If not activated within seven days, a new request must be submitted.\n\nüìä API Rate Limits\n\nWithout an API key, you're limited to 5 requests per 30-second window. With an API key, you‚Äôre allowed up to 50 requests in the same period. To prevent request throttling, it's recommended to introduce slight delays between consecutive API calls in production setups.\n\n1. Clone or import this workflow into your n8n instance.\n2. Set up the following credentials:\n   * Google Sheets OAuth2\n   * NVD API Key (via HTTP Header Auth)\n3. The workflow logs data to a Google Sheet titled **NVD Database**, with Sheet 1 named **CVE Lookup** and Sheet 2 named **CVE History**.\n4. Trigger each workflow using the respective webhook URL, appending `?cveId=CVE-XXXX-XXXX` as a query parameter.\n\n### üîç Example Webhook Request (CVE Change History)\n\nYou can test this workflow with the following example:\n\n```\nGET https://your-domain.com/webhook/cve-history?cveId=CVE-2023-34362\n```\n\n## How to customize this workflow\n\n* Use the `Edit Fields` node (optional) to centralize configuration like sheet name or query input\n* Extend the CVE flattening logic to include more nested metadata if needed\n* Integrate notification systems (e.g., Slack or email) by branching from the processing nodes\n* Modify webhook paths for better endpoint organization\n\n## üîê Production Security Tips\n\n* Use **HTTP Header Auth** on the webhook for secure access\n\n&gt; ‚ö†Ô∏è **This template uses webhooks and NVD API access with authentication headers.**\n\n---\n\nThis template uses two flows:\n\n* **Webhook 1:** `NVD CVE Lookup` ‚Äî Lookup CVE vulnerability metadata from NVD and sync to Google Sheet\n* **Webhook 2:** `NVD CVE Change History` ‚Äî Track change history for CVEs via NVD and log each update\n\nEach flow:\n\n* Hits NVD‚Äôs respective endpoint\n* Uses custom JS Code node to flatten the nested JSON\n* Syncs data to dedicated Google Sheet tabs\n* üß© 4 nodes: Webhook ‚Üí API Call ‚Üí Parse ‚Üí Sheet Sync\n\nMake sure both flows are activated and webhooks exposed for external access. Based on your needs, ensure you have a secure setup‚Äîwhether hosted internally or in a cloud environment‚Äîwhen running n8n in production.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Webhook: Get CVE Details",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Fetch CVE from NVD API",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Parse CVE JSON ‚Üí Flat Format",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Log CVE Metadata to Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Webhook: Get CVE Change History",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Fetch CVE History from NVD API",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Parse CVE History JSON ‚Üí Flat Format",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Log CVE History to Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}