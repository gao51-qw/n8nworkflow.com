{
  "id": 10199,
  "slug": "10199",
  "title": "Predict customer churn with AI analysis of HubSpot and Google Sheets data",
  "description": "## Who it’s for\nBuilt for Customer Success and Account Management teams focused on proactive retention. This workflow helps you automatically identify at-risk customers – before they churn – by combining CRM, usage, and sentiment data into one actionable alert.\n\n## What it does\nThis end-to-end workflow continuously monitors customer health by consolidating data from HubSpot and Google Sheets.\nHere’s how it works:\n* Fetch deals from HubSpot.\n* Collect context — linked support tickets and feature usage from a Google Sheet.\n* Run sentiment analysis on the tickets to generate a customer health score.\n* Evaluate risk — an AI agent reviews deal age, sentiment score, and usage trends against predefined thresholds.\n* Send alerts — if churn risk is detected, it automatically sends a clear, data-driven email to the responsible team member with next-step recommendations.\n\n## How to set it up\nTo get started, configure your credentials and parameters in the following nodes:\n\n1.  **Credentials:**\n    * **HubSpot:** Connect your account (`HubSpot: Get All Deals`).\n    * **LLM Model:** Add credentials for your preferred provider (`Config: Set LLM for Agent & Chains`).\n    * **Google Sheets:** Connect your account (`Tool: Get Feature Usage from Sheets`).\n    * **Email:** Set up your SMTP credentials (`Email: Send Churn Alert`).\n2.  **Tool URLs:**\n    * In **Tool: Calculate Sentiment Score**, enter the **Webhook URL** from the `Trigger: Receive Tickets for Scoring` node within this same workflow.\n    * In **Tool: Get HubSpot Data**, enter the **Endpoint URL** for your MCP HubSpot data workflow. *(Note: This tool *does* call an external workflow)*.\n3.  **Google Sheet:**\n    * In **Tool: Get Feature Usage from Sheets**, enter the Document ID for your own Google Sheet.\n4.  **Email Details:**\n    * In **Email: Send Churn Alert**, change the `From` and `To` email addresses.\n\n## Requirements\n* HubSpot account with Deals API access\n* LLM provider account (e.g. OpenAI)\n* Google Sheets tracking customer feature usage\n* n8n with LangChain community nodes enabled\n* A separate n8n workflow set up to act as an MCP endpoint for fetching HubSpot data (called by `Tool: Get HubSpot Data`).\n\n## How to customize it\nTailor this workflow to match your business logic:\n* **Scoring logic:** Adjust the JavaScript in the `Code: Convert Sentiment to Score` node to redefine how customer scores are calculated.\n* **Alert thresholds:** Update the prompt in the `AI Chain: Analyze for Churn Risk` node to fine-tune when alerts trigger (e.g. deal age, score cutoff, or usage drop).\n* **Data sources:** Swap HubSpot or Google Sheets for your CRM or database of choice — like Salesforce or Airtable.\n\n✅ **Outcome:** A proactive customer health monitoring system that surfaces risks before it’s too late — keeping your team focused on prevention, not firefighting.",
  "featuredImage": "/data/workflows/10199/10199.webp",
  "author": {
    "id": 101,
    "slug": "Pollup",
    "name": "PollupAI",
    "avatar": ""
  },
  "categories": [
    "CRM",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1077,
  "downloads": 107,
  "createdAt": "2025-10-26T14:06:09.510Z",
  "updatedAt": "2026-01-16T09:03:55.794Z",
  "publishedAt": "2025-10-26T14:06:09.510Z",
  "nodes": 27,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10199",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Predict customer churn with AI analysis of HubSpot and Google Sheets data",
    "workflowName": "Predict customer churn with AI analysis of HubSpot and Google Sheets data",
    "description": "## Who it’s for\nBuilt for Customer Success and Account Management teams focused on proactive retention. This workflow helps you automatically identify at-risk customers – before they churn – by combining CRM, usage, and sentiment data into one actionable alert.\n\n## What it does\nThis end-to-end workflow continuously monitors customer health by consolidating data from HubSpot and Google Sheets.\nHere’s how it works:\n* Fetch deals from HubSpot.\n* Collect context — linked support tickets and feature usage from a Google Sheet.\n* Run sentiment analysis on the tickets to generate a customer health score.\n* Evaluate risk — an AI agent reviews deal age, sentiment score, and usage trends against predefined thresholds.\n* Send alerts — if churn risk is detected, it automatically sends a clear, data-driven email to the responsible team member with next-step recommendations.\n\n## How to set it up\nTo get started, configure your credentials and parameters in the following nodes:\n\n1.  **Credentials:**\n    * **HubSpot:** Connect your account (`HubSpot: Get All Deals`).\n    * **LLM Model:** Add credentials for your preferred provider (`Config: Set LLM for Agent & Chains`).\n    * **Google Sheets:** Connect your account (`Tool: Get Feature Usage from Sheets`).\n    * **Email:** Set up your SMTP credentials (`Email: Send Churn Alert`).\n2.  **Tool URLs:**\n    * In **Tool: Calculate Sentiment Score**, enter the **Webhook URL** from the `Trigger: Receive Tickets for Scoring` node within this same workflow.\n    * In **Tool: Get HubSpot Data**, enter the **Endpoint URL** for your MCP HubSpot data workflow. *(Note: This tool *does* call an external workflow)*.\n3.  **Google Sheet:**\n    * In **Tool: Get Feature Usage from Sheets**, enter the Document ID for your own Google Sheet.\n4.  **Email Details:**\n    * In **Email: Send Churn Alert**, change the `From` and `To` email addresses.\n\n## Requirements\n* HubSpot account with Deals API access\n* LLM provider account (e.g. OpenAI)\n* Google Sheets tracking customer feature usage\n* n8n with LangChain community nodes enabled\n* A separate n8n workflow set up to act as an MCP endpoint for fetching HubSpot data (called by `Tool: Get HubSpot Data`).\n\n## How to customize it\nTailor this workflow to match your business logic:\n* **Scoring logic:** Adjust the JavaScript in the `Code: Convert Sentiment to Score` node to redefine how customer scores are calculated.\n* **Alert thresholds:** Update the prompt in the `AI Chain: Analyze for Churn Risk` node to fine-tune when alerts trigger (e.g. deal age, score cutoff, or usage drop).\n* **Data sources:** Swap HubSpot or Google Sheets for your CRM or database of choice — like Salesforce or Airtable.\n\n✅ **Outcome:** A proactive customer health monitoring system that surfaces risks before it’s too late — keeping your team focused on prevention, not firefighting.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Manual Trigger: Run Churn Analysis",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "HubSpot: Get All Deals",
      "type": "n8n-nodes-base.hubspot",
      "role": "hubspot",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Start Loop: For Each Deal",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Set: Isolate Current Deal ID  Export to Sheets",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Trigger: Receive Tickets for Scoring",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Code: Format Tickets for Analysis",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Loop: For Each Ticket",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "AI: Analyze Ticket Sentiment",
      "type": "@n8n/n8n-nodes-langchain.sentimentAnalysis",
      "role": "sentimentAnalysis",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Merge: Consolidate Results",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Code: Convert Sentiment to Score",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Code: Sum All Ticket Scores",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Respond: Return Total Score  Export to Sheets",
      "type": "n8n-nodes-base.respondToWebhook",
      "role": "respondToWebhook",
      "configDescription": "Version 1.4"
    },
    {
      "name": "AI Agent: Gather Customer Data",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Config: Set LLM for Agent & Chains",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Tool: Get HubSpot Data",
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "role": "mcpClientTool",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Tool: Calculate Sentiment Score",
      "type": "n8n-nodes-base.httpRequestTool",
      "role": "httpRequestTool",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Tool: Get Feature Usage from Sheets",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.7"
    },
    {
      "name": "AI: Structure Agent's Findings  Export to Sheets",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Code: Group Feature Data by Name",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Chain: Analyze for Churn Risk",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.7"
    },
    {
      "name": "AI: Structure Alert Email",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Format: Convert Alert to HTML",
      "type": "n8n-nodes-base.markdown",
      "role": "markdown",
      "configDescription": "Version 1"
    },
    {
      "name": "Email: Send Churn Alert  Export to Sheets",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    }
  ]
}