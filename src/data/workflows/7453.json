{
  "id": 7453,
  "slug": "7453",
  "title": "Prevent prompt injection attacks with a GPT-4O security defense system",
  "description": "# AI Security Pipeline - Prompt Injection Defense System using GPT-4O\n\nProtect your AI workflows from prompt injection attacks, XSS attempts, and malicious content with this multi-layer security sanitization system.\n\n&gt; Important:  The n8n workflow template uploader did not allow me to upload the complete system prompt for the **Input Validation & Pattern Detection**. Copy the complete System Prompt from [here](https://github.com/inderjeetsingh21/n8n-workflows/blob/main/Input%20Validation%20%26%20Pattern%20Detection%20System%20Prompt )\n\n## What it does\n\nThis workflow acts as a security shield for AI-powered automations, preventing indirect prompt injection and other threats. It processes content through a multi-layered defense pipeline that detects malicious patterns, sanitizes markdown, validates URLs, and provides comprehensive security assessments.\n\n## How it works\n\n1. **Receives content** via webhook endpoint\n2. **Detects threats** including prompt injections, XSS attempts, and data URI attacks\n3. **Sanitizes markdown** by removing HTML, dangerous protocols, and suspicious links\n4. **Validates URLs** blocking suspicious IP addresses, domains, and URL shorteners\n5. **Returns security report** with risk assessment and sanitized content\n\n## Setup\n\n1. Import and activate the workflow\n2. Use the generated webhook URL: `/webhook/security-sanitize`\n3. Send POST requests with \n```\nJSON: `{\"content\": \"your_text\", \"source\": \"identifier\"}`\n```\n\n## Use cases\n\n- Secure AI chatbots and LLM integrations\n- Process user-generated content before AI processing\n- Protect RAG systems from data poisoning\n- Sanitize external webhook payloads\n- Ensure compliance with security standards\n\nPerfect for any organization using AI that needs to prevent prompt manipulation, data exfiltration, and injection attacks while maintaining audit trails for compliance.\n\n\n",
  "featuredImage": "/data/workflows/7453/7453.webp",
  "author": {
    "id": 101,
    "slug": "idsinghbhambra",
    "name": "inderjeet Bhambra",
    "avatar": ""
  },
  "categories": [
    "SecOps",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 750,
  "downloads": 75,
  "createdAt": "2025-08-15T18:56:49.167Z",
  "updatedAt": "2026-01-16T08:50:24.432Z",
  "publishedAt": "2025-08-15T18:56:49.167Z",
  "nodes": 26,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7453",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Prevent prompt injection attacks with a GPT-4O security defense system",
    "workflowName": "Prevent prompt injection attacks with a GPT-4O security defense system",
    "description": "# AI Security Pipeline - Prompt Injection Defense System using GPT-4O\n\nProtect your AI workflows from prompt injection attacks, XSS attempts, and malicious content with this multi-layer security sanitization system.\n\n&gt; Important:  The n8n workflow template uploader did not allow me to upload the complete system prompt for the **Input Validation & Pattern Detection**. Copy the complete System Prompt from [here](https://github.com/inderjeetsingh21/n8n-workflows/blob/main/Input%20Validation%20%26%20Pattern%20Detection%20System%20Prompt )\n\n## What it does\n\nThis workflow acts as a security shield for AI-powered automations, preventing indirect prompt injection and other threats. It processes content through a multi-layered defense pipeline that detects malicious patterns, sanitizes markdown, validates URLs, and provides comprehensive security assessments.\n\n## How it works\n\n1. **Receives content** via webhook endpoint\n2. **Detects threats** including prompt injections, XSS attempts, and data URI attacks\n3. **Sanitizes markdown** by removing HTML, dangerous protocols, and suspicious links\n4. **Validates URLs** blocking suspicious IP addresses, domains, and URL shorteners\n5. **Returns security report** with risk assessment and sanitized content\n\n## Setup\n\n1. Import and activate the workflow\n2. Use the generated webhook URL: `/webhook/security-sanitize`\n3. Send POST requests with \n```\nJSON: `{\"content\": \"your_text\", \"source\": \"identifier\"}`\n```\n\n## Use cases\n\n- Secure AI chatbots and LLM integrations\n- Process user-generated content before AI processing\n- Protect RAG systems from data poisoning\n- Sanitize external webhook payloads\n- Ensure compliance with security standards\n\nPerfect for any organization using AI that needs to prevent prompt manipulation, data exfiltration, and injection attacks while maintaining audit trails for compliance.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Extract Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Text violations",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "role": "respondToWebhook",
      "configDescription": "Version 1.4"
    },
    {
      "name": "Input Validation & Pattern Detection",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Content Sanitization & Neutralization",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Check Success",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "REJECTED?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Report Rejection",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Final Quality Assurance & Delivery Readiness",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Validate trueCategories",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Is REJECTED?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Custom Message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Format Content",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "EMAIL",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    }
  ]
}