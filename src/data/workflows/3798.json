{
  "id": 3798,
  "slug": "3798",
  "title": "Create a session-based Telegram chatbot with GPT-4o-mini and Google Sheets",
  "description": "### **How It Works**  \nThis workflow creates an **AI-powered Telegram chatbot** with **session management**, allowing users to:  \n- **Start new conversations** (`/new`).  \n- **Check current sessions** (`/current`).  \n- **Resume past sessions** (`/resume`).  \n- **Get summaries** (`/summary`).  \n- **Ask questions** (`/question`).  \n\n**Key Components**:  \n- **Session Management**:  \n  - Uses **Google Sheets** to track active/expired sessions (storing `SESSION` IDs and `STATE`).  \n  - `/new` creates a session; `/resume` reactivates past ones.  \n- **AI Processing**:  \n  - **OpenAI GPT-4** generates responses with **contextual memory** (via `Simple Memory` node).  \n  - **Summarization**: Condenses past conversations when requested.  \n- **Data Logging**:  \n  - All interactions (prompts/responses) are saved to Google Sheets for audit and retrieval.  \n- **User Interaction**:  \n  - Telegram commands trigger specific actions (e.g., `/question [query]` fetches answers from session history).  \n\n---\n\n### Main Advantages\n\n**1. Multi-session Handling**  \nEach user can create, manage, and switch between multiple sessions independently, perfect for organizing different conversations without confusion.\n\n**2. Persistent Memory**  \nConversations are stored in Google Sheets, ensuring that chat history and session states are preserved even if the server or n8n instance restarts.\n\n**3. Commands for Full Control**  \nWith intuitive commands like `/new`, `/current`, `/resume`, `/summary`, and `/question`, users can manage sessions easily without needing a web interface.\n\n**4. Smart Summarization and Q&A**  \nThanks to OpenAI models, the workflow can **summarize** entire conversations or **answer specific questions** about past discussions, saving time and improving the chatbot’s usability.\n\n**5. Easy Setup and Scalability**  \nBy using Google Sheets instead of a database, the workflow is easy to clone, modify, and deploy — ideal for quick prototyping or lightweight production uses.\n\n**6. Modular and Extensible**  \nEach logical block (new session, get current session, resume, summarize, ask question) is modular, making it easy to **extend** the workflow with additional features like analytics, personalized greetings, or integrations with CRM systems.\n\n---\n\n### **Setup Steps**  \n\n##### **Prerequisites**:  \n- **Telegram Bot Token**: Create via [BotFather](https://core.telegram.org/bots#botfather).  \n- **Google Sheets**:  \n  - Duplicate [this template](https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit).  \n  - Two sheets: `Session` (active/inactive sessions) and `Database` (chat logs).  \n- **OpenAI API Key**: For GPT-4 responses.  \n\n##### **Configuration**:  \n1. **Telegram Integration**:  \n   - Add your bot token to the **Telegram Trigger** and **Telegram Send** nodes.  \n\n2. **Google Sheets Setup**:  \n   - Authenticate the **Google Sheets nodes** with OAuth.  \n   - Ensure sheet names (`Session`, `Database`) and column mappings match the template.  \n\n3. **OpenAI & Memory**:  \n   - Add your API key to the **OpenAI Chat Model** nodes.  \n   - Adjust `contextWindowLength` in the **Simple Memory** node for conversation history length.  \n\n4. **Testing**:  \n   - Use Telegram commands to test:  \n     - `/new`: Starts a session.  \n     - `/question [query]`: Tests AI responses.  \n     - `/summary`: Checks summarization.  \n\n5. **Deployment**:  \n   - Activate the workflow; the bot will respond to Telegram messages in real-time.  \n\n\n---\n\n\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/). ",
  "featuredImage": "/data/workflows/3798/3798.webp",
  "author": {
    "id": 101,
    "slug": "n3witalia",
    "name": "Davide",
    "avatar": ""
  },
  "categories": [
    "Support Chatbot",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 12858,
  "downloads": 1285,
  "createdAt": "2025-04-30T08:31:26.629Z",
  "updatedAt": "2026-01-16T08:31:31.318Z",
  "publishedAt": "2025-04-30T08:31:26.629Z",
  "nodes": 38,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3798",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Create a session-based Telegram chatbot with GPT-4o-mini and Google Sheets",
    "workflowName": "Create a session-based Telegram chatbot with GPT-4o-mini and Google Sheets",
    "description": "### **How It Works**  \nThis workflow creates an **AI-powered Telegram chatbot** with **session management**, allowing users to:  \n- **Start new conversations** (`/new`).  \n- **Check current sessions** (`/current`).  \n- **Resume past sessions** (`/resume`).  \n- **Get summaries** (`/summary`).  \n- **Ask questions** (`/question`).  \n\n**Key Components**:  \n- **Session Management**:  \n  - Uses **Google Sheets** to track active/expired sessions (storing `SESSION` IDs and `STATE`).  \n  - `/new` creates a session; `/resume` reactivates past ones.  \n- **AI Processing**:  \n  - **OpenAI GPT-4** generates responses with **contextual memory** (via `Simple Memory` node).  \n  - **Summarization**: Condenses past conversations when requested.  \n- **Data Logging**:  \n  - All interactions (prompts/responses) are saved to Google Sheets for audit and retrieval.  \n- **User Interaction**:  \n  - Telegram commands trigger specific actions (e.g., `/question [query]` fetches answers from session history).  \n\n---\n\n### Main Advantages\n\n**1. Multi-session Handling**  \nEach user can create, manage, and switch between multiple sessions independently, perfect for organizing different conversations without confusion.\n\n**2. Persistent Memory**  \nConversations are stored in Google Sheets, ensuring that chat history and session states are preserved even if the server or n8n instance restarts.\n\n**3. Commands for Full Control**  \nWith intuitive commands like `/new`, `/current`, `/resume`, `/summary`, and `/question`, users can manage sessions easily without needing a web interface.\n\n**4. Smart Summarization and Q&A**  \nThanks to OpenAI models, the workflow can **summarize** entire conversations or **answer specific questions** about past discussions, saving time and improving the chatbot’s usability.\n\n**5. Easy Setup and Scalability**  \nBy using Google Sheets instead of a database, the workflow is easy to clone, modify, and deploy — ideal for quick prototyping or lightweight production uses.\n\n**6. Modular and Extensible**  \nEach logical block (new session, get current session, resume, summarize, ask question) is modular, making it easy to **extend** the workflow with additional features like analytics, personalized greetings, or integrations with CRM systems.\n\n---\n\n### **Setup Steps**  \n\n##### **Prerequisites**:  \n- **Telegram Bot Token**: Create via [BotFather](https://core.telegram.org/bots#botfather).  \n- **Google Sheets**:  \n  - Duplicate [this template](https://docs.google.com/spreadsheets/d/1MCJLAqKP0Y7Qr68ZYoSSBeEVyKI1QgAAZnlEiyqkzXo/edit).  \n  - Two sheets: `Session` (active/inactive sessions) and `Database` (chat logs).  \n- **OpenAI API Key**: For GPT-4 responses.  \n\n##### **Configuration**:  \n1. **Telegram Integration**:  \n   - Add your bot token to the **Telegram Trigger** and **Telegram Send** nodes.  \n\n2. **Google Sheets Setup**:  \n   - Authenticate the **Google Sheets nodes** with OAuth.  \n   - Ensure sheet names (`Session`, `Database`) and column mappings match the template.  \n\n3. **OpenAI & Memory**:  \n   - Add your API key to the **OpenAI Chat Model** nodes.  \n   - Adjust `contextWindowLength` in the **Simple Memory** node for conversation history length.  \n\n4. **Testing**:  \n   - Use Telegram commands to test:  \n     - `/new`: Starts a session.  \n     - `/question [query]`: Tests AI responses.  \n     - `/summary`: Checks summarization.  \n\n5. **Deployment**:  \n   - Activate the workflow; the bot will respond to Telegram messages in real-time.  \n\n\n---\n\n\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "role": "memoryBufferWindow",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Get message",
      "type": "n8n-nodes-base.telegramTrigger",
      "role": "telegramTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Command or text?",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Get session",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Disable previous session",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Set new session",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Session activated",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Send response",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Update database",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Summarization Chain",
      "type": "@n8n/n8n-nodes-langchain.chainSummarization",
      "role": "chainSummarization",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "OpenAI Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Basic LLM Chain",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.6"
    },
    {
      "name": "Get message1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set to expire",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Exist?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "OK",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "KO",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Trim resume",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Get session1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Prompt + Resume",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send summary",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Get message2",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Trim question",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Set new current session",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Response + Text",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "fullText",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send answer",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Send current session",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Telegram Chatbot",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    }
  ]
}