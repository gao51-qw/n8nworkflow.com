{
  "id": 8051,
  "slug": "8051",
  "title": "Customer personality (BaZi, DISC, Numerology) with Gemini & Google Sheets",
  "description": "## üìÑ What this workflow does\n This workflow turns your n8n into an automated personality-insights engine driven by Google Sheets. When a row is updated with Analysis Status = Run, it:\n- Computes Lunar Date of Birth and Four Pillars (BaZi) from DOB and optional birth time.\n- Calculates Numerology (Life Path, Birth Day, Pinnacles/Challenges, Expression, Soul Urge, Personality, Maturity) and a phone ‚Äúvibration‚Äù number.\n- Generates concise, sales-oriented bullet-point analyses with Gemini for BaZi, Numerology, and DISC (from Notes).\n- Merges results and writes back to the sheet: Lunar Date of Birth, Four Pillars, Numerology, Four Pillars Analysis, Numerology Analysis, DISC Analysis, and a combined Personality summary‚Äîthen flips Analysis Status to Done.\n- Handles missing data gracefully and logs clear warnings in the sheet fields.\n\n\n## üë§ Who is this for\n- Sales teams working from spreadsheets who want fast personality cues for outreach.\n- Coaches/consultants providing light BaZi/Numerology/DISC summaries at scale.\n- SMBs maintaining lead/customer lists in Google Sheets and wanting auto-generated insights.\n\n\n## ‚úÖ Requirements\n- An n8n instance.\n- Google Sheets with these columns (English): No, Full Name, Date of Birth, Birth Time, Gender, Email, Phone, Status, Analysis Status, Purchase Value, Notes, Four Pillars, Four Pillars Analysis, Lunar Date of Birth, Numerology, Numerology Analysis, DISC Analysis, Personality, Script.\n- Google Sheets OAuth2 credentials connected in n8n.\n- Google Gemini API credentials (nodes use models like models/gemini-1.5-flash and models/gemini-2.5-flash).\n- (Optional) Confirm timezone (+07:00) used in the BaZi lunar calculations fits your use case.\n\n\n## ‚öôÔ∏è How to set up\n- Import the provided workflow JSON into n8n.\n- Connect Google Sheets credentials and point to your spreadsheet + sheet (gid).\n- Connect Gemini credentials and keep/adjust the default model IDs.\n- Ensure your sheet has the listed English column headers.\n- (Optional) Adjust the timezone constant in the Code nodes if you‚Äôre not in GMT+7.\n- Set Analysis Status = Run in any row you want analyzed and trigger a row update.\n\n\nüîÅ How it works\n1. Trigger ‚Üí Google Sheets Trigger fires on row update where Analysis Status = Run.\n2. Pre-processing ‚Üí Code computes Lunar DOB + Four Pillars; Code1 computes Numerology and phone metric.\n3. Conditional flows ‚Üí IF nodes check available inputs (BaZi/Numerology/Notes) and call the relevant Gemini nodes.\n4. LLM Generation ‚Üí Gemini returns three focused analyses (BaZi, Numerology, DISC) plus a combined Personality summary.\n5. Merge/Aggregate ‚Üí Results are merged for a single row.\n6. Write-back ‚Üí Google Sheets nodes update Lunar Date of Birth, Four Pillars, Numerology, Four Pillars Analysis, Numerology Analysis, DISC Analysis, Personality and set Analysis Status = Done.\n\n## üí° About Margin AI\n[Margin AI](https://marginai.co/) is an AI-services agency that acts as your AI Service Companion. We design intelligent, human-centric automation solutions‚Äîturning your team‚Äôs best practices into scalable workflows and tools. Industries like marketing, sales, and operations benefit from our tailored AI consulting, automation tools, and chatbot development.\n\n\n\n\n",
  "featuredImage": "/data/workflows/8051/8051.webp",
  "author": {
    "id": 101,
    "slug": "cong-nguyen",
    "name": "Cong Nguyen",
    "avatar": ""
  },
  "categories": [
    "Lead Nurturing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 75,
  "downloads": 7,
  "createdAt": "2025-08-30T09:53:17.303Z",
  "updatedAt": "2026-01-16T08:53:51.940Z",
  "publishedAt": "2025-08-30T09:53:17.303Z",
  "nodes": 24,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8051",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Customer personality (BaZi, DISC, Numerology) with Gemini & Google Sheets",
    "workflowName": "Customer personality (BaZi, DISC, Numerology) with Gemini & Google Sheets",
    "description": "## üìÑ What this workflow does\n This workflow turns your n8n into an automated personality-insights engine driven by Google Sheets. When a row is updated with Analysis Status = Run, it:\n- Computes Lunar Date of Birth and Four Pillars (BaZi) from DOB and optional birth time.\n- Calculates Numerology (Life Path, Birth Day, Pinnacles/Challenges, Expression, Soul Urge, Personality, Maturity) and a phone ‚Äúvibration‚Äù number.\n- Generates concise, sales-oriented bullet-point analyses with Gemini for BaZi, Numerology, and DISC (from Notes).\n- Merges results and writes back to the sheet: Lunar Date of Birth, Four Pillars, Numerology, Four Pillars Analysis, Numerology Analysis, DISC Analysis, and a combined Personality summary‚Äîthen flips Analysis Status to Done.\n- Handles missing data gracefully and logs clear warnings in the sheet fields.\n\n\n## üë§ Who is this for\n- Sales teams working from spreadsheets who want fast personality cues for outreach.\n- Coaches/consultants providing light BaZi/Numerology/DISC summaries at scale.\n- SMBs maintaining lead/customer lists in Google Sheets and wanting auto-generated insights.\n\n\n## ‚úÖ Requirements\n- An n8n instance.\n- Google Sheets with these columns (English): No, Full Name, Date of Birth, Birth Time, Gender, Email, Phone, Status, Analysis Status, Purchase Value, Notes, Four Pillars, Four Pillars Analysis, Lunar Date of Birth, Numerology, Numerology Analysis, DISC Analysis, Personality, Script.\n- Google Sheets OAuth2 credentials connected in n8n.\n- Google Gemini API credentials (nodes use models like models/gemini-1.5-flash and models/gemini-2.5-flash).\n- (Optional) Confirm timezone (+07:00) used in the BaZi lunar calculations fits your use case.\n\n\n## ‚öôÔ∏è How to set up\n- Import the provided workflow JSON into n8n.\n- Connect Google Sheets credentials and point to your spreadsheet + sheet (gid).\n- Connect Gemini credentials and keep/adjust the default model IDs.\n- Ensure your sheet has the listed English column headers.\n- (Optional) Adjust the timezone constant in the Code nodes if you‚Äôre not in GMT+7.\n- Set Analysis Status = Run in any row you want analyzed and trigger a row update.\n\n\nüîÅ How it works\n1. Trigger ‚Üí Google Sheets Trigger fires on row update where Analysis Status = Run.\n2. Pre-processing ‚Üí Code computes Lunar DOB + Four Pillars; Code1 computes Numerology and phone metric.\n3. Conditional flows ‚Üí IF nodes check available inputs (BaZi/Numerology/Notes) and call the relevant Gemini nodes.\n4. LLM Generation ‚Üí Gemini returns three focused analyses (BaZi, Numerology, DISC) plus a combined Personality summary.\n5. Merge/Aggregate ‚Üí Results are merged for a single row.\n6. Write-back ‚Üí Google Sheets nodes update Lunar Date of Birth, Four Pillars, Numerology, Four Pillars Analysis, Numerology Analysis, DISC Analysis, Personality and set Analysis Status = Done.\n\n## üí° About Margin AI\n[Margin AI](https://marginai.co/) is an AI-services agency that acts as your AI Service Companion. We design intelligent, human-centric automation solutions‚Äîturning your team‚Äôs best practices into scalable workflows and tools. Industries like marketing, sales, and operations benefit from our tailored AI consulting, automation tools, and chatbot development.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Google Sheets Trigger",
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "role": "googleSheetsTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "If2",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Update row in sheet1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Update row in sheet2",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Update row in sheet3",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Update row in sheet4",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Filter",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Get row(s) in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Update row in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Compute Bazi",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Compute Numerology",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Numerology analysis",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Bazi Analysis",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "DISC Analysis",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Summary Customer Insight",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Writing Script for Salers",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}