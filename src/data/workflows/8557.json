{
  "id": 8557,
  "slug": "8557",
  "title": "Transform Excel data into AI-ready vectors with OpenAI and Supabase",
  "description": "## Description\nThis workflow is a **practical, ‚Äúdirty‚Äù solution** for real-world scenarios where frontline workers keep using Excel in their daily processes.  \nInstead of forcing change, we take their spreadsheets as-is, clean and normalize the data, generate embeddings, and store everything in Supabase.\n\nThe benefit: frontline staff continue with their familiar tools, while **data analysts gain clean, structured, and vectorized data** ready for analysis or RAG-style AI applications.\n\n## How it works\n- **Frontline workers continue with Excel** ‚Äì no disruption to their daily routines.  \n- **Upload & trigger** ‚Äì The workflow runs when a new Excel sheet is ready.  \n- **Read Excel rows** ‚Äì Data is pulled from the specified workbook and worksheet.  \n- **Clean & normalize** ‚Äì HTML is stripped, Excel dates are fixed, and text fields are standardized.  \n- **Batch & switch** ‚Äì Rows are split and routed into Question/Answer processing paths.  \n- **Generate embeddings** ‚Äì Cleaned Questions and Answers are converted into vectors via OpenAI.  \n- **Merge enriched records** ‚Äì Original business data is combined with embeddings.  \n- **Write into Supabase** ‚Äì Data lands in a structured table (`excel_records`) with vector and FTS indexes.  \n\n## Why it‚Äôs ‚Äúdirty but useful‚Äù\n- **No disruption** ‚Äì frontline workers don‚Äôt need to change how they work.  \n- **Analyst-ready data** ‚Äì Supabase holds clean, queryable data for dashboards, reporting, or AI pipelines.  \n- **Bridge between old and new** ‚Äì Excel remains the input, but the backend becomes modern and scalable.  \n- **Incremental modernization** ‚Äì paves the way for future workflow upgrades without blocking current work.  \n\n## Outcome\nFrontline workers keep their Excel-based workflows, while **data can immediately be structured, searchable, and vectorized in Supabase** ‚Äî enabling AI-powered search, reporting, and retrieval-augmented generation.\n\n\n## Required setup\n\n**Supabase account**\n- Create a project and enable the **pgvector** extension. \n\n**OpenAI API Key** \n  - Required for generating embeddings (`text-embedding-3-small`).  \n\n**Microsoft Excel credentials**\n  - Needed to connect to your workbook and worksheet.  \n\n- ## Need Help\nüîó [LinkedIn ‚Äì Wessel Bulte](https://www.linkedin.com/in/wessel-bulte/)\n",
  "featuredImage": "/data/workflows/8557/8557.webp",
  "author": {
    "id": 101,
    "slug": "uuessel",
    "name": "Wessel Bulte",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1394,
  "downloads": 139,
  "createdAt": "2025-09-13T13:44:14.142Z",
  "updatedAt": "2026-01-16T08:56:28.428Z",
  "publishedAt": "2025-09-13T13:44:14.142Z",
  "nodes": 29,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8557",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Transform Excel data into AI-ready vectors with OpenAI and Supabase",
    "workflowName": "Transform Excel data into AI-ready vectors with OpenAI and Supabase",
    "description": "## Description\nThis workflow is a **practical, ‚Äúdirty‚Äù solution** for real-world scenarios where frontline workers keep using Excel in their daily processes.  \nInstead of forcing change, we take their spreadsheets as-is, clean and normalize the data, generate embeddings, and store everything in Supabase.\n\nThe benefit: frontline staff continue with their familiar tools, while **data analysts gain clean, structured, and vectorized data** ready for analysis or RAG-style AI applications.\n\n## How it works\n- **Frontline workers continue with Excel** ‚Äì no disruption to their daily routines.  \n- **Upload & trigger** ‚Äì The workflow runs when a new Excel sheet is ready.  \n- **Read Excel rows** ‚Äì Data is pulled from the specified workbook and worksheet.  \n- **Clean & normalize** ‚Äì HTML is stripped, Excel dates are fixed, and text fields are standardized.  \n- **Batch & switch** ‚Äì Rows are split and routed into Question/Answer processing paths.  \n- **Generate embeddings** ‚Äì Cleaned Questions and Answers are converted into vectors via OpenAI.  \n- **Merge enriched records** ‚Äì Original business data is combined with embeddings.  \n- **Write into Supabase** ‚Äì Data lands in a structured table (`excel_records`) with vector and FTS indexes.  \n\n## Why it‚Äôs ‚Äúdirty but useful‚Äù\n- **No disruption** ‚Äì frontline workers don‚Äôt need to change how they work.  \n- **Analyst-ready data** ‚Äì Supabase holds clean, queryable data for dashboards, reporting, or AI pipelines.  \n- **Bridge between old and new** ‚Äì Excel remains the input, but the backend becomes modern and scalable.  \n- **Incremental modernization** ‚Äì paves the way for future workflow upgrades without blocking current work.  \n\n## Outcome\nFrontline workers keep their Excel-based workflows, while **data can immediately be structured, searchable, and vectorized in Supabase** ‚Äî enabling AI-powered search, reporting, and retrieval-augmented generation.\n\n\n## Required setup\n\n**Supabase account**\n- Create a project and enable the **pgvector** extension. \n\n**OpenAI API Key** \n  - Required for generating embeddings (`text-embedding-3-small`).  \n\n**Microsoft Excel credentials**\n  - Needed to connect to your workbook and worksheet.  \n\n- ## Need Help\nüîó [LinkedIn ‚Äì Wessel Bulte](https://www.linkedin.com/in/wessel-bulte/)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòExecute workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Remove HTML ",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Merge import Data",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Code \"Question\"",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Code \"Answer\"",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Embeddings OpenAI Answer",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Embeddings OpenAI Question",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Merge fields for database insert",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Write row to database",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Retrieve existing  rows",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Build table in Supabase",
      "type": "n8n-nodes-base.postgres",
      "role": "postgres",
      "configDescription": "Version 2.6"
    },
    {
      "name": "Get rows from sheet",
      "type": "n8n-nodes-base.microsoftExcel",
      "role": "microsoftExcel",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note - Overview",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Write row to database",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Merge fields for database insert",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Merge",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Embeddings OpenAI Question",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Code \"Question\"",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Code \"Answer\"",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Switch",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Loop Over Items",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Remove HTML ",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Merge import Data",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Retrieve existing  rows",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Get rows from sheet",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}