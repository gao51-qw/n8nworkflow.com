{
  "id": 8767,
  "slug": "8767",
  "title": "Extract timesheet data with Mistral OCR & Gmail human verification",
  "description": "## üìñ Description  \n\n### üîπ How it works  \nThis workflow introduces an **AI + Human-in-the-Loop pipeline** for employee timesheet management. It combines the power of **Google Drive, AI (OCR + LLM), and Gmail** with a **human review step** to ensure accuracy and compliance.  \n\n1. **AI-Powered File Discovery**  \n   - Scans a Google Drive folder for new or updated timesheet files (PDF, Word, Excel, Images).  \n\n2. **AI Data Extraction**  \n   - Uses OCR and LLM (Mistral) to intelligently read and extract structured data. \n   -  Supports **multiple formats**: PDF, Word (DOC/DOCX), Excel (XLS/XLSX), and Image files (JPG, PNG, scanned documents).   \n   - Creates clean JSON with file details and timesheet logs (date, hours worked, tasks, notes).  \n\n3. **Smart Data Formatting**  \n   - Converts AI output into a **clear HTML summary table** for easy review.  \n   - Flags potential anomalies (missing hours, duplicate dates, irregular entries).  \n\n4. **Human-in-the-Loop Verification**  \n   - Sends an approval email via Gmail containing:  \n     - File metadata  \n     - AI-generated HTML summary  \n     - JSON attachment of raw extracted data  \n   - HR/Managers review the summary and **approve/reject** before final actions occur.  \n\n5. **Post-Approval Automation** *(optional)*  \n   - Approved records can be saved in a separate Google Drive folder.  \n   - Employees or HR receive confirmation emails.  \n\n---\n\n## ‚öôÔ∏è Set up steps  \n\n1. **Connect Credentials**  \n   - Add Google Drive and Gmail credentials in n8n.  \n   - Configure Mistral (or any LLM) API credentials. \n\n2. **Configure Google Drive**  \n   - In the ‚ÄúSearch files and folders‚Äù node, replace the `folderId` with your company‚Äôs timesheet folder ID.  \n\n3. **Customize Extraction Schema**  \n   - Sticky notes explain how JSON output is structured.  \n   - Adapt it for your organization‚Äôs needs (e.g., overtime, project codes).  \n\n4. **Set Up Human Verification Emails**  \n   - Update Gmail node recipients to your HR or approval team.  \n   - Customize the email body (AI summary + JSON file attached).  \n\n5. **Activate & Test**  \n   - Enable the workflow.  \n   - Upload a sample timesheet to trigger the AI + human verification loop.  \n\n---\n\n  \n\n\n\n‚ö° **Result:** A robust **AI + Human-in-the-Loop workflow** that reduces repetitive data entry, prevents payroll errors, and gives HR full confidence before final approval.  ",
  "featuredImage": "/data/workflows/8767/8767.webp",
  "author": {
    "id": 101,
    "slug": "rnair1996",
    "name": "ResilNext",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 286,
  "downloads": 28,
  "createdAt": "2025-09-20T05:51:37.727Z",
  "updatedAt": "2026-01-16T08:57:33.703Z",
  "publishedAt": "2025-09-20T05:51:37.727Z",
  "nodes": 32,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8767",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Extract timesheet data with Mistral OCR & Gmail human verification",
    "workflowName": "Extract timesheet data with Mistral OCR & Gmail human verification",
    "description": "## üìñ Description  \n\n### üîπ How it works  \nThis workflow introduces an **AI + Human-in-the-Loop pipeline** for employee timesheet management. It combines the power of **Google Drive, AI (OCR + LLM), and Gmail** with a **human review step** to ensure accuracy and compliance.  \n\n1. **AI-Powered File Discovery**  \n   - Scans a Google Drive folder for new or updated timesheet files (PDF, Word, Excel, Images).  \n\n2. **AI Data Extraction**  \n   - Uses OCR and LLM (Mistral) to intelligently read and extract structured data. \n   -  Supports **multiple formats**: PDF, Word (DOC/DOCX), Excel (XLS/XLSX), and Image files (JPG, PNG, scanned documents).   \n   - Creates clean JSON with file details and timesheet logs (date, hours worked, tasks, notes).  \n\n3. **Smart Data Formatting**  \n   - Converts AI output into a **clear HTML summary table** for easy review.  \n   - Flags potential anomalies (missing hours, duplicate dates, irregular entries).  \n\n4. **Human-in-the-Loop Verification**  \n   - Sends an approval email via Gmail containing:  \n     - File metadata  \n     - AI-generated HTML summary  \n     - JSON attachment of raw extracted data  \n   - HR/Managers review the summary and **approve/reject** before final actions occur.  \n\n5. **Post-Approval Automation** *(optional)*  \n   - Approved records can be saved in a separate Google Drive folder.  \n   - Employees or HR receive confirmation emails.  \n\n---\n\n## ‚öôÔ∏è Set up steps  \n\n1. **Connect Credentials**  \n   - Add Google Drive and Gmail credentials in n8n.  \n   - Configure Mistral (or any LLM) API credentials. \n\n2. **Configure Google Drive**  \n   - In the ‚ÄúSearch files and folders‚Äù node, replace the `folderId` with your company‚Äôs timesheet folder ID.  \n\n3. **Customize Extraction Schema**  \n   - Sticky notes explain how JSON output is structured.  \n   - Adapt it for your organization‚Äôs needs (e.g., overtime, project codes).  \n\n4. **Set Up Human Verification Emails**  \n   - Update Gmail node recipients to your HR or approval team.  \n   - Customize the email body (AI summary + JSON file attached).  \n\n5. **Activate & Test**  \n   - Enable the workflow.  \n   - Upload a sample timesheet to trigger the AI + human verification loop.  \n\n---\n\n  \n\n\n\n‚ö° **Result:** A robust **AI + Human-in-the-Loop workflow** that reduces repetitive data entry, prevents payroll errors, and gives HR full confidence before final approval.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòTest workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items2",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Read Spreadsheet File",
      "type": "n8n-nodes-base.spreadsheetFile",
      "role": "spreadsheetFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Mistral Cloud Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatMistralCloud",
      "role": "lmChatMistralCloud",
      "configDescription": "Version 1"
    },
    {
      "name": "Download File",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Set File ID1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Search files and folders",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Switch File Type",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "HTTP Request1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Edit Fields3",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Mistral Upload",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Mistral Signed URL",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Mistral DOC OCR",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "AI Agent to clean and format exctracred data",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Clean excel data format",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "normalize output",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "normalize output1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "normalize output2",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "clean ai output",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "json to html",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    }
  ]
}