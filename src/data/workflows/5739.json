{
  "id": 5739,
  "slug": "5739",
  "title": "Automated invoice data extraction with LlamaParse, Gemini 2.5 & Google Sheets",
  "description": "### This n8n template demonstrates how to automate invoice data extraction from PDF attachments received via Gmail. Using LlamaParse and Gemini LLM, this workflow parses structured fields like PO numbers, line items, tax amounts, and totals ‚Äî and stores them neatly into a Google Sheet.\n\nPerfect for use cases such as:\nüíº Finance teams managing vendor invoices\nüìä Bookkeeping workflows\nüîÑ Automating monthly reconciliation\n\n\n## Good to Know\nAt the time of writing, LlamaParse and Gemini may involve API usage costs depending on your subscription tier. Check LlamaIndex Pricing and Gemini Pricing for updated info.\n\nLlamaParse provides Markdown-formatted parsed output which is then passed to an LLM for structured field extraction.\n\nGemini models may be geo-restricted. If you encounter \"model not found\" errors, your region might not be supported.\n\n\n## How it Works\n- Trigger: Watches your Gmail for new emails with PDF attachments.\n- Email Filter: Ensures we only parse fresh emails not already labeled as \"invoice synced\".\n- LlamaParse Upload: Uploads the PDF to LlamaParse‚Äôs parsing endpoint.\n- Status Polling: Periodically checks whether the parsing is complete.\n- Download Markdown: Once ready, it fetches the parsed invoice in Markdown format.\n- AI Parsing with Gemini: Sends the Markdown to Gemini LLM to extract structured JSON (like PO number, line items, taxes, etc.) using a predefined schema.\n- Google Sheets Upload: Stores extracted data into a predefined spreadsheet. \n- Labeling: Marks the email as ‚Äúinvoice synced‚Äù to avoid reprocessing.\n\n## How to Use\nThe trigger is based on Gmail, but you can replace this with a webhook or manual trigger for testing.\n\n## Setup Instructions\nGmail API\n- Enable Gmail API in Google Cloud Console.\n- Connect your Gmail account in n8n credentials.\n- Allow read + modify access.\n\nGoogle Sheets\n\n- Create a new Google Sheet with the following headers (row 1): Date | Vendor Name | Invoice Number | PO Number | Line Items | Subtotal | Tax | Total Amount\n- Connect Google Sheets in n8n and paste the Sheet ID in the node.\n- You can customise the google sheet basis your requirement.\n\nLlamaParse\n\n- Get a LlamaIndex API Key from LlamaIndex.\n- Use the LlamaParse upload and polling nodes to process your PDFs.\n\nGemini (via Vertex AI)\n\n- Set up Gemini access in GCP.\n- Use the Gemini 2.5 Model.\n- Construct a structured prompt to extract required fields.\n\nLabeling\n\n- Create a Gmail label named \"Invoice Synced\" for tracking processed emails.\n\n## Requirements\nGmail account with API access\n\nLlamaParse (LlamaIndex) account with API Key\n\nGoogle Sheets API credentials\n\nAccess to Gemini 2.5 model via Google Vertex AI\n\n## Customising This Workflow\nThis template is just the beginning. You can expand it to:\n\n- Auto-generate invoices back to vendors\n- Run duplicate checks before inserting into Sheets\n- Integrate with accounting tools like Zoho, QuickBooks, or Tally\n- Trigger Slack/Email notifications on specific vendors or high invoice amounts\n\n",
  "featuredImage": "/data/workflows/5739/5739.webp",
  "author": {
    "id": 101,
    "slug": "arpanjain29",
    "name": "Agentick AI",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 807,
  "downloads": 80,
  "createdAt": "2025-07-07T07:03:16.407Z",
  "updatedAt": "2026-01-16T08:41:11.493Z",
  "publishedAt": "2025-07-07T07:03:16.407Z",
  "nodes": 25,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/5739",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated invoice data extraction with LlamaParse, Gemini 2.5 & Google Sheets",
    "workflowName": "Automated invoice data extraction with LlamaParse, Gemini 2.5 & Google Sheets",
    "description": "### This n8n template demonstrates how to automate invoice data extraction from PDF attachments received via Gmail. Using LlamaParse and Gemini LLM, this workflow parses structured fields like PO numbers, line items, tax amounts, and totals ‚Äî and stores them neatly into a Google Sheet.\n\nPerfect for use cases such as:\nüíº Finance teams managing vendor invoices\nüìä Bookkeeping workflows\nüîÑ Automating monthly reconciliation\n\n\n## Good to Know\nAt the time of writing, LlamaParse and Gemini may involve API usage costs depending on your subscription tier. Check LlamaIndex Pricing and Gemini Pricing for updated info.\n\nLlamaParse provides Markdown-formatted parsed output which is then passed to an LLM for structured field extraction.\n\nGemini models may be geo-restricted. If you encounter \"model not found\" errors, your region might not be supported.\n\n\n## How it Works\n- Trigger: Watches your Gmail for new emails with PDF attachments.\n- Email Filter: Ensures we only parse fresh emails not already labeled as \"invoice synced\".\n- LlamaParse Upload: Uploads the PDF to LlamaParse‚Äôs parsing endpoint.\n- Status Polling: Periodically checks whether the parsing is complete.\n- Download Markdown: Once ready, it fetches the parsed invoice in Markdown format.\n- AI Parsing with Gemini: Sends the Markdown to Gemini LLM to extract structured JSON (like PO number, line items, taxes, etc.) using a predefined schema.\n- Google Sheets Upload: Stores extracted data into a predefined spreadsheet. \n- Labeling: Marks the email as ‚Äúinvoice synced‚Äù to avoid reprocessing.\n\n## How to Use\nThe trigger is based on Gmail, but you can replace this with a webhook or manual trigger for testing.\n\n## Setup Instructions\nGmail API\n- Enable Gmail API in Google Cloud Console.\n- Connect your Gmail account in n8n credentials.\n- Allow read + modify access.\n\nGoogle Sheets\n\n- Create a new Google Sheet with the following headers (row 1): Date | Vendor Name | Invoice Number | PO Number | Line Items | Subtotal | Tax | Total Amount\n- Connect Google Sheets in n8n and paste the Sheet ID in the node.\n- You can customise the google sheet basis your requirement.\n\nLlamaParse\n\n- Get a LlamaIndex API Key from LlamaIndex.\n- Use the LlamaParse upload and polling nodes to process your PDFs.\n\nGemini (via Vertex AI)\n\n- Set up Gemini access in GCP.\n- Use the Gemini 2.5 Model.\n- Construct a structured prompt to extract required fields.\n\nLabeling\n\n- Create a Gmail label named \"Invoice Synced\" for tracking processed emails.\n\n## Requirements\nGmail account with API access\n\nLlamaParse (LlamaIndex) account with API Key\n\nGoogle Sheets API credentials\n\nAccess to Gemini 2.5 model via Google Vertex AI\n\n## Customising This Workflow\nThis template is just the beginning. You can expand it to:\n\n- Auto-generate invoices back to vendors\n- Run duplicate checks before inserting into Sheets\n- Integrate with accounting tools like Zoho, QuickBooks, or Tally\n- Trigger Slack/Email notifications on specific vendors or high invoice amounts",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Upload to LlamaParse",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Receiving Invoices",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Append to Reconciliation Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Get Processing Status",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Wait to stay within service limits",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Is Job Ready?",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Add \"invoice synced\" Label",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Get Parsed Invoice Data",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Map Output",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.3"
    },
    {
      "name": "Apply Data Extraction Rules",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.4"
    },
    {
      "name": "Should Process Email?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Split Out Labels",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Labels Names",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Combine Label Names",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Email with Label Names",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    }
  ]
}