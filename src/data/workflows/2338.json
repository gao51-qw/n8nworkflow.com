{
  "id": 2338,
  "slug": "2338",
  "title": "Reconcile rent payments with local Excel spreadsheet and OpenAI",
  "description": "This n8n workflow is designed to work on the local network and assists with reconciling downloaded bank statements with internal tenant records to quickly highlight any issues with payments such as missed or late payments or those of incorrect amounts.\n\nThis assistant can then generate a report to quick flag attention to ensure remedial action is taken.\n\n## How it works\n\n* The workflow monitors a local network drive to watch for new bank statements that are added.\n* This bank statement is then imported into the n8n workflow, its contents extracted and sent to the AI Agent.\n* The AI Agent analyses the line items to identify the dates and any incoming payments from tenants.\n* The AI agent then uses an locally-hosted Excel (\"XLSX\") spreadsheet to get both tenant records and property records. From this data, it can determine for each active tenant when payment is due, the amount and the tenancy duration.\n* Comparing to the bank statement, the AI Agent can now report on where tenants have missed their payments, made late payments or are paying the incorrect amounts.\n* The final report is generated and logged in the same XLSX for a human to check and action.\n\n## Requirements\n\n* A self-hosted version of n8n is required.\n* OpenAI account for the AI model\n\n## Customising this workflow\n\nIf you organisation has a Slack or Teams account, consider sending reports to a channel for increased productivity. Email may be a good choice too.\n\n## Want to go fully local?\n\nA version of this workflow is available which uses Ollama instead. You can download this template here: https://drive.google.com/file/d/1YRKjfakpInm23F_g8AHupKPBN-fphWgK/view?usp=sharing",
  "featuredImage": "/data/workflows/2338/2338.webp",
  "author": {
    "id": 101,
    "slug": "jimleuk",
    "name": "Jimleuk",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 7845,
  "downloads": 784,
  "createdAt": "2024-07-11T08:49:45.563Z",
  "updatedAt": "2026-01-16T08:24:05.963Z",
  "publishedAt": "2024-07-11T08:49:45.563Z",
  "nodes": 17,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/2338",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Reconcile rent payments with local Excel spreadsheet and OpenAI",
    "workflowName": "Reconcile rent payments with local Excel spreadsheet and OpenAI",
    "description": "This n8n workflow is designed to work on the local network and assists with reconciling downloaded bank statements with internal tenant records to quickly highlight any issues with payments such as missed or late payments or those of incorrect amounts.\n\nThis assistant can then generate a report to quick flag attention to ensure remedial action is taken.\n\n## How it works\n\n* The workflow monitors a local network drive to watch for new bank statements that are added.\n* This bank statement is then imported into the n8n workflow, its contents extracted and sent to the AI Agent.\n* The AI Agent analyses the line items to identify the dates and any incoming payments from tenants.\n* The AI agent then uses an locally-hosted Excel (\"XLSX\") spreadsheet to get both tenant records and property records. From this data, it can determine for each active tenant when payment is due, the amount and the tenancy duration.\n* Comparing to the bank statement, the AI Agent can now report on where tenants have missed their payments, made late payments or are paying the incorrect amounts.\n* The final report is generated and logged in the same XLSX for a human to check and action.\n\n## Requirements\n\n* A self-hosted version of n8n is required.\n* OpenAI account for the AI model\n\n## Customising this workflow\n\nIf you organisation has a Slack or Teams account, consider sending reports to a channel for increased productivity. Email may be a good choice too.\n\n## Want to go fully local?\n\nA version of this workflow is available which uses Ollama instead. You can download this template here: https://drive.google.com/file/d/1YRKjfakpInm23F_g8AHupKPBN-fphWgK/view?usp=sharing",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Watch For Bank Statements",
      "type": "n8n-nodes-base.localFileTrigger",
      "role": "localFileTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Tenant Details",
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "role": "toolCode",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Get Bank Statement File",
      "type": "n8n-nodes-base.readWriteFile",
      "role": "readWriteFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Get CSV Data",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Alert Actions To List",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Property Details",
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "role": "toolCode",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Set Variables",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Append To Spreadsheet",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Reconcile Rental Payments",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.6"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}