{
  "id": 12576,
  "slug": "12576",
  "title": "Detect and score refund risk with Webhook, OpenAI and Google Sheets",
  "description": "## How it works  \nThis workflow automatically evaluates refund and chargeback risk for incoming e-commerce orders. Orders are received via a webhook, processed individually, and checked to avoid duplicate analysis. Each transaction is normalized and sent to OpenAI for structured risk scoring and classification. Results are logged for auditing, alerts are triggered for high-risk cases, and processed orders are marked to prevent reprocessing.\n\n## Step-by-step  \n- **Step 1 – Ingest incoming orders**  \n  - **Webhook** – Receives single or bulk order payloads from external systems.  \n  - **Split Out** – Breaks array-based payloads into individual order records.  \n  - **Split In Batches** – Iterates through each order in a controlled loop.\n\n- **Step 2 – Deduplication check**  \n  - **IF (DEDUPE CHECK)** – Verifies whether an order was already processed and skips duplicates.\n\n- **Step 3 – Normalize transaction data**  \n  - **Code (Normalize Data)** – Validates required fields and standardizes order, customer, and behavioral attributes.\n\n- **Step 4 – AI risk assessment**  \n  - **OpenAI (Message a model)** – Sends normalized transaction data to the AI model and requests a strict JSON risk evaluation.\n\n- **Step 5 – Parse AI output**  \n  - **Code (Parse AI Output)** – Cleans the AI response and extracts risk score, risk level, key drivers, and recommendations.\n\n- **Step 6 – Log results**  \n  - **Google Sheets (Append)** – Stores timestamps, order details, and AI risk outcomes for reporting and audits.\n\n- **Step 7 – Risk decision and alerts**  \n  - **IF (High Risk)** – Filters only transactions classified as HIGH risk.  \n  - **Discord** – Sends real-time alerts to operations or finance teams.  \n  - **Gmail** – Emails finance stakeholders with full risk context.\n\n- **Step 8 – Mark order as processed**  \n  - **Google Sheets (Update)** – Updates the source row to prevent duplicate processing.\n\n## Why use this?  \n- Automatically detects high refund or chargeback risk before losses occur.  \n- Eliminates manual review with consistent, AI-driven risk scoring.  \n- Sends instant alerts so teams can act quickly on high-risk orders.  \n- Maintains a clear audit trail for compliance and reporting.  \n- Scales easily to handle single or bulk order evaluations.\n",
  "featuredImage": "/data/workflows/12576/12576.webp",
  "author": {
    "id": 101,
    "slug": "itechnotion",
    "name": "Avkash Kakdiya",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 3,
  "downloads": 0,
  "createdAt": "2026-01-08T06:39:37.791Z",
  "updatedAt": "2026-01-16T09:12:43.560Z",
  "publishedAt": "2026-01-08T06:39:37.791Z",
  "nodes": 21,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/12576",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Detect and score refund risk with Webhook, OpenAI and Google Sheets",
    "workflowName": "Detect and score refund risk with Webhook, OpenAI and Google Sheets",
    "description": "## How it works  \nThis workflow automatically evaluates refund and chargeback risk for incoming e-commerce orders. Orders are received via a webhook, processed individually, and checked to avoid duplicate analysis. Each transaction is normalized and sent to OpenAI for structured risk scoring and classification. Results are logged for auditing, alerts are triggered for high-risk cases, and processed orders are marked to prevent reprocessing.\n\n## Step-by-step  \n- **Step 1 – Ingest incoming orders**  \n  - **Webhook** – Receives single or bulk order payloads from external systems.  \n  - **Split Out** – Breaks array-based payloads into individual order records.  \n  - **Split In Batches** – Iterates through each order in a controlled loop.\n\n- **Step 2 – Deduplication check**  \n  - **IF (DEDUPE CHECK)** – Verifies whether an order was already processed and skips duplicates.\n\n- **Step 3 – Normalize transaction data**  \n  - **Code (Normalize Data)** – Validates required fields and standardizes order, customer, and behavioral attributes.\n\n- **Step 4 – AI risk assessment**  \n  - **OpenAI (Message a model)** – Sends normalized transaction data to the AI model and requests a strict JSON risk evaluation.\n\n- **Step 5 – Parse AI output**  \n  - **Code (Parse AI Output)** – Cleans the AI response and extracts risk score, risk level, key drivers, and recommendations.\n\n- **Step 6 – Log results**  \n  - **Google Sheets (Append)** – Stores timestamps, order details, and AI risk outcomes for reporting and audits.\n\n- **Step 7 – Risk decision and alerts**  \n  - **IF (High Risk)** – Filters only transactions classified as HIGH risk.  \n  - **Discord** – Sends real-time alerts to operations or finance teams.  \n  - **Gmail** – Emails finance stakeholders with full risk context.\n\n- **Step 8 – Mark order as processed**  \n  - **Google Sheets (Update)** – Updates the source row to prevent duplicate processing.\n\n## Why use this?  \n- Automatically detects high refund or chargeback risk before losses occur.  \n- Eliminates manual review with consistent, AI-driven risk scoring.  \n- Sends instant alerts so teams can act quickly on high-risk orders.  \n- Maintains a clear audit trail for compliance and reporting.  \n- Scales easily to handle single or bulk order evaluations.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Normalize Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Parse AI Output",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "IF High Risk",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Email Finance",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 1"
    },
    {
      "name": "Log Result",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4"
    },
    {
      "name": "Update row in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "DEDUPE CHECK",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Message a model2",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Discord1",
      "type": "n8n-nodes-base.discord",
      "role": "discord",
      "configDescription": "Version 2"
    },
    {
      "name": "Webhook1",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}