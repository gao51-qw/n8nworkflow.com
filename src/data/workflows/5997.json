{
  "id": 5997,
  "slug": "5997",
  "title": "Malicious file detection & response: Wazuh to VirusTotal with Slack alerts",
  "description": "# Malicious File Detection & Threat Summary Automation using Wazuh + VirusTotal + n8n\n\nThis workflow helps SOC teams automate the detection and reporting of potentially malicious files using **Wazuh alerts**, **VirusTotal hash validation**, and integrated **summary/report generation**. It's ideal for analysts who want instant context and communication for file-based threats — without writing a single line of code.\n\n---\n\n## What It Does\n\nWhen Wazuh detects a suspicious file:\n\n- **Ingests Wazuh Alert**  \n  A webhook node captures incoming alerts containing file hashes (SHA256/MD5).\n\n- **Parses IOCs**  \n  Extracts relevant indicators (file hash, filename, etc.).\n\n- **Validates with VirusTotal**  \n  Automatically checks the file hash reputation using VirusTotal's threat intelligence API.\n\n- **Generates Human-Readable Summary**  \n  Outputs a structured file report.\n\n- **Routes Alerts Based on Threat Level**  \n  - Sends a formatted email with the file summary using Gmail.  \n  - If the file is deemed malicious/suspicious:\n    - Creates a file-related incident ticket.  \n    - Sends an instant Slack alert to notify the team.\n\n---\n\n## Tech Stack Used\n\n- **Wazuh** – For endpoint alerting  \n- **VirusTotal API** – For real-time hash validation  \n- **n8n** – To orchestrate, parse, enrich, and communicate  \n- **Slack, Gmail, Incident Tool** – To notify and take action\n\n---\n\n## Ideal Use Case\n\nThis template is designed for security teams looking to automate **file threat triage**, **IOC validation**, and **alert-to-ticket escalation**, with zero human delay.\n\n---\n\n## Included Nodes\n\n- **Webhook** (Wazuh)\n- **Function** (IOC extraction and summary)\n- **HTTP Request** (VirusTotal)\n- **If / Switch** (threat level check)\n- **Gmail**, **Slack**, **Incident Creation**\n\n---\n\n## Tips\n\n- Make sure to add your **VirusTotal API key** in the HTTP node.  \n- Customize the **incident creation node** to fit your ticketing platform (Jira, ServiceNow, etc.).  \n- Add logic to enrich the file alert further using WHOIS or sandbox reports if needed.\n",
  "featuredImage": "/data/workflows/5997/5997.webp",
  "author": {
    "id": 101,
    "slug": "rajneeshgupta",
    "name": "Rajneesh Gupta",
    "avatar": ""
  },
  "categories": [
    "SecOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 2085,
  "downloads": 208,
  "createdAt": "2025-07-14T12:43:58.086Z",
  "updatedAt": "2026-01-16T08:42:34.729Z",
  "publishedAt": "2025-07-14T12:43:58.086Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/5997",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Malicious file detection & response: Wazuh to VirusTotal with Slack alerts",
    "workflowName": "Malicious file detection & response: Wazuh to VirusTotal with Slack alerts",
    "description": "# Malicious File Detection & Threat Summary Automation using Wazuh + VirusTotal + n8n\n\nThis workflow helps SOC teams automate the detection and reporting of potentially malicious files using **Wazuh alerts**, **VirusTotal hash validation**, and integrated **summary/report generation**. It's ideal for analysts who want instant context and communication for file-based threats — without writing a single line of code.\n\n---\n\n## What It Does\n\nWhen Wazuh detects a suspicious file:\n\n- **Ingests Wazuh Alert**  \n  A webhook node captures incoming alerts containing file hashes (SHA256/MD5).\n\n- **Parses IOCs**  \n  Extracts relevant indicators (file hash, filename, etc.).\n\n- **Validates with VirusTotal**  \n  Automatically checks the file hash reputation using VirusTotal's threat intelligence API.\n\n- **Generates Human-Readable Summary**  \n  Outputs a structured file report.\n\n- **Routes Alerts Based on Threat Level**  \n  - Sends a formatted email with the file summary using Gmail.  \n  - If the file is deemed malicious/suspicious:\n    - Creates a file-related incident ticket.  \n    - Sends an instant Slack alert to notify the team.\n\n---\n\n## Tech Stack Used\n\n- **Wazuh** – For endpoint alerting  \n- **VirusTotal API** – For real-time hash validation  \n- **n8n** – To orchestrate, parse, enrich, and communicate  \n- **Slack, Gmail, Incident Tool** – To notify and take action\n\n---\n\n## Ideal Use Case\n\nThis template is designed for security teams looking to automate **file threat triage**, **IOC validation**, and **alert-to-ticket escalation**, with zero human delay.\n\n---\n\n## Included Nodes\n\n- **Webhook** (Wazuh)\n- **Function** (IOC extraction and summary)\n- **HTTP Request** (VirusTotal)\n- **If / Switch** (threat level check)\n- **Gmail**, **Slack**, **Incident Creation**\n\n---\n\n## Tips\n\n- Make sure to add your **VirusTotal API key** in the HTTP node.  \n- Customize the **incident creation node** to fit your ticketing platform (Jira, ServiceNow, etc.).  \n- Add logic to enrich the file alert further using WHOIS or sandbox reports if needed.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "file summary display",
      "type": "n8n-nodes-base.html",
      "role": "html",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Gmail1",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Wazuh Alert",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Extract IOCs",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Generate File Summary",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Filter Suspicious Files",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Create File Incident",
      "type": "n8n-nodes-base.serviceNow",
      "role": "serviceNow",
      "configDescription": "Version 1"
    },
    {
      "name": "Slack File Alert",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "VirusTotal File Hash Validation",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}