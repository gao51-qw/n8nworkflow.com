{
  "id": 11975,
  "slug": "11975",
  "title": "AI-powered security analysis for n8n with Google Gemini and n8n audit API",
  "description": "# Generate a security audit report from an n8n instance to a web form\nThis workflow provides a deep-dive security assessment of an n8n instance using the native Audit API and AI analysis.\n\n## Who’s it for\n* This template is for n8n administrators and DevSecOps engineers who need to maintain a high security standard across their automation infrastructure. \n* It is particularly useful for teams managing self-hosted instances with multiple users.\n\n## How it works\n* The workflow triggers via an n8n Form where you provide your instance URL and API key. \n* It calls the official n8n Audit API to scan for five categories of risk: instance settings, credentials, database (SQL injection), nodes, and filesystem access. \n* A Code node parses this data, which is then analyzed by Google Gemini to create a prioritized remediation plan.\n\n## Requirements\n* n8n version v1.0 or higher.\n* A Google Gemini API Key.\n* An n8n API Key with 'Audit' scope permissions.\n\n## How to set up\n1. Create a Google Gemini API credential in n8n.\n2. Ensure your n8n API key has the correct scopes.\n3. Execute the workflow and enter your credentials into the trigger form.\n\n## How to customize the workflow\n* You can easily swap the Google Gemini node for OpenAI or Anthropic. \n* You can also add a 'Send Email' or 'Slack' node at the end to automatically route the report to your security channel instead of just viewing it in the browser.\n",
  "featuredImage": "/data/workflows/11975/11975.webp",
  "author": {
    "id": 101,
    "slug": "hatemgifaeeri",
    "name": "Hatem Gifaeeri",
    "avatar": ""
  },
  "categories": [
    "SecOps",
    "AI Summarization"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 86,
  "downloads": 8,
  "createdAt": "2025-12-19T22:30:15.417Z",
  "updatedAt": "2026-01-16T09:10:51.791Z",
  "publishedAt": "2025-12-19T22:30:15.417Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11975",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "AI-powered security analysis for n8n with Google Gemini and n8n audit API",
    "workflowName": "AI-powered security analysis for n8n with Google Gemini and n8n audit API",
    "description": "# Generate a security audit report from an n8n instance to a web form\nThis workflow provides a deep-dive security assessment of an n8n instance using the native Audit API and AI analysis.\n\n## Who’s it for\n* This template is for n8n administrators and DevSecOps engineers who need to maintain a high security standard across their automation infrastructure. \n* It is particularly useful for teams managing self-hosted instances with multiple users.\n\n## How it works\n* The workflow triggers via an n8n Form where you provide your instance URL and API key. \n* It calls the official n8n Audit API to scan for five categories of risk: instance settings, credentials, database (SQL injection), nodes, and filesystem access. \n* A Code node parses this data, which is then analyzed by Google Gemini to create a prioritized remediation plan.\n\n## Requirements\n* n8n version v1.0 or higher.\n* A Google Gemini API Key.\n* An n8n API Key with 'Audit' scope permissions.\n\n## How to set up\n1. Create a Google Gemini API credential in n8n.\n2. Ensure your n8n API key has the correct scopes.\n3. Execute the workflow and enter your credentials into the trigger form.\n\n## How to customize the workflow\n* You can easily swap the Google Gemini node for OpenAI or Anthropic. \n* You can also add a 'Send Email' or 'Slack' node at the end to automatically route the report to your security channel instead of just viewing it in the browser.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Prepare Audit Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Report Generator",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.4"
    },
    {
      "name": "Format Report Output",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "gemini-2.f-flash",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "On form submission",
      "type": "n8n-nodes-base.formTrigger",
      "role": "formTrigger",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Get Audit Data",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Code Explanation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Stage 1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Stage 3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Workflow Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Display Final Audit Report",
      "type": "n8n-nodes-base.form",
      "role": "form",
      "configDescription": "Version 2.3"
    }
  ]
}