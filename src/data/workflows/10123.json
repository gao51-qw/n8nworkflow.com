{
  "id": 10123,
  "slug": "10123",
  "title": "Automated invoice-PO matching with Google Gemini AI and email notifications",
  "description": "## Automated Invoice-Processing AI Agent for n8n\nOverview\nThe Automated Invoice-Processing AI Agent in n8n is designed to streamline and optimize invoice management for finance teams and accounts payable (AP) professionals. This solution addresses the common challenge of verifying invoice data manually, cross-checking it against purchase orders (POs), and ensuring compliance before releasing payments. By intelligently fetching invoices from Google Drive, extracting key details, validating them against PO records from Google Sheets, and automating the next actions, this system reduces human intervention, minimizes errors, and accelerates the payment process.\n\n### Target Audience\nThis automation primarily serves finance and AP teams responsible for managing large volumes of vendor invoices. It also supports finance managers, procurement departments, and auditors who require accuracy in payment reconciliation, ensuring that invoices align with approved POs before processing.\n\n### Business Problem Addressed\nOrganizations frequently struggle with time-consuming manual invoice verification and data entry. Discrepancies between invoices and purchase orders can lead to payment delays, compliance risks, or duplicate payments. This n8n-based AI agent automates that process—ensuring that every invoice is validated, exceptions are flagged to the finance team promptly, and payments of smaller value (under defined thresholds) are processed automatically.\n\n### Prerequisites\n\nActive n8n account or self-hosted instance\n\nGoogle Drive and Google Sheets connected via n8n credentials\n\nLLM (AI node) configured for document extraction (optional but recommended)\n\nA Google Sheet set up with existing PO data (including PO Number, Amount, and Date fields)\n\n### Setup Instructions\n\nConnect Google Drive and Google Sheets integrations within n8n.\n\nConfigure the workflow trigger to monitor a designated \"Invoices\" folder.\n\nAdd a document-parsing node to extract invoice details such as PO Number, Invoice Date, and Amount.\n\n### Implement conditional logic:\n\nIf the invoice amount &gt; 5000, the agent cross-references PO details from the Google Sheet.\n\nIf it matches, it updates the PO sheet status to “Process Payment.”\n\nIf not, an automated email notifies the finance team.\n\nIf the amount ≤ 5000, the workflow marks it for direct payment.\n\nTest the workflow with sample invoices before full deployment.\n\n### Customization Options\n\nAdjust the payment threshold value (e.g., 10,000 instead of 5,000).\n\nCustomize the email notification template and recipient list.\n\nIntegrate with accounting systems such as QuickBooks or SAP for end-to-end automation.\n\nAdd audit logging nodes to create traceability for every action taken.\n\nThis AI-driven automation brings speed, accuracy, and scalability to invoice verification—empowering finance professionals to focus on analytical and strategic tasks rather than repetitive manual work.",
  "featuredImage": "/data/workflows/10123/10123.webp",
  "author": {
    "id": 101,
    "slug": "matheen",
    "name": "Abdul Matheen",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1103,
  "downloads": 110,
  "createdAt": "2025-10-24T12:42:34.287Z",
  "updatedAt": "2026-01-16T09:03:32.431Z",
  "publishedAt": "2025-10-24T12:42:34.287Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10123",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated invoice-PO matching with Google Gemini AI and email notifications",
    "workflowName": "Automated invoice-PO matching with Google Gemini AI and email notifications",
    "description": "## Automated Invoice-Processing AI Agent for n8n\nOverview\nThe Automated Invoice-Processing AI Agent in n8n is designed to streamline and optimize invoice management for finance teams and accounts payable (AP) professionals. This solution addresses the common challenge of verifying invoice data manually, cross-checking it against purchase orders (POs), and ensuring compliance before releasing payments. By intelligently fetching invoices from Google Drive, extracting key details, validating them against PO records from Google Sheets, and automating the next actions, this system reduces human intervention, minimizes errors, and accelerates the payment process.\n\n### Target Audience\nThis automation primarily serves finance and AP teams responsible for managing large volumes of vendor invoices. It also supports finance managers, procurement departments, and auditors who require accuracy in payment reconciliation, ensuring that invoices align with approved POs before processing.\n\n### Business Problem Addressed\nOrganizations frequently struggle with time-consuming manual invoice verification and data entry. Discrepancies between invoices and purchase orders can lead to payment delays, compliance risks, or duplicate payments. This n8n-based AI agent automates that process—ensuring that every invoice is validated, exceptions are flagged to the finance team promptly, and payments of smaller value (under defined thresholds) are processed automatically.\n\n### Prerequisites\n\nActive n8n account or self-hosted instance\n\nGoogle Drive and Google Sheets connected via n8n credentials\n\nLLM (AI node) configured for document extraction (optional but recommended)\n\nA Google Sheet set up with existing PO data (including PO Number, Amount, and Date fields)\n\n### Setup Instructions\n\nConnect Google Drive and Google Sheets integrations within n8n.\n\nConfigure the workflow trigger to monitor a designated \"Invoices\" folder.\n\nAdd a document-parsing node to extract invoice details such as PO Number, Invoice Date, and Amount.\n\n### Implement conditional logic:\n\nIf the invoice amount &gt; 5000, the agent cross-references PO details from the Google Sheet.\n\nIf it matches, it updates the PO sheet status to “Process Payment.”\n\nIf not, an automated email notifies the finance team.\n\nIf the amount ≤ 5000, the workflow marks it for direct payment.\n\nTest the workflow with sample invoices before full deployment.\n\n### Customization Options\n\nAdjust the payment threshold value (e.g., 10,000 instead of 5,000).\n\nCustomize the email notification template and recipient list.\n\nIntegrate with accounting systems such as QuickBooks or SAP for end-to-end automation.\n\nAdd audit logging nodes to create traceability for every action taken.\n\nThis AI-driven automation brings speed, accuracy, and scalability to invoice verification—empowering finance professionals to focus on analytical and strategic tasks rather than repetitive manual work.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Download file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "role": "informationExtractor",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.3"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Google Gemini Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "PO_DB",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Update_Row",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.7"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Append row in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.microsoftOutlook",
      "role": "microsoftOutlook",
      "configDescription": "Version 2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}