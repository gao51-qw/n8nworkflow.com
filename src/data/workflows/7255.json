{
  "id": 7255,
  "slug": "7255",
  "title": "Create daily newsletter digests from Gmail using GPT-4.1-mini",
  "description": "## Summary\nEvery day at a set time, this workflow fetches yesterday’s newsletters from Gmail, summarizes each email into concise topics with an LLM, merges all topics, renders a clean HTML digest, and emails it to your inbox.\n\n## What this workflow does\n-  Triggers on a daily schedule (default 16:00, server time)\n-  Fetches Gmail messages since yesterday using a custom search query with optional sender filters\n-  Retrieves and decodes each email’s HTML, subject, sender name, and date\n-  Prompts an LLM (GPT‑4.1‑mini) to produce a consistent JSON summary of topics per email\n-  Merges topics from all emails into a single list\n-  Renders a styled HTML email with enumerated items\n-  Sends the HTML digest to a specified recipient via Gmail\n\n## Apps and credentials\n-  Gmail OAuth2: Gmail account (read and send)\n-  OpenAI: OpenAi account\n\n## Typical use cases\n-  Daily/weekly newsletter rollups delivered as one email\n-  Curated digests from specific media or authors\n-  Team briefings that are easy to read and forward\n\n## How it works (node-by-node)\n-  Schedule Trigger\n  \t- Fires at the configured hour (default 16:00).\n-  Get many messages (Gmail → getAll, returnAll: true)\n  \t- Uses a filter like:\n    =(from:____@____.com) OR (from:____@____.com) OR (from:____@____.com -\"____\") after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n  \t- Returns a list of message IDs from the past day.\n-  Loop Over Items (Split in Batches)\n  \t- Iterates through each message ID.\n-  Get a message (Gmail → get)\n  \t- Retrieves the full message/payload for the current email.\n-  Get message data (Code)\n  \t- Extracts HTML from Gmail’s MIME parts.\n  \t- Normalizes the sender to just the display name.\n \t - Formats the date as DD.MM.YYYY.\n \t - Passes html, subject, from, date forward.\n-  Clean (Code)\n  \t- Converts DD.MM.YYYY → MM.DD (for prompt brevity).\n  \t- Passes html, subject, from, date to the LLM.\n-  Message a model (OpenAI, model: gpt‑4.1‑mini, JSON output)\n  \t- Prompt instructs:\n    \t\t- Produce JSON: { \"topics\": [ { \"title\", \"descr\", \"subject\", \"from\", \"date\" } ] }\n   \t\t - Split multi-news blocks into separate topics\n    \t\t- Combine or ignore specific blocks for particular senders (placeholders ____)\n   \t\t - Keep subject untranslated; other values in ____ language\n    \t\t- Injects subject/from/date/html from the current email\n-  Loop Over Items (continues)\n \t - Processes all emails for the time window.\n-  Merge (Code)\n  \t- Flattens the topics arrays from all processed emails into one combined topics list.\n-  Create template (Code)\n  \t- Builds a complete HTML email:\n    \t\t- Enumerated items with title, one-line description\n    \t\t- Original subject and “from — date”\n    \t\t- Safely escapes HTML and preserves line breaks\n    \t\t- Inline, email-friendly styles\n-  Send a message (Gmail → send)\n  \t- Sends the final HTML to your recipient with a custom subject.\n\nNode map\n| Node | Type | Purpose |\n|---|---|---|\n| Schedule Trigger | Trigger | Run at a specific time each day |\n| Get many messages | Gmail (getAll) | Search emails since yesterday with filters |\n| Loop Over Items | Split in Batches | Iterate messages one-by-one |\n| Get a message | Gmail (get) | Fetch full message payload |\n| Get message data | Code | Extract HTML/subject/from/date; normalize sender and date |\n| Clean | Code | Reformat date and forward fields to LLM |\n| Message a model | OpenAI | Summarize email into JSON topics |\n| Merge | Code | Merge topics from all emails |\n| Create template | Code | Render a styled HTML email digest |\n| Send a message | Gmail (send) | Deliver the digest email |\n\nBefore you start\n-  Connect Gmail OAuth2 in n8n (ensure it has both read and send permissions)\n-  Add your OpenAI API key\n-  Import the provided workflow JSON into n8n\n\nSetup instructions\n1) Schedule\n-  Schedule Trigger node:\n  - Set your preferred hour (server time). Default is 16:00.\n\n2) Gmail\n-  Get many messages:\n  \t- Adjust filters.q to your senders/labels and window:\n    \t\t- Example: =(from:news@publisher.com) OR (from:briefs@media.com -\"promo\") after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n  \t- You can use label: or category: to narrow scope.\n-  Send a message:\n  \t- sendTo = your email\n  \t- subject = your subject line\n  \t- message = set to {{ $json.htmlBody }} (already produced by Create template)\n \t - The HTML body uses inline styles for broad email client support.\n\n3) OpenAI\n-  Message a model:\n  \t- Model: gpt‑4.1‑mini (swap to gpt‑4o‑mini or your preferred)\n  \t- Update prompt placeholders:\n    \t\t- ____ language → your target language\n   \t\t - ____ sender rules → special cases (combine blocks, ignore sections)\n\n## How to use\n-  The workflow runs daily at the scheduled time, compiling a digest from yesterday’s emails.\n-  You’ll receive one HTML email with all topics neatly listed.\n-  Adjust the time window or filters to change what gets included.\n\n## Customization ideas\n-  Time window control:\n  \t- after: {{ $now.minus({ days: X }) }} and/or add before:\n-  Filter by labels:\n  \t- q = label:Newsletters after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n-  Language:\n  \t- Set the ____ language in the LLM prompt\n-  Template:\n  \t- Edit “Create template” to add a header, footer, hero section, logo/branding\n  \t- Include links parsed from HTML (add an HTML parser step in “Get message data”)\n-  Subject line:\n  \t- Make dynamic, e.g., “Digest for {{ $now.toFormat('dd.MM.yyyy') }}”\n-  Sender:\n  \t- Use a dedicated Gmail account or alias for deliverability and separation\n\n## Limits and notes\n-  Gmail size limit for outgoing emails is ~25 MB; large digests may need pruning\n-  LLM usage incurs cost and latency proportional to email size and count\n-  HTML rendering varies across clients; inline styles are used for compatibility\n-  Schedule uses the n8n server’s timezone; adjust if your server runs in a different TZ\n\n## Privacy and safety\n-  Emails are sent to OpenAI for summarization—ensure this aligns with your data policies\n-  Limit the Gmail search scope to only the newsletters you want processed\n-  Avoid including sensitive emails in the search window\n\n## Sample output (email body)\n-  Title 1\n  \t- One-sentence description\n  \t- Original Subject\n \t - → Sender — DD.MM.YYYY\n-  Title 2\n \t - One-sentence description\n \t - Original Subject\n \t - → Sender — DD.MM.YYYY\n\n## Tips and troubleshooting\n-  No emails found? Check filters.q and the time window (after:)\n-  Model returns empty JSON? Simplify the prompt or try another model\n-  Odd characters in output? The template escapes HTML and preserves line breaks; verify your input encoding\n-  Delivery issues? Use a verified sender, set a clear subject, and avoid spammy keywords\n\n## Tags\n-  gmail, openai, llm, newsletters, digest, summarization, email, automation\n\n## Changelog\n-  v1: Initial release with scheduled time window, sender filters, LLM summarization, topic merging, and HTML email template rendering",
  "featuredImage": "/data/workflows/7255/7255.webp",
  "author": {
    "id": 101,
    "slug": "vladzima",
    "name": "Vlad Arbatov",
    "avatar": ""
  },
  "categories": [
    "Personal Productivity",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 981,
  "downloads": 98,
  "createdAt": "2025-08-11T15:09:35.051Z",
  "updatedAt": "2026-01-16T08:49:18.496Z",
  "publishedAt": "2025-08-11T15:09:35.051Z",
  "nodes": 13,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7255",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Create daily newsletter digests from Gmail using GPT-4.1-mini",
    "workflowName": "Create daily newsletter digests from Gmail using GPT-4.1-mini",
    "description": "## Summary\nEvery day at a set time, this workflow fetches yesterday’s newsletters from Gmail, summarizes each email into concise topics with an LLM, merges all topics, renders a clean HTML digest, and emails it to your inbox.\n\n## What this workflow does\n-  Triggers on a daily schedule (default 16:00, server time)\n-  Fetches Gmail messages since yesterday using a custom search query with optional sender filters\n-  Retrieves and decodes each email’s HTML, subject, sender name, and date\n-  Prompts an LLM (GPT‑4.1‑mini) to produce a consistent JSON summary of topics per email\n-  Merges topics from all emails into a single list\n-  Renders a styled HTML email with enumerated items\n-  Sends the HTML digest to a specified recipient via Gmail\n\n## Apps and credentials\n-  Gmail OAuth2: Gmail account (read and send)\n-  OpenAI: OpenAi account\n\n## Typical use cases\n-  Daily/weekly newsletter rollups delivered as one email\n-  Curated digests from specific media or authors\n-  Team briefings that are easy to read and forward\n\n## How it works (node-by-node)\n-  Schedule Trigger\n  \t- Fires at the configured hour (default 16:00).\n-  Get many messages (Gmail → getAll, returnAll: true)\n  \t- Uses a filter like:\n    =(from:____@____.com) OR (from:____@____.com) OR (from:____@____.com -\"____\") after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n  \t- Returns a list of message IDs from the past day.\n-  Loop Over Items (Split in Batches)\n  \t- Iterates through each message ID.\n-  Get a message (Gmail → get)\n  \t- Retrieves the full message/payload for the current email.\n-  Get message data (Code)\n  \t- Extracts HTML from Gmail’s MIME parts.\n  \t- Normalizes the sender to just the display name.\n \t - Formats the date as DD.MM.YYYY.\n \t - Passes html, subject, from, date forward.\n-  Clean (Code)\n  \t- Converts DD.MM.YYYY → MM.DD (for prompt brevity).\n  \t- Passes html, subject, from, date to the LLM.\n-  Message a model (OpenAI, model: gpt‑4.1‑mini, JSON output)\n  \t- Prompt instructs:\n    \t\t- Produce JSON: { \"topics\": [ { \"title\", \"descr\", \"subject\", \"from\", \"date\" } ] }\n   \t\t - Split multi-news blocks into separate topics\n    \t\t- Combine or ignore specific blocks for particular senders (placeholders ____)\n   \t\t - Keep subject untranslated; other values in ____ language\n    \t\t- Injects subject/from/date/html from the current email\n-  Loop Over Items (continues)\n \t - Processes all emails for the time window.\n-  Merge (Code)\n  \t- Flattens the topics arrays from all processed emails into one combined topics list.\n-  Create template (Code)\n  \t- Builds a complete HTML email:\n    \t\t- Enumerated items with title, one-line description\n    \t\t- Original subject and “from — date”\n    \t\t- Safely escapes HTML and preserves line breaks\n    \t\t- Inline, email-friendly styles\n-  Send a message (Gmail → send)\n  \t- Sends the final HTML to your recipient with a custom subject.\n\nNode map\n| Node | Type | Purpose |\n|---|---|---|\n| Schedule Trigger | Trigger | Run at a specific time each day |\n| Get many messages | Gmail (getAll) | Search emails since yesterday with filters |\n| Loop Over Items | Split in Batches | Iterate messages one-by-one |\n| Get a message | Gmail (get) | Fetch full message payload |\n| Get message data | Code | Extract HTML/subject/from/date; normalize sender and date |\n| Clean | Code | Reformat date and forward fields to LLM |\n| Message a model | OpenAI | Summarize email into JSON topics |\n| Merge | Code | Merge topics from all emails |\n| Create template | Code | Render a styled HTML email digest |\n| Send a message | Gmail (send) | Deliver the digest email |\n\nBefore you start\n-  Connect Gmail OAuth2 in n8n (ensure it has both read and send permissions)\n-  Add your OpenAI API key\n-  Import the provided workflow JSON into n8n\n\nSetup instructions\n1) Schedule\n-  Schedule Trigger node:\n  - Set your preferred hour (server time). Default is 16:00.\n\n2) Gmail\n-  Get many messages:\n  \t- Adjust filters.q to your senders/labels and window:\n    \t\t- Example: =(from:news@publisher.com) OR (from:briefs@media.com -\"promo\") after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n  \t- You can use label: or category: to narrow scope.\n-  Send a message:\n  \t- sendTo = your email\n  \t- subject = your subject line\n  \t- message = set to {{ $json.htmlBody }} (already produced by Create template)\n \t - The HTML body uses inline styles for broad email client support.\n\n3) OpenAI\n-  Message a model:\n  \t- Model: gpt‑4.1‑mini (swap to gpt‑4o‑mini or your preferred)\n  \t- Update prompt placeholders:\n    \t\t- ____ language → your target language\n   \t\t - ____ sender rules → special cases (combine blocks, ignore sections)\n\n## How to use\n-  The workflow runs daily at the scheduled time, compiling a digest from yesterday’s emails.\n-  You’ll receive one HTML email with all topics neatly listed.\n-  Adjust the time window or filters to change what gets included.\n\n## Customization ideas\n-  Time window control:\n  \t- after: {{ $now.minus({ days: X }) }} and/or add before:\n-  Filter by labels:\n  \t- q = label:Newsletters after:{{ $now.minus({ days: 1 }).toFormat('yyyy/MM/dd') }}\n-  Language:\n  \t- Set the ____ language in the LLM prompt\n-  Template:\n  \t- Edit “Create template” to add a header, footer, hero section, logo/branding\n  \t- Include links parsed from HTML (add an HTML parser step in “Get message data”)\n-  Subject line:\n  \t- Make dynamic, e.g., “Digest for {{ $now.toFormat('dd.MM.yyyy') }}”\n-  Sender:\n  \t- Use a dedicated Gmail account or alias for deliverability and separation\n\n## Limits and notes\n-  Gmail size limit for outgoing emails is ~25 MB; large digests may need pruning\n-  LLM usage incurs cost and latency proportional to email size and count\n-  HTML rendering varies across clients; inline styles are used for compatibility\n-  Schedule uses the n8n server’s timezone; adjust if your server runs in a different TZ\n\n## Privacy and safety\n-  Emails are sent to OpenAI for summarization—ensure this aligns with your data policies\n-  Limit the Gmail search scope to only the newsletters you want processed\n-  Avoid including sensitive emails in the search window\n\n## Sample output (email body)\n-  Title 1\n  \t- One-sentence description\n  \t- Original Subject\n \t - → Sender — DD.MM.YYYY\n-  Title 2\n \t - One-sentence description\n \t - Original Subject\n \t - → Sender — DD.MM.YYYY\n\n## Tips and troubleshooting\n-  No emails found? Check filters.q and the time window (after:)\n-  Model returns empty JSON? Simplify the prompt or try another model\n-  Odd characters in output? The template escapes HTML and preserves line breaks; verify your input encoding\n-  Delivery issues? Use a verified sender, set a clear subject, and avoid spammy keywords\n\n## Tags\n-  gmail, openai, llm, newsletters, digest, summarization, email, automation\n\n## Changelog\n-  v1: Initial release with scheduled time window, sender filters, LLM summarization, topic merging, and HTML email template rendering",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Get many messages",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Get a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Get message data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Clean",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create template",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Message a model",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    }
  ]
}