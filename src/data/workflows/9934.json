{
  "id": 9934,
  "slug": "9934",
  "title": "Keep RAG system updated with Google Drive file changes to Supabase vector DB",
  "description": "This n8n workflow ensures data freshness in the RAG system by handling modifications to existing files. It complements the \"Document Ingestion\" workflow by triggering whenever a file in the monitored Google Drive folder is updated.\n\nThis \"delete-then-re-insert\" process ensures the RAG agent always has access to the most current version of your documents.\n\nKey Features & Workflow:\n\nUpdate Trigger: The workflow activates using the File Updated trigger for the same Google Drive folder (\"DOCUMENTS\").\n\nDuplicate Run Prevention: An If node cleverly filters out immediate \"update\" events that are triggered by the \"Upload Doc\" workflow's Word-to-Google-Doc conversion, preventing unecessary duplicate runs.\n\nDelete Old Entries: Once a genuine update is detected, the workflow's first action is to find and delete all existing vector chunks associated with that file_id from the Supabase \"documents\" table.\n\nSmart Versioning: It then retrieves the old version number from the deleted metadata and uses an OpenAI node (Set Version) to intelligently increment it (e.g., \"v1\" becomes \"v2\").\n\nRe-Ingestion Pipeline: The updated file is then processed through the exact same logic as the \"Upload Doc\" workflow:\n\nIt is routed by a Switch node based on its MIME type (PDF, Google Doc, Excel, etc.).\n\nText is extracted, chunked, and embedded.\n\nThe Enhanced Default Data Loader enriches these new chunks with metadata, including the new, incremented version number.\n\nInsert New Entries: Finally, the newly processed and versioned chunks are inserted back into the Supabase Vector Store.",
  "featuredImage": "/data/workflows/9934/9934.webp",
  "author": {
    "id": 101,
    "slug": "edsan",
    "name": "edisantosa",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 425,
  "downloads": 42,
  "createdAt": "2025-10-20T11:27:42.042Z",
  "updatedAt": "2026-01-16T09:02:40.725Z",
  "publishedAt": "2025-10-20T11:27:42.042Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9934",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Keep RAG system updated with Google Drive file changes to Supabase vector DB",
    "workflowName": "Keep RAG system updated with Google Drive file changes to Supabase vector DB",
    "description": "This n8n workflow ensures data freshness in the RAG system by handling modifications to existing files. It complements the \"Document Ingestion\" workflow by triggering whenever a file in the monitored Google Drive folder is updated.\n\nThis \"delete-then-re-insert\" process ensures the RAG agent always has access to the most current version of your documents.\n\nKey Features & Workflow:\n\nUpdate Trigger: The workflow activates using the File Updated trigger for the same Google Drive folder (\"DOCUMENTS\").\n\nDuplicate Run Prevention: An If node cleverly filters out immediate \"update\" events that are triggered by the \"Upload Doc\" workflow's Word-to-Google-Doc conversion, preventing unecessary duplicate runs.\n\nDelete Old Entries: Once a genuine update is detected, the workflow's first action is to find and delete all existing vector chunks associated with that file_id from the Supabase \"documents\" table.\n\nSmart Versioning: It then retrieves the old version number from the deleted metadata and uses an OpenAI node (Set Version) to intelligently increment it (e.g., \"v1\" becomes \"v2\").\n\nRe-Ingestion Pipeline: The updated file is then processed through the exact same logic as the \"Upload Doc\" workflow:\n\nIt is routed by a Switch node based on its MIME type (PDF, Google Doc, Excel, etc.).\n\nText is extracted, chunked, and embedded.\n\nThe Enhanced Default Data Loader enriches these new chunks with metadata, including the new, incremented version number.\n\nInsert New Entries: Finally, the newly processed and versioned chunks are inserted back into the Supabase Vector Store.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Set File ID",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Delete Old Doc Rows",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Download File",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Summarize",
      "type": "n8n-nodes-base.summarize",
      "role": "summarize",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract PDF Text1",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract from Excel1",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert to Google Doc2",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.1"
    },
    {
      "name": "Delete File1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Recursive Character Text Splitter1",
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "role": "textSplitterRecursiveCharacterTextSplitter",
      "configDescription": "Version 1"
    },
    {
      "name": "Embeddings OpenAI2",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "role": "embeddingsOpenAi",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Enhanced Default Data Loader2",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "role": "documentDefaultDataLoader",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items1",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "File Updated",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Insert into Supabase Vectorstore",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "role": "vectorStoreSupabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3"
    },
    {
      "name": "Extract from Text File1",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Limit",
      "type": "n8n-nodes-base.limit",
      "role": "limit",
      "configDescription": "Version 1"
    },
    {
      "name": "Set Version",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.7"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}