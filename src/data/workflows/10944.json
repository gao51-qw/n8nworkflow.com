{
  "id": 10944,
  "slug": "10944",
  "title": "WhatsApp assistant with Gemini AI for calendar management via Evolution API",
  "description": "## AI Agent that uses MCP Server to execute actions requested via Evolution API.\n This workflow receives messages and media from WhatsApp via the Evolution API, converts the content into structured inputs, and forwards them to an AI Agent capable of triggering MCP tools to execute external actions.\n\n### üîß  **How it works**\n- A **Webhook** receives messages sent to WhatsApp via the **Evolution API**.\n- The **\"Message Type\"** node detects and forwards the received media. It handles the types `Text`, `Image`, `Audio`, and `Document`. If it is another media type, the fallback forwards a \"media not supported\" message to the user.\n- The message goes to the system where it retrieves the **Base64** of the media.\n- The media is converted into **Binary File(s)** and a Gemini node will generate a text input for the agent.\n- The **AI Agent** receives the structured input and calls the appropriate **MCP Tool**. In this example, only one **MCP Server** was configured.\n- The AI ‚Äã‚ÄãAgent generates the output and sends it to the user.\n\n### üóíÔ∏è Requirements\n- Evolution API Account, with the instance configured.\n- Gemini API.\n- Google Calendar API.\n- MCP Server (Internal or external, whichever you prefer) configured and with a URL to link to the MCP Tool.\n\n### ‚úîÔ∏è How to set up\n- **Configure the Evolution API webhook**\n    - Copy the webhook URL generated in the first node.\n    - In the Evolution API panel, go to the instance &gt; webhook &gt; paste the URL into the corresponding field.\n- **Configure Google Calendar credentials**\n    - In n8n, go to *Credentials ‚Üí Create New* and select **Google Calendar OAuth2**.\n    - Select this credential in all Google Calendar MCP nodes (Get, Create, Update, Delete).\n- **Enable MCP Server nodes**\n    - Copy the MCP Server URL and paste it into the ‚Äú**Endpoint** field of the MCP Tool.\n- **Configure Evolution API nodes**\n    - In all Evolution API nodes, you need to fill in the ‚Äú**instance** field with the name of your Evolution API instance.\n\n### ü¶æ how to adapt it?\n- **Customize or extend the MCP Tools**\n    - You can add new MCP tools (e.g., Google Sheets, Notion, ClickUp).\n    - Only the agent prompt needs to be updated; the workflow structure remains the same.\n- I opted to use simple memory, but if you want the agent to remember the entire conversation, I recommend changing the memory type; as it is, it will only remember the last 8 messages.\n- If you're going to use a tool like Chatwoot or TypeBot, simply change the webhook URL and pay attention to the objects that the switch (Message Type) uses.",
  "featuredImage": "/data/workflows/10944/10944.webp",
  "author": {
    "id": 101,
    "slug": "pedroprotes",
    "name": "Pedro Protes",
    "avatar": ""
  },
  "categories": [
    "Support Chatbot",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 600,
  "downloads": 60,
  "createdAt": "2025-11-17T23:15:08.909Z",
  "updatedAt": "2026-01-16T09:06:52.960Z",
  "publishedAt": "2025-11-17T23:15:08.909Z",
  "nodes": 31,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10944",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "WhatsApp assistant with Gemini AI for calendar management via Evolution API",
    "workflowName": "WhatsApp assistant with Gemini AI for calendar management via Evolution API",
    "description": "## AI Agent that uses MCP Server to execute actions requested via Evolution API.\n This workflow receives messages and media from WhatsApp via the Evolution API, converts the content into structured inputs, and forwards them to an AI Agent capable of triggering MCP tools to execute external actions.\n\n### üîß  **How it works**\n- A **Webhook** receives messages sent to WhatsApp via the **Evolution API**.\n- The **\"Message Type\"** node detects and forwards the received media. It handles the types `Text`, `Image`, `Audio`, and `Document`. If it is another media type, the fallback forwards a \"media not supported\" message to the user.\n- The message goes to the system where it retrieves the **Base64** of the media.\n- The media is converted into **Binary File(s)** and a Gemini node will generate a text input for the agent.\n- The **AI Agent** receives the structured input and calls the appropriate **MCP Tool**. In this example, only one **MCP Server** was configured.\n- The AI ‚Äã‚ÄãAgent generates the output and sends it to the user.\n\n### üóíÔ∏è Requirements\n- Evolution API Account, with the instance configured.\n- Gemini API.\n- Google Calendar API.\n- MCP Server (Internal or external, whichever you prefer) configured and with a URL to link to the MCP Tool.\n\n### ‚úîÔ∏è How to set up\n- **Configure the Evolution API webhook**\n    - Copy the webhook URL generated in the first node.\n    - In the Evolution API panel, go to the instance &gt; webhook &gt; paste the URL into the corresponding field.\n- **Configure Google Calendar credentials**\n    - In n8n, go to *Credentials ‚Üí Create New* and select **Google Calendar OAuth2**.\n    - Select this credential in all Google Calendar MCP nodes (Get, Create, Update, Delete).\n- **Enable MCP Server nodes**\n    - Copy the MCP Server URL and paste it into the ‚Äú**Endpoint** field of the MCP Tool.\n- **Configure Evolution API nodes**\n    - In all Evolution API nodes, you need to fill in the ‚Äú**instance** field with the name of your Evolution API instance.\n\n### ü¶æ how to adapt it?\n- **Customize or extend the MCP Tools**\n    - You can add new MCP tools (e.g., Google Sheets, Notion, ClickUp).\n    - Only the agent prompt needs to be updated; the workflow structure remains the same.\n- I opted to use simple memory, but if you want the agent to remember the entire conversation, I recommend changing the memory type; as it is, it will only remember the last 8 messages.\n- If you're going to use a tool like Chatwoot or TypeBot, simply change the webhook URL and pay attention to the objects that the switch (Message Type) uses.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Message Type",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.3"
    },
    {
      "name": "Message not supported",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "role": "evolutionApi",
      "configDescription": "Version 1"
    },
    {
      "name": "Transcribe a recording",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Audio",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Get base64 audio",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "role": "evolutionApi",
      "configDescription": "Version 1"
    },
    {
      "name": "Get base64 image",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "role": "evolutionApi",
      "configDescription": "Version 1"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Convert to image",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Convert to audio",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Analyze an image",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "role": "memoryBufferWindow",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Archestrator Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Get base64 document",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "role": "evolutionApi",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert to document",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Analyze document",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Document",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "MCP Server Google Calendar",
      "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
      "role": "mcpTrigger",
      "configDescription": "Version 2"
    },
    {
      "name": "Send message",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "role": "evolutionApi",
      "configDescription": "Version 1"
    },
    {
      "name": "MCP Calendar",
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "role": "mcpClientTool",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Image",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Create an event",
      "type": "n8n-nodes-base.googleCalendarTool",
      "role": "googleCalendarTool",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Get many events",
      "type": "n8n-nodes-base.googleCalendarTool",
      "role": "googleCalendarTool",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Delete an event",
      "type": "n8n-nodes-base.googleCalendarTool",
      "role": "googleCalendarTool",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Update an event",
      "type": "n8n-nodes-base.googleCalendarTool",
      "role": "googleCalendarTool",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}