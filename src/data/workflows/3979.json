{
  "id": 3979,
  "slug": "3979",
  "title": "Raw materials inventory management with Google Sheets, Supabase and approvals",
  "description": "# Automated Raw Materials Inventory Management with Google Sheets, Supabase, and Gmail using n8n Webhooks\n\n![Screenshot 20250514 at 14.02.15.png](fileId:1312)\n\n## Description\n\n### What Problem Does This Solve? üõ†Ô∏è\nThis workflow automates raw materials inventory management for businesses, eliminating manual stock updates, delayed material issue approvals, and missed low stock alerts. It ensures real-time stock tracking, streamlined approvals, and timely notifications. \n\n**Target audience**: Small to medium-sized businesses, inventory managers, and n8n users familiar with Google Sheets, Supabase, and Gmail integrations.\n\n### What Does It Do? üåü\n- Receives raw material data and issue requests via form submissions.\n- Updates stock levels in Google Sheets and Supabase.\n- Manages approvals for material issue requests with email notifications.\n- Detects low stock levels and sends alerts via Gmail.\n- Maintains data consistency across Google Sheets and Supabase.\n\n### Key Features \n- Real-time stock updates from form submissions.\n- Automated approval process for material issuance.\n- Low stock detection with Gmail notifications.\n- Dual storage in Google Sheets and Supabase for redundancy.\n- Error handling for robust data validation.\n\n## Setup Instructions\n\n### Prerequisites \n- **n8n Instance**: Self-hosted or cloud n8n instance.\n- **API Credentials**:\n  - **Google Sheets API**: Credentials from Google Cloud Console with Sheets scope, stored in n8n credentials.\n  - **Supabase API**: API key and URL from Supabase project, stored in n8n credentials (do not hardcode in nodes).\n  - **Gmail API**: Credentials from Google Cloud Console with Gmail scope.\n- **Forms**: A form (e.g., Google Form) to submit raw material receipts and issue requests, configured to send data to n8n webhooks.\n\n### Installation Steps \n1. **Import the Workflow**:\n   - Copy the workflow JSON from the ‚ÄúTemplate Code‚Äù section (to be provided).\n   - Import it into n8n via ‚ÄúImport from File‚Äù or ‚ÄúImport from URL‚Äù.\n2. **Configure Credentials**:\n   - Add API credentials in n8n‚Äôs Credentials section for Google Sheets, Supabase, and Gmail.\n   - Assign credentials to respective nodes. For example:\n     - In the Append Raw Materials node, use Google Sheets credentials: `{{ $credentials.GoogleSheets }}`.\n     - In the Current Stock Update node, use Supabase credentials: `{{ $credentials.Supabase }}`.\n     - In the Send Low Stock Email Alert node, use Gmail credentials.\n3. **Set Up Nodes**:\n   - **Webhook Nodes (Receive Raw Materials Webhook, Receive Material Issue Webhook)**: Configure webhook URLs and link them to your form submissions.\n   - **Approval Email (Send Approval Request)**: Customize the HTML email template if needed.\n   - **Low Stock Alerts (Send Low Stock Email Alert, Send Low Stock Email After Issue)**: Configure recipient email addresses.\n4. **Test the Workflow**:\n   - Submit a test form for raw material receipt and verify stock updates in Google Sheets/Supabase.\n   - Submit a material issue request, approve/reject it, and confirm stock updates and notifications.\n\n## How It Works\n\n### High-Level Steps \n1. **Receive Raw Materials**: Processes form submissions for raw material receipts.\n2. **Update Stock**: Updates stock levels in Google Sheets and Supabase.\n3. **Handle Issue Requests**: Processes material issue requests via forms.\n4. **Manage Approvals**: Sends approval requests and processes decisions.\n5. **Monitor Stock Levels**: Detects low stock and sends Gmail alerts.\n\n### Detailed Descriptions\nDetailed node descriptions are available in the sticky notes within the workflow screenshot (to be provided). Below is a summary of key actions.\n\n## Node Names and Actions\n\n### Raw Materials Receiving and Stock Update\n- **Receive Raw Materials Webhook**: Receives raw material data from a form submission.\n- **Standardize Raw Material Data**: Maps form data into a consistent format.\n- **Calculate Total Price**: Computes `Total Price` (Quantity Received * Unit Price).\n- **Append Raw Materials**: Records receipt in Google Sheets.\n- **Check Quantity Received Validity**: Ensures `Quantity Received` is valid.\n- **Lookup Existing Stock**: Retrieves current stock for the `Product ID`.\n- **Check If Product Exists**: Branches based on `Product ID` existence.\n- **Calculate Updated Current Stock**: Adds `Quantity Received` to stock (True branch).\n- **Update Current Stock**: Updates stock in Google Sheets (True branch).\n- **Retrieve Updated Stock for Check**: Retrieves updated stock for low stock check.\n- **Detect Low Stock Level**: Flags if stock is below minimum.\n- **Trigger Low Stock Alert**: Triggers email if stock is low.\n- **Send Low Stock Email Alert**: Sends low stock alert via Gmail.\n- **Add New Product to Stock**: Adds new product to stock (False branch).\n- **Current Stock Update**: Updates Supabase `Current Stock` table.\n- **New Row Current Stock**: Inserts new product into Supabase.\n- **Search Current Stock**: Retrieves Supabase stock records.\n- **New Record Raw**: Inserts raw material record into Supabase.\n- **Format Response**: Removes duplicates from Supabase response.\n- **Combine Stock Update Branches**: Merges branches for existing/new products.\n\n### Material Issue Request and Approval\n- **Receive Material Issue Webhook**: Receives issue request from a form submission.\n- **Standardize Data**: Normalizes request data and adds `Approval Link`.\n- **Validate Issue Request Data**: Ensures `Quantity Requested` is valid.\n- **Verify Requested Quantity**: Validates `Product ID` and `Submission ID`.\n- **Append Material Request**: Records request in Google Sheets.\n- **Check Available Stock for Issue**: Retrieves current stock for the request.\n- **Prepare Approval**: Checks stock sufficiency for the request.\n- **Send Approval Request**: Emails approver with Approve/Reject options.\n- **Receive Approval Response**: Captures approver‚Äôs decision via webhook.\n- **Format Approval Response**: Processes approval data with `Approval Date`.\n- **Verify Approval Data**: Validates the approval response.\n- **Retrieve Issue Request Details**: Retrieves original request from Google Sheets.\n- **Process Approval Decision**: Branches based on approval action.\n- **Get Stock for Issue Update**: Retrieves stock before update (Approved).\n- **Deduct Issued Stock**: Reduces stock by `Approved Quantity` (Approved).\n- **Update Stock After Issue**: Updates stock in Google Sheets (Approved).\n- **Retrieve Stock After Issue**: Retrieves updated stock for low stock check.\n- **Detect Low Stock After Issue**: Flags low stock after issuance.\n- **Trigger Low Stock Alert After Issue**: Triggers email if stock is low.\n- **Send Low Stock Email After Issue**: Sends low stock alert via Gmail.\n- **Update Issue Request Status**: Updates request status (Approved/Rejected).\n- **Combine Stock Lookup Results**: Merges stock lookup branches.\n- **Create Record Issue**: Inserts issue request into Supabase.\n- **Search Stock by Product ID**: Retrieves Supabase stock records.\n- **Issues Table Update**: Updates Supabase `Materials Issued` table.\n- **Update Current Stock**: Updates Supabase stock after issuance.\n- **Combine Issue Lookup Branches**: Merges issue lookup branches.\n- **Search Issue by Submission ID**: Retrieves Supabase issue records.\n\n## Customization Tips\n- **Expand Storage Options **: Add nodes to store data in other databases (e.g., Airtable) alongside Google Sheets and Supabase.\n- **Modify Approval Email **: Update the Send Approval Request node to customize the HTML email template (e.g., adjust styling or add branding).\n- **Alternative Notifications **: Add nodes to send low stock alerts via other platforms (e.g., Slack or Telegram).\n- **Adjust Low Stock Threshold **: Modify the Detect Low Stock Level node to change the `Minimum Stock Level` (default: 50).!",
  "featuredImage": "/data/workflows/3979/3979.webp",
  "author": {
    "id": 101,
    "slug": "spectrabit",
    "name": "Immanuel",
    "avatar": ""
  },
  "categories": [
    "Miscellaneous"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 4887,
  "downloads": 488,
  "createdAt": "2025-05-11T13:15:27.989Z",
  "updatedAt": "2026-01-16T08:32:29.024Z",
  "publishedAt": "2025-05-11T13:15:27.989Z",
  "nodes": 51,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3979",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Raw materials inventory management with Google Sheets, Supabase and approvals",
    "workflowName": "Raw materials inventory management with Google Sheets, Supabase and approvals",
    "description": "# Automated Raw Materials Inventory Management with Google Sheets, Supabase, and Gmail using n8n Webhooks\n\n![Screenshot 20250514 at 14.02.15.png](fileId:1312)\n\n## Description\n\n### What Problem Does This Solve? üõ†Ô∏è\nThis workflow automates raw materials inventory management for businesses, eliminating manual stock updates, delayed material issue approvals, and missed low stock alerts. It ensures real-time stock tracking, streamlined approvals, and timely notifications. \n\n**Target audience**: Small to medium-sized businesses, inventory managers, and n8n users familiar with Google Sheets, Supabase, and Gmail integrations.\n\n### What Does It Do? üåü\n- Receives raw material data and issue requests via form submissions.\n- Updates stock levels in Google Sheets and Supabase.\n- Manages approvals for material issue requests with email notifications.\n- Detects low stock levels and sends alerts via Gmail.\n- Maintains data consistency across Google Sheets and Supabase.\n\n### Key Features \n- Real-time stock updates from form submissions.\n- Automated approval process for material issuance.\n- Low stock detection with Gmail notifications.\n- Dual storage in Google Sheets and Supabase for redundancy.\n- Error handling for robust data validation.\n\n## Setup Instructions\n\n### Prerequisites \n- **n8n Instance**: Self-hosted or cloud n8n instance.\n- **API Credentials**:\n  - **Google Sheets API**: Credentials from Google Cloud Console with Sheets scope, stored in n8n credentials.\n  - **Supabase API**: API key and URL from Supabase project, stored in n8n credentials (do not hardcode in nodes).\n  - **Gmail API**: Credentials from Google Cloud Console with Gmail scope.\n- **Forms**: A form (e.g., Google Form) to submit raw material receipts and issue requests, configured to send data to n8n webhooks.\n\n### Installation Steps \n1. **Import the Workflow**:\n   - Copy the workflow JSON from the ‚ÄúTemplate Code‚Äù section (to be provided).\n   - Import it into n8n via ‚ÄúImport from File‚Äù or ‚ÄúImport from URL‚Äù.\n2. **Configure Credentials**:\n   - Add API credentials in n8n‚Äôs Credentials section for Google Sheets, Supabase, and Gmail.\n   - Assign credentials to respective nodes. For example:\n     - In the Append Raw Materials node, use Google Sheets credentials: `{{ $credentials.GoogleSheets }}`.\n     - In the Current Stock Update node, use Supabase credentials: `{{ $credentials.Supabase }}`.\n     - In the Send Low Stock Email Alert node, use Gmail credentials.\n3. **Set Up Nodes**:\n   - **Webhook Nodes (Receive Raw Materials Webhook, Receive Material Issue Webhook)**: Configure webhook URLs and link them to your form submissions.\n   - **Approval Email (Send Approval Request)**: Customize the HTML email template if needed.\n   - **Low Stock Alerts (Send Low Stock Email Alert, Send Low Stock Email After Issue)**: Configure recipient email addresses.\n4. **Test the Workflow**:\n   - Submit a test form for raw material receipt and verify stock updates in Google Sheets/Supabase.\n   - Submit a material issue request, approve/reject it, and confirm stock updates and notifications.\n\n## How It Works\n\n### High-Level Steps \n1. **Receive Raw Materials**: Processes form submissions for raw material receipts.\n2. **Update Stock**: Updates stock levels in Google Sheets and Supabase.\n3. **Handle Issue Requests**: Processes material issue requests via forms.\n4. **Manage Approvals**: Sends approval requests and processes decisions.\n5. **Monitor Stock Levels**: Detects low stock and sends Gmail alerts.\n\n### Detailed Descriptions\nDetailed node descriptions are available in the sticky notes within the workflow screenshot (to be provided). Below is a summary of key actions.\n\n## Node Names and Actions\n\n### Raw Materials Receiving and Stock Update\n- **Receive Raw Materials Webhook**: Receives raw material data from a form submission.\n- **Standardize Raw Material Data**: Maps form data into a consistent format.\n- **Calculate Total Price**: Computes `Total Price` (Quantity Received * Unit Price).\n- **Append Raw Materials**: Records receipt in Google Sheets.\n- **Check Quantity Received Validity**: Ensures `Quantity Received` is valid.\n- **Lookup Existing Stock**: Retrieves current stock for the `Product ID`.\n- **Check If Product Exists**: Branches based on `Product ID` existence.\n- **Calculate Updated Current Stock**: Adds `Quantity Received` to stock (True branch).\n- **Update Current Stock**: Updates stock in Google Sheets (True branch).\n- **Retrieve Updated Stock for Check**: Retrieves updated stock for low stock check.\n- **Detect Low Stock Level**: Flags if stock is below minimum.\n- **Trigger Low Stock Alert**: Triggers email if stock is low.\n- **Send Low Stock Email Alert**: Sends low stock alert via Gmail.\n- **Add New Product to Stock**: Adds new product to stock (False branch).\n- **Current Stock Update**: Updates Supabase `Current Stock` table.\n- **New Row Current Stock**: Inserts new product into Supabase.\n- **Search Current Stock**: Retrieves Supabase stock records.\n- **New Record Raw**: Inserts raw material record into Supabase.\n- **Format Response**: Removes duplicates from Supabase response.\n- **Combine Stock Update Branches**: Merges branches for existing/new products.\n\n### Material Issue Request and Approval\n- **Receive Material Issue Webhook**: Receives issue request from a form submission.\n- **Standardize Data**: Normalizes request data and adds `Approval Link`.\n- **Validate Issue Request Data**: Ensures `Quantity Requested` is valid.\n- **Verify Requested Quantity**: Validates `Product ID` and `Submission ID`.\n- **Append Material Request**: Records request in Google Sheets.\n- **Check Available Stock for Issue**: Retrieves current stock for the request.\n- **Prepare Approval**: Checks stock sufficiency for the request.\n- **Send Approval Request**: Emails approver with Approve/Reject options.\n- **Receive Approval Response**: Captures approver‚Äôs decision via webhook.\n- **Format Approval Response**: Processes approval data with `Approval Date`.\n- **Verify Approval Data**: Validates the approval response.\n- **Retrieve Issue Request Details**: Retrieves original request from Google Sheets.\n- **Process Approval Decision**: Branches based on approval action.\n- **Get Stock for Issue Update**: Retrieves stock before update (Approved).\n- **Deduct Issued Stock**: Reduces stock by `Approved Quantity` (Approved).\n- **Update Stock After Issue**: Updates stock in Google Sheets (Approved).\n- **Retrieve Stock After Issue**: Retrieves updated stock for low stock check.\n- **Detect Low Stock After Issue**: Flags low stock after issuance.\n- **Trigger Low Stock Alert After Issue**: Triggers email if stock is low.\n- **Send Low Stock Email After Issue**: Sends low stock alert via Gmail.\n- **Update Issue Request Status**: Updates request status (Approved/Rejected).\n- **Combine Stock Lookup Results**: Merges stock lookup branches.\n- **Create Record Issue**: Inserts issue request into Supabase.\n- **Search Stock by Product ID**: Retrieves Supabase stock records.\n- **Issues Table Update**: Updates Supabase `Materials Issued` table.\n- **Update Current Stock**: Updates Supabase stock after issuance.\n- **Combine Issue Lookup Branches**: Merges issue lookup branches.\n- **Search Issue by Submission ID**: Retrieves Supabase issue records.\n\n## Customization Tips\n- **Expand Storage Options **: Add nodes to store data in other databases (e.g., Airtable) alongside Google Sheets and Supabase.\n- **Modify Approval Email **: Update the Send Approval Request node to customize the HTML email template (e.g., adjust styling or add branding).\n- **Alternative Notifications **: Add nodes to send low stock alerts via other platforms (e.g., Slack or Telegram).\n- **Adjust Low Stock Threshold **: Modify the Detect Low Stock Level node to change the `Minimum Stock Level` (default: 50).!",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Append Material Request",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Get Approvals",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Standardize Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Update Stock",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Receive Issue Request",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Send Approval Request",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Prepare Approval",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create Record Issue",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Search Product ID",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Searck Issues",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Update Current Stck",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Merge Lookups",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "Update Current Stock1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "LookUp Current stock1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Low stock Detection1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Append Raw Materials",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Calculate Total Price",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Calculate Updated Current Stock",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Validate Quantity Received",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Initialize New Product stock",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Update Current Stock",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "LookUp Current stock",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "New Row Current Stock",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Current Stock Update",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Search Current Stock",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Format response",
      "type": "n8n-nodes-base.itemLists",
      "role": "itemLists",
      "configDescription": "Version 3"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "Low stock Detection2",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Receive Raw Materials Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Standardize Raw Material Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Lookup Existing Stock",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Check If Product ID Exists",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "New Record Row",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Trigger Low Stock Alert",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send Low Stock Email Alert",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Low Stock Email Alert",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Validate Issue Request Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Verify Requested Quantity",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Check Available Stock for Issue",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Format Approval Response",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Verify Approval Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Retrieve Issue Request Details",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Process Approval Decision",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Get Stock for Issue Update from Current",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Update Stock After Issue",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Materials Issue Table Update",
      "type": "n8n-nodes-base.supabase",
      "role": "supabase",
      "configDescription": "Version 1"
    },
    {
      "name": "Is Stock is Low",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    }
  ]
}