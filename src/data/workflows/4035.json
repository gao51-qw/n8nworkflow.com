{
  "id": 4035,
  "slug": "4035",
  "title": "Automated daily backup of n8n workflows to GitLab repositories",
  "description": "# n8n Workflow: Sync Workflows with GitLab\n\n## How It Works\n\nThis workflow ensures that your self-hosted n8n workflows are version-controlled in a GitLab repository. It compares each current workflow from n8n with its stored counterpart in GitLab. If any differences are detected, the GitLab file is updated with the latest version.\n\n### Core Logic:\n1. **Retrieve Workflows** – Fetch all workflows from the n8n REST API.\n\n2. **Compare with GitLab** – For each workflow, fetch the corresponding file from GitLab and compare the JSON.\n\n3. **Update if Changed** – If differences exist, commit the updated workflow to GitLab using its API.\n\n---\n\n## Setup\n\nBefore using the workflow, ensure the following:\n\n### Prerequisites:\n- **n8n**: Self-hosted instance with access to the `/rest/workflows` API.\n\n- **GitLab**: A repository where workflows will be stored, and a Personal Access Token (PAT) with `api` and `write_repository` permissions.\n\n- **n8n Nodes Required**:\n  - HTTP Request (to call n8n and GitLab APIs)\n  - Code or Function nodes (for diffing and formatting)\n  - Looping (`SplitInBatches` or similar)\n\n### Configuration:\n- Set environment variables or workflow credentials for:\n  - `GITLAB_TOKEN`\n  - `GITLAB_REPO`\n  - `GITLAB_BRANCH` (e.g., `main`)\n  - `GITLAB_FILE_PATH_PREFIX` (e.g., `n8n-workflows/`)\n\n---\n\n## How to Use\n\n1. **Import the Workflow** into your n8n instance.\n\n2. **Configure GitLab API Credentials**:\n   - Set the GitLab PAT as a header in the HTTP\n\nRequest node:  \n     `Private-Token: {{ $env.GITLAB_TOKEN }}`\n\n3. **Map Workflows to GitLab Paths**:\n   - Use the workflow name or ID to create the file path. Example:  \n     `n8n-workflows/workflow-name.json`\n\n4. **Trigger the Workflow**:\n   - Can be manually triggered, or scheduled to run at intervals (e.g., daily).\n   \n5. **Review Commits in GitLab**:\n   - Each updated workflow will be committed with a message like:  \n     `\"Update workflow: Sample Workflow\"`\n\n---\n\n## Disclaimer\n\n- This workflow does **not** handle merge conflicts or manual edits made directly in GitLab. Always ensure proper coordination if multiple sources are modifying workflows.\n- Only structural changes are tracked. Non-functional metadata (like timestamps or IDs) may trigger false positives unless filtered.\n- Use at your own risk. Test in a safe environment before applying to production workflows.\n\n---\n\n",
  "featuredImage": "/data/workflows/4035/4035.webp",
  "author": {
    "id": 101,
    "slug": "akhilv7",
    "name": "Akhil Varma Gadiraju",
    "avatar": ""
  },
  "categories": [
    "DevOps"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2203,
  "downloads": 220,
  "createdAt": "2025-05-14T06:06:07.562Z",
  "updatedAt": "2026-01-16T08:32:42.348Z",
  "publishedAt": "2025-05-14T06:06:07.562Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4035",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated daily backup of n8n workflows to GitLab repositories",
    "workflowName": "Automated daily backup of n8n workflows to GitLab repositories",
    "description": "# n8n Workflow: Sync Workflows with GitLab\n\n## How It Works\n\nThis workflow ensures that your self-hosted n8n workflows are version-controlled in a GitLab repository. It compares each current workflow from n8n with its stored counterpart in GitLab. If any differences are detected, the GitLab file is updated with the latest version.\n\n### Core Logic:\n1. **Retrieve Workflows** – Fetch all workflows from the n8n REST API.\n\n2. **Compare with GitLab** – For each workflow, fetch the corresponding file from GitLab and compare the JSON.\n\n3. **Update if Changed** – If differences exist, commit the updated workflow to GitLab using its API.\n\n---\n\n## Setup\n\nBefore using the workflow, ensure the following:\n\n### Prerequisites:\n- **n8n**: Self-hosted instance with access to the `/rest/workflows` API.\n\n- **GitLab**: A repository where workflows will be stored, and a Personal Access Token (PAT) with `api` and `write_repository` permissions.\n\n- **n8n Nodes Required**:\n  - HTTP Request (to call n8n and GitLab APIs)\n  - Code or Function nodes (for diffing and formatting)\n  - Looping (`SplitInBatches` or similar)\n\n### Configuration:\n- Set environment variables or workflow credentials for:\n  - `GITLAB_TOKEN`\n  - `GITLAB_REPO`\n  - `GITLAB_BRANCH` (e.g., `main`)\n  - `GITLAB_FILE_PATH_PREFIX` (e.g., `n8n-workflows/`)\n\n---\n\n## How to Use\n\n1. **Import the Workflow** into your n8n instance.\n\n2. **Configure GitLab API Credentials**:\n   - Set the GitLab PAT as a header in the HTTP\n\nRequest node:  \n     `Private-Token: {{ $env.GITLAB_TOKEN }}`\n\n3. **Map Workflows to GitLab Paths**:\n   - Use the workflow name or ID to create the file path. Example:  \n     `n8n-workflows/workflow-name.json`\n\n4. **Trigger the Workflow**:\n   - Can be manually triggered, or scheduled to run at intervals (e.g., daily).\n   \n5. **Review Commits in GitLab**:\n   - Each updated workflow will be committed with a message like:  \n     `\"Update workflow: Sample Workflow\"`\n\n---\n\n## Disclaimer\n\n- This workflow does **not** handle merge conflicts or manual edits made directly in GitLab. Always ensure proper coordination if multiple sources are modifying workflows.\n- Only structural changes are tracked. Non-functional metadata (like timestamps or IDs) may trigger false positives unless filtered.\n- Use at your own risk. Test in a safe environment before applying to production workflows.\n\n---",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Globals",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Result",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Current workflow",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Workflows",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Get file",
      "type": "n8n-nodes-base.gitlab",
      "role": "gitlab",
      "configDescription": "Version 1"
    },
    {
      "name": "File status",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Status error",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.2"
    },
    {
      "name": "End Loop",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Create file",
      "type": "n8n-nodes-base.gitlab",
      "role": "gitlab",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract From File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3"
    },
    {
      "name": "New file version",
      "type": "n8n-nodes-base.gitlab",
      "role": "gitlab",
      "configDescription": "Version 1"
    },
    {
      "name": "Error output to normal output",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Status diff",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Status same",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Retrieve all workflows",
      "type": "n8n-nodes-base.n8n",
      "role": "n8n",
      "configDescription": "Version 1"
    },
    {
      "name": "Save each version in a different field",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "GitLab",
      "type": "n8n-nodes-base.gitlab",
      "role": "gitlab",
      "configDescription": "Version 1"
    }
  ]
}