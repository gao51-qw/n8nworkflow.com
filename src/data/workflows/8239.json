{
  "id": 8239,
  "slug": "8239",
  "title": "Automated request-to-quote with OpenAI, Google Sheets & CraftMyPDF",
  "description": "## üìÑ What this workflow does\n- Turns a simple form submission into a polished, priced PDF quote‚Äîautomatically.\n- Captures lead details via Form: Request a Quote.\n- Loads your Google Sheets catalog (SKUs, price, stock, min qty, etc.).\n- Uses OpenAI to select SKUs and build a strict JSON quote (respects in_stock and min_qty, optional discount ‚â§10%).\n- Maps data in a Code node to compute line totals, discount, VAT, and a unique invoice_number; validates/falls back due_date.\n- Renders a branded PDF via CraftMyPDF, fetches the file link, and emails the customer the quote.\n\n\n## üë§ Who is this for\n- SMBs and sales teams needing instant quotes from website forms.\n- Ops teams managing catalogs in Sheets who want LLM-assisted SKU selection.\n- Agencies/shops that must generate consistent, branded PDFs and email them automatically.\n\n\n## ‚úÖ Requirements\n- A self-hosted n8n instance.\n- Google Sheets catalog with (recommended) columns: sku, name, uom, unit_price, currency, in_stock (TRUE/FALSE), min_qty, lead_time_days, notes.\n- Connected credentials: Google Sheets OAuth2, OpenAI (or compatible), CraftMyPDF, SMTP.\n- A CraftMyPDF template whose fields match the Code node output (invoice_number, items[], gross_total, etc.). CraftMyPDF provides a drag-and-drop editor and PDF Generation API that work well with n8n.\n\n\n## ‚öôÔ∏è How to set up\n- Import the workflow JSON into n8n.\n- In Google Sheets: Products, set real documentId/sheetName (IDs) and connect OAuth.\n- In LLM node, keep or change model (default gpt-4.1-mini), and keep the ‚ÄúJSON-only‚Äù system prompt.\n- In Create a PDF, set your CraftMyPDF templateId.\n- In Email: Send Quote, set fromEmail and SMTP credentials.\n- Submit a test form; verify LLM JSON ‚Üí PDF render ‚Üí email delivery.\n- (Optional) Adjust defaults in the Code node: vat_pct (default 10), payment_terms, currency fallback, and valid_days.\n\n\n## üß© CraftMyPDF template ‚Äî quick guide (UI)\n- Create & open a template: Log in ‚Üí Manage Templates ‚Üí New Template (choose blank or a starter) ‚Üí Edit to open the editor. The editor has four core tabs: Designer, Preview, Data, Settings.\n- Paste sample JSON: Go to the Data tab and paste a sample that mirrors what n8n will send (e.g., includes invoice_number, client, items[]). This JSON powers the editor‚Äôs auto-complete and live preview.\n- Bind fields fast: In Designer, use Data Fields to drag pre-bound text/image components that auto-insert expressions from your JSON‚Äîmuch quicker than manual binding.\n- Add line items: For repeating rows like items[], use Simple Table (set Data Source to {{data.items}}, then in each column use {{row.field}}, e.g., {{row.description}}, {{row.quantity}}, {{row.unit_price}}, {{row.total}}).\n- Use expressions: Anywhere you need dynamic text, enter {{ data.&lt;field&gt; }}‚Äîfor example {{data.invoice_number}}, {{data.client}}, {{data.gross_total}}. Preview the result and/or generate a real PDF from the Preview tab.\n- Finish & integrate: Save the template, note its Template ID, and use it in the n8n CraftMyPDF node. You can return to the editor anytime to tweak layout/styles; the next workflow run will use the updated design. The editor and API are built for reusable templates.\n\n\n## üîÅ How it works\n- Trigger ‚Üí Form submission captures: Full Name, Email, Company, Requirements, Budget Min/Max, Need By, Notes.\n- Catalog Load ‚Üí Sheets node returns rows; passed to the LLM as JSON.\n- LLM Quote ‚Üí Model selects SKUs/qty, pricing, discount (‚â§10%), terms, and returns VALID JSON only.\n- Code Mapping ‚Üí Parses JSON (strips code fences if present), computes discounts/VAT/totals, assigns invoice_number (Q-YYYYMMDD-ABCDE), and validates due_date (falls back to today + valid_days).\n- PDF Render ‚Üí CraftMyPDF generates the branded quote and returns a file URL.\n- Delivery ‚Üí HTTP node fetches the file; SMTP node emails the customer with dynamic subject and totals.\n\n\n## üí° About Margin AI\n[Margin AI](https://marginai.co/) is your AI Service Companion. We help organizations design intelligent, human-centric automation ‚Äî from content pipelines and branding workflows to customer insights and sales enablement. Our tailored AI solutions scale marketing, operations, and creative processes with ease.",
  "featuredImage": "/data/workflows/8239/8239.webp",
  "author": {
    "id": 101,
    "slug": "cong-nguyen",
    "name": "Cong Nguyen",
    "avatar": ""
  },
  "categories": [
    "CRM",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 99,
  "downloads": 9,
  "createdAt": "2025-09-04T03:59:32.174Z",
  "updatedAt": "2026-01-16T08:54:52.390Z",
  "publishedAt": "2025-09-04T03:59:32.174Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8239",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated request-to-quote with OpenAI, Google Sheets & CraftMyPDF",
    "workflowName": "Automated request-to-quote with OpenAI, Google Sheets & CraftMyPDF",
    "description": "## üìÑ What this workflow does\n- Turns a simple form submission into a polished, priced PDF quote‚Äîautomatically.\n- Captures lead details via Form: Request a Quote.\n- Loads your Google Sheets catalog (SKUs, price, stock, min qty, etc.).\n- Uses OpenAI to select SKUs and build a strict JSON quote (respects in_stock and min_qty, optional discount ‚â§10%).\n- Maps data in a Code node to compute line totals, discount, VAT, and a unique invoice_number; validates/falls back due_date.\n- Renders a branded PDF via CraftMyPDF, fetches the file link, and emails the customer the quote.\n\n\n## üë§ Who is this for\n- SMBs and sales teams needing instant quotes from website forms.\n- Ops teams managing catalogs in Sheets who want LLM-assisted SKU selection.\n- Agencies/shops that must generate consistent, branded PDFs and email them automatically.\n\n\n## ‚úÖ Requirements\n- A self-hosted n8n instance.\n- Google Sheets catalog with (recommended) columns: sku, name, uom, unit_price, currency, in_stock (TRUE/FALSE), min_qty, lead_time_days, notes.\n- Connected credentials: Google Sheets OAuth2, OpenAI (or compatible), CraftMyPDF, SMTP.\n- A CraftMyPDF template whose fields match the Code node output (invoice_number, items[], gross_total, etc.). CraftMyPDF provides a drag-and-drop editor and PDF Generation API that work well with n8n.\n\n\n## ‚öôÔ∏è How to set up\n- Import the workflow JSON into n8n.\n- In Google Sheets: Products, set real documentId/sheetName (IDs) and connect OAuth.\n- In LLM node, keep or change model (default gpt-4.1-mini), and keep the ‚ÄúJSON-only‚Äù system prompt.\n- In Create a PDF, set your CraftMyPDF templateId.\n- In Email: Send Quote, set fromEmail and SMTP credentials.\n- Submit a test form; verify LLM JSON ‚Üí PDF render ‚Üí email delivery.\n- (Optional) Adjust defaults in the Code node: vat_pct (default 10), payment_terms, currency fallback, and valid_days.\n\n\n## üß© CraftMyPDF template ‚Äî quick guide (UI)\n- Create & open a template: Log in ‚Üí Manage Templates ‚Üí New Template (choose blank or a starter) ‚Üí Edit to open the editor. The editor has four core tabs: Designer, Preview, Data, Settings.\n- Paste sample JSON: Go to the Data tab and paste a sample that mirrors what n8n will send (e.g., includes invoice_number, client, items[]). This JSON powers the editor‚Äôs auto-complete and live preview.\n- Bind fields fast: In Designer, use Data Fields to drag pre-bound text/image components that auto-insert expressions from your JSON‚Äîmuch quicker than manual binding.\n- Add line items: For repeating rows like items[], use Simple Table (set Data Source to {{data.items}}, then in each column use {{row.field}}, e.g., {{row.description}}, {{row.quantity}}, {{row.unit_price}}, {{row.total}}).\n- Use expressions: Anywhere you need dynamic text, enter {{ data.&lt;field&gt; }}‚Äîfor example {{data.invoice_number}}, {{data.client}}, {{data.gross_total}}. Preview the result and/or generate a real PDF from the Preview tab.\n- Finish & integrate: Save the template, note its Template ID, and use it in the n8n CraftMyPDF node. You can return to the editor anytime to tweak layout/styles; the next workflow run will use the updated design. The editor and API are built for reusable templates.\n\n\n## üîÅ How it works\n- Trigger ‚Üí Form submission captures: Full Name, Email, Company, Requirements, Budget Min/Max, Need By, Notes.\n- Catalog Load ‚Üí Sheets node returns rows; passed to the LLM as JSON.\n- LLM Quote ‚Üí Model selects SKUs/qty, pricing, discount (‚â§10%), terms, and returns VALID JSON only.\n- Code Mapping ‚Üí Parses JSON (strips code fences if present), computes discounts/VAT/totals, assigns invoice_number (Q-YYYYMMDD-ABCDE), and validates due_date (falls back to today + valid_days).\n- PDF Render ‚Üí CraftMyPDF generates the branded quote and returns a file URL.\n- Delivery ‚Üí HTTP node fetches the file; SMTP node emails the customer with dynamic subject and totals.\n\n\n## üí° About Margin AI\n[Margin AI](https://marginai.co/) is your AI Service Companion. We help organizations design intelligent, human-centric automation ‚Äî from content pipelines and branding workflows to customer insights and sales enablement. Our tailored AI solutions scale marketing, operations, and creative processes with ease.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Form: Request a Quote",
      "type": "n8n-nodes-base.formTrigger",
      "role": "formTrigger",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Google Sheets: Products",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "LLM: Select & Quote (JSON only)",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Code: Map for CraftMyPDF",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create a PDF",
      "type": "n8n-nodes-craftmypdf.craftMyPdf",
      "role": "craftMyPdf",
      "configDescription": "Version 1"
    },
    {
      "name": "Get PDF file",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Email: Send Quote",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}