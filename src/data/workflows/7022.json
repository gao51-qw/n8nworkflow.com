{
  "id": 7022,
  "slug": "7022",
  "title": "Auto remediate endpoint infections with Wazuh, ClamAV, and GPT-4",
  "description": "Reduce human delays between **malware detection and remediation** in MSSP/SOC environments. This workflow automates full endpoint antivirus scanning immediately after high-severity endpoint infection wazuh alerts, closing the gap between alerting and action.\n\n**Why Use This Workflow?**\n\nMalware alerts are only effective if acted upon swiftly. Manual follow-ups are slow or often missed, letting threats persist.\n\n**Automates detection, triage, scan initiation, and notificationâ€”all** within **one minute** of alerting.\n\nEnsures consistent, auditable actions across endpoints running Linux or Windows.\n\n---\nðŸ”‘ **Key Features**\n\nListens for high-severity Wazuh AV infection alerts (e.g., rule 52502).\n\nUses GPT-4 for AI-powered alert summaries to speed triage and decision making.\n\nExtracts exact infected file paths using AI and regex for targeted scanning.\n\nRuns ClamAV/defender scans directly on endpoints via SSH with least-privilege credentials.\n\nSends real-time scan results and remediation updates through Telegram, Slack, or email.\n\nRuns locally with limited permissionsâ€”no need for elevated Wazuh manager access.\n\n---\n**ðŸŽ¯ Impact**\n\nEliminates **manual lagâ€”scans** start automatically and immediately.\n\nStandardizes response playbooks for **reliable, repeatable remediation.**\n\nReduces **threat dwell time**, minimizing risk exposure.\n\nProvides full event-to-remediation visibility via logs and notifications.\n\n---\n\nðŸš€ **Get Started**\n\nConfigure Wazuh Manager to forward AV alerts to this n8n webhook.\n\nImport this workflow JSON into your n8n instance.\n\nSet up required credentials: OpenAI API, SSH access for ClamAV scanning, notification channels (Telegram/Slack/email).\n\nActivate the workflow and monitor alerts triggering automated scans and reports.\n\n---\n\n**ðŸ“‚ Enjoy customizing**\n\nSwap ClamAV with your preferred antivirus commands (e.g., Defender) as needed.\n\nIntegrate with your existing communication or ticketing systems.\n\nExtend or adapt for multi-endpoint orchestration or other alert rules.\n\n---\n\n**Created by [Mariskarthick M](https://www.linkedin.com/in/mariskarthickm/)** \nSenior Security Analyst | Detection Engineer | Threat Hunter | Open-Source Enthusiast\n\n",
  "featuredImage": "/data/workflows/7022/7022.webp",
  "author": {
    "id": 101,
    "slug": "mariskarthick",
    "name": "mariskarthick",
    "avatar": ""
  },
  "categories": [
    "SecOps",
    "AI Summarization"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 612,
  "downloads": 61,
  "createdAt": "2025-08-05T18:24:51.711Z",
  "updatedAt": "2026-01-16T08:48:11.845Z",
  "publishedAt": "2025-08-05T18:24:51.711Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7022",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Auto remediate endpoint infections with Wazuh, ClamAV, and GPT-4",
    "workflowName": "Auto remediate endpoint infections with Wazuh, ClamAV, and GPT-4",
    "description": "Reduce human delays between **malware detection and remediation** in MSSP/SOC environments. This workflow automates full endpoint antivirus scanning immediately after high-severity endpoint infection wazuh alerts, closing the gap between alerting and action.\n\n**Why Use This Workflow?**\n\nMalware alerts are only effective if acted upon swiftly. Manual follow-ups are slow or often missed, letting threats persist.\n\n**Automates detection, triage, scan initiation, and notificationâ€”all** within **one minute** of alerting.\n\nEnsures consistent, auditable actions across endpoints running Linux or Windows.\n\n---\nðŸ”‘ **Key Features**\n\nListens for high-severity Wazuh AV infection alerts (e.g., rule 52502).\n\nUses GPT-4 for AI-powered alert summaries to speed triage and decision making.\n\nExtracts exact infected file paths using AI and regex for targeted scanning.\n\nRuns ClamAV/defender scans directly on endpoints via SSH with least-privilege credentials.\n\nSends real-time scan results and remediation updates through Telegram, Slack, or email.\n\nRuns locally with limited permissionsâ€”no need for elevated Wazuh manager access.\n\n---\n**ðŸŽ¯ Impact**\n\nEliminates **manual lagâ€”scans** start automatically and immediately.\n\nStandardizes response playbooks for **reliable, repeatable remediation.**\n\nReduces **threat dwell time**, minimizing risk exposure.\n\nProvides full event-to-remediation visibility via logs and notifications.\n\n---\n\nðŸš€ **Get Started**\n\nConfigure Wazuh Manager to forward AV alerts to this n8n webhook.\n\nImport this workflow JSON into your n8n instance.\n\nSet up required credentials: OpenAI API, SSH access for ClamAV scanning, notification channels (Telegram/Slack/email).\n\nActivate the workflow and monitor alerts triggering automated scans and reports.\n\n---\n\n**ðŸ“‚ Enjoy customizing**\n\nSwap ClamAV with your preferred antivirus commands (e.g., Defender) as needed.\n\nIntegrate with your existing communication or ticketing systems.\n\nExtend or adapt for multi-endpoint orchestration or other alert rules.\n\n---\n\n**Created by [Mariskarthick M](https://www.linkedin.com/in/mariskarthickm/)** \nSenior Security Analyst | Detection Engineer | Threat Hunter | Open-Source Enthusiast",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Wazuh Alert",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Check High Severity",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Summarize Alert",
      "type": "@n8n/n8n-nodes-langchain.chainSummarization",
      "role": "chainSummarization",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Extract Path",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Run AV Scan",
      "type": "n8n-nodes-base.ssh",
      "role": "ssh",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify Stateholders via Telegram",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    }
  ]
}