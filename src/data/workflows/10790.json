{
  "id": 10790,
  "slug": "10790",
  "title": "Automated WhatsApp upsell messages for Shopify cancellations with Rapiwa & Sheet",
  "description": "## Who is this for?\nThis workflow is for Shopify store owners, customer success, and marketing teams who want to automatically check customers’ WhatsApp numbers and send personalized messages with discount codes for canceled orders. It helps recover lost sales by reaching out with special offers.\n\n## What This Workflow Does\n* Automatically checks for canceled orders on a schedule\n* Fetches canceled orders from Shopify\n* Creates personalized recovery messages based on customer data\n* Verifies customers’ WhatsApp numbers via Rapiwa\n* Logs results in Google Sheets: *“Verified & Sent”* for successful messages, *“Unverified & Not Sent”* for unverified numbers\n\n\n## Requirements\n- Shopify store with API access enabled\n- Shopify API credentials with access to orders and customer data\n- Rapiwa account and a valid Bearer token\n- Google account with Sheets access and OAuth2 credentials\n\n## Setup plan\n1. **Add your credentials**\n   * **Rapiwa:** Create an HTTP Bearer credential in n8n and paste your token (example name: *Rapiwa Bearer Auth*).\n   * **Google Sheets:** Add an OAuth2 credential (example name: *Google Sheets*).\n\n2. **Set up Shopify**\n   * Replace **your_shopify_domain** with your real Shopify domain.\n   * Replace **your_shop_access-token** with your actual Shopify API token.\n\n3. **Set up Google Sheets**\n   * Update the example spreadsheet ID and sheet gid with your own.\n   * Make sure your sheet’s column headers match the mapping keys exactly—same spelling, case, and no extra spaces.\n\n4. **Configure the Schedule Trigger**\n   * Choose how often you want the workflow to check for canceled orders (daily, weekly, etc.).\n\n5. **Check the HTTP Request nodes**\n   * **Verify endpoint:** Should call Rapiwa’s *verifyWhatsAppNumber*.\n   * **Send endpoint:** Should use Rapiwa’s send-message API with your template (includes customer name, reorder link, discount code).\n\n## Google Sheet Column Structure\nThe Google Sheets nodes in the flow append rows with these column. Make sure the sheet headers match exactly.\n\n**A Google Sheet formatted like this** ➤ [sample](https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit?usp=sharing)\n\n\n| Name         | Number        | Item Name   | Coupon   | Item Link   |  Validity   | Status |\n| ------------ | ------------- | ------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ----------- | ---------- | ------ |\n| Abdul Mannan | 8801322827799 | Samsung Galaxy S24 Ultra 5G 256GB-512GB-1TB | REORDER5 | [Re-order Link](https://your_shopify_domain/94618124606xxxxxthenticatexx/250c6a7d50018140b2ac21741233) |  verified   | sent   |\n| Abdul Mannan | 8801322827790 | Samsung Galaxy S24 Ultra 5G 256GB-512GB-1TB | REORDER5 | [Re-order Link](https://your_shopify_domain/94618124606xxxxxthenticatexx/250c6a7d50018140b2ac21741233) | unverified | not sent   |\n\n\n\n## Important Notes\n- Do not hard-code API keys or tokens; always use n8n credentials.\n- Google Sheets column header names must match the mapping keys used in the nodes. Trailing spaces are common accidental problems — trim them in the spreadsheet or adjust the mapping.\n- Message templates reference - update templates if you need to reference different data.\n- The workflow processes cancelled orders in batches to avoid rate limits. Adjust the batch size if needed.\n\n## Useful Links\n- **Install Rapiwa**: [How to install Rapiwa](https://www.npmjs.com/package/n8n-nodes-rapiwa)\n- **Dashboard:** [https://app.rapiwa.com](https://app.rapiwa.com/login)\n- **Official Website:** [https://rapiwa.com](https://rapiwa.com/)\n- **Documentation:** [https://docs.rapiwa.com](https://docs.rapiwa.com/)\n- **Shopify API Documentation:** [https://shopify.dev/docs/admin-api](https://shopify.dev/docs/admin-api)\n\n## Support & Help\n- **WhatsApp**: [Chat on WhatsApp](https://wa.me/8801322827799)\n- **Discord**: [SpaGreen Community](https://discord.gg/SsCChWEP)\n- **Facebook Group**: [SpaGreen Support](https://www.facebook.com/groups/spagreenbd)\n- **Website**: [https://spagreen.net](https://spagreen.net)\n- **Developer Portfolio**: [Codecanyon SpaGreen](https://codecanyon.net/user/spagreen/portfolio)",
  "featuredImage": "/data/workflows/10790/10790.webp",
  "author": {
    "id": 101,
    "slug": "rapiwa",
    "name": "Rapiwa",
    "avatar": ""
  },
  "categories": [
    "Lead Nurturing"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 48,
  "downloads": 4,
  "createdAt": "2025-11-13T11:51:19.524Z",
  "updatedAt": "2026-01-16T09:06:19.754Z",
  "publishedAt": "2025-11-13T11:51:19.524Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10790",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated WhatsApp upsell messages for Shopify cancellations with Rapiwa & Sheet",
    "workflowName": "Automated WhatsApp upsell messages for Shopify cancellations with Rapiwa & Sheet",
    "description": "## Who is this for?\nThis workflow is for Shopify store owners, customer success, and marketing teams who want to automatically check customers’ WhatsApp numbers and send personalized messages with discount codes for canceled orders. It helps recover lost sales by reaching out with special offers.\n\n## What This Workflow Does\n* Automatically checks for canceled orders on a schedule\n* Fetches canceled orders from Shopify\n* Creates personalized recovery messages based on customer data\n* Verifies customers’ WhatsApp numbers via Rapiwa\n* Logs results in Google Sheets: *“Verified & Sent”* for successful messages, *“Unverified & Not Sent”* for unverified numbers\n\n\n## Requirements\n- Shopify store with API access enabled\n- Shopify API credentials with access to orders and customer data\n- Rapiwa account and a valid Bearer token\n- Google account with Sheets access and OAuth2 credentials\n\n## Setup plan\n1. **Add your credentials**\n   * **Rapiwa:** Create an HTTP Bearer credential in n8n and paste your token (example name: *Rapiwa Bearer Auth*).\n   * **Google Sheets:** Add an OAuth2 credential (example name: *Google Sheets*).\n\n2. **Set up Shopify**\n   * Replace **your_shopify_domain** with your real Shopify domain.\n   * Replace **your_shop_access-token** with your actual Shopify API token.\n\n3. **Set up Google Sheets**\n   * Update the example spreadsheet ID and sheet gid with your own.\n   * Make sure your sheet’s column headers match the mapping keys exactly—same spelling, case, and no extra spaces.\n\n4. **Configure the Schedule Trigger**\n   * Choose how often you want the workflow to check for canceled orders (daily, weekly, etc.).\n\n5. **Check the HTTP Request nodes**\n   * **Verify endpoint:** Should call Rapiwa’s *verifyWhatsAppNumber*.\n   * **Send endpoint:** Should use Rapiwa’s send-message API with your template (includes customer name, reorder link, discount code).\n\n## Google Sheet Column Structure\nThe Google Sheets nodes in the flow append rows with these column. Make sure the sheet headers match exactly.\n\n**A Google Sheet formatted like this** ➤ [sample](https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit?usp=sharing)\n\n\n| Name         | Number        | Item Name   | Coupon   | Item Link   |  Validity   | Status |\n| ------------ | ------------- | ------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ----------- | ---------- | ------ |\n| Abdul Mannan | 8801322827799 | Samsung Galaxy S24 Ultra 5G 256GB-512GB-1TB | REORDER5 | [Re-order Link](https://your_shopify_domain/94618124606xxxxxthenticatexx/250c6a7d50018140b2ac21741233) |  verified   | sent   |\n| Abdul Mannan | 8801322827790 | Samsung Galaxy S24 Ultra 5G 256GB-512GB-1TB | REORDER5 | [Re-order Link](https://your_shopify_domain/94618124606xxxxxthenticatexx/250c6a7d50018140b2ac21741233) | unverified | not sent   |\n\n\n\n## Important Notes\n- Do not hard-code API keys or tokens; always use n8n credentials.\n- Google Sheets column header names must match the mapping keys used in the nodes. Trailing spaces are common accidental problems — trim them in the spreadsheet or adjust the mapping.\n- Message templates reference - update templates if you need to reference different data.\n- The workflow processes cancelled orders in batches to avoid rate limits. Adjust the batch size if needed.\n\n## Useful Links\n- **Install Rapiwa**: [How to install Rapiwa](https://www.npmjs.com/package/n8n-nodes-rapiwa)\n- **Dashboard:** [https://app.rapiwa.com](https://app.rapiwa.com/login)\n- **Official Website:** [https://rapiwa.com](https://rapiwa.com/)\n- **Documentation:** [https://docs.rapiwa.com](https://docs.rapiwa.com/)\n- **Shopify API Documentation:** [https://shopify.dev/docs/admin-api](https://shopify.dev/docs/admin-api)\n\n## Support & Help\n- **WhatsApp**: [Chat on WhatsApp](https://wa.me/8801322827799)\n- **Discord**: [SpaGreen Community](https://discord.gg/SsCChWEP)\n- **Facebook Group**: [SpaGreen Support](https://www.facebook.com/groups/spagreenbd)\n- **Website**: [https://spagreen.net](https://spagreen.net)\n- **Developer Portfolio**: [Codecanyon SpaGreen](https://codecanyon.net/user/spagreen/portfolio)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Get Specific Customer Data",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Get All Cancelled Order",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Get Product name with re-order llink",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Get customer info",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Get Customer Total Spent",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Rapiwa (verify number)",
      "type": "n8n-nodes-rapiwa.rapiwa",
      "role": "rapiwa",
      "configDescription": "Version 1"
    },
    {
      "name": "Rapiwa (sent message)",
      "type": "n8n-nodes-rapiwa.rapiwa",
      "role": "rapiwa",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Store State of Rows in Verified & Sent",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Store State of Rows in Unverified & Not Sent",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}