{
  "id": 12221,
  "slug": "12221",
  "title": "Monitor SSL certificates for brand-impersonating domains with crt.sh, Urlscan.io and Slack",
  "description": "## Phishing Lookout (Typosquatting) and Brand Domain Monitor\nThis workflow monitors SSL certificate logs to find and scan new domains that might be impersonating your brand.\n\n## Background\nIn modern cybersecurity, Brand Impersonation (or \"Typosquatting\") is quite common in phishing attacks. Attackers register domains that look nearly identical to a trusted brand—such as .input-n8n.io, n8n.i0, etc. instead of the legitimate— to deceive users into revealing sensitive credentials or downloading malware.\n\n## How it works\nMonitor: Checks crt.sh every hour for new SSL certificates matching your brand keywords.\n\nProcess: Uses a Split Out node to handle multi-domain certificates and a Filter node to ignore your own legitimate domains bringing only most recent certificates.\n\nScan: Automatically sends suspicious domains to Urlscan.io for a headless browser scan and screenshot.\n\nLoop & Triage: Implements a 30-second Wait to allow the scan in loop to finish before fetching results.\n\nAlert: Sends a Slack message with the domain name, report link, and an image of the supposedly suspicious site trying to mimic your site login page, etc. alerting potentially a phishing case.\n\n## Setup Steps\nCredentials: Connect your Urlscan.io API key and Slack bot token.\n\nConfiguration: Update the \"Poll crt.sh\" node. \nIn URL https://crt.sh/?q=%.testdomain.com&output=json, use your specific brand name (e.g., %.yourbrand.com or .yourdomain.com instead of .testdomain.com).\n\nWhitelist: Add your real domains to the myDomains list in the Filter & Deduplicate code node to prevent false alerts. Alternatively, you may also NOT opt to include your own domain for testing purposes to check how the Workflow behaves and outputs. In such case, obviously, your domain and sub-domains also are highlighted as Suspicious (as received in Slack Alerts)\n\nLooping: Ensure the Alert Slack node output is connected back to the Split In Batches input to process all found domains.\n\n![Phishing alert workflow image.png](fileId:3844)\n",
  "featuredImage": "/data/workflows/12221/12221.webp",
  "author": {
    "id": 101,
    "slug": "rams1005",
    "name": "RamS",
    "avatar": ""
  },
  "categories": [
    "SecOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 76,
  "downloads": 7,
  "createdAt": "2025-12-27T15:37:26.631Z",
  "updatedAt": "2026-01-16T09:11:45.571Z",
  "publishedAt": "2025-12-27T15:37:26.631Z",
  "nodes": 14,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/12221",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Monitor SSL certificates for brand-impersonating domains with crt.sh, Urlscan.io and Slack",
    "workflowName": "Monitor SSL certificates for brand-impersonating domains with crt.sh, Urlscan.io and Slack",
    "description": "## Phishing Lookout (Typosquatting) and Brand Domain Monitor\nThis workflow monitors SSL certificate logs to find and scan new domains that might be impersonating your brand.\n\n## Background\nIn modern cybersecurity, Brand Impersonation (or \"Typosquatting\") is quite common in phishing attacks. Attackers register domains that look nearly identical to a trusted brand—such as .input-n8n.io, n8n.i0, etc. instead of the legitimate— to deceive users into revealing sensitive credentials or downloading malware.\n\n## How it works\nMonitor: Checks crt.sh every hour for new SSL certificates matching your brand keywords.\n\nProcess: Uses a Split Out node to handle multi-domain certificates and a Filter node to ignore your own legitimate domains bringing only most recent certificates.\n\nScan: Automatically sends suspicious domains to Urlscan.io for a headless browser scan and screenshot.\n\nLoop & Triage: Implements a 30-second Wait to allow the scan in loop to finish before fetching results.\n\nAlert: Sends a Slack message with the domain name, report link, and an image of the supposedly suspicious site trying to mimic your site login page, etc. alerting potentially a phishing case.\n\n## Setup Steps\nCredentials: Connect your Urlscan.io API key and Slack bot token.\n\nConfiguration: Update the \"Poll crt.sh\" node. \nIn URL https://crt.sh/?q=%.testdomain.com&output=json, use your specific brand name (e.g., %.yourbrand.com or .yourdomain.com instead of .testdomain.com).\n\nWhitelist: Add your real domains to the myDomains list in the Filter & Deduplicate code node to prevent false alerts. Alternatively, you may also NOT opt to include your own domain for testing purposes to check how the Workflow behaves and outputs. In such case, obviously, your domain and sub-domains also are highlighted as Suspicious (as received in Slack Alerts)\n\nLooping: Ensure the Alert Slack node output is connected back to the Split In Batches input to process all found domains.\n\n![Phishing alert workflow image.png](fileId:3844)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Schedule (Every Hour)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Poll crt.sh (SSL Logs)",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.1"
    },
    {
      "name": "Filter & Deduplicate",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Split In Batches",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Wait for Scan",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1"
    },
    {
      "name": "Alert Slack",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Perform a scan",
      "type": "n8n-nodes-base.urlScanIo",
      "role": "urlScanIo",
      "configDescription": "Version 1"
    },
    {
      "name": "Get a scan",
      "type": "n8n-nodes-base.urlScanIo",
      "role": "urlScanIo",
      "configDescription": "Version 1"
    },
    {
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}