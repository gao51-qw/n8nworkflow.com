{
  "id": 7773,
  "slug": "7773",
  "title": "Automated invoice payment tracking with OCR, Claude AI, Slack & Notion DB",
  "description": "# How it Works\nThis workflow automates Invoice & Payment Tracking (with Approvals) across Notion and Slack.\n\n- Ingest — You drop invoices/receipts (PDF/IMG/JSON) into the flow.\n- Extract — OCR + parsing pulls out key fields (invoice no, vendor, currency, totals, receipt paid amount/date).\n- De-dup & Match — We canonicalize vendor + invoice_no and search Notion:\n\t- Primary match: Invoice No (+ optional Currency / Vendor (Canon)).\n\t- Fallback: uses document Amount Total and dates.\n\n- Decide the action\n\t- create_unpaid — new invoice (no payment).\n\t- create_paid — new invoice fully paid (unverified).\n\t- create_partial — new invoice with a first partial payment.\n\t- update_partial — add a partial to an existing invoice.\n\t- update_mark_paid — mark existing invoice paid in full.\n\t- manual_review — currency mismatch / overpayment / ambiguous.\n\t- archive — push to archive logs (from manual review).\n\n- Slack approvals (one-click) — A message shows previous paid, this receipt, new total, and Approve buttons (links to a Wait for Webhook resumeUrl). Reviewer picks: Approve Partial / Mark Paid / Manual Review / Archive.\n\n- Notion updates\n\n\t- We only write editable fields: Paid Amount (number), Status (select), Last Payment Date (date).\n\t- Formulas (e.g., Amount Total, Amount Due) recompute automatically.\n\t- Receipts are saved in a Receipts DB and related back to the invoice.\n\n- Notifications & duplicates — If duplicates are detected, Slack posts a simple list with clickable invoice names.\n- Archiving — From Manual Review, Archive goes straight to Archived Invoice DB (and optional Archived Source File DB) as a log entry—no pre-checks needed.\n\n# Set up Steps\nPrerequisites\n1. Notion DB\n2. 4 Slack Channel (**Invoice Input**, **Notification**, **Manual Review**, ***Duplicate Alert (Optional)***)\n3. AI Model (We use **Claude 3.5 Haiku**, Feel free to use Latest Model)\n4. OCR Parsing (We Used **ocr.space**, Feel Free to Change into any OCR Parsing you have)\n#\n- **Create Notion DBs:**  \n\t- *Invoice DB*: Title `Invoice No`; Number `Paid Amount` (editable); Select `Status`; Dates (`Issue/Due/Last Payment Date`); Formulas:  \n\t  - `Amount Total = round(Subtotal - Discount Amount + Tax Total, 2)`  \n\t  - `Amount Due = max(0, round(Amount Total - Paid Amount, 2))`  \n\t- *Receipts DB*: `Invoice No`, `Vendor`, `Paid Amount` (number), `Currency` (select), `Paid Date` (date), `Receipt No`, `Source URL`; Relation → Invoice.  \n\t- *Archived Invoice DB*: `Invoice No`, `Vendor`, `Reason`, `Source URL`, `Original Page ID`, `Archived At` (date).  \n\t- *(Optional)* Source File / Archived Source File DBs.  \n\t- Share all DBs with your Notion integration (*Add connections*).\n- **Add credentials in n8n:** Notion (integration token) and Slack (bot token). Invite the bot to your channel.\n- **Import the workflow/template:** Set each Notion node’s **Database ID** and each Slack node’s **Channel/Credential**.\n- **Map updates:** In the Invoice **Update Page** node, map **Paid Amount**, **Status**, **Last Payment Date**. In **Create Receipt**, map `Invoice` relation + receipt fields.\n- **Test:** Run with a sample invoice/receipt → click a Slack button → verify Invoice/Receipt updates in Notion → try Archive from Manual Review.",
  "featuredImage": "/data/workflows/7773/7773.webp",
  "author": {
    "id": 101,
    "slug": "han",
    "name": "Han",
    "avatar": ""
  },
  "categories": [
    "AI Summarization",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 235,
  "downloads": 23,
  "createdAt": "2025-08-23T19:18:25.943Z",
  "updatedAt": "2026-01-16T08:52:20.811Z",
  "publishedAt": "2025-08-23T19:18:25.943Z",
  "nodes": 92,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7773",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated invoice payment tracking with OCR, Claude AI, Slack & Notion DB",
    "workflowName": "Automated invoice payment tracking with OCR, Claude AI, Slack & Notion DB",
    "description": "# How it Works\nThis workflow automates Invoice & Payment Tracking (with Approvals) across Notion and Slack.\n\n- Ingest — You drop invoices/receipts (PDF/IMG/JSON) into the flow.\n- Extract — OCR + parsing pulls out key fields (invoice no, vendor, currency, totals, receipt paid amount/date).\n- De-dup & Match — We canonicalize vendor + invoice_no and search Notion:\n\t- Primary match: Invoice No (+ optional Currency / Vendor (Canon)).\n\t- Fallback: uses document Amount Total and dates.\n\n- Decide the action\n\t- create_unpaid — new invoice (no payment).\n\t- create_paid — new invoice fully paid (unverified).\n\t- create_partial — new invoice with a first partial payment.\n\t- update_partial — add a partial to an existing invoice.\n\t- update_mark_paid — mark existing invoice paid in full.\n\t- manual_review — currency mismatch / overpayment / ambiguous.\n\t- archive — push to archive logs (from manual review).\n\n- Slack approvals (one-click) — A message shows previous paid, this receipt, new total, and Approve buttons (links to a Wait for Webhook resumeUrl). Reviewer picks: Approve Partial / Mark Paid / Manual Review / Archive.\n\n- Notion updates\n\n\t- We only write editable fields: Paid Amount (number), Status (select), Last Payment Date (date).\n\t- Formulas (e.g., Amount Total, Amount Due) recompute automatically.\n\t- Receipts are saved in a Receipts DB and related back to the invoice.\n\n- Notifications & duplicates — If duplicates are detected, Slack posts a simple list with clickable invoice names.\n- Archiving — From Manual Review, Archive goes straight to Archived Invoice DB (and optional Archived Source File DB) as a log entry—no pre-checks needed.\n\n# Set up Steps\nPrerequisites\n1. Notion DB\n2. 4 Slack Channel (**Invoice Input**, **Notification**, **Manual Review**, ***Duplicate Alert (Optional)***)\n3. AI Model (We use **Claude 3.5 Haiku**, Feel free to use Latest Model)\n4. OCR Parsing (We Used **ocr.space**, Feel Free to Change into any OCR Parsing you have)\n#\n- **Create Notion DBs:**  \n\t- *Invoice DB*: Title `Invoice No`; Number `Paid Amount` (editable); Select `Status`; Dates (`Issue/Due/Last Payment Date`); Formulas:  \n\t  - `Amount Total = round(Subtotal - Discount Amount + Tax Total, 2)`  \n\t  - `Amount Due = max(0, round(Amount Total - Paid Amount, 2))`  \n\t- *Receipts DB*: `Invoice No`, `Vendor`, `Paid Amount` (number), `Currency` (select), `Paid Date` (date), `Receipt No`, `Source URL`; Relation → Invoice.  \n\t- *Archived Invoice DB*: `Invoice No`, `Vendor`, `Reason`, `Source URL`, `Original Page ID`, `Archived At` (date).  \n\t- *(Optional)* Source File / Archived Source File DBs.  \n\t- Share all DBs with your Notion integration (*Add connections*).\n- **Add credentials in n8n:** Notion (integration token) and Slack (bot token). Invite the bot to your channel.\n- **Import the workflow/template:** Set each Notion node’s **Database ID** and each Slack node’s **Channel/Credential**.\n- **Map updates:** In the Invoice **Update Page** node, map **Paid Amount**, **Status**, **Last Payment Date**. In **Create Receipt**, map `Invoice` relation + receipt fields.\n- **Test:** Run with a sample invoice/receipt → click a Slack button → verify Invoice/Receipt updates in Notion → try Archive from Manual Review.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Format Check",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Check Format",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Take Binary Files for Document",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "OCR Space Parse1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Check parsing Error3",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Basic LLM Chain",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.7"
    },
    {
      "name": "Anthropic Chat Model4",
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "role": "lmChatAnthropic",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Cleans AI Response",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Internal Check Duplicate Invoice",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Slack Trigger",
      "type": "n8n-nodes-base.slackTrigger",
      "role": "slackTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Merge with Original Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Merge Data Value into One Key",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Decide Fate for Data",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create Query for DB",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Check DB Invoice",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Merge Items Invoice",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send to Source File Invoice 1",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Prepare Line Items before send",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Decide Fate",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Create new Invoice Unpaid",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Add Receipt into Cashflow",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Update Invoice to Paid Fully",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send to Source File Invoice 2",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Add Receipt into Cashflow Paid 1",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create new Invoice Paid Full",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send to Archive Source File Invoice",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Archive Invoice",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Send to Archive Source File Invoice Duplicate",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Archive Invoice Duplicate",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Prepare Archive Duplicate Items",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send to Source File Invoice 3",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Add Receipt into Cashflow Paid 2",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Approval Check",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Add Receipt into Cashflow1",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Update Invoice to Paid Fully 1",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create new Invoice Paid 3",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Take Invoice Details 2",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Take Invoice Details 1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Update Invoice to Paid Fully ",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send to Source File Invoice ",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create new Invoice Paid ",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Archive Invoice 1",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Take Invoice Details 3",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Check DB Exist 1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Check DB Exist 2",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send to Source File Invoice 4",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Add Receipt into Cashflow Paid Partially",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create new Invoice Paid Partially",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Add Receipt into Cashflow2",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Update Invoice to Paid Partial or Fully",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Check parsing Error2",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "OCR Space Parse",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Take Binary Files",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Stop and Error",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "Stop and Error1",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "Aggregate1",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Send Duplicate Notification",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Aggregate2",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify New Invoice with Receipt",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Notify New Invoice",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate3",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify Update Invoice",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate4",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Aggregate5",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Aggregate6",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify Update Invoice Partial Paid",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Notify Create Invoice Partial Paid",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Notify Invoice Archived",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate8",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify Invoice Archived2",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Send to Archive Source File Invoice ",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Aggregate7",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify New Invoice1",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate9",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify New Invoice2",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate10",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify New Invoice with Receipt1",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Aggregate11",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Notify New Invoice with Receipt2",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Error Trigger",
      "type": "n8n-nodes-base.errorTrigger",
      "role": "errorTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Create a database page",
      "type": "n8n-nodes-base.notion",
      "role": "notion",
      "configDescription": "Version 2.2"
    }
  ]
}