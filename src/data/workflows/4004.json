{
  "id": 4004,
  "slug": "4004",
  "title": "Remote IOT sensor monitoring via MQTT and InfluxDB",
  "description": ". \n\n# Read and store IOT sensor data with the MQTT Trigger and InfluxDB\n\ntonyduffy@protonmail.com\n\n\nThis workflow is for users wanting a practical example of how to obtain data from remote IOT systems using the MQTT protocol in an n8n environment.\n\nThe template provides typical n8n node implementation and configuration settings necessary to read and store IOT data.\n\nThe workflow reads the temperature and humidity data from a remote IOT system in this case a DHT22 sensor connected to a ESP32 micro controller. The data is parsed into the correct JSON format and then ingested in an InfluxDB data bucket. From there the stored temperature and humidity values can be displayed in real time.\n\nThe workflow can be easily modified to read any MQTT driven device data.\n\n## Remote IOT Sensor Setup\n\nThe ESP32 controller with the DHT22 sensor are running on a Wokwi simulator.  The simulator uses micro python to publish a MQTT \"wokwi-weather\" topic with the temperature and humidity payloads to an online Mosquitto MQTT broker. The n8n MQTT trigger node subscribes to the topic on the broker and reads the payload values when any changes are published. The code node then prepares the payload for JSON format. The HTTP request node ingests the data in a InfluxDB bucket \n\n## How to customise this workflow to your needs\n\nWokwi IOT ESP32 simulator\n\n* You will need to setup a free account at Wokwi.com\n* Once created search for a project \"Micro-Python MQTT Weather Logger (ESP32)\"\n* Then when the MQTT weather logger project is open change lines 28 and 29 to the following\n    * 28 MQTT_CLIENT_ID = \"\"\n    * 29 MQTT_BROKER    = \"test.mosquitto.org\"\n* You then can start the simulation by clicking on the green arrow and it will connect the mosquitto broker and the \"wokwi-weather\" topic will be published.\n* By clicking on the DHT22 sensor the temperature and humidity bar will appear and you can change the values to send updated payload values to the broker.\n\nInfluxDB\n\n You will require access to functioning InfluxDB database to utilise this workflow\n\nNote : You will have to provide the following for the HTTP request node to connect to InfluxDB.\n\n* The URL and port of the desired InfluxDB (In this case the InfluxDB is running locally on port 8086 ie. http://localhost:8086.)\n* InfluxDB bucket for the data. ( In this case the created bucket name is \"wokwi-data\")\n* The Organization ID of the InfluxDB. This can be obtained for the InfluxDB admin page\n* A generated API token to read and write to the InfluxDB bucket. Created from the InfluxDB admin\n\nn8n workflow.\n\n * The MQTT trigger node is configured to subscribe to the \"wokwi-weather\" topic on the test Mosquitto MQTT broker. It reads the temperature and humidity data sent by ESP32.\n * The code node uses Javascript to move the temperature and humidity payloads to JSON format. This is flexible and can easily modified.\n * The HTTP request node posts the JSON payloads to the InfluxDB bucket.\n\n\n When the above is configured the workflow should function correctly.\n\nThanks to the many who have downloaded this template. Let me know on what you would like to build.  Contact me at tonyduffy@protonmail.com",
  "featuredImage": "/data/workflows/4004/4004.webp",
  "author": {
    "id": 101,
    "slug": "tduffy",
    "name": "Tony Duffy",
    "avatar": ""
  },
  "categories": [
    "Engineering"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1921,
  "downloads": 192,
  "createdAt": "2025-05-12T21:47:36.071Z",
  "updatedAt": "2026-01-16T08:32:33.907Z",
  "publishedAt": "2025-05-12T21:47:36.071Z",
  "nodes": 6,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4004",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Remote IOT sensor monitoring via MQTT and InfluxDB",
    "workflowName": "Remote IOT sensor monitoring via MQTT and InfluxDB",
    "description": ". \n\n# Read and store IOT sensor data with the MQTT Trigger and InfluxDB\n\ntonyduffy@protonmail.com\n\n\nThis workflow is for users wanting a practical example of how to obtain data from remote IOT systems using the MQTT protocol in an n8n environment.\n\nThe template provides typical n8n node implementation and configuration settings necessary to read and store IOT data.\n\nThe workflow reads the temperature and humidity data from a remote IOT system in this case a DHT22 sensor connected to a ESP32 micro controller. The data is parsed into the correct JSON format and then ingested in an InfluxDB data bucket. From there the stored temperature and humidity values can be displayed in real time.\n\nThe workflow can be easily modified to read any MQTT driven device data.\n\n## Remote IOT Sensor Setup\n\nThe ESP32 controller with the DHT22 sensor are running on a Wokwi simulator.  The simulator uses micro python to publish a MQTT \"wokwi-weather\" topic with the temperature and humidity payloads to an online Mosquitto MQTT broker. The n8n MQTT trigger node subscribes to the topic on the broker and reads the payload values when any changes are published. The code node then prepares the payload for JSON format. The HTTP request node ingests the data in a InfluxDB bucket \n\n## How to customise this workflow to your needs\n\nWokwi IOT ESP32 simulator\n\n* You will need to setup a free account at Wokwi.com\n* Once created search for a project \"Micro-Python MQTT Weather Logger (ESP32)\"\n* Then when the MQTT weather logger project is open change lines 28 and 29 to the following\n    * 28 MQTT_CLIENT_ID = \"\"\n    * 29 MQTT_BROKER    = \"test.mosquitto.org\"\n* You then can start the simulation by clicking on the green arrow and it will connect the mosquitto broker and the \"wokwi-weather\" topic will be published.\n* By clicking on the DHT22 sensor the temperature and humidity bar will appear and you can change the values to send updated payload values to the broker.\n\nInfluxDB\n\n You will require access to functioning InfluxDB database to utilise this workflow\n\nNote : You will have to provide the following for the HTTP request node to connect to InfluxDB.\n\n* The URL and port of the desired InfluxDB (In this case the InfluxDB is running locally on port 8086 ie. http://localhost:8086.)\n* InfluxDB bucket for the data. ( In this case the created bucket name is \"wokwi-data\")\n* The Organization ID of the InfluxDB. This can be obtained for the InfluxDB admin page\n* A generated API token to read and write to the InfluxDB bucket. Created from the InfluxDB admin\n\nn8n workflow.\n\n * The MQTT trigger node is configured to subscribe to the \"wokwi-weather\" topic on the test Mosquitto MQTT broker. It reads the temperature and humidity data sent by ESP32.\n * The code node uses Javascript to move the temperature and humidity payloads to JSON format. This is flexible and can easily modified.\n * The HTTP request node posts the JSON payloads to the InfluxDB bucket.\n\n\n When the above is configured the workflow should function correctly.\n\nThanks to the many who have downloaded this template. Let me know on what you would like to build.  Contact me at tonyduffy@protonmail.com",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Remote Sensor MQTT Trigger",
      "type": "n8n-nodes-base.mqttTrigger",
      "role": "mqttTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Data ingest to InfluxDB bucket",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Payload data preparation node",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    }
  ]
}