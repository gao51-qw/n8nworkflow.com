{
  "id": 10086,
  "slug": "10086",
  "title": "ðŸŽ“ How to transform unstructured email data into structured format with AI agent",
  "description": "This workflow automates the process of extracting structured, usable information from unstructured email messages across multiple platforms.\n\nIt connects directly to **Gmail**, **Outlook**, and **IMAP** accounts, retrieves incoming emails, and sends their content to an **AI-powered parsing agent** built on **OpenAI GPT models**.\n\nThe AI agent analyzes each email, identifies relevant details, and returns a **clean JSON structure** containing key fields:\n\n* **From** â€“ senderâ€™s email address\n* **To** â€“ recipientâ€™s email address\n* **Subject** â€“ email subject line\n* **Summary** â€“ short AI-generated summary of the email body\n\nThe extracted information is then automatically inserted into an **n8n Data Table**, creating a structured database of email metadata and summaries ready for indexing, reporting, or integration with other tools.\n\n\n---\n\n###  **Key Benefits**\n\n* âœ… **Full Automation:** Eliminates manual reading and data entry from incoming emails.\n* âœ… **Multi-Source Integration:** Handles data from different email providers seamlessly.\n* âœ… **AI-Driven Accuracy:** Uses advanced language models to interpret complex or unformatted content.\n* âœ… **Structured Storage:** Creates a standardized, query-ready dataset from previously unstructured text.\n* âœ… **Time Efficiency:** Processes emails in real time, improving productivity and response speed.\n*âœ…  **Scalability:** Easily extendable to handle additional sources or extract more data fields.\n---\n\n### How it works\n\nThis workflow automates the transformation of unstructured email data into a structured, queryable format. It operates through a series of connected steps:\n\n1.  **Email Triggering:** The workflow is initiated by one of three different email triggers (Gmail, Microsoft Outlook, or a generic IMAP account), which constantly monitor for new incoming emails.\n2.  **AI-Powered Parsing & Structuring:** When a new email is detected, its raw, unstructured content is passed to a central \"Parsing Agent.\" This agent uses a specified OpenAI language model to intelligently analyze the email text.\n3.  **Data Extraction & Standardization:** Following a predefined system prompt, the AI agent extracts key information from the email, such as the sender, recipient, subject, and a generated summary. It then forces the output into a strict JSON structure using a \"Structured Output Parser\" node, ensuring data consistency.\n4.  **Data Storage:** Finally, the clean, structured data (the `from`, `to`, `subject`, and `summarize` fields) is inserted as a new row into a specified n8n Data Table, creating a searchable and reportable database of email information.\n---\n\n\n### Set up steps\n\nTo implement this workflow, follow these configuration steps:\n\n1.  **Prepare the Data Table:**\n    *   Create a new Data Table within n8n.\n    *   Define the columns with the following names and string type: `From`, `To`, `Subject`, and `Summary`.\n\n2.  **Configure Email Credentials:**\n    *   Set up the credential connections for the email services you wish to use (Gmail OAuth2, Microsoft Outlook OAuth2, and/or IMAP). Ensure the accounts have the necessary permissions to read emails.\n\n3.  **Configure AI Model Credentials:**\n    *   Set up the OpenAI API credential with a valid API key. The workflow is configured to use the model, but this can be changed in the respective nodes if needed.\n\n4.  **Connect the Nodes:**\n    *   The workflow canvas is already correctly wired. Visually confirm that the email triggers are connected to the \"Parsing Agent,\" which is connected to the \"Insert row\" (Data Table) node. Also, ensure the \"OpenAI Chat Model\" and \"Structured Output Parser\" are connected to the \"Parsing Agent\" as its AI model and output parser, respectively.\n\n5.  **Activate the Workflow:**\n    *   Save the workflow and toggle the \"Active\" switch to ON. The triggers will begin polling for new emails according to their schedule (e.g., every minute), and the automation will start processing incoming messages.\n---\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).",
  "featuredImage": "/data/workflows/10086/10086.webp",
  "author": {
    "id": 101,
    "slug": "n3witalia",
    "name": "Davide",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1470,
  "downloads": 147,
  "createdAt": "2025-10-23T14:31:30.248Z",
  "updatedAt": "2026-01-16T09:03:19.612Z",
  "publishedAt": "2025-10-23T14:31:30.248Z",
  "nodes": 16,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10086",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "ðŸŽ“ How to transform unstructured email data into structured format with AI agent",
    "workflowName": "ðŸŽ“ How to transform unstructured email data into structured format with AI agent",
    "description": "This workflow automates the process of extracting structured, usable information from unstructured email messages across multiple platforms.\n\nIt connects directly to **Gmail**, **Outlook**, and **IMAP** accounts, retrieves incoming emails, and sends their content to an **AI-powered parsing agent** built on **OpenAI GPT models**.\n\nThe AI agent analyzes each email, identifies relevant details, and returns a **clean JSON structure** containing key fields:\n\n* **From** â€“ senderâ€™s email address\n* **To** â€“ recipientâ€™s email address\n* **Subject** â€“ email subject line\n* **Summary** â€“ short AI-generated summary of the email body\n\nThe extracted information is then automatically inserted into an **n8n Data Table**, creating a structured database of email metadata and summaries ready for indexing, reporting, or integration with other tools.\n\n\n---\n\n###  **Key Benefits**\n\n* âœ… **Full Automation:** Eliminates manual reading and data entry from incoming emails.\n* âœ… **Multi-Source Integration:** Handles data from different email providers seamlessly.\n* âœ… **AI-Driven Accuracy:** Uses advanced language models to interpret complex or unformatted content.\n* âœ… **Structured Storage:** Creates a standardized, query-ready dataset from previously unstructured text.\n* âœ… **Time Efficiency:** Processes emails in real time, improving productivity and response speed.\n*âœ…  **Scalability:** Easily extendable to handle additional sources or extract more data fields.\n---\n\n### How it works\n\nThis workflow automates the transformation of unstructured email data into a structured, queryable format. It operates through a series of connected steps:\n\n1.  **Email Triggering:** The workflow is initiated by one of three different email triggers (Gmail, Microsoft Outlook, or a generic IMAP account), which constantly monitor for new incoming emails.\n2.  **AI-Powered Parsing & Structuring:** When a new email is detected, its raw, unstructured content is passed to a central \"Parsing Agent.\" This agent uses a specified OpenAI language model to intelligently analyze the email text.\n3.  **Data Extraction & Standardization:** Following a predefined system prompt, the AI agent extracts key information from the email, such as the sender, recipient, subject, and a generated summary. It then forces the output into a strict JSON structure using a \"Structured Output Parser\" node, ensuring data consistency.\n4.  **Data Storage:** Finally, the clean, structured data (the `from`, `to`, `subject`, and `summarize` fields) is inserted as a new row into a specified n8n Data Table, creating a searchable and reportable database of email information.\n---\n\n\n### Set up steps\n\nTo implement this workflow, follow these configuration steps:\n\n1.  **Prepare the Data Table:**\n    *   Create a new Data Table within n8n.\n    *   Define the columns with the following names and string type: `From`, `To`, `Subject`, and `Summary`.\n\n2.  **Configure Email Credentials:**\n    *   Set up the credential connections for the email services you wish to use (Gmail OAuth2, Microsoft Outlook OAuth2, and/or IMAP). Ensure the accounts have the necessary permissions to read emails.\n\n3.  **Configure AI Model Credentials:**\n    *   Set up the OpenAI API credential with a valid API key. The workflow is configured to use the model, but this can be changed in the respective nodes if needed.\n\n4.  **Connect the Nodes:**\n    *   The workflow canvas is already correctly wired. Visually confirm that the email triggers are connected to the \"Parsing Agent,\" which is connected to the \"Insert row\" (Data Table) node. Also, ensure the \"OpenAI Chat Model\" and \"Structured Output Parser\" are connected to the \"Parsing Agent\" as its AI model and output parser, respectively.\n\n5.  **Activate the Workflow:**\n    *   Save the workflow and toggle the \"Active\" switch to ON. The triggers will begin polling for new emails according to their schedule (e.g., every minute), and the automation will start processing incoming messages.\n---\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Gmail Trigger",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Insert row",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Email Trigger (IMAP)",
      "type": "n8n-nodes-base.emailReadImap",
      "role": "emailReadImap",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Microsoft Outlook Trigger",
      "type": "n8n-nodes-base.microsoftOutlookTrigger",
      "role": "microsoftOutlookTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Parsing Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Email Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Emails",
      "type": "n8n-nodes-base.dataTableTool",
      "role": "dataTableTool",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    }
  ]
}