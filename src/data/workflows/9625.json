{
  "id": 9625,
  "slug": "9625",
  "title": "Transcribing Telegram voice messages using Whisper and Gemini with a fallback mechanism",
  "description": "# ğŸ™ï¸ n8n Workflow: Voice Message Transcription with Access Control\n\nThis n8n workflow enables automated transcription of voice messages in Telegram groups with built-in access control and intelligent fallback mechanisms. It's designed for teams that need to convert audio messages to text while maintaining security and handling various audio formats.\n\n---\n\n## ğŸ“Œ Section 1: Trigger & Access Control\n\n### âš¡ Receive Message (Telegram Trigger)\n**Purpose:** Captures incoming messages from users in your Telegram group.\n\n**How it works:** When a user sends a message (voice, audio, or text), the workflow is triggered and the sender's information is captured.\n\n**Benefit:** Serves as the entry point for the entire transcription pipeline.\n\n### ğŸ” Sender Verification\n**Purpose:** Validates whether the sender has permission to use the transcription service.\n\n**Logic:**\nCheck sender against authorized users list\nIf authorized â†’ Proceed to next step\nIf not authorized â†’ Send \"Access denied\" message and stop workflow\n\n**Benefit:** Prevents unauthorized users from consuming AI credits and accessing the service.\n\n---\n\n## ğŸ“Œ Section 2: Message Type Detection\n\n### ğŸµ Audio/Voice Recognition\n**Purpose:** Identifies the type of incoming message and audio format.\n\n**Why it's needed:** Telegram handles different audio types with different statuses:\n- Voice notes (voice messages)\n- Audio files (standard audio attachments)\n- Text messages (no audio content)\n\n**Process:**\n1. Check if message contains audio/voice content\n2. If no audio file detected â†’ Send \"No audio file found\" message\n3. If audio detected â†’ Assign file ID and proceed to format detection\n\n### ğŸ§© File Type Determination (IF Node)\n**Purpose:** Identifies the specific audio format for proper processing.\n\n**Supported formats:**\n- OGG (Telegram voice messages)\n- MPEG/MP3\n- MP4/M4A\n- Other audio formats\n\n**Logic:**\n\nIf format recognized â†’ Proceed to transcription\nIf format not recognized â†’ Send \"File format not recognized\" message\n\n**Benefit:** Ensures compatibility with transcription services by validating file types upfront.\n\n---\n\n## ğŸ“Œ Section 3: Primary Transcription (OpenAI)\n\n### ğŸ“¥ File Download\n**Purpose:** Downloads the audio file from Telegram for processing.\n\n### ğŸ¤– OpenAI Transcription\n**Purpose:** Transcribes audio to text using OpenAI's Whisper API.\n\n**Why OpenAI:** High-quality transcription with cost-effective pricing.\n\n**Process:**\n1. Send downloaded file to OpenAI transcription API\n2. Simultaneously send notification: \"Transcription started\"\n3. If successful â†’ Assign transcribed text to variable and proceed\n4. If error occurs â†’ Trigger fallback mechanism\n\n**Benefit:** Fast, accurate transcription with multi-language support.\n\n---\n\n## ğŸ“Œ Section 4: Fallback Transcription (Gemini)\n\n### ğŸ›Ÿ Gemini Backup Transcription\n**Purpose:** Provides a safety net if OpenAI transcription fails.\n\n**Process:**\n1. Receives file only if OpenAI node returns an error\n2. Downloads and processes the same audio file\n3. Sends to Google Gemini for transcription\n4. Assigns transcribed text to the same text variable\n\n**Benefit:** Ensures high reliabilityâ€”if one service fails, the other takes over automatically.\n\n---\n\n## ğŸ“Œ Section 5: Message Length Handling\n\n### ğŸ“ Text Length Check (IF Node)\n**Purpose:** Determines if the transcribed text exceeds Telegram's character limit.\n\n**Logic:**\n\nIf text â‰¤ 4000 characters â†’ Send directly to Telegram\nIf text &gt; 4000 characters â†’ Split into chunks\n\n**Why:** Telegram has a 4,000-character limit per message.\n\n### âœ‚ï¸ Text Splitting (Code Node)\n**Purpose:** Breaks long transcriptions into 4,000-character segments.\n\n**Process:**\n1. Receives text longer than 4,000 characters\n2. Splits text into chunks of â‰¤4,000 characters\n3. Maintains readability by avoiding mid-word breaks\n4. Outputs array of text chunks\n\n---\n\n## ğŸ“Œ Section 6: Response Delivery\n\n### ğŸ’¬ Send Transcription (Telegram Node)\n**Purpose:** Delivers the transcribed text back to the Telegram group.\n\n**Behavior:**\n- **Short messages:** Sent as a single message\n- **Long messages:** Sent as multiple sequential messages\n\n**Benefit:** Users receive complete transcriptions regardless of length, ensuring no content is lost.\n\n---\n\n## ğŸ“Š Workflow Overview Table\n\n| Section | Node Name | Purpose |\n|---------|-----------|---------|\n| 1. Trigger | Receive Message | Captures incoming Telegram messages |\n| 2. Access Control | Sender Verification | Validates user permissions |\n| 3. Detection | Audio/Voice Recognition | Identifies message type and audio format |\n| 4. Validation | File Type Check | Verifies supported audio formats |\n| 5. Download | File Download | Retrieves audio file from Telegram |\n| 6. Primary AI | OpenAI Transcription | Main transcription service |\n| 7. Fallback AI | Gemini Transcription | Backup transcription service |\n| 8. Processing | Text Length Check | Determines if splitting is needed |\n| 9. Splitting | Code Node | Breaks long text into chunks |\n| 10. Response | Send to Telegram | Delivers transcribed text |\n\n---\n\n## ğŸ¯ Key Benefits\n\n* ğŸ” **Secure access control:** Only authorized users can trigger transcriptions\n* ğŸ’° **Cost management:** Prevents unauthorized credit consumption\n* ğŸµ **Multi-format support:** Handles various Telegram audio types\n* ğŸ›¡ï¸ **High reliability:** Dual-AI fallback ensures transcription success\n* ğŸ“± **Telegram-optimized:** Automatically handles message length limits\n* ğŸŒ **Multi-language:** Both AI services support numerous languages\n* âš¡ **Real-time notifications:** Users receive status updates during processing\n* ğŸ”„ **Automatic chunking:** Long transcriptions are intelligently split\n* ğŸ§  **Smart routing:** Files are processed through the optimal path\n* ğŸ“Š **Complete delivery:** No content loss regardless of transcription length\n\n---\n\n## ğŸš€ Use Cases\n\n- **Team meetings:** Transcribe voice notes from team discussions\n- **Client communications:** Convert client voice messages to searchable text\n- **Documentation:** Create text records of verbal communications\n- **Accessibility:** Make audio content accessible to all team members\n- **Multi-language teams:** Leverage AI transcription for various languages",
  "featuredImage": "/data/workflows/9625/9625.webp",
  "author": {
    "id": 101,
    "slug": "egm-systems",
    "name": "Yehor EGMS",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 267,
  "downloads": 26,
  "createdAt": "2025-10-14T12:31:38.546Z",
  "updatedAt": "2026-01-16T09:01:16.943Z",
  "publishedAt": "2025-10-14T12:31:38.546Z",
  "nodes": 33,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9625",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Transcribing Telegram voice messages using Whisper and Gemini with a fallback mechanism",
    "workflowName": "Transcribing Telegram voice messages using Whisper and Gemini with a fallback mechanism",
    "description": "# ğŸ™ï¸ n8n Workflow: Voice Message Transcription with Access Control\n\nThis n8n workflow enables automated transcription of voice messages in Telegram groups with built-in access control and intelligent fallback mechanisms. It's designed for teams that need to convert audio messages to text while maintaining security and handling various audio formats.\n\n---\n\n## ğŸ“Œ Section 1: Trigger & Access Control\n\n### âš¡ Receive Message (Telegram Trigger)\n**Purpose:** Captures incoming messages from users in your Telegram group.\n\n**How it works:** When a user sends a message (voice, audio, or text), the workflow is triggered and the sender's information is captured.\n\n**Benefit:** Serves as the entry point for the entire transcription pipeline.\n\n### ğŸ” Sender Verification\n**Purpose:** Validates whether the sender has permission to use the transcription service.\n\n**Logic:**\nCheck sender against authorized users list\nIf authorized â†’ Proceed to next step\nIf not authorized â†’ Send \"Access denied\" message and stop workflow\n\n**Benefit:** Prevents unauthorized users from consuming AI credits and accessing the service.\n\n---\n\n## ğŸ“Œ Section 2: Message Type Detection\n\n### ğŸµ Audio/Voice Recognition\n**Purpose:** Identifies the type of incoming message and audio format.\n\n**Why it's needed:** Telegram handles different audio types with different statuses:\n- Voice notes (voice messages)\n- Audio files (standard audio attachments)\n- Text messages (no audio content)\n\n**Process:**\n1. Check if message contains audio/voice content\n2. If no audio file detected â†’ Send \"No audio file found\" message\n3. If audio detected â†’ Assign file ID and proceed to format detection\n\n### ğŸ§© File Type Determination (IF Node)\n**Purpose:** Identifies the specific audio format for proper processing.\n\n**Supported formats:**\n- OGG (Telegram voice messages)\n- MPEG/MP3\n- MP4/M4A\n- Other audio formats\n\n**Logic:**\n\nIf format recognized â†’ Proceed to transcription\nIf format not recognized â†’ Send \"File format not recognized\" message\n\n**Benefit:** Ensures compatibility with transcription services by validating file types upfront.\n\n---\n\n## ğŸ“Œ Section 3: Primary Transcription (OpenAI)\n\n### ğŸ“¥ File Download\n**Purpose:** Downloads the audio file from Telegram for processing.\n\n### ğŸ¤– OpenAI Transcription\n**Purpose:** Transcribes audio to text using OpenAI's Whisper API.\n\n**Why OpenAI:** High-quality transcription with cost-effective pricing.\n\n**Process:**\n1. Send downloaded file to OpenAI transcription API\n2. Simultaneously send notification: \"Transcription started\"\n3. If successful â†’ Assign transcribed text to variable and proceed\n4. If error occurs â†’ Trigger fallback mechanism\n\n**Benefit:** Fast, accurate transcription with multi-language support.\n\n---\n\n## ğŸ“Œ Section 4: Fallback Transcription (Gemini)\n\n### ğŸ›Ÿ Gemini Backup Transcription\n**Purpose:** Provides a safety net if OpenAI transcription fails.\n\n**Process:**\n1. Receives file only if OpenAI node returns an error\n2. Downloads and processes the same audio file\n3. Sends to Google Gemini for transcription\n4. Assigns transcribed text to the same text variable\n\n**Benefit:** Ensures high reliabilityâ€”if one service fails, the other takes over automatically.\n\n---\n\n## ğŸ“Œ Section 5: Message Length Handling\n\n### ğŸ“ Text Length Check (IF Node)\n**Purpose:** Determines if the transcribed text exceeds Telegram's character limit.\n\n**Logic:**\n\nIf text â‰¤ 4000 characters â†’ Send directly to Telegram\nIf text &gt; 4000 characters â†’ Split into chunks\n\n**Why:** Telegram has a 4,000-character limit per message.\n\n### âœ‚ï¸ Text Splitting (Code Node)\n**Purpose:** Breaks long transcriptions into 4,000-character segments.\n\n**Process:**\n1. Receives text longer than 4,000 characters\n2. Splits text into chunks of â‰¤4,000 characters\n3. Maintains readability by avoiding mid-word breaks\n4. Outputs array of text chunks\n\n---\n\n## ğŸ“Œ Section 6: Response Delivery\n\n### ğŸ’¬ Send Transcription (Telegram Node)\n**Purpose:** Delivers the transcribed text back to the Telegram group.\n\n**Behavior:**\n- **Short messages:** Sent as a single message\n- **Long messages:** Sent as multiple sequential messages\n\n**Benefit:** Users receive complete transcriptions regardless of length, ensuring no content is lost.\n\n---\n\n## ğŸ“Š Workflow Overview Table\n\n| Section | Node Name | Purpose |\n|---------|-----------|---------|\n| 1. Trigger | Receive Message | Captures incoming Telegram messages |\n| 2. Access Control | Sender Verification | Validates user permissions |\n| 3. Detection | Audio/Voice Recognition | Identifies message type and audio format |\n| 4. Validation | File Type Check | Verifies supported audio formats |\n| 5. Download | File Download | Retrieves audio file from Telegram |\n| 6. Primary AI | OpenAI Transcription | Main transcription service |\n| 7. Fallback AI | Gemini Transcription | Backup transcription service |\n| 8. Processing | Text Length Check | Determines if splitting is needed |\n| 9. Splitting | Code Node | Breaks long text into chunks |\n| 10. Response | Send to Telegram | Delivers transcribed text |\n\n---\n\n## ğŸ¯ Key Benefits\n\n* ğŸ” **Secure access control:** Only authorized users can trigger transcriptions\n* ğŸ’° **Cost management:** Prevents unauthorized credit consumption\n* ğŸµ **Multi-format support:** Handles various Telegram audio types\n* ğŸ›¡ï¸ **High reliability:** Dual-AI fallback ensures transcription success\n* ğŸ“± **Telegram-optimized:** Automatically handles message length limits\n* ğŸŒ **Multi-language:** Both AI services support numerous languages\n* âš¡ **Real-time notifications:** Users receive status updates during processing\n* ğŸ”„ **Automatic chunking:** Long transcriptions are intelligently split\n* ğŸ§  **Smart routing:** Files are processed through the optimal path\n* ğŸ“Š **Complete delivery:** No content loss regardless of transcription length\n\n---\n\n## ğŸš€ Use Cases\n\n- **Team meetings:** Transcribe voice notes from team discussions\n- **Client communications:** Convert client voice messages to searchable text\n- **Documentation:** Create text records of verbal communications\n- **Accessibility:** Make audio content accessible to all team members\n- **Multi-language teams:** Leverage AI transcription for various languages",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Telegram Trigger1",
      "type": "n8n-nodes-base.telegramTrigger",
      "role": "telegramTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - Starting transcription. Please wait.",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - Access denied!",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - No file!",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Get File GPT",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Get File Gemini",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - File not recognized",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - Output",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "MSG - Output with chunking",
      "type": "n8n-nodes-base.telegram",
      "role": "telegram",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Access Check",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Determining The Type Of Document",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Assigning file_id For Voice",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Assigning file_id For Audio",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Transcription Decision Node",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Transcription by OpenAi",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Transcription by Gemini",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "role": "googleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Assignment of variable TEXT",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Assignment of variable TEXT1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Checking the length of a message",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Text Division",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    }
  ]
}