{
  "id": 8476,
  "slug": "8476",
  "title": "Automate invoice processing with AI data extraction, Google Drive & Sheets",
  "description": "# üßæ Automated Invoice Processing - n8n Workflow\n\n## üìñ **Workflow Description**\n\nThis n8n workflow automates the complete processing of PDF invoices with AI-powered data extraction. The workflow monitors a Google Drive folder, extracts important invoice data, and automatically organizes files in a structured filing system.\n\n---\n\n## üéØ **Features**\n\n- **üîç Automatic monitoring** of a Google Drive folder for new PDF files\n- **ü§ñ AI-powered data extraction** from invoices (customer, amount, date, etc.)\n- **üìÅ Intelligent file sorting** by year and month\n- **üìù Automatic renaming** following a consistent schema\n- **üìä Central documentation** in Google Sheets\n\n---\n\n## üîß **Required Integrations**\n\n### **Required Accounts:**\n- Google Drive (with folder permissions)\n- Google Sheets (with write permissions)\n- Google Gemini API (for AI data extraction)\n\n### **Used n8n Nodes:**\n- Google Drive Trigger\n- Google Drive (File Operations)\n- Google Sheets\n- Extract from File (PDF)\n- Information Extractor (LangChain)\n- Google Gemini Chat Model\n- Split in Batches\n\n---\n\n## üìã **Workflow Steps in Detail**\n\n### **1. Monitoring & Triggering**\n- **Google Drive Trigger** monitors a defined input folder\n- Automatically starts when new PDF files are detected\n- **Split in Batches** enables batch processing of multiple files\n\n### **2. File Processing**\n- **GetFile** downloads PDF files from Google Drive\n- **ExtractFromPDF** converts PDF content to text\n- Supports scanned documents as well\n\n### **3. AI Data Extraction**\nThe **Information Extractor** node with **Google Gemini** extracts:\n- Company name/sender\n- Customer name and customer number\n- Invoice number and date\n- Net and gross amount\n- Value-added tax\n- Article description\n- Month and year (for sorting)\n\n### **4. Automatic Filing**\n- **GetYearFolder** searches/creates year folders\n- **GetMonthFolder** searches/creates month folders\n- **MoveFile** moves invoice to correct folder\n- **UpdateFileName** renames file (schema: \"Customer Month Year\")\n\n### **5. Documentation**\n- **AddToOverview** enters all data into Google Sheets table\n- Enables central overview and analysis\n\n---\n\n## ‚öôÔ∏è **Setup Instructions**\n\n### **Step 1: Prepare Google Drive**\n\nCreate the following folder structure in Google Drive:\n\n```\nüìÅ [Input Folder] (e.g., \"Invoices-Inbox\")\nüìÅ [Main Folder] (e.g., \"Accounting\")\n   ‚îî‚îÄ‚îÄ üìÅ 2024\n       ‚îú‚îÄ‚îÄ üìÅ January\n       ‚îú‚îÄ‚îÄ üìÅ February\n       ‚îú‚îÄ‚îÄ üìÅ March\n       ‚îî‚îÄ‚îÄ ... (all months)\n   ‚îî‚îÄ‚îÄ üìÅ 2025\n       ‚îî‚îÄ‚îÄ ... (all months)\n```\n\n### **Step 2: Create Google Sheets Table**\n\nCreate a spreadsheet with the following columns:\n- Customer Number\n- Customer\n- [Company Name] Location\n- Invoice Date\n- Invoice Number\n- VAT\n- Net Amount\n- Month\n- Year\n\n### **Step 3: Configure Workflow**\n\n#### **Configure Google Drive Trigger:**\n- Select your input folder as \"Folder to Watch\"\n- Set \"Event\" to \"fileCreated\"\n- Activate the trigger\n\n#### **Search files and folders:**\n- Select the same input folder as filter\n\n#### **Customize Information Extractor:**\n- Adapt attribute names to your needs\n- Change company name in description\n- Adjust system prompt if needed\n\n#### **GetYearFolder & GetMonthFolder:**\n- Set the correct folder ID for your main folder\n- Check query string for year/month search\n\n#### **AddToOverview:**\n- Select your Google Sheets table\n- Map columns according to your table\n\n---\n\n## üîß **Customization Options**\n\n### **Extend Data Extraction:**\nAdd more attributes in the Information Extractor node:\n```json\n{\n  \"name\": \"Payment Terms\",\n  \"description\": \"Days until payment due\",\n  \"required\": false\n}\n```\n\n### **Customize File Naming:**\nChange the schema in the UpdateFileName node:\n```\n\"{{ $('Information Extractor').item.json.output.InvoiceNumber }} - {{ $('Information Extractor').item.json.output.Customer }}\"\n```\n\n### **Change Monitoring Interval:**\nIn Google Drive Trigger under \"Poll Times\" select different intervals.\n\n---\n\n## üö® **Important Notes**\n\n### **‚ö†Ô∏è Permissions:**\n- Google Drive: Full access to configured folders\n- Google Sheets: Write permission for target table\n- Google Gemini: Valid API key required\n\n### **üìù Data Format:**\n- Works with German number formats (comma as decimal separator)\n- Date format: YYYY-MM-DD\n- Supports various PDF formats\n\n### **üîÑ Error Handling:**\n- Workflow fails if folders are missing\n- Incomplete PDFs may lead to incomplete extractions\n- Check logs for troubleshooting\n\n---\n\n## üìä **Performance & Limitations**\n\n- **Processing time:** 30-60 seconds per invoice\n- **Supported formats:** PDF (text and OCR)\n- **Batch processing:** Yes, multiple files simultaneously\n- **AI accuracy:** ~95% for standardized invoices\n\n---\n\n## üß™ **Testing**\n\n1. **Run Test:**\n   - Upload a test PDF to the input folder\n   - Monitor workflow execution in n8n\n   - Check results in Google Sheets\n   - Verify correct file movement and renaming\n\n2. **Error Diagnosis:**\n   - For errors: check n8n logs\n   - Consider Google API quotas\n   - Validate folder permissions\n\n---\n\n## üìÑ **License & Support**\n\nThis workflow can be used and customized freely. For configuration questions or issues, check the n8n community or Google API documentation.\n\n**Tip:** Start with a few test invoices before using the workflow in production!",
  "featuredImage": "/data/workflows/8476/8476.webp",
  "author": {
    "id": 101,
    "slug": "romi-walker",
    "name": "Romain",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 609,
  "downloads": 60,
  "createdAt": "2025-09-11T13:04:25.837Z",
  "updatedAt": "2026-01-16T08:56:05.474Z",
  "publishedAt": "2025-09-11T13:04:25.837Z",
  "nodes": 29,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8476",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate invoice processing with AI data extraction, Google Drive & Sheets",
    "workflowName": "Automate invoice processing with AI data extraction, Google Drive & Sheets",
    "description": "# üßæ Automated Invoice Processing - n8n Workflow\n\n## üìñ **Workflow Description**\n\nThis n8n workflow automates the complete processing of PDF invoices with AI-powered data extraction. The workflow monitors a Google Drive folder, extracts important invoice data, and automatically organizes files in a structured filing system.\n\n---\n\n## üéØ **Features**\n\n- **üîç Automatic monitoring** of a Google Drive folder for new PDF files\n- **ü§ñ AI-powered data extraction** from invoices (customer, amount, date, etc.)\n- **üìÅ Intelligent file sorting** by year and month\n- **üìù Automatic renaming** following a consistent schema\n- **üìä Central documentation** in Google Sheets\n\n---\n\n## üîß **Required Integrations**\n\n### **Required Accounts:**\n- Google Drive (with folder permissions)\n- Google Sheets (with write permissions)\n- Google Gemini API (for AI data extraction)\n\n### **Used n8n Nodes:**\n- Google Drive Trigger\n- Google Drive (File Operations)\n- Google Sheets\n- Extract from File (PDF)\n- Information Extractor (LangChain)\n- Google Gemini Chat Model\n- Split in Batches\n\n---\n\n## üìã **Workflow Steps in Detail**\n\n### **1. Monitoring & Triggering**\n- **Google Drive Trigger** monitors a defined input folder\n- Automatically starts when new PDF files are detected\n- **Split in Batches** enables batch processing of multiple files\n\n### **2. File Processing**\n- **GetFile** downloads PDF files from Google Drive\n- **ExtractFromPDF** converts PDF content to text\n- Supports scanned documents as well\n\n### **3. AI Data Extraction**\nThe **Information Extractor** node with **Google Gemini** extracts:\n- Company name/sender\n- Customer name and customer number\n- Invoice number and date\n- Net and gross amount\n- Value-added tax\n- Article description\n- Month and year (for sorting)\n\n### **4. Automatic Filing**\n- **GetYearFolder** searches/creates year folders\n- **GetMonthFolder** searches/creates month folders\n- **MoveFile** moves invoice to correct folder\n- **UpdateFileName** renames file (schema: \"Customer Month Year\")\n\n### **5. Documentation**\n- **AddToOverview** enters all data into Google Sheets table\n- Enables central overview and analysis\n\n---\n\n## ‚öôÔ∏è **Setup Instructions**\n\n### **Step 1: Prepare Google Drive**\n\nCreate the following folder structure in Google Drive:\n\n```\nüìÅ [Input Folder] (e.g., \"Invoices-Inbox\")\nüìÅ [Main Folder] (e.g., \"Accounting\")\n   ‚îî‚îÄ‚îÄ üìÅ 2024\n       ‚îú‚îÄ‚îÄ üìÅ January\n       ‚îú‚îÄ‚îÄ üìÅ February\n       ‚îú‚îÄ‚îÄ üìÅ March\n       ‚îî‚îÄ‚îÄ ... (all months)\n   ‚îî‚îÄ‚îÄ üìÅ 2025\n       ‚îî‚îÄ‚îÄ ... (all months)\n```\n\n### **Step 2: Create Google Sheets Table**\n\nCreate a spreadsheet with the following columns:\n- Customer Number\n- Customer\n- [Company Name] Location\n- Invoice Date\n- Invoice Number\n- VAT\n- Net Amount\n- Month\n- Year\n\n### **Step 3: Configure Workflow**\n\n#### **Configure Google Drive Trigger:**\n- Select your input folder as \"Folder to Watch\"\n- Set \"Event\" to \"fileCreated\"\n- Activate the trigger\n\n#### **Search files and folders:**\n- Select the same input folder as filter\n\n#### **Customize Information Extractor:**\n- Adapt attribute names to your needs\n- Change company name in description\n- Adjust system prompt if needed\n\n#### **GetYearFolder & GetMonthFolder:**\n- Set the correct folder ID for your main folder\n- Check query string for year/month search\n\n#### **AddToOverview:**\n- Select your Google Sheets table\n- Map columns according to your table\n\n---\n\n## üîß **Customization Options**\n\n### **Extend Data Extraction:**\nAdd more attributes in the Information Extractor node:\n```json\n{\n  \"name\": \"Payment Terms\",\n  \"description\": \"Days until payment due\",\n  \"required\": false\n}\n```\n\n### **Customize File Naming:**\nChange the schema in the UpdateFileName node:\n```\n\"{{ $('Information Extractor').item.json.output.InvoiceNumber }} - {{ $('Information Extractor').item.json.output.Customer }}\"\n```\n\n### **Change Monitoring Interval:**\nIn Google Drive Trigger under \"Poll Times\" select different intervals.\n\n---\n\n## üö® **Important Notes**\n\n### **‚ö†Ô∏è Permissions:**\n- Google Drive: Full access to configured folders\n- Google Sheets: Write permission for target table\n- Google Gemini: Valid API key required\n\n### **üìù Data Format:**\n- Works with German number formats (comma as decimal separator)\n- Date format: YYYY-MM-DD\n- Supports various PDF formats\n\n### **üîÑ Error Handling:**\n- Workflow fails if folders are missing\n- Incomplete PDFs may lead to incomplete extractions\n- Check logs for troubleshooting\n\n---\n\n## üìä **Performance & Limitations**\n\n- **Processing time:** 30-60 seconds per invoice\n- **Supported formats:** PDF (text and OCR)\n- **Batch processing:** Yes, multiple files simultaneously\n- **AI accuracy:** ~95% for standardized invoices\n\n---\n\n## üß™ **Testing**\n\n1. **Run Test:**\n   - Upload a test PDF to the input folder\n   - Monitor workflow execution in n8n\n   - Check results in Google Sheets\n   - Verify correct file movement and renaming\n\n2. **Error Diagnosis:**\n   - For errors: check n8n logs\n   - Consider Google API quotas\n   - Validate folder permissions\n\n---\n\n## üìÑ **License & Support**\n\nThis workflow can be used and customized freely. For configuration questions or issues, check the n8n community or Google API documentation.\n\n**Tip:** Start with a few test invoices before using the workflow in production!",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "GetFile",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "role": "informationExtractor",
      "configDescription": "Version 1"
    },
    {
      "name": "ExtractFromPDF",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "GetYearFolder",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "GetMonthFolder",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "MoveFile",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "UpdateFileName",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "AddToOverview",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Search files and folders",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Jahresordner schon vorhanden?",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Jahresordner erstellen",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Monatsordner einf√ºgen",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Monate als Liste",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Jahre ausw√§hlen",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Ordner noch nicht vorhanden",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}