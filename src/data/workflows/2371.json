{
  "id": 2371,
  "slug": "2371",
  "title": "Request and receive Zigbee backup from zigbee2mqtt and save it via SFTP",
  "description": "A single workflow with 2 flows/paths that combine to handle the backup sequence for Zigbee device configuration from HomeAssistant / zigbee2mqtt.  This provides a way to automate a periodic capture of Zigbee coordinators and device pairings to speed the recovery process when/if the HomeAssistant instance needs to be rebuilt.  Setting up similar automation without n8n (e.g. shell scripts and system timers) is consiterably more challenging.  n8n makes it easy and this template should remove any other excuse not to do it.\n\n## Flow 1\n* Triggered by Cron/Timer\n  * set whatever interval for backups\n  * sends mqtt message to request zigbee2mqtt backup (via separate message)\n\n## Flow 2\n* Triggered by zigbee2mqtt backup message\n* Extracts zip file from the message and stores somewhere, with a date-stamp in the filename, via sftp\n\n## Setup\n* Create a MQTT connection named **\"MQTT Account\"** with the appropriate protocol (mqtt), host, port (1883), username, and password\n* Create an sftp connection named **\"SFTP Zigbee Backups\"** with the appropriate host, port (22), username, and password or key.\n\n## Reference\n* [This article](https://home-assistant-guide.com/changelog/zigbee2mqtt/zigbee2mqtt-1-26-0/you-can-now-back-up-your-complete-zigbee2mqtt-configuration/) describes the mqtt parts.\n",
  "featuredImage": "/data/workflows/2371/2371.webp",
  "author": {
    "id": 101,
    "slug": "hubschrauber",
    "name": "Hubschrauber",
    "avatar": ""
  },
  "categories": [
    "File Management"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1874,
  "downloads": 187,
  "createdAt": "2024-08-03T00:26:43.219Z",
  "updatedAt": "2026-01-16T08:24:15.753Z",
  "publishedAt": "2024-08-03T00:26:43.219Z",
  "nodes": 6,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/2371",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Request and receive Zigbee backup from zigbee2mqtt and save it via SFTP",
    "workflowName": "Request and receive Zigbee backup from zigbee2mqtt and save it via SFTP",
    "description": "A single workflow with 2 flows/paths that combine to handle the backup sequence for Zigbee device configuration from HomeAssistant / zigbee2mqtt.  This provides a way to automate a periodic capture of Zigbee coordinators and device pairings to speed the recovery process when/if the HomeAssistant instance needs to be rebuilt.  Setting up similar automation without n8n (e.g. shell scripts and system timers) is consiterably more challenging.  n8n makes it easy and this template should remove any other excuse not to do it.\n\n## Flow 1\n* Triggered by Cron/Timer\n  * set whatever interval for backups\n  * sends mqtt message to request zigbee2mqtt backup (via separate message)\n\n## Flow 2\n* Triggered by zigbee2mqtt backup message\n* Extracts zip file from the message and stores somewhere, with a date-stamp in the filename, via sftp\n\n## Setup\n* Create a MQTT connection named **\"MQTT Account\"** with the appropriate protocol (mqtt), host, port (1883), username, and password\n* Create an sftp connection named **\"SFTP Zigbee Backups\"** with the appropriate host, port (22), username, and password or key.\n\n## Reference\n* [This article](https://home-assistant-guide.com/changelog/zigbee2mqtt/zigbee2mqtt-1-26-0/you-can-now-back-up-your-complete-zigbee2mqtt-configuration/) describes the mqtt parts.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "SFTP zip file content",
      "type": "n8n-nodes-base.ftp",
      "role": "ftp",
      "configDescription": "Version 1"
    },
    {
      "name": "CRON Monday 2:45 am",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Send Zigbee2MQTT backup request",
      "type": "n8n-nodes-base.mqtt",
      "role": "mqtt",
      "configDescription": "Version 1"
    },
    {
      "name": "MQTT Trigger - Backup Response",
      "type": "n8n-nodes-base.mqttTrigger",
      "role": "mqttTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Parse JSON Object from Message Text",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Convert to File - base64 to binary",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1"
    }
  ]
}