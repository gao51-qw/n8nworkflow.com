{
  "id": 2899,
  "slug": "2899",
  "title": "Unique QRcode coupon assignment and validation for lead generation with SuiteCRM",
  "description": "This workflow is designed to manage the assignment and validation of unique QR code coupons within a lead generation system with SuiteCRM.\n\n---\n\n### **How it Works**\n\nThis workflow automates the process of assigning unique QR code coupons to leads generated through a form submission, ensuring no duplicates are created, and validating the usage of coupons. Here's how it operates:\n\n1. **Webhook Trigger**:\n   - The workflow starts with a `Webhook` node that listens for incoming requests containing QR code data.\n   - A `Set coupon` node extracts the QR code value from the request parameters.\n\n2. **Validation of QR Code**:\n   - An `If` node checks if the QR code exists in the incoming data. If it does, the process proceeds; otherwise, a \"No coupon\" response is sent back.\n\n3. **Coupon Lookup**:\n   - The `Get Lead` node queries a Google Sheets document to check if the QR code corresponds to an existing lead.\n   - A subsequent `Not used?` node verifies whether the coupon has already been used by checking the \"USED COUPON?\" field in the sheet.\n\n4. **Lead Duplication Check**:\n   - When a new lead submits the form (`On form submission`), the `Duplicate Lead?` node checks if the email already exists in the system to prevent duplicates.\n\n5. **Coupon Assignment**:\n   - If the lead is not a duplicate, the `Get Coupon` node retrieves an available unassigned coupon from the Google Sheets document.\n   - The `Token SuiteCRM` node generates an access token for SuiteCRM, and the `Create Lead SuiteCRM` node creates a new lead entry in SuiteCRM, associating it with the assigned coupon.\n\n6. **QR Code Generation and Email Notification**:\n   - The `Get QR` node generates a QR code image URL for the assigned coupon.\n   - The `Send Email` node sends an email to the lead with the QR code attached.\n\n7. **Response Handling**:\n   - Depending on the validation results, the workflow responds with appropriate messages:\n     - \"Coupon OK\" if the coupon is valid and unused.\n     - \"Coupon KO\" if the coupon has already been used.\n     - \"Coupon not valid\" if the QR code does not exist.\n\n---\n\n### **Set Up Steps**\n\nTo replicate this workflow in your own n8n environment, follow these steps:\n\n1. **Configuration**:\n   - Set up an n8n instance either locally or via cloud services.\n   - Import the provided JSON configuration file into your workspace.\n   - Configure all required credentials, such as:\n     - Google Sheets OAuth2 API for accessing the spreadsheet.\n     - SuiteCRM API credentials (e.g., `SUITECRMURL`, `CLIENTID`, `CLIENTSECRET`).\n     - SMTP credentials for sending emails.\n\n2. **Customization**:\n   - Adjust the `Webhook` URL to match your deployment environment.\n   - Modify the Google Sheets document ID and sheet name in nodes like `Duplicate Lead?`, `Get Coupon`, `Update Sheet`, and `Update coupon used`.\n   - Update the SuiteCRM API endpoint and credentials in nodes like `Token SuiteCRM` and `Create Lead SuiteCRM`.\n   - Customize the email template in the `Send Email` node to match your branding and messaging requirements.\n   - Ensure the QR code generation URL in the `Get QR` node points to a valid QR code generator service.\n\nBy following these steps, you can effectively implement and customize this workflow to manage lead generation and coupon assignments in your organization. \n",
  "featuredImage": "/data/workflows/2899/2899.webp",
  "author": {
    "id": 101,
    "slug": "n3witalia",
    "name": "Davide",
    "avatar": ""
  },
  "categories": [
    "Lead Generation"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2643,
  "downloads": 264,
  "createdAt": "2025-02-13T15:06:26.229Z",
  "updatedAt": "2026-01-16T08:27:06.988Z",
  "publishedAt": "2025-02-13T15:06:26.229Z",
  "nodes": 29,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/2899",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Unique QRcode coupon assignment and validation for lead generation with SuiteCRM",
    "workflowName": "Unique QRcode coupon assignment and validation for lead generation with SuiteCRM",
    "description": "This workflow is designed to manage the assignment and validation of unique QR code coupons within a lead generation system with SuiteCRM.\n\n---\n\n### **How it Works**\n\nThis workflow automates the process of assigning unique QR code coupons to leads generated through a form submission, ensuring no duplicates are created, and validating the usage of coupons. Here's how it operates:\n\n1. **Webhook Trigger**:\n   - The workflow starts with a `Webhook` node that listens for incoming requests containing QR code data.\n   - A `Set coupon` node extracts the QR code value from the request parameters.\n\n2. **Validation of QR Code**:\n   - An `If` node checks if the QR code exists in the incoming data. If it does, the process proceeds; otherwise, a \"No coupon\" response is sent back.\n\n3. **Coupon Lookup**:\n   - The `Get Lead` node queries a Google Sheets document to check if the QR code corresponds to an existing lead.\n   - A subsequent `Not used?` node verifies whether the coupon has already been used by checking the \"USED COUPON?\" field in the sheet.\n\n4. **Lead Duplication Check**:\n   - When a new lead submits the form (`On form submission`), the `Duplicate Lead?` node checks if the email already exists in the system to prevent duplicates.\n\n5. **Coupon Assignment**:\n   - If the lead is not a duplicate, the `Get Coupon` node retrieves an available unassigned coupon from the Google Sheets document.\n   - The `Token SuiteCRM` node generates an access token for SuiteCRM, and the `Create Lead SuiteCRM` node creates a new lead entry in SuiteCRM, associating it with the assigned coupon.\n\n6. **QR Code Generation and Email Notification**:\n   - The `Get QR` node generates a QR code image URL for the assigned coupon.\n   - The `Send Email` node sends an email to the lead with the QR code attached.\n\n7. **Response Handling**:\n   - Depending on the validation results, the workflow responds with appropriate messages:\n     - \"Coupon OK\" if the coupon is valid and unused.\n     - \"Coupon KO\" if the coupon has already been used.\n     - \"Coupon not valid\" if the QR code does not exist.\n\n---\n\n### **Set Up Steps**\n\nTo replicate this workflow in your own n8n environment, follow these steps:\n\n1. **Configuration**:\n   - Set up an n8n instance either locally or via cloud services.\n   - Import the provided JSON configuration file into your workspace.\n   - Configure all required credentials, such as:\n     - Google Sheets OAuth2 API for accessing the spreadsheet.\n     - SuiteCRM API credentials (e.g., `SUITECRMURL`, `CLIENTID`, `CLIENTSECRET`).\n     - SMTP credentials for sending emails.\n\n2. **Customization**:\n   - Adjust the `Webhook` URL to match your deployment environment.\n   - Modify the Google Sheets document ID and sheet name in nodes like `Duplicate Lead?`, `Get Coupon`, `Update Sheet`, and `Update coupon used`.\n   - Update the SuiteCRM API endpoint and credentials in nodes like `Token SuiteCRM` and `Create Lead SuiteCRM`.\n   - Customize the email template in the `Send Email` node to match your branding and messaging requirements.\n   - Ensure the QR code generation URL in the `Get QR` node points to a valid QR code generator service.\n\nBy following these steps, you can effectively implement and customize this workflow to manage lead generation and coupon assignments in your organization.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Token SuiteCRM",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 1"
    },
    {
      "name": "Create Lead SuiteCRM",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 3"
    },
    {
      "name": "On form submission",
      "type": "n8n-nodes-base.formTrigger",
      "role": "formTrigger",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Duplicate Lead?",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Form Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Get Coupon",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Update Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Is Duplicate?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get QR",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Send Email",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Update Lead",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 3"
    },
    {
      "name": "Not used?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Coupon OK",
      "type": "n8n-nodes-base.respondToWebhook",
      "role": "respondToWebhook",
      "configDescription": "Version 1.1"
    },
    {
      "name": "No coupon",
      "type": "n8n-nodes-base.respondToWebhook",
      "role": "respondToWebhook",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Coupon KO",
      "type": "n8n-nodes-base.respondToWebhook",
      "role": "respondToWebhook",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Token SuiteCRM 1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 1"
    },
    {
      "name": "Set coupon",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Get Lead",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Update coupon used",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}