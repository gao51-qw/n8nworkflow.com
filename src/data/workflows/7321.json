{
  "id": 7321,
  "slug": "7321",
  "title": "Process scanned invoices with Google Drive, OCR & OpenAI to Google Sheets",
  "description": "### This template allows you to automatically process scanned invoices from Google Drive, extract key information using AI, and organize the data in Google Sheets with email notifications.\n\n### Overview\nThis comprehensive workflow automates the entire invoice processing pipeline by monitoring a Google Drive folder for new invoice uploads, intelligently processing both PDF and image formats, extracting structured data using AI-powered information extraction, and automatically organizing the results in a Google Sheet while sending email notifications. The system handles various file formats and includes smart fallback mechanisms for challenging documents like CamScanner PDFs.\n\n### How it Works\n\n1. **File Monitoring**: The workflow continuously monitors a specified Google Drive folder for new invoice files using a trigger that checks every minute for newly created files.\n\n2. **File Processing**: When new files are detected, the system downloads them and determines the file type (PDF or image) using a smart switch mechanism.\n\n3. **Text Extraction**: \n   - For PDFs: Attempts direct text extraction first\n   - For Images: Uses OCR.Space API for optical character recognition\n   - For problematic PDFs (like CamScanner): Falls back to OCR processing\n\n4. **AI Information Extraction**: Processes the extracted text through OpenAI's language model to identify and extract key invoice information including:\n   - Company name\n   - Total amount\n   - Currency\n   - Invoice date\n   - Invoice number\n\n5. **Data Storage**: Automatically appends the extracted information to a Google Sheet with links back to the original scanned documents.\n\n6. **Notification**: Sends formatted email notifications via Mailgun when new invoices are processed, including an HTML table summary.\n\n### How to Use\n\n1. **Setup Google Drive**: Create a dedicated folder in Google Drive for invoice uploads and note the folder ID.\n\n2. **Configure Credentials**: Set up the following credential connections in n8n:\n   - Google Drive OAuth2 API\n   - Google Sheets OAuth2 API  \n   - OpenAI API\n   - OCR.Space API\n   - Mailgun API\n\n3. **Update Configuration**: \n   - Replace the Google Drive folder ID with your target folder\n   - Replace the Google Sheets document ID with your destination spreadsheet\n   - Update email addresses in the Mailgun node\n\n4. **Test the Workflow**: Use the manual trigger to process existing invoices in your folder for initial testing.\n\n5. **Activate**: Enable the workflow to start automatic monitoring of new invoice uploads.\n\n## Requirements\n\n**External APIs:**\n- **OpenAI API** - For AI-powered information extraction from invoice text\n- **OCR.Space API** - For optical character recognition of image-based invoices\n- **Mailgun API** - For sending email notifications\n\n**Google Services:**\n- **Google Drive API** - For monitoring folders and downloading files\n- **Google Sheets API** - For storing extracted invoice data\n\n**Setup Prerequisites:**\n- Google Drive folder dedicated to invoice uploads\n- Google Sheet with appropriate column headers (date, company name, total, currency, invoice number, scan link, etc.)\n- Email domain configured with Mailgun (or alternative email service)\n- OCR.Space account for image processing capabilities: https://ocr.space/OCRAPI\n\n**Recommended Settings:**\n- Set the Google Drive trigger to check for new files every minute\n- Ensure sufficient API rate limits for your expected invoice volume\n- Configure proper error handling for failed OCR or AI extraction attempts",
  "featuredImage": "/data/workflows/7321/7321.webp",
  "author": {
    "id": 101,
    "slug": "zohar",
    "name": "Ovadia Rocks",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1057,
  "downloads": 105,
  "createdAt": "2025-08-13T10:26:05.705Z",
  "updatedAt": "2026-01-16T08:49:43.043Z",
  "publishedAt": "2025-08-13T10:26:05.705Z",
  "nodes": 24,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7321",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Process scanned invoices with Google Drive, OCR & OpenAI to Google Sheets",
    "workflowName": "Process scanned invoices with Google Drive, OCR & OpenAI to Google Sheets",
    "description": "### This template allows you to automatically process scanned invoices from Google Drive, extract key information using AI, and organize the data in Google Sheets with email notifications.\n\n### Overview\nThis comprehensive workflow automates the entire invoice processing pipeline by monitoring a Google Drive folder for new invoice uploads, intelligently processing both PDF and image formats, extracting structured data using AI-powered information extraction, and automatically organizing the results in a Google Sheet while sending email notifications. The system handles various file formats and includes smart fallback mechanisms for challenging documents like CamScanner PDFs.\n\n### How it Works\n\n1. **File Monitoring**: The workflow continuously monitors a specified Google Drive folder for new invoice files using a trigger that checks every minute for newly created files.\n\n2. **File Processing**: When new files are detected, the system downloads them and determines the file type (PDF or image) using a smart switch mechanism.\n\n3. **Text Extraction**: \n   - For PDFs: Attempts direct text extraction first\n   - For Images: Uses OCR.Space API for optical character recognition\n   - For problematic PDFs (like CamScanner): Falls back to OCR processing\n\n4. **AI Information Extraction**: Processes the extracted text through OpenAI's language model to identify and extract key invoice information including:\n   - Company name\n   - Total amount\n   - Currency\n   - Invoice date\n   - Invoice number\n\n5. **Data Storage**: Automatically appends the extracted information to a Google Sheet with links back to the original scanned documents.\n\n6. **Notification**: Sends formatted email notifications via Mailgun when new invoices are processed, including an HTML table summary.\n\n### How to Use\n\n1. **Setup Google Drive**: Create a dedicated folder in Google Drive for invoice uploads and note the folder ID.\n\n2. **Configure Credentials**: Set up the following credential connections in n8n:\n   - Google Drive OAuth2 API\n   - Google Sheets OAuth2 API  \n   - OpenAI API\n   - OCR.Space API\n   - Mailgun API\n\n3. **Update Configuration**: \n   - Replace the Google Drive folder ID with your target folder\n   - Replace the Google Sheets document ID with your destination spreadsheet\n   - Update email addresses in the Mailgun node\n\n4. **Test the Workflow**: Use the manual trigger to process existing invoices in your folder for initial testing.\n\n5. **Activate**: Enable the workflow to start automatic monitoring of new invoice uploads.\n\n## Requirements\n\n**External APIs:**\n- **OpenAI API** - For AI-powered information extraction from invoice text\n- **OCR.Space API** - For optical character recognition of image-based invoices\n- **Mailgun API** - For sending email notifications\n\n**Google Services:**\n- **Google Drive API** - For monitoring folders and downloading files\n- **Google Sheets API** - For storing extracted invoice data\n\n**Setup Prerequisites:**\n- Google Drive folder dedicated to invoice uploads\n- Google Sheet with appropriate column headers (date, company name, total, currency, invoice number, scan link, etc.)\n- Email domain configured with Mailgun (or alternative email service)\n- OCR.Space account for image processing capabilities: https://ocr.space/OCRAPI\n\n**Recommended Settings:**\n- Set the Google Drive trigger to check for new files every minute\n- Ensure sufficient API rate limits for your expected invoice volume\n- Configure proper error handling for failed OCR or AI extraction attempts",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking 'Execute workflow'",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Switch Mime Type",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Set file identity",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Save base64",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Re-set base64",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Check for new invoices",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Download file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Fetch 50 docs",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Identify CamScanner",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Analyze Image",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "role": "informationExtractor",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Append row in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Mailgun",
      "type": "n8n-nodes-base.mailgun",
      "role": "mailgun",
      "configDescription": "Version 1"
    },
    {
      "name": "Prepare a table",
      "type": "n8n-nodes-base.html",
      "role": "html",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}