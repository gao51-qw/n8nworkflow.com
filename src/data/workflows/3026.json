{
  "id": 3026,
  "slug": "3026",
  "title": "Run Apache Airflow DAG and retrieve XCom value",
  "description": "# Run Apache Airflow DAG and Retrieve XCom Value\n\n## What this workflow does\n\nThis workflow integrates the Apache Airflow API [DAGRun](https://airflow.apache.org/docs/apache-airflow/2.10.5/stable-rest-api-ref.html#tag/DAGRun) and [XCom](https://airflow.apache.org/docs/apache-airflow/2.10.5/stable-rest-api-ref.html#tag/XCom). It enables n8n to trigger Airflow DAGs and retrieve the execution results.\n\n## Preparation:\n\n1. **Update Airflow API Link Prefix**\n\n   - Navigate to the `airflow-api` node.\n   - Update the prefix of the Airflow API link in the format: `http(s)://ip:port`.\n   - Example: `https://airflow.example.com`\n\n2. **Configure Authentication**\n\n   - Go to the `Airflow: dag_run` node.\n   - Update the `Basic Auth` credentials with your Airflow username and password.\n   - Repeat this step for `Airflow: dag_run - state` and `Airflow: dag_run - get result` nodes.\n\n   **Security Note:** Using Basic Authentication requires storing credentials in plaintext. If possible, consider using API Keys or Tokens for enhanced security.\n\n   - An example is setting Airflow's [API Authentication](https://airflow.apache.org/docs/apache-airflow-providers-fab/stable/auth-manager/api-authentication.html) to [basic\\_auth](https://airflow.apache.org/docs/apache-airflow-providers-fab/stable/auth-manager/api-authentication.html#basic-authentication). Choose other authentication methods if needed.\n   - Ensure the user account has the following permissions: `can create on DAG Runs`, `can read on DAG Runs`, `can read on XComs`, `can edit on DAGs`, and `can read on DAGs`.\n\n## How to Use:\n\nTo execute this workflow, use the **Execute Sub-workflow** node with the following input parameters:\n\n- **dag\\_id**: The DAG ID (name) in Airflow that you want to trigger.\n- **task\\_id**: The Task ID (name) from which you want to retrieve the XCom return\\_value.\n- **conf**: Input data for the Airflow DAG run.\n- **wait**: Delay (in seconds) between each `Airflow: dag_run - state` check.\n- **wait\\_time**: The maximum time (in seconds) to wait for `Airflow: dag_run - state` before returning an error.\n\n## Output:\n\n- The workflow returns the XCom result from `Airflow: dag_run - get result`.\n- The XCom `return_value` is stored in the `value` field.\n",
  "featuredImage": "/data/workflows/3026/3026.webp",
  "author": {
    "id": 101,
    "slug": "windoac",
    "name": "Antonio Cheong",
    "avatar": ""
  },
  "categories": [
    "Engineering"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 725,
  "downloads": 72,
  "createdAt": "2025-02-27T06:42:48.457Z",
  "updatedAt": "2026-01-16T08:27:41.612Z",
  "publishedAt": "2025-02-27T06:42:48.457Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3026",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Run Apache Airflow DAG and retrieve XCom value",
    "workflowName": "Run Apache Airflow DAG and retrieve XCom value",
    "description": "# Run Apache Airflow DAG and Retrieve XCom Value\n\n## What this workflow does\n\nThis workflow integrates the Apache Airflow API [DAGRun](https://airflow.apache.org/docs/apache-airflow/2.10.5/stable-rest-api-ref.html#tag/DAGRun) and [XCom](https://airflow.apache.org/docs/apache-airflow/2.10.5/stable-rest-api-ref.html#tag/XCom). It enables n8n to trigger Airflow DAGs and retrieve the execution results.\n\n## Preparation:\n\n1. **Update Airflow API Link Prefix**\n\n   - Navigate to the `airflow-api` node.\n   - Update the prefix of the Airflow API link in the format: `http(s)://ip:port`.\n   - Example: `https://airflow.example.com`\n\n2. **Configure Authentication**\n\n   - Go to the `Airflow: dag_run` node.\n   - Update the `Basic Auth` credentials with your Airflow username and password.\n   - Repeat this step for `Airflow: dag_run - state` and `Airflow: dag_run - get result` nodes.\n\n   **Security Note:** Using Basic Authentication requires storing credentials in plaintext. If possible, consider using API Keys or Tokens for enhanced security.\n\n   - An example is setting Airflow's [API Authentication](https://airflow.apache.org/docs/apache-airflow-providers-fab/stable/auth-manager/api-authentication.html) to [basic\\_auth](https://airflow.apache.org/docs/apache-airflow-providers-fab/stable/auth-manager/api-authentication.html#basic-authentication). Choose other authentication methods if needed.\n   - Ensure the user account has the following permissions: `can create on DAG Runs`, `can read on DAG Runs`, `can read on XComs`, `can edit on DAGs`, and `can read on DAGs`.\n\n## How to Use:\n\nTo execute this workflow, use the **Execute Sub-workflow** node with the following input parameters:\n\n- **dag\\_id**: The DAG ID (name) in Airflow that you want to trigger.\n- **task\\_id**: The Task ID (name) from which you want to retrieve the XCom return\\_value.\n- **conf**: Input data for the Airflow DAG run.\n- **wait**: Delay (in seconds) between each `Airflow: dag_run - state` check.\n- **wait\\_time**: The maximum time (in seconds) to wait for `Airflow: dag_run - state` before returning an error.\n\n## Output:\n\n- The workflow returns the XCom result from `Airflow: dag_run - get result`.\n- The XCom `return_value` is stored in the `value` field.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Airflow: dag_run",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Airflow: dag_run - state",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "count",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "dag run fail",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "if state == queued",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "dag run wait too long",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "Airflow: dag_run - get result",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Switch: state",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "in data",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "role": "executeWorkflowTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "If count > wait_time",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "airflow-api",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    }
  ]
}