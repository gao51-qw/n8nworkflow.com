{
  "id": 3413,
  "slug": "3413",
  "title": "LINE messages with GPT: Save notes, namecard data and tasks",
  "description": "This workflow template, \"Personal Assistant to Note Messages and Extract Namecard Information\" is designed to streamline the processing of incoming messages on the LINE messaging platform. It integrates with powerful tools like Microsoft Teams , Microsoft To Do , OneDrive , and OpenRouter.ai to handle tasks such as saving notes, extracting namecard information, and organizing images. Whether you’re managing personal productivity or automating workflows for teams, this template offers a versatile and customizable solution.\n\nBy leveraging this workflow, you can automate repetitive tasks, improve collaboration, and enhance efficiency in handling LINE messages.\n\n## Who Is This Template For?\nThis template is ideal for:\n\n- Professionals: Who want to save important messages, extract data from namecards, or organize images automatically.\n- Teams: Looking to integrate LINE messages into tools like Microsoft Teams and Microsoft To Do for better collaboration.\n- Developers: Seeking to build intelligent workflows that process text, images, and other inputs from LINE.\n- Business Owners: Who need to manage customer interactions, follow-ups, and task tracking efficiently.\n\n## What Problem Does This Workflow Solve?\nManaging incoming messages on LINE can be time-consuming, especially when dealing with diverse input types like text, images, and namecards. This workflow solves that problem by:\n- Automatically identifying and routing different message types (text, images, namecards) to appropriate actions.\n- Extracting structured data from namecards and saving it for follow-up tasks.\n- Uploading images to OneDrive and saving text messages to Microsoft Teams or Microsoft To Do for easy access.\n- Sending real-time feedback to users via LINE to confirm that their messages have been processed.\n\n## What This Workflow Does\n- Receive Messages via LINE Webhook:\nThe workflow is triggered whenever a user sends a message (text, image, or other types) to the LINE bot.\n- Display Loading Animation:\nA loading animation is displayed to reassure the user that their request is being processed.\nRoute Input Types:\n\nThe workflow uses a Switch node to determine the type of input:\n- Text Starting with \"T\": Adds the message as a task in Microsoft To Do.\n- Plain Text: Saves the message in Microsoft Teams under a designated channel (e.g., \"Notes\").\n- Images: Identifies whether the image is a namecard, handwritten note, or other content, then processes accordingly.\n- Unsupported formats trigger a polite response indicating the limitation.\nProcess Namecards:\n\n**Images **\nIf the image is identified as a namecard, the workflow extracts structured data (e.g., name, email, phone number) using OpenRouter.ai and saves it to Microsoft To Do for follow-up tasks.\nSave Images to OneDrive:\n\nImages are uploaded to OneDrive, renamed based on their unique message ID, and linked in Microsoft Teams for reference.\n\n**Send Feedback via LINE:**\nThe workflow replies to the user with confirmation messages, such as \"[ Task Created ]\" or \"[ Message Saved ].\"\n\n## Setup Guide\n**Pre-Requisites**\n- Access to the LINE Developers Console to configure your webhook and bot.\n- Accounts for Microsoft Teams , Microsoft To Do, and OneDrive with API access.\n- An OpenRouter.ai account with credentials to access models like GPT-4o.\n- Basic knowledge of APIs, webhooks, and JSON formatting.\n\n**Step-by-Step Setup**\n1) Configure the LINE Webhook:\n- Go to the LINE Developers Console and set up a webhook to receive incoming messages.\n- Copy the Webhook URL from the Line Webhook node and paste it into the LINE Console.\n- Remove any \"test\" configurations when moving to production.\n2) Set Up Microsoft Integrations:\n- Connect your Microsoft Teams, Microsoft To Do, and OneDrive accounts to the respective nodes in the workflow.\n3) Set Up OpenRouter.ai:\n- Create an account on OpenRouter.ai and obtain your API credentials.\n- Connect your credentials to the OpenRouter nodes in the workflow.\n\n**Test the Workflow:**\n- Simulate sending text, images, and namecards to the LINE bot to verify that all actions are processed correctly.\n\n## How to Customize This Workflow to Your Needs\n- Add More Actions: Extend the workflow to handle additional input types or integrate with other tools.\n- Enhance Image Processing: Use advanced OCR tools to improve text extraction from complex images.\n- Customize Feedback Messages: Modify the reply format to include emojis, links, or other formatting options.\n- Expand Use Cases: Adapt the workflow for specific industries, such as sales or customer support, by tailoring the actions to relevant tasks.\n\n**Why Use This Template?**\n- Versatile Automation: Handles multiple input types (text, images, namecards) with ease.\n- Seamless Integration: Connects LINE messages to popular productivity tools like Microsoft Teams and To Do.\n- Structured Data Extraction: Extracts and organizes data from namecards, saving time and effort.\n- Real-Time Feedback: Keeps users informed about the status of their requests with instant notifications.\n",
  "featuredImage": "/data/workflows/3413/3413.webp",
  "author": {
    "id": 101,
    "slug": "linlinmhee",
    "name": "lin@davoy.tech",
    "avatar": ""
  },
  "categories": [
    "Personal Productivity",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2307,
  "downloads": 230,
  "createdAt": "2025-04-03T07:20:26.138Z",
  "updatedAt": "2026-01-16T08:29:41.036Z",
  "publishedAt": "2025-04-03T07:20:26.138Z",
  "nodes": 45,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3413",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "LINE messages with GPT: Save notes, namecard data and tasks",
    "workflowName": "LINE messages with GPT: Save notes, namecard data and tasks",
    "description": "This workflow template, \"Personal Assistant to Note Messages and Extract Namecard Information\" is designed to streamline the processing of incoming messages on the LINE messaging platform. It integrates with powerful tools like Microsoft Teams , Microsoft To Do , OneDrive , and OpenRouter.ai to handle tasks such as saving notes, extracting namecard information, and organizing images. Whether you’re managing personal productivity or automating workflows for teams, this template offers a versatile and customizable solution.\n\nBy leveraging this workflow, you can automate repetitive tasks, improve collaboration, and enhance efficiency in handling LINE messages.\n\n## Who Is This Template For?\nThis template is ideal for:\n\n- Professionals: Who want to save important messages, extract data from namecards, or organize images automatically.\n- Teams: Looking to integrate LINE messages into tools like Microsoft Teams and Microsoft To Do for better collaboration.\n- Developers: Seeking to build intelligent workflows that process text, images, and other inputs from LINE.\n- Business Owners: Who need to manage customer interactions, follow-ups, and task tracking efficiently.\n\n## What Problem Does This Workflow Solve?\nManaging incoming messages on LINE can be time-consuming, especially when dealing with diverse input types like text, images, and namecards. This workflow solves that problem by:\n- Automatically identifying and routing different message types (text, images, namecards) to appropriate actions.\n- Extracting structured data from namecards and saving it for follow-up tasks.\n- Uploading images to OneDrive and saving text messages to Microsoft Teams or Microsoft To Do for easy access.\n- Sending real-time feedback to users via LINE to confirm that their messages have been processed.\n\n## What This Workflow Does\n- Receive Messages via LINE Webhook:\nThe workflow is triggered whenever a user sends a message (text, image, or other types) to the LINE bot.\n- Display Loading Animation:\nA loading animation is displayed to reassure the user that their request is being processed.\nRoute Input Types:\n\nThe workflow uses a Switch node to determine the type of input:\n- Text Starting with \"T\": Adds the message as a task in Microsoft To Do.\n- Plain Text: Saves the message in Microsoft Teams under a designated channel (e.g., \"Notes\").\n- Images: Identifies whether the image is a namecard, handwritten note, or other content, then processes accordingly.\n- Unsupported formats trigger a polite response indicating the limitation.\nProcess Namecards:\n\n**Images **\nIf the image is identified as a namecard, the workflow extracts structured data (e.g., name, email, phone number) using OpenRouter.ai and saves it to Microsoft To Do for follow-up tasks.\nSave Images to OneDrive:\n\nImages are uploaded to OneDrive, renamed based on their unique message ID, and linked in Microsoft Teams for reference.\n\n**Send Feedback via LINE:**\nThe workflow replies to the user with confirmation messages, such as \"[ Task Created ]\" or \"[ Message Saved ].\"\n\n## Setup Guide\n**Pre-Requisites**\n- Access to the LINE Developers Console to configure your webhook and bot.\n- Accounts for Microsoft Teams , Microsoft To Do, and OneDrive with API access.\n- An OpenRouter.ai account with credentials to access models like GPT-4o.\n- Basic knowledge of APIs, webhooks, and JSON formatting.\n\n**Step-by-Step Setup**\n1) Configure the LINE Webhook:\n- Go to the LINE Developers Console and set up a webhook to receive incoming messages.\n- Copy the Webhook URL from the Line Webhook node and paste it into the LINE Console.\n- Remove any \"test\" configurations when moving to production.\n2) Set Up Microsoft Integrations:\n- Connect your Microsoft Teams, Microsoft To Do, and OneDrive accounts to the respective nodes in the workflow.\n3) Set Up OpenRouter.ai:\n- Create an account on OpenRouter.ai and obtain your API credentials.\n- Connect your credentials to the OpenRouter nodes in the workflow.\n\n**Test the Workflow:**\n- Simulate sending text, images, and namecards to the LINE bot to verify that all actions are processed correctly.\n\n## How to Customize This Workflow to Your Needs\n- Add More Actions: Extend the workflow to handle additional input types or integrate with other tools.\n- Enhance Image Processing: Use advanced OCR tools to improve text extraction from complex images.\n- Customize Feedback Messages: Modify the reply format to include emojis, links, or other formatting options.\n- Expand Use Cases: Adapt the workflow for specific industries, such as sales or customer support, by tailoring the actions to relevant tasks.\n\n**Why Use This Template?**\n- Versatile Automation: Handles multiple input types (text, images, namecards) with ease.\n- Seamless Integration: Connects LINE messages to popular productivity tools like Microsoft Teams and To Do.\n- Structured Data Extraction: Extracts and organizes data from namecards, saving time and effort.\n- Real-Time Feedback: Keeps users informed about the status of their requests with instant notifications.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Line Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Line Loading Animation",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Image",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Line Reply (image)",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Line Reply (Text)",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Line Reply (Not Supported 2)",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Line Reply (Not Supported 1)",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "OpenRouter Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "Image Router",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Microsoft Teams",
      "type": "n8n-nodes-base.microsoftTeams",
      "role": "microsoftTeams",
      "configDescription": "Version 2"
    },
    {
      "name": "Microsoft To Do",
      "type": "n8n-nodes-base.microsoftToDo",
      "role": "microsoftToDo",
      "configDescription": "Version 1"
    },
    {
      "name": "Line Reply (Text)1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "If namecard",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Other Images",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Microsoft Teams1",
      "type": "n8n-nodes-base.microsoftTeams",
      "role": "microsoftTeams",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenRouter Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "Microsoft OneDrive",
      "type": "n8n-nodes-base.microsoftOneDrive",
      "role": "microsoftOneDrive",
      "configDescription": "Version 1"
    },
    {
      "name": "Microsoft OneDrive1",
      "type": "n8n-nodes-base.microsoftOneDrive",
      "role": "microsoftOneDrive",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Image2",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Microsoft To Do1",
      "type": "n8n-nodes-base.microsoftToDo",
      "role": "microsoftToDo",
      "configDescription": "Version 1"
    },
    {
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "OpenRouter Chat Model3",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "NamecardExtract",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Line Reply Namecard",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Image3",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}