{
  "id": 12646,
  "slug": "12646",
  "title": "Track monthly OpenAI token usage with Google Sheets and Gmail reports",
  "description": "**Who's this for**\nFinance teams, AI developers, product managers, and business owners who need to monitor and control OpenAI API costs across different models and projects. If you're using GPT-4, GPT-3.5, or other OpenAI models and want to track spending patterns, identify cost optimization opportunities, and generate stakeholder reports, this workflow is for you.\n\n**What it does**\nThis workflow automatically tracks your OpenAI token usage on a monthly basis, breaks down costs by model and date, stores the data in Google Sheets with automatic cost calculations, and emails PDF reports to stakeholders. It transforms raw API usage data into actionable insights, helping you understand which models are driving costs, identify usage trends over time, and maintain budget accountability. The workflow runs completely hands-free once configured, generating comprehensive monthly reports without manual intervention.\n\n**How it works**\nThe workflow executes automatically on the 5th of each month and follows these steps:\n\nCreates a new Google Sheet from your template with the naming format \"Token_Tracking_[Month]_[Year]\"\nFetches the previous month's OpenAI usage data via the OpenAI Admin API\nTransforms raw API responses into a clean daily breakdown showing usage by model\nAppends the data to Google Sheets with columns for date, model, input tokens, and output tokens\nYour Google Sheets formulas automatically calculate costs based on OpenAI's pricing for each model\nExports the completed report as both PDF and Excel formats\nEmails the PDF report to designated stakeholders with a summary message\nArchives the Excel file to Google Drive for long-term recordkeeping and historical analysis\n\n**Requirements**\n\nOpenAI account with Admin API access (required to access organization usage endpoints)\nGoogle Sheets template pre-configured with cost calculation formulas\nGoogle Drive for report storage and archiving\nGmail account for sending email notifications\nn8n instance (self-hosted or cloud) with the following credentials configured:\n\nOpenAI API credentials\nGoogle Sheets OAuth2\nGoogle Drive OAuth2\nGmail OAuth2\n\n\n\n**Setup instructions**\n1. Create your Google Sheets template\nSet up a Google Sheet with these columns:\n\n- Date\n- Model\n- Token Usage In\n- Token Usage Out\n- Token Cost Input (formula: =C2 * [price per 1M input tokens] / 1000000)\n- Token Cost Output (formula: =D2 * [price per 1M output tokens] / 1000000)\n- Total Cost USD (formula: =E2 + F2)\n- Total Cost AUD (optional, formula: =G2 * [exchange rate]) (workflow contains a template)\n\nInclude pricing formulas based on OpenAI's current pricing. Add summary calculations at the bottom to total costs by model.\n\n**2. Configure n8n credentials**\nIn your n8n instance, set up credentials for:\n\nOpenAI API (you'll need admin access to your organization)\nGoogle Sheets (OAuth2 connection)\nGoogle Drive (OAuth2 connection)\nGmail (OAuth2 connection)\n\n**3. Update workflow placeholders**\nReplace the following placeholders in the workflow:\n\nyour-api-key-id: Your OpenAI API key ID (find this in your OpenAI dashboard)\nyour-template-file-id: The ID of your Google Sheets template\nyour-archive-folder-id: The Google Drive folder ID where reports should be archived\nyour-email@example.com: The email address that should receive monthly reports\n\n**4. Assign credentials to nodes**\nOpen each node that requires credentials and select the appropriate credential from your configured options:\n\n\"Fetch OpenAI Usage Data\" → OpenAI API credential\n\"Append Data to Google Sheet\" → Google Sheets credential\n\"Create Monthly Report from Template\" → Google Drive credential\n\"Export Sheet as Excel\" → Google Drive credential\n\"Export Sheet as PDF for Email\" → Google Drive credential\n\"Archive Report to Drive\" → Google Drive credential\n\"Email Report to Stakeholder\" → Gmail credential\n\n**5. Test the workflow**\nBefore enabling the schedule, manually execute the workflow to ensure:\n\nThe template copies successfully\nOpenAI data fetches correctly\nData appends to the sheet properly\nPDF and Excel exports work\nEmail sends successfully\nFile archives to the correct folder\n\n**6. Enable the schedule**\nOnce testing is complete, activate the workflow. It will run automatically on the 5th of each month.",
  "featuredImage": "/data/workflows/12646/12646.webp",
  "author": {
    "id": 101,
    "slug": "therealpjc014",
    "name": "Patrick Campbell ",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 0,
  "downloads": 0,
  "createdAt": "2026-01-12T00:55:42.760Z",
  "updatedAt": "2026-01-16T09:12:49.242Z",
  "publishedAt": "2026-01-12T00:55:42.760Z",
  "nodes": 13,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/12646",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Track monthly OpenAI token usage with Google Sheets and Gmail reports",
    "workflowName": "Track monthly OpenAI token usage with Google Sheets and Gmail reports",
    "description": "**Who's this for**\nFinance teams, AI developers, product managers, and business owners who need to monitor and control OpenAI API costs across different models and projects. If you're using GPT-4, GPT-3.5, or other OpenAI models and want to track spending patterns, identify cost optimization opportunities, and generate stakeholder reports, this workflow is for you.\n\n**What it does**\nThis workflow automatically tracks your OpenAI token usage on a monthly basis, breaks down costs by model and date, stores the data in Google Sheets with automatic cost calculations, and emails PDF reports to stakeholders. It transforms raw API usage data into actionable insights, helping you understand which models are driving costs, identify usage trends over time, and maintain budget accountability. The workflow runs completely hands-free once configured, generating comprehensive monthly reports without manual intervention.\n\n**How it works**\nThe workflow executes automatically on the 5th of each month and follows these steps:\n\nCreates a new Google Sheet from your template with the naming format \"Token_Tracking_[Month]_[Year]\"\nFetches the previous month's OpenAI usage data via the OpenAI Admin API\nTransforms raw API responses into a clean daily breakdown showing usage by model\nAppends the data to Google Sheets with columns for date, model, input tokens, and output tokens\nYour Google Sheets formulas automatically calculate costs based on OpenAI's pricing for each model\nExports the completed report as both PDF and Excel formats\nEmails the PDF report to designated stakeholders with a summary message\nArchives the Excel file to Google Drive for long-term recordkeeping and historical analysis\n\n**Requirements**\n\nOpenAI account with Admin API access (required to access organization usage endpoints)\nGoogle Sheets template pre-configured with cost calculation formulas\nGoogle Drive for report storage and archiving\nGmail account for sending email notifications\nn8n instance (self-hosted or cloud) with the following credentials configured:\n\nOpenAI API credentials\nGoogle Sheets OAuth2\nGoogle Drive OAuth2\nGmail OAuth2\n\n\n\n**Setup instructions**\n1. Create your Google Sheets template\nSet up a Google Sheet with these columns:\n\n- Date\n- Model\n- Token Usage In\n- Token Usage Out\n- Token Cost Input (formula: =C2 * [price per 1M input tokens] / 1000000)\n- Token Cost Output (formula: =D2 * [price per 1M output tokens] / 1000000)\n- Total Cost USD (formula: =E2 + F2)\n- Total Cost AUD (optional, formula: =G2 * [exchange rate]) (workflow contains a template)\n\nInclude pricing formulas based on OpenAI's current pricing. Add summary calculations at the bottom to total costs by model.\n\n**2. Configure n8n credentials**\nIn your n8n instance, set up credentials for:\n\nOpenAI API (you'll need admin access to your organization)\nGoogle Sheets (OAuth2 connection)\nGoogle Drive (OAuth2 connection)\nGmail (OAuth2 connection)\n\n**3. Update workflow placeholders**\nReplace the following placeholders in the workflow:\n\nyour-api-key-id: Your OpenAI API key ID (find this in your OpenAI dashboard)\nyour-template-file-id: The ID of your Google Sheets template\nyour-archive-folder-id: The Google Drive folder ID where reports should be archived\nyour-email@example.com: The email address that should receive monthly reports\n\n**4. Assign credentials to nodes**\nOpen each node that requires credentials and select the appropriate credential from your configured options:\n\n\"Fetch OpenAI Usage Data\" → OpenAI API credential\n\"Append Data to Google Sheet\" → Google Sheets credential\n\"Create Monthly Report from Template\" → Google Drive credential\n\"Export Sheet as Excel\" → Google Drive credential\n\"Export Sheet as PDF for Email\" → Google Drive credential\n\"Archive Report to Drive\" → Google Drive credential\n\"Email Report to Stakeholder\" → Gmail credential\n\n**5. Test the workflow**\nBefore enabling the schedule, manually execute the workflow to ensure:\n\nThe template copies successfully\nOpenAI data fetches correctly\nData appends to the sheet properly\nPDF and Excel exports work\nEmail sends successfully\nFile archives to the correct folder\n\n**6. Enable the schedule**\nOnce testing is complete, activate the workflow. It will run automatically on the 5th of each month.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Fetch OpenAI Usage Data",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Transform Usage to Daily Breakdown",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Append Data to Google Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Create Monthly Report from Template",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Export Sheet as Excel",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Archive Report to Drive",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Email Report to Stakeholder",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Export Sheet as PDF for Email",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Workflow Overview",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Monthly Report Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}