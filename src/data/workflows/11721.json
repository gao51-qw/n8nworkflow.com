{
  "id": 11721,
  "slug": "11721",
  "title": "Poll multiple Gmail accounts with unified data table storage & Discord notifications",
  "description": "![Screenshot 20251216 001014.png](fileId:3669)\n\nThis template lets you poll multiple Gmail accounts from a single workflow using n8n’s credential-aware execution. Instead of creating separate workflows for every inbox, this setup loops through all accounts stored in your data table and runs Gmail operations dynamically using the correct OAuth2 credential.\n\nIt’s built for cases like *cold-email systems, multi-client mail monitoring*, or anything that needs centralized polling and logging.\n\n## ### What It Does\n\n1. Pulls all email account records from the cold_email_accounts table.\n\n2. For every account, the workflow:\n\n3. Runs the Gmail “Get Many Messages” node for that account using \"Run Node With Credentials X\" community node.\n\n\n4. Messages are reformatted into a clean JSON object (from, subject, preview text, body, labels, attachments, etc.).\n\n5. Saved into the All Emails table using an upsert (avoids duplicates).\n\n6. Sends a Discord notification like “15 new emails arrived”.\n\n## ### How to Set It Up\n\n1. Create Gmail OAuth2 credentials in n8n, one for each email account you want to poll.\n\n2. Add those credentials into a Data Table named cold_email_accounts with columns:\ncred_id\ncredentials_name\nemail\nlast_polled (datetime)\n\n3. Import this workflow template into n8n.\n\n4. Update:\nDataTable references (if your names/IDs differ)\nDiscord channel/server IDs\nAny domain filters inside the Gmail search query\n\n5. Activate the workflow and it will automatically:\nPoll each Gmail inbox every hour\nSave all new emails\nNotify you on Discord\nKeep everything synced via last_polled.",
  "featuredImage": "/data/workflows/11721/11721.webp",
  "author": {
    "id": 101,
    "slug": "jatinkhatri",
    "name": "Jatin Khatri",
    "avatar": ""
  },
  "categories": [
    "Ticket Management"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 24,
  "downloads": 2,
  "createdAt": "2025-12-11T20:49:36.783Z",
  "updatedAt": "2026-01-16T09:09:51.407Z",
  "publishedAt": "2025-12-11T20:49:36.783Z",
  "nodes": 21,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11721",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Poll multiple Gmail accounts with unified data table storage & Discord notifications",
    "workflowName": "Poll multiple Gmail accounts with unified data table storage & Discord notifications",
    "description": "![Screenshot 20251216 001014.png](fileId:3669)\n\nThis template lets you poll multiple Gmail accounts from a single workflow using n8n’s credential-aware execution. Instead of creating separate workflows for every inbox, this setup loops through all accounts stored in your data table and runs Gmail operations dynamically using the correct OAuth2 credential.\n\nIt’s built for cases like *cold-email systems, multi-client mail monitoring*, or anything that needs centralized polling and logging.\n\n## ### What It Does\n\n1. Pulls all email account records from the cold_email_accounts table.\n\n2. For every account, the workflow:\n\n3. Runs the Gmail “Get Many Messages” node for that account using \"Run Node With Credentials X\" community node.\n\n\n4. Messages are reformatted into a clean JSON object (from, subject, preview text, body, labels, attachments, etc.).\n\n5. Saved into the All Emails table using an upsert (avoids duplicates).\n\n6. Sends a Discord notification like “15 new emails arrived”.\n\n## ### How to Set It Up\n\n1. Create Gmail OAuth2 credentials in n8n, one for each email account you want to poll.\n\n2. Add those credentials into a Data Table named cold_email_accounts with columns:\ncred_id\ncredentials_name\nemail\nlast_polled (datetime)\n\n3. Import this workflow template into n8n.\n\n4. Update:\nDataTable references (if your names/IDs differ)\nDiscord channel/server IDs\nAny domain filters inside the Gmail search query\n\n5. Activate the workflow and it will automatically:\nPoll each Gmail inbox every hour\nSave all new emails\nNotify you on Discord\nKeep everything synced via last_polled.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Run Node With Credentials X",
      "type": "n8n-nodes-run-node-with-credentials-x.runNodeWithCredentialsX",
      "role": "runNodeWithCredentialsX",
      "configDescription": "Version 1"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "upsert emails",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Update last_polled",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Update last_polled1",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.discord",
      "role": "discord",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Limit",
      "type": "n8n-nodes-base.limit",
      "role": "limit",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get All Email Accounts",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Email Normalization",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get new emails if any",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "If new email found",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "If new email found1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    }
  ]
}