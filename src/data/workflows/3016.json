{
  "id": 3016,
  "slug": "3016",
  "title": "Invoices from Gmail to Drive and Google Sheets",
  "description": "# Attachments Gmail to Drive and Google Sheets\n\n## Description\nAutomatically process invoice emails by saving attachments to Google Drive and extracting key invoice data to Google Sheets using AI. This workflow monitors your Gmail for unread emails with attachments, saves PDFs to a specified Google Drive folder, and uses OpenAI's GPT-4o to extract invoice details (date, description, amount) into a structured spreadsheet.\n\n## Use cases\n- **Invoice Management**: Automatically organize and track invoices received via email\n- **Financial Record Keeping**: Maintain a structured database of all invoice information\n- **Document Organization**: Keep digital copies of invoices organized in Google Drive\n- **Automated Data Entry**: Eliminate manual data entry for invoice processing\n\n## Resources\n- Gmail account\n- Google Drive account\n- Google Sheets account\n- OpenAI API key\n\n## Setup instructions\n\n### Prerequisites\n1. Active Gmail, Google Drive, and Google Sheets accounts\n2. OpenAI API key (GPT-4o model access)\n3. n8n instance with credentials manager\n\n### Steps\n1. **Gmail and Google Drive Setup**:\n   - Connect your Gmail account in n8n credentials\n   - Connect your Google Drive account with appropriate permissions\n   - Create a destination folder in Google Drive for invoice storage\n\n2. **Google Sheets Setup**:\n   - Connect your Google Sheets account\n   - Create a spreadsheet with columns: Invoice date, Invoice Description, Total price, and Fichero\n   - Copy your spreadsheet ID for configuration\n\n3. **OpenAI Setup**:\n   - Add your OpenAI API key to n8n credentials\n\n4. **Configure Email Filter**:\n   - Update the email filter node to match your specific sender requirements\n\n## Benefits\n- **Time Saving**: Eliminates manual downloading, filing, and data entry\n- **Accuracy**: AI-powered data extraction reduces human error\n- **Organization**: Consistent file naming and storage structure\n- **Searchability**: Creates a searchable database of all invoice information\n- **Automation**: Runs every minute to process new emails as they arrive\n\n## Related templates\n- Email Parser to CRM\n- Document Processing Workflow\n- Financial Data Automation",
  "featuredImage": "/data/workflows/3016/3016.webp",
  "author": {
    "id": 101,
    "slug": "carlosgracia",
    "name": "Juan Carlos Cavero Gracia",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 36175,
  "downloads": 3617,
  "createdAt": "2025-02-25T21:34:30.197Z",
  "updatedAt": "2026-01-16T08:27:39.947Z",
  "publishedAt": "2025-02-25T21:34:30.197Z",
  "nodes": 17,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3016",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Invoices from Gmail to Drive and Google Sheets",
    "workflowName": "Invoices from Gmail to Drive and Google Sheets",
    "description": "# Attachments Gmail to Drive and Google Sheets\n\n## Description\nAutomatically process invoice emails by saving attachments to Google Drive and extracting key invoice data to Google Sheets using AI. This workflow monitors your Gmail for unread emails with attachments, saves PDFs to a specified Google Drive folder, and uses OpenAI's GPT-4o to extract invoice details (date, description, amount) into a structured spreadsheet.\n\n## Use cases\n- **Invoice Management**: Automatically organize and track invoices received via email\n- **Financial Record Keeping**: Maintain a structured database of all invoice information\n- **Document Organization**: Keep digital copies of invoices organized in Google Drive\n- **Automated Data Entry**: Eliminate manual data entry for invoice processing\n\n## Resources\n- Gmail account\n- Google Drive account\n- Google Sheets account\n- OpenAI API key\n\n## Setup instructions\n\n### Prerequisites\n1. Active Gmail, Google Drive, and Google Sheets accounts\n2. OpenAI API key (GPT-4o model access)\n3. n8n instance with credentials manager\n\n### Steps\n1. **Gmail and Google Drive Setup**:\n   - Connect your Gmail account in n8n credentials\n   - Connect your Google Drive account with appropriate permissions\n   - Create a destination folder in Google Drive for invoice storage\n\n2. **Google Sheets Setup**:\n   - Connect your Google Sheets account\n   - Create a spreadsheet with columns: Invoice date, Invoice Description, Total price, and Fichero\n   - Copy your spreadsheet ID for configuration\n\n3. **OpenAI Setup**:\n   - Add your OpenAI API key to n8n credentials\n\n4. **Configure Email Filter**:\n   - Update the email filter node to match your specific sender requirements\n\n## Benefits\n- **Time Saving**: Eliminates manual downloading, filing, and data entry\n- **Accuracy**: AI-powered data extraction reduces human error\n- **Organization**: Consistent file naming and storage structure\n- **Searchability**: Creates a searchable database of all invoice information\n- **Automation**: Runs every minute to process new emails as they arrive\n\n## Related templates\n- Email Parser to CRM\n- Document Processing Workflow\n- Financial Data Automation",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Gmail Trigger1",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Setup1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Upload PDF to Drive1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Rename file1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Move to the correct folder1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Gmail",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Extract from File2",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "OpenAI Model",
      "type": "@n8n/n8n-nodes-langchain.lmOpenAi",
      "role": "lmOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Append to Reconciliation Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Map Output",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.3"
    },
    {
      "name": "Apply Data Extraction Rules",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.4"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Only invoice mails with attachments",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.1"
    }
  ]
}