{
  "id": 7861,
  "slug": "7861",
  "title": "Generate marketing reports from Google Sheets with GPT-4 insights and PDF.co",
  "description": "This workflow pulls **marketing data from Google Sheets**, aggregates spend by channel, generates an **AI-written summary**, and outputs a formatted **PDF report** using a custom HTML template on **PDF.co**.  \n\n---\n\n## ‚öôÔ∏è Setup Instructions\n\n### 1Ô∏è‚É£ Prepare Your Google Sheet  \n- Copy this template into your Google Drive: [Sample Marketing Data](https://docs.google.com/spreadsheets/d/1UDWt0-Z9fHqwnSNfU3vvhSoYCFG6EG3E-ZewJC_CLq4/edit?gid=365710158#gid=365710158)  \n- Add or update your marketing spend data in rows 2‚Äì100.  \n\n#### Connect Google Sheets in n8n  \n1. Go to **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Sheets (OAuth2)**  \n2. Log in with your Google account and grant access  \n3. Select the **Spreadsheet ID** and **Worksheet** in the workflow  \n\n---\n\n### 2Ô∏è‚É£ Set Up PDF.co for PDF Reports  \n1. Create a free account at [PDF.co](https://pdf.co/)  \n2. In **PDF.co Dashboard ‚Üí HTML to PDF Templates**, create a new **Mustache template**  \n   - Paste the HTML provided at the bottom of this description  \n   - Save, and note your **Template ID**  \n3. In **n8n ‚Üí Credentials ‚Üí New ‚Üí PDF.co API**, paste your **API Key** and save  \n4. In the workflow, select your **PDF.co credential** in the `Create PDF` node  \n5. Replace the `templateId` with your Template ID  \n\n---\n\n## üß† How It Works  \n- **Google Sheets Node**: Pulls marketing spend data  \n- **Summarize Nodes**: Aggregate total spend and spend per channel  \n- **OpenAI Node**: Writes a daily summary of marketing performance  \n- **Code Node**: Converts aggregated data into the correct shape for the PDF template  \n- **PDF.co Node**: Generates a final, formatted **PDF report**  \n\n---\n\n## üì¨ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your PDF)?  \n\n- üìß **robert@ynteractive.com**  \n- üîó **[Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)**  \n- üåê **[ynteractive.com](https://ynteractive.com)**  \n\n---\n\n## üìÑ HTML Template (for PDF.co)  \n\n&gt; Paste this into a new **HTML Template** on [PDF.co](https://pdf.co/) and reference its Template ID in your workflow.\n\n```html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\" /&gt;\n  &lt;title&gt;Invoice {{invoiceNumber}}&lt;/title&gt;\n  &lt;style&gt;\n    body { font-family: Arial, Helvetica, sans-serif; margin: 36px; color: #222; }\n    .header { display: flex; justify-content: space-between; align-items: center; }\n    .brand { max-height: 56px; }\n    h1 { margin: 12px 0 4px; font-size: 22px; }\n    .meta { font-size: 12px; color: #555; }\n    .two-col { display: flex; gap: 24px; margin-top: 16px; }\n    .box { flex: 1; border: 1px solid #ddd; padding: 12px; border-radius: 6px; }\n    .label { font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: .02em; }\n    table { width: 100%; border-collapse: collapse; margin-top: 16px; }\n    th, td { border-bottom: 1px solid #eee; padding: 10px 8px; font-size: 13px; }\n    th { background: #fafafa; text-align: left; }\n    tfoot td { border-top: 2px solid #ddd; font-size: 13px; }\n    .right { text-align: right; }\n    .totals td { padding: 6px 8px; }\n    .grand { font-weight: 700; font-size: 14px; }\n    .notes { margin-top: 18px; font-size: 12px; color: #444; }\n  &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  <div>\n    <div>\n      <h1>Invoice {{invoiceNumber}}</h1>\n      <div>Date: {{invoiceDate}} &nbsp; | &nbsp; Due: {{dueDate}}</div>\n    </div>\n    {{#company.logoUrl}}\n    <img src alt=\"Logo\" />\n    {{/company.logoUrl}}\n  </div>\n\n  <div>\n    <div>\n      <div>From</div>\n      <div><strong>{{company.name}}</strong></div>\n      <div>{{company.address}}</div>\n      <div>{{company.phone}}</div>\n      <div>{{company.email}}</div>\n    </div>\n    <div>\n      <div>Bill To</div>\n      <div><strong>{{billTo.name}}</strong></div>\n      <div>{{billTo.address}}</div>\n      <div>{{billTo.email}}</div>\n    </div>\n  </div>\n\n  <table>\n    <thead>\n      <tr>\n        <th>#</th>\n        <th>Description</th>\n        <th>Qty</th>\n        <th>Unit Price</th>\n        <th>Line Total</th>\n      </tr>\n    </thead>\n    <tbody>\n      {{#items}}\n      <tr>\n        <td>{{line}}</td>\n        <td>{{description}}</td>\n        <td>{{qty}}</td>\n        <td>{{unitPriceFmt}}</td>\n        <td>{{lineTotalFmt}}</td>\n      </tr>\n      {{/items}}\n    </tbody>\n    <tfoot>\n      <tr>\n        <td colspan=\"4\">Subtotal</td>\n        <td>{{subTotalFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Tax ({{taxRatePct}})</td>\n        <td>{{taxAmountFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Discount</td>\n        <td>-{{discountFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Total</td>\n        <td>{{totalFmt}}</td>\n      </tr>\n    </tfoot>\n  </table>\n\n  <div>\n    <strong>Notes:</strong> {{notes}}<br />\n    <strong>Terms:</strong> {{terms}}\n  </div>\n&lt;/body&gt;\n&lt;/html&gt;\n",
  "featuredImage": "/data/workflows/7861/7861.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 317,
  "downloads": 31,
  "createdAt": "2025-08-26T01:11:07.627Z",
  "updatedAt": "2026-01-16T08:52:47.811Z",
  "publishedAt": "2025-08-26T01:11:07.627Z",
  "nodes": 15,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7861",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Generate marketing reports from Google Sheets with GPT-4 insights and PDF.co",
    "workflowName": "Generate marketing reports from Google Sheets with GPT-4 insights and PDF.co",
    "description": "This workflow pulls **marketing data from Google Sheets**, aggregates spend by channel, generates an **AI-written summary**, and outputs a formatted **PDF report** using a custom HTML template on **PDF.co**.  \n\n---\n\n## ‚öôÔ∏è Setup Instructions\n\n### 1Ô∏è‚É£ Prepare Your Google Sheet  \n- Copy this template into your Google Drive: [Sample Marketing Data](https://docs.google.com/spreadsheets/d/1UDWt0-Z9fHqwnSNfU3vvhSoYCFG6EG3E-ZewJC_CLq4/edit?gid=365710158#gid=365710158)  \n- Add or update your marketing spend data in rows 2‚Äì100.  \n\n#### Connect Google Sheets in n8n  \n1. Go to **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Sheets (OAuth2)**  \n2. Log in with your Google account and grant access  \n3. Select the **Spreadsheet ID** and **Worksheet** in the workflow  \n\n---\n\n### 2Ô∏è‚É£ Set Up PDF.co for PDF Reports  \n1. Create a free account at [PDF.co](https://pdf.co/)  \n2. In **PDF.co Dashboard ‚Üí HTML to PDF Templates**, create a new **Mustache template**  \n   - Paste the HTML provided at the bottom of this description  \n   - Save, and note your **Template ID**  \n3. In **n8n ‚Üí Credentials ‚Üí New ‚Üí PDF.co API**, paste your **API Key** and save  \n4. In the workflow, select your **PDF.co credential** in the `Create PDF` node  \n5. Replace the `templateId` with your Template ID  \n\n---\n\n## üß† How It Works  \n- **Google Sheets Node**: Pulls marketing spend data  \n- **Summarize Nodes**: Aggregate total spend and spend per channel  \n- **OpenAI Node**: Writes a daily summary of marketing performance  \n- **Code Node**: Converts aggregated data into the correct shape for the PDF template  \n- **PDF.co Node**: Generates a final, formatted **PDF report**  \n\n---\n\n## üì¨ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your PDF)?  \n\n- üìß **robert@ynteractive.com**  \n- üîó **[Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)**  \n- üåê **[ynteractive.com](https://ynteractive.com)**  \n\n---\n\n## üìÑ HTML Template (for PDF.co)  \n\n&gt; Paste this into a new **HTML Template** on [PDF.co](https://pdf.co/) and reference its Template ID in your workflow.\n\n```html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\" /&gt;\n  &lt;title&gt;Invoice {{invoiceNumber}}&lt;/title&gt;\n  &lt;style&gt;\n    body { font-family: Arial, Helvetica, sans-serif; margin: 36px; color: #222; }\n    .header { display: flex; justify-content: space-between; align-items: center; }\n    .brand { max-height: 56px; }\n    h1 { margin: 12px 0 4px; font-size: 22px; }\n    .meta { font-size: 12px; color: #555; }\n    .two-col { display: flex; gap: 24px; margin-top: 16px; }\n    .box { flex: 1; border: 1px solid #ddd; padding: 12px; border-radius: 6px; }\n    .label { font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: .02em; }\n    table { width: 100%; border-collapse: collapse; margin-top: 16px; }\n    th, td { border-bottom: 1px solid #eee; padding: 10px 8px; font-size: 13px; }\n    th { background: #fafafa; text-align: left; }\n    tfoot td { border-top: 2px solid #ddd; font-size: 13px; }\n    .right { text-align: right; }\n    .totals td { padding: 6px 8px; }\n    .grand { font-weight: 700; font-size: 14px; }\n    .notes { margin-top: 18px; font-size: 12px; color: #444; }\n  &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  <div>\n    <div>\n      <h1>Invoice {{invoiceNumber}}</h1>\n      <div>Date: {{invoiceDate}} &nbsp; | &nbsp; Due: {{dueDate}}</div>\n    </div>\n    {{#company.logoUrl}}\n    <img src alt=\"Logo\" />\n    {{/company.logoUrl}}\n  </div>\n\n  <div>\n    <div>\n      <div>From</div>\n      <div><strong>{{company.name}}</strong></div>\n      <div>{{company.address}}</div>\n      <div>{{company.phone}}</div>\n      <div>{{company.email}}</div>\n    </div>\n    <div>\n      <div>Bill To</div>\n      <div><strong>{{billTo.name}}</strong></div>\n      <div>{{billTo.address}}</div>\n      <div>{{billTo.email}}</div>\n    </div>\n  </div>\n\n  <table>\n    <thead>\n      <tr>\n        <th>#</th>\n        <th>Description</th>\n        <th>Qty</th>\n        <th>Unit Price</th>\n        <th>Line Total</th>\n      </tr>\n    </thead>\n    <tbody>\n      {{#items}}\n      <tr>\n        <td>{{line}}</td>\n        <td>{{description}}</td>\n        <td>{{qty}}</td>\n        <td>{{unitPriceFmt}}</td>\n        <td>{{lineTotalFmt}}</td>\n      </tr>\n      {{/items}}\n    </tbody>\n    <tfoot>\n      <tr>\n        <td colspan=\"4\">Subtotal</td>\n        <td>{{subTotalFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Tax ({{taxRatePct}})</td>\n        <td>{{taxAmountFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Discount</td>\n        <td>-{{discountFmt}}</td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">Total</td>\n        <td>{{totalFmt}}</td>\n      </tr>\n    </tfoot>\n  </table>\n\n  <div>\n    <strong>Notes:</strong> {{notes}}<br />\n    <strong>Terms:</strong> {{terms}}\n  </div>\n&lt;/body&gt;\n&lt;/html&gt;",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòExecute workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Sticky Note53",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Marketing Data",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Sum Spend by Channel",
      "type": "n8n-nodes-base.summarize",
      "role": "summarize",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sum Spend",
      "type": "n8n-nodes-base.summarize",
      "role": "summarize",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Write Summary",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Combine All",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Convert to PDF Upload",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create PDF",
      "type": "n8n-nodes-pdfco.PDFco Api",
      "role": "PDFco Api",
      "configDescription": "Version 1"
    },
    {
      "name": "Covert to 1 row",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note59",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note60",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}