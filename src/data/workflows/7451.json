{
  "id": 7451,
  "slug": "7451",
  "title": "Natural language to SQL converter for Google Sheets with GPT-4o",
  "description": "This n8n workflow template creates an intelligent data analysis system that converts natural language questions into Google Sheets SQL queries using OpenAI's GPT-4o model. The system generates proper Google Sheets query URLs and executes them via HTTP requests for efficient data retrieval.\n\n## What This Workflow Does\n\n- **Natural Language to SQL**: Converts user questions into Google Sheets SQL syntax\n- **Direct HTTP Queries**: Bypasses API limits by using Google Sheets' built-in query functionality\n- **Column Letter Mapping**: Automatically maps column names to their corresponding letters (A, B, C, etc.)\n- **Structured Query Generation**: Outputs properly formatted Google Sheets query URLs\n- **Real-time Data Access**: Retrieves live data directly from Google Sheets\n- **Memory Management**: Maintains conversation context for follow-up questions\n\n## Tools Used\n\n- **OpenAI Chat Model (GPT-4o)** - SQL query generation and natural language understanding\n- **OpenAI Chat Model (GPT-4.1 Mini)** - Result formatting and table output\n- **Google Sheets Tool** - Column metadata extraction and schema understanding\n- **HTTP Request Node** - Direct data retrieval via Google Sheets query API\n- **Structured Output Parser** - Formats AI responses into executable queries\n- **Memory Buffer Window** - Conversation history management\n- **Chat Trigger** - Webhook-based conversation interface\n\n\n## Step-by-Step Setup Instructions\n\n### 1. Prerequisites\n\nBefore starting, ensure you have:\n- An n8n instance (cloud or self-hosted)\n- An OpenAI account with API access and billing setup\n- A Google account with access to Google Sheets\n- The target Google Sheet must be publicly accessible or shareable via link\n\n### 2. Import the Workflow\n\n1. Copy the workflow JSON provided\n2. In your n8n instance, go to **Workflows** → **Import from JSON**\n3. Paste the JSON and click **Import**\n4. Save with a descriptive name like \"Google Sheets SQL Query Generator\"\n\n### 3. Set Up OpenAI Connections\n\n#### Get API Key:\n1. Go to [OpenAI Platform](https://platform.openai.com/)\n2. Sign in or create an account\n3. Navigate to **API Keys** section\n4. Click **Create new secret key**\n5. Copy the generated API key\n6. **Important**: Add billing information and credits to your OpenAI account\n\n#### Configure Both OpenAI Nodes:\n1. **OpenAI Chat Model1 (GPT-4o)**:\n   - Click on the node\n   - Click **Create New Credential**\n   - Select **OpenAI API**\n   - Paste your API key\n   - Save the credential\n\n2. **OpenAI Chat Model2 (GPT-4.1 Mini)**:\n   - Apply the same OpenAI API credential\n   - This handles result formatting\n\n### 4. Set Up Google Sheets Connection\n\n#### Create OAuth2 Credentials:\n1. Go to [Google Cloud Console](https://console.cloud.google.com/)\n2. Create a new project or select existing one\n3. Enable the **Google Sheets API**\n4. Go to **Credentials** → **Create Credentials** → **OAuth 2.0 Client IDs**\n5. Set application type to **Web Application**\n6. Add authorized redirect URIs (get this from n8n credentials setup)\n7. Copy the **Client ID** and **Client Secret**\n\n#### Configure in n8n:\n1. Click on the **Get Column Info2** node\n2. Click **Create New Credential**\n3. Select **Google Sheets OAuth2 API**\n4. Enter your **Client ID** and **Client Secret**\n5. Complete the OAuth flow by clicking **Connect my account**\n6. Authorize the required permissions\n\n### 5. Prepare Your Google Sheet\n\n#### Option A: Use the Sample Data Sheet\n- Access the pre-configured sheet: [Sample Marketing Data](https://docs.google.com/spreadsheets/d/19aUQYZq02qHsCelO4eeV4sx_MTJJupC5qe0gDLQBtRA/edit?usp=drivesdk)\n- Make a copy to your Google Drive\n- **Important**: Set sharing to \"Anyone with the link can view\"\n\n4. **Critical**: Set sharing to \"Anyone with the link can view\" for HTTP access\n5. Copy the Sheet ID from the URL\n6. Update the **Get Column Info2** node with your Sheet ID and column metadata sheet\n\n### 6. Configure Sheet References\n\n1. **Get Column Info2 Node**:\n   - Set **Document ID** to your Google Sheet ID\n   - Set **Sheet Name** to your columns metadata sheet (e.g., \"Columns\")\n   - This provides the AI with column letter mappings\n\n2. **HTTP Request Node**:\n   - No configuration needed - it uses dynamic URLs from the AI agent\n   - Ensure your sheet has proper sharing permissions\n\n### 7. Update System Prompt (If Using Custom Sheet)\n\nIf using your own Google Sheet, update the system prompt in the **AI Agent3** node:\n1. Replace the URL in the system message with your Google Sheet URL\n2. Update the GID (sheet ID) to match your data sheet\n3. Keep the same query structure format\n\n\n\n\n---\n\n## Contact Information\n\n**Robert  Ynteractive**\n\nFor support, customization, or questions about this template:\n\n- **Email**: robert@ynteractive.com\n- **LinkedIn**: [Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)\n\n*Need help implementing this workflow, want to add security features, or require custom modifications? Reach out for professional n8n automation services and AI integration support.*",
  "featuredImage": "/data/workflows/7451/7451.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 736,
  "downloads": 73,
  "createdAt": "2025-08-15T18:42:36.269Z",
  "updatedAt": "2026-01-16T08:50:23.292Z",
  "publishedAt": "2025-08-15T18:42:36.269Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7451",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Natural language to SQL converter for Google Sheets with GPT-4o",
    "workflowName": "Natural language to SQL converter for Google Sheets with GPT-4o",
    "description": "This n8n workflow template creates an intelligent data analysis system that converts natural language questions into Google Sheets SQL queries using OpenAI's GPT-4o model. The system generates proper Google Sheets query URLs and executes them via HTTP requests for efficient data retrieval.\n\n## What This Workflow Does\n\n- **Natural Language to SQL**: Converts user questions into Google Sheets SQL syntax\n- **Direct HTTP Queries**: Bypasses API limits by using Google Sheets' built-in query functionality\n- **Column Letter Mapping**: Automatically maps column names to their corresponding letters (A, B, C, etc.)\n- **Structured Query Generation**: Outputs properly formatted Google Sheets query URLs\n- **Real-time Data Access**: Retrieves live data directly from Google Sheets\n- **Memory Management**: Maintains conversation context for follow-up questions\n\n## Tools Used\n\n- **OpenAI Chat Model (GPT-4o)** - SQL query generation and natural language understanding\n- **OpenAI Chat Model (GPT-4.1 Mini)** - Result formatting and table output\n- **Google Sheets Tool** - Column metadata extraction and schema understanding\n- **HTTP Request Node** - Direct data retrieval via Google Sheets query API\n- **Structured Output Parser** - Formats AI responses into executable queries\n- **Memory Buffer Window** - Conversation history management\n- **Chat Trigger** - Webhook-based conversation interface\n\n\n## Step-by-Step Setup Instructions\n\n### 1. Prerequisites\n\nBefore starting, ensure you have:\n- An n8n instance (cloud or self-hosted)\n- An OpenAI account with API access and billing setup\n- A Google account with access to Google Sheets\n- The target Google Sheet must be publicly accessible or shareable via link\n\n### 2. Import the Workflow\n\n1. Copy the workflow JSON provided\n2. In your n8n instance, go to **Workflows** → **Import from JSON**\n3. Paste the JSON and click **Import**\n4. Save with a descriptive name like \"Google Sheets SQL Query Generator\"\n\n### 3. Set Up OpenAI Connections\n\n#### Get API Key:\n1. Go to [OpenAI Platform](https://platform.openai.com/)\n2. Sign in or create an account\n3. Navigate to **API Keys** section\n4. Click **Create new secret key**\n5. Copy the generated API key\n6. **Important**: Add billing information and credits to your OpenAI account\n\n#### Configure Both OpenAI Nodes:\n1. **OpenAI Chat Model1 (GPT-4o)**:\n   - Click on the node\n   - Click **Create New Credential**\n   - Select **OpenAI API**\n   - Paste your API key\n   - Save the credential\n\n2. **OpenAI Chat Model2 (GPT-4.1 Mini)**:\n   - Apply the same OpenAI API credential\n   - This handles result formatting\n\n### 4. Set Up Google Sheets Connection\n\n#### Create OAuth2 Credentials:\n1. Go to [Google Cloud Console](https://console.cloud.google.com/)\n2. Create a new project or select existing one\n3. Enable the **Google Sheets API**\n4. Go to **Credentials** → **Create Credentials** → **OAuth 2.0 Client IDs**\n5. Set application type to **Web Application**\n6. Add authorized redirect URIs (get this from n8n credentials setup)\n7. Copy the **Client ID** and **Client Secret**\n\n#### Configure in n8n:\n1. Click on the **Get Column Info2** node\n2. Click **Create New Credential**\n3. Select **Google Sheets OAuth2 API**\n4. Enter your **Client ID** and **Client Secret**\n5. Complete the OAuth flow by clicking **Connect my account**\n6. Authorize the required permissions\n\n### 5. Prepare Your Google Sheet\n\n#### Option A: Use the Sample Data Sheet\n- Access the pre-configured sheet: [Sample Marketing Data](https://docs.google.com/spreadsheets/d/19aUQYZq02qHsCelO4eeV4sx_MTJJupC5qe0gDLQBtRA/edit?usp=drivesdk)\n- Make a copy to your Google Drive\n- **Important**: Set sharing to \"Anyone with the link can view\"\n\n4. **Critical**: Set sharing to \"Anyone with the link can view\" for HTTP access\n5. Copy the Sheet ID from the URL\n6. Update the **Get Column Info2** node with your Sheet ID and column metadata sheet\n\n### 6. Configure Sheet References\n\n1. **Get Column Info2 Node**:\n   - Set **Document ID** to your Google Sheet ID\n   - Set **Sheet Name** to your columns metadata sheet (e.g., \"Columns\")\n   - This provides the AI with column letter mappings\n\n2. **HTTP Request Node**:\n   - No configuration needed - it uses dynamic URLs from the AI agent\n   - Ensure your sheet has proper sharing permissions\n\n### 7. Update System Prompt (If Using Custom Sheet)\n\nIf using your own Google Sheet, update the system prompt in the **AI Agent3** node:\n1. Replace the URL in the system message with your Google Sheet URL\n2. Update the GID (sheet ID) to match your data sheet\n3. Keep the same query structure format\n\n\n\n\n---\n\n## Contact Information\n\n**Robert  Ynteractive**\n\nFor support, customization, or questions about this template:\n\n- **Email**: robert@ynteractive.com\n- **LinkedIn**: [Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)\n\n*Need help implementing this workflow, want to add security features, or require custom modifications? Reach out for professional n8n automation services and AI integration support.*",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "AI Agent3",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Get Column Info2",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Simple Memory2",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "role": "memoryBufferWindow",
      "configDescription": "Version 1.3"
    },
    {
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser1",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "OpenAI Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Get Data from Google Sheet",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Write into Table Output1",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}