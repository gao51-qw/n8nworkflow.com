{
  "id": 6504,
  "slug": "6504",
  "title": "Automatically create invoices from Gmail labels with GPT-4O + QuickBooks",
  "description": "## What It Does\nThis workflow reads Gmail threads labeled `Invoice Needed`, extracts invoice and client details using an AI agent, and creates a draft invoice in QuickBooks Online. It then downloads the invoice as a PDF and drafts a reply email with the invoice attached — all automatically.\n\nPerfect for freelancers, agencies, or small businesses looking to streamline client billing from email.\n\n## Prerequisites\nTo use this workflow, you’ll need:\n\n- A Gmail OAuth2 credential\n- A QuickBooks OAuth2 credential\n- An OpenAI credential (for AI-powered data extraction)\n\n## How to Label Threads\n- In Gmail, apply the label `Invoice Needed` to any email thread that contains details for an invoice request.\n- The workflow will process only those threads.\n\n## How It Works\n1. **Trigger:** The workflow runs on a schedule (e.g., every hour)\n2. **Fetch Emails:** Gmail node pulls all threads with the `Invoice Needed` label\n3. **Group Messages:** Emails in each thread are grouped together\n4. **AI Extraction:** An OpenAI-powered agent extracts client info, billing address, invoice amount, and description\n5. **Add a New Client:** This node will attempt to create a new client in QuickBooks\n6. **Find Existing Client** If the client already exists, this node will find the client's id\n7. **Create Invoice:** An invoice is created based on the extracted details\n8. **Download PDF:** The invoice is saved as a PDF\n9. **Draft Reply:** A Gmail draft is created with a template message and the invoice attached\n10. **Remove Label:** The processed thread is untagged to avoid duplicates\n\n## Example Use Cases\n- Automatically generate invoices from client emails\n- Use AI to extract invoice data without manual input\n- Ensure consistent and timely billing\n- Create a paper trail with attached PDFs in replies\n- Free up your inbox by processing and clearing labeled threads\n\n## How to Use\n- Set your schedule (e.g., every hour or more often if needed)\n- Select a product in the `Create A New Invoice` node\n- Ask the client to provide invoice details if needed (company name, billing address)\n- Add the `Invoice Needed` label to threads manually, via a Gmail filter or via another workflow\n- Review and send the drafted replies in Gmail\n- Optionally, add your branding or custom template to the email message\n\n## Optimization Instructions:\n- For larger companies with frequent invoice requests, consider shortening the interval between workflow runs. This helps prevent the system from processing too many labeled threads at once, ensuring smoother performance and faster response times.\n\n## Customization Options\n- Add line multiple items based on the product or service purchased instead of a single invoice row\n- Add conditional logic to skip certain threads\n- Auto-send emails instead of saving drafts (after testing)\n- Use custom prompts to extract additional fields\n\n## Why It's Useful\nThis workflow eliminates the manual labor of crafting invoices from scratch by automating the entire process—from email to invoice. It reduces the need to switch between multiple apps, since you no longer have to open QuickBooks Online to create an invoice. By streamlining your billing workflow, it saves time, minimizes errors, and lets you stay focused on your actual work while still keeping full control over outgoing communications.",
  "featuredImage": "/data/workflows/6504/6504.webp",
  "author": {
    "id": 101,
    "slug": "roshragel",
    "name": "Rosh Ragel",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 639,
  "downloads": 63,
  "createdAt": "2025-07-27T00:06:27.108Z",
  "updatedAt": "2026-01-16T08:45:19.740Z",
  "publishedAt": "2025-07-27T00:06:27.108Z",
  "nodes": 23,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6504",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automatically create invoices from Gmail labels with GPT-4O + QuickBooks",
    "workflowName": "Automatically create invoices from Gmail labels with GPT-4O + QuickBooks",
    "description": "## What It Does\nThis workflow reads Gmail threads labeled `Invoice Needed`, extracts invoice and client details using an AI agent, and creates a draft invoice in QuickBooks Online. It then downloads the invoice as a PDF and drafts a reply email with the invoice attached — all automatically.\n\nPerfect for freelancers, agencies, or small businesses looking to streamline client billing from email.\n\n## Prerequisites\nTo use this workflow, you’ll need:\n\n- A Gmail OAuth2 credential\n- A QuickBooks OAuth2 credential\n- An OpenAI credential (for AI-powered data extraction)\n\n## How to Label Threads\n- In Gmail, apply the label `Invoice Needed` to any email thread that contains details for an invoice request.\n- The workflow will process only those threads.\n\n## How It Works\n1. **Trigger:** The workflow runs on a schedule (e.g., every hour)\n2. **Fetch Emails:** Gmail node pulls all threads with the `Invoice Needed` label\n3. **Group Messages:** Emails in each thread are grouped together\n4. **AI Extraction:** An OpenAI-powered agent extracts client info, billing address, invoice amount, and description\n5. **Add a New Client:** This node will attempt to create a new client in QuickBooks\n6. **Find Existing Client** If the client already exists, this node will find the client's id\n7. **Create Invoice:** An invoice is created based on the extracted details\n8. **Download PDF:** The invoice is saved as a PDF\n9. **Draft Reply:** A Gmail draft is created with a template message and the invoice attached\n10. **Remove Label:** The processed thread is untagged to avoid duplicates\n\n## Example Use Cases\n- Automatically generate invoices from client emails\n- Use AI to extract invoice data without manual input\n- Ensure consistent and timely billing\n- Create a paper trail with attached PDFs in replies\n- Free up your inbox by processing and clearing labeled threads\n\n## How to Use\n- Set your schedule (e.g., every hour or more often if needed)\n- Select a product in the `Create A New Invoice` node\n- Ask the client to provide invoice details if needed (company name, billing address)\n- Add the `Invoice Needed` label to threads manually, via a Gmail filter or via another workflow\n- Review and send the drafted replies in Gmail\n- Optionally, add your branding or custom template to the email message\n\n## Optimization Instructions:\n- For larger companies with frequent invoice requests, consider shortening the interval between workflow runs. This helps prevent the system from processing too many labeled threads at once, ensuring smoother performance and faster response times.\n\n## Customization Options\n- Add line multiple items based on the product or service purchased instead of a single invoice row\n- Add conditional logic to skip certain threads\n- Auto-send emails instead of saving drafts (after testing)\n- Use custom prompts to extract additional fields\n\n## Why It's Useful\nThis workflow eliminates the manual labor of crafting invoices from scratch by automating the entire process—from email to invoice. It reduces the need to switch between multiple apps, since you no longer have to open QuickBooks Online to create an invoice. By streamlining your billing workflow, it saves time, minimizes errors, and lets you stay focused on your actual work while still keeping full control over outgoing communications.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Add Client to QBO",
      "type": "n8n-nodes-base.quickbooks",
      "role": "quickbooks",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Messages w/ Invoice Needed Label",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Find Existing Customer",
      "type": "n8n-nodes-base.quickbooks",
      "role": "quickbooks",
      "configDescription": "Version 1"
    },
    {
      "name": "Create A New Invoice",
      "type": "n8n-nodes-base.quickbooks",
      "role": "quickbooks",
      "configDescription": "Version 1"
    },
    {
      "name": "Download Invoice",
      "type": "n8n-nodes-base.quickbooks",
      "role": "quickbooks",
      "configDescription": "Version 1"
    },
    {
      "name": "Write Draft Reply to Client",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "AI Agent: Extract Customer & Invoice Details",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    },
    {
      "name": "Remove Invoice Needed Label",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Combine all Messages in a Thread",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}