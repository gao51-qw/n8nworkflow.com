{
  "id": 11046,
  "slug": "11046",
  "title": "Automate marketing leads import from Google Sheets to Airtable CRM",
  "description": "# üéØGeneral Principles\nThis workflow automates the import of leads into the **Company** table of a CRM built with Airtable. \n\nIts originality lies in leveraging the new \"**Data Table**\" node (an internal table within n8n) to generate an execution report.\n\n**üìö Why Data Tables:** This approach eliminates the need for reading/writing operations on a Google Sheet file or an external database.\n\n________________________________________\n\n## üß© It is structured on 3 main key steps:\n\n1. Reading leads for which email address validity has been verified.\n2. Creating or updating company information.\n3. Generating of execution report.\n\nThis workflow enables precise tracking of marketing actions while facilitating the historical record of interactions with prospects and clients.\n\n________________________________________\n\n## Prerequisites\n### Leads file:\nA prior validation check on email address accuracy is required.\n\n### Airtable:\nMust contain at least a Company table with the following fields:\n* Company: company name\n* Business Leader: name of the executive\n* Activity: business sector (notary, accountant, plumber, electrician, etc.)\n* Address: main company address\n* Zip Code: postal code\n* City: city\n* Phone Number: phone number\n* Email: email address of a manager\n* URL Site: company website URL\n* Opt-in: company‚Äôs consent for commercial prospecting\n* Campaign: reserved for future marketing campaigns\n* Valid Email: indicator confirming email verification\n\n________________________________________\n\n## ‚öôÔ∏è Step-by-Step Description\n### 1Ô∏è‚É£ Initialization and Lead Selection\n**Data Table Initialization:**\nAn internal n8n table is created to build the execution report.\n\n**Lead Selection:**\nThe workflow selects leads from the Google Sheet file (Sheet1 tab) where the condition \"Valid Email\" is equal to OK.\n\n### 2Ô∏è‚É£ Iterative Loop\n**Company Existence Check:**\nThe Search Company node is configured with Always Output Data enabled.\nA JavaScript code node distinguishes three possibilities:\n1. Company does not exist: create a new record and increment the created records counter.\n\n2. Company exists once: update the record and increment the updated records counter.\n\n3. Company appears multiple times: log the issue in the Leads file under the Logs tab, requiring a data quality procedure.\n\n### 3Ô∏è‚É£ Execution Report Generation\nAn execution report is generated and emailed, example format:\n**Leads Import Report:**\n* Number of records read: 2392\n* Number of records created: 2345\n* Number of records updated: 42\n\nIf the sum of records created and updated differs from the total records read, it indicates **the presence of duplicates**. A counter for duplicated companies could be added.\n\n________________________________________\n\n## ‚úÖ Benefits of this template\n* Exception Management and Logging: Identification and traceability of inconsistencies during import with dedicated logs for issues.\n* Data Quality and Structuring: Built-in checks for duplicate detection, validation, and mapping to ensure accurate analysis and compliance.\n* Automated Reporting: Systematic production and delivery of a detailed execution report covering records read, created, and updated.\n\n## üì¨ Contact\nNeed help customizing this (e.g., expanding Data Tables, connecting multiple surveys, or automating follow-ups)?\n\nüìß [smarthome.smartelec@gmail.com](smarthome.smartelec@gmail.com)\nüîó [guy.salvatore](https://www.linkedin.com/in/guy-salvatore-3570911a/)\nüåê [smarthome-smartelec.fr](https://smarthome-smartelec.fr)",
  "featuredImage": "/data/workflows/11046/11046.webp",
  "author": {
    "id": 101,
    "slug": "guy",
    "name": "Guy",
    "avatar": ""
  },
  "categories": [
    "CRM"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 327,
  "downloads": 32,
  "createdAt": "2025-11-20T14:03:52.146Z",
  "updatedAt": "2026-01-16T09:07:16.313Z",
  "publishedAt": "2025-11-20T14:03:52.146Z",
  "nodes": 26,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11046",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate marketing leads import from Google Sheets to Airtable CRM",
    "workflowName": "Automate marketing leads import from Google Sheets to Airtable CRM",
    "description": "# üéØGeneral Principles\nThis workflow automates the import of leads into the **Company** table of a CRM built with Airtable. \n\nIts originality lies in leveraging the new \"**Data Table**\" node (an internal table within n8n) to generate an execution report.\n\n**üìö Why Data Tables:** This approach eliminates the need for reading/writing operations on a Google Sheet file or an external database.\n\n________________________________________\n\n## üß© It is structured on 3 main key steps:\n\n1. Reading leads for which email address validity has been verified.\n2. Creating or updating company information.\n3. Generating of execution report.\n\nThis workflow enables precise tracking of marketing actions while facilitating the historical record of interactions with prospects and clients.\n\n________________________________________\n\n## Prerequisites\n### Leads file:\nA prior validation check on email address accuracy is required.\n\n### Airtable:\nMust contain at least a Company table with the following fields:\n* Company: company name\n* Business Leader: name of the executive\n* Activity: business sector (notary, accountant, plumber, electrician, etc.)\n* Address: main company address\n* Zip Code: postal code\n* City: city\n* Phone Number: phone number\n* Email: email address of a manager\n* URL Site: company website URL\n* Opt-in: company‚Äôs consent for commercial prospecting\n* Campaign: reserved for future marketing campaigns\n* Valid Email: indicator confirming email verification\n\n________________________________________\n\n## ‚öôÔ∏è Step-by-Step Description\n### 1Ô∏è‚É£ Initialization and Lead Selection\n**Data Table Initialization:**\nAn internal n8n table is created to build the execution report.\n\n**Lead Selection:**\nThe workflow selects leads from the Google Sheet file (Sheet1 tab) where the condition \"Valid Email\" is equal to OK.\n\n### 2Ô∏è‚É£ Iterative Loop\n**Company Existence Check:**\nThe Search Company node is configured with Always Output Data enabled.\nA JavaScript code node distinguishes three possibilities:\n1. Company does not exist: create a new record and increment the created records counter.\n\n2. Company exists once: update the record and increment the updated records counter.\n\n3. Company appears multiple times: log the issue in the Leads file under the Logs tab, requiring a data quality procedure.\n\n### 3Ô∏è‚É£ Execution Report Generation\nAn execution report is generated and emailed, example format:\n**Leads Import Report:**\n* Number of records read: 2392\n* Number of records created: 2345\n* Number of records updated: 42\n\nIf the sum of records created and updated differs from the total records read, it indicates **the presence of duplicates**. A counter for duplicated companies could be added.\n\n________________________________________\n\n## ‚úÖ Benefits of this template\n* Exception Management and Logging: Identification and traceability of inconsistencies during import with dedicated logs for issues.\n* Data Quality and Structuring: Built-in checks for duplicate detection, validation, and mapping to ensure accurate analysis and compliance.\n* Automated Reporting: Systematic production and delivery of a detailed execution report covering records read, created, and updated.\n\n## üì¨ Contact\nNeed help customizing this (e.g., expanding Data Tables, connecting multiple surveys, or automating follow-ups)?\n\nüìß [smarthome.smartelec@gmail.com](smarthome.smartelec@gmail.com)\nüîó [guy.salvatore](https://www.linkedin.com/in/guy-salvatore-3570911a/)\nüåê [smarthome-smartelec.fr](https://smarthome-smartelec.fr)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòExecute workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Update row(s)",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Get row(s)",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Insert row",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Limit",
      "type": "n8n-nodes-base.limit",
      "role": "limit",
      "configDescription": "Version 1"
    },
    {
      "name": "Get row(s)1",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Wait1",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Create Company",
      "type": "n8n-nodes-base.airtable",
      "role": "airtable",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Update row(s) - Creation",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Update row(s) - Update",
      "type": "n8n-nodes-base.dataTable",
      "role": "dataTable",
      "configDescription": "Version 1"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Get row(s) Leads",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Search Company",
      "type": "n8n-nodes-base.airtable",
      "role": "airtable",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Update Company",
      "type": "n8n-nodes-base.airtable",
      "role": "airtable",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Create row(s) Logs",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}