{
  "id": 5451,
  "slug": "5451",
  "title": "AI auto-save Gmail receipts to Google Sheets + Google Drive",
  "description": "## Who is this for?\n\nThis workflow is ideal for:\n\n- For freelancers, business owners, and finance teams who receive receipts via Gmail  \n- Automatically logs expenses for tax, \n- bookkeeping and year-end audits\n\n## What problem is this workflow solving?\n\nWhen tax season hits, missing receipts create panic.\n\nThis workflow keeps everything in one place. It uses AI to extract details from Gmail attachments, logs them in a Google Sheet, and stores the PDFs in Google Drive.\n\nNo digging. No copying. Just everything where it should be.\n\n## How it works?\n\n1. Apply the label `receipt` to any incoming Gmail email. Do not mark it as read.\n\n2. On a schedule (e.g. daily at 8:00 AM), the workflow triggers.\n\n3. It searches for unread emails with the label `receipt`.\n\n4. For each matching email, it downloads the attached receipt file.\n\n5. It extracts text content from the receipt file.\n\n6. It uploads the original receipt file to a specified folder in Google Drive.\n\n7. It merges the extracted text with email metadata.\n\n8. It sends this combined data to OpenAI.  \n   OpenAI extracts structured fields:\n   - `date`\n   - `merchant`\n   - `category`\n   - `description`\n   - `subtotal`\n   - `tax`\n   - `total`\n\n9. The extracted data is appended as a new row in the specific Google Sheet.\n\n10. Finally, the email is marked as read to prevent it from being processed again.\n\n## How to set up?\n\n1. **Connect these services** in your n8n credentials:\n   - Gmail (OAuth2)\n   - Google Drive\n   - Google Sheets\n   - OpenAI\n2. **Configure the Google Drive upload**:\n   - In the “Upload File” node, select the target folder where you want receipt PDFs stored.\n3. **Set your execution schedule**:\n   - Open the “Schedule Trigger” node and choose when it should run (default is once daily at 8:00 AM).\n4. **Choose your Google Sheet and tab**:\n   - In the “Append to Google Sheet” node, select your document and tab\n   - Ensure the sheet contains these columns:  \n     `Date`, `Merchant`, `Category`, `Description`, `Subtotal`, `Tax`, `Total`.\n\n\n## How to customize this workflow to your needs? \n- **Change the Gmail label or search filter** to match your needs.\n- **Modify the OpenAI schema** to extract additional fields like `currency`, `project`, or `notes`.",
  "featuredImage": "/data/workflows/5451/5451.webp",
  "author": {
    "id": 101,
    "slug": "mattxchong",
    "name": "Matt Chong | n8n Creator",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1331,
  "downloads": 133,
  "createdAt": "2025-06-29T12:07:36.666Z",
  "updatedAt": "2026-01-16T08:39:45.716Z",
  "publishedAt": "2025-06-29T12:07:36.666Z",
  "nodes": 14,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/5451",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "AI auto-save Gmail receipts to Google Sheets + Google Drive",
    "workflowName": "AI auto-save Gmail receipts to Google Sheets + Google Drive",
    "description": "## Who is this for?\n\nThis workflow is ideal for:\n\n- For freelancers, business owners, and finance teams who receive receipts via Gmail  \n- Automatically logs expenses for tax, \n- bookkeeping and year-end audits\n\n## What problem is this workflow solving?\n\nWhen tax season hits, missing receipts create panic.\n\nThis workflow keeps everything in one place. It uses AI to extract details from Gmail attachments, logs them in a Google Sheet, and stores the PDFs in Google Drive.\n\nNo digging. No copying. Just everything where it should be.\n\n## How it works?\n\n1. Apply the label `receipt` to any incoming Gmail email. Do not mark it as read.\n\n2. On a schedule (e.g. daily at 8:00 AM), the workflow triggers.\n\n3. It searches for unread emails with the label `receipt`.\n\n4. For each matching email, it downloads the attached receipt file.\n\n5. It extracts text content from the receipt file.\n\n6. It uploads the original receipt file to a specified folder in Google Drive.\n\n7. It merges the extracted text with email metadata.\n\n8. It sends this combined data to OpenAI.  \n   OpenAI extracts structured fields:\n   - `date`\n   - `merchant`\n   - `category`\n   - `description`\n   - `subtotal`\n   - `tax`\n   - `total`\n\n9. The extracted data is appended as a new row in the specific Google Sheet.\n\n10. Finally, the email is marked as read to prevent it from being processed again.\n\n## How to set up?\n\n1. **Connect these services** in your n8n credentials:\n   - Gmail (OAuth2)\n   - Google Drive\n   - Google Sheets\n   - OpenAI\n2. **Configure the Google Drive upload**:\n   - In the “Upload File” node, select the target folder where you want receipt PDFs stored.\n3. **Set your execution schedule**:\n   - Open the “Schedule Trigger” node and choose when it should run (default is once daily at 8:00 AM).\n4. **Choose your Google Sheet and tab**:\n   - In the “Append to Google Sheet” node, select your document and tab\n   - Ensure the sheet contains these columns:  \n     `Date`, `Merchant`, `Category`, `Description`, `Subtotal`, `Tax`, `Total`.\n\n\n## How to customize this workflow to your needs? \n- **Change the Gmail label or search filter** to match your needs.\n- **Modify the OpenAI schema** to extract additional fields like `currency`, `project`, or `notes`.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Get Emails with Receipts",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Get Required Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Download Attachment",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Append to Google Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Merge Data",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Upload File",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Extract Data from Invoice",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Mark Email as Read",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}