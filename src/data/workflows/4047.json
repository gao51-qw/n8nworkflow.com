{
  "id": 4047,
  "slug": "4047",
  "title": "Taxi service provider (production-ready, part 4)",
  "description": "### Workflow Name: ðŸ¤– Taxi Service Provider\n\nTemplate was created in n8n v1.90.2\n\n### Skill Level: High\n\n### Categories: n8n, Chatbot\n\n### Stacks\n\n- Execute Sub-workflow Trigger node\n- Chat Trigger node\n- Redis node\n- Postgres node\n- AI Agent node\n- Calculator node\n- If node, Switch node, Code node, Edit Fields (Set)\n\n### Prerequisite\n\n- Execute Sub-workflow Trigger: **Taxi Service Workflow** (or your own node)\n- Sub-workflow: **Demo Call Back** (or your own node)\n\n# Production Features\n\n- **Scaling Design** for n8n **Queue mode** in production environment\n- **Provider Data** from **external Database** with **Caching Mechanism**\n- Optional **Score** design output\n- Optimize **Taxi Provider Prompt** from database\n- **Error Management**\n\n# What this workflow does?\n\nThis is a n8n **Taxi Provider Workflow** demo. It will receive message from the **Taxi Service Workflow**, process the estimation and return to the caller.\n\n# **How it works**\n\n- The **Flow Trigger** node will wait for the message from other Sub-workflow.\n- When message is received, it will first check for the matching **Provider** from the PostgreSQL database.\n- Then it will increase a **Provider Number** in Redis for selection later\n- Trigger a **AI Agent** to process the fare estimation and create a **NEW booking**\n- Finally, send the AI response to the **Call Output**\n- Note: if the **Provider** is set to inactive, it will do nothing\n\n# **Set up instructions**\n\n1. Pull and Set up the required SQL from our [Github repository](https://github.com/ChatPayLabs/n8n-chatbot-core).\n2. Create you **Redis credentials**, refer to [n8n integration documentation](https://docs.n8n.io/integrations/builtin/credentials/slack/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal) for more information.\n3. Select your Credentials in **Provider Cache,** **Save Provider Cache** and **Provider Number**.\n4. Create you **Postgres credentials**, refer to [n8n integration documentation](https://docs.n8n.io/integrations/builtin/credentials/slack/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal) for more information.\n5. Select your Credentials in **Load Provider Data** and **Create Booking Data.**\n6. Modify the **AI Agent** prompt to fit your need\n\n# How to adjust it to your needs\n\n1. By default, this template will use the **sys_provider** table provider information, you could change it for your own design.\n2. You can use any **AI Model** for the **AI Agent** node\n3. Include is our prompt for the taxi service provider. It is a flexible design which use the data from the **Provider Cache** to customize the prompt, so you could create more **Taxi Service Providers** by duplicate this workflow in the **Taxi Service** node.\n",
  "featuredImage": "/data/workflows/4047/4047.webp",
  "author": {
    "id": 101,
    "slug": "chatpaylabs",
    "name": "ChatPayLabs",
    "avatar": ""
  },
  "categories": [
    "Support Chatbot",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 314,
  "downloads": 31,
  "createdAt": "2025-05-14T15:28:48.092Z",
  "updatedAt": "2026-01-16T08:32:46.303Z",
  "publishedAt": "2025-05-14T15:28:48.092Z",
  "nodes": 30,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4047",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Taxi service provider (production-ready, part 4)",
    "workflowName": "Taxi service provider (production-ready, part 4)",
    "description": "### Workflow Name: ðŸ¤– Taxi Service Provider\n\nTemplate was created in n8n v1.90.2\n\n### Skill Level: High\n\n### Categories: n8n, Chatbot\n\n### Stacks\n\n- Execute Sub-workflow Trigger node\n- Chat Trigger node\n- Redis node\n- Postgres node\n- AI Agent node\n- Calculator node\n- If node, Switch node, Code node, Edit Fields (Set)\n\n### Prerequisite\n\n- Execute Sub-workflow Trigger: **Taxi Service Workflow** (or your own node)\n- Sub-workflow: **Demo Call Back** (or your own node)\n\n# Production Features\n\n- **Scaling Design** for n8n **Queue mode** in production environment\n- **Provider Data** from **external Database** with **Caching Mechanism**\n- Optional **Score** design output\n- Optimize **Taxi Provider Prompt** from database\n- **Error Management**\n\n# What this workflow does?\n\nThis is a n8n **Taxi Provider Workflow** demo. It will receive message from the **Taxi Service Workflow**, process the estimation and return to the caller.\n\n# **How it works**\n\n- The **Flow Trigger** node will wait for the message from other Sub-workflow.\n- When message is received, it will first check for the matching **Provider** from the PostgreSQL database.\n- Then it will increase a **Provider Number** in Redis for selection later\n- Trigger a **AI Agent** to process the fare estimation and create a **NEW booking**\n- Finally, send the AI response to the **Call Output**\n- Note: if the **Provider** is set to inactive, it will do nothing\n\n# **Set up instructions**\n\n1. Pull and Set up the required SQL from our [Github repository](https://github.com/ChatPayLabs/n8n-chatbot-core).\n2. Create you **Redis credentials**, refer to [n8n integration documentation](https://docs.n8n.io/integrations/builtin/credentials/slack/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal) for more information.\n3. Select your Credentials in **Provider Cache,** **Save Provider Cache** and **Provider Number**.\n4. Create you **Postgres credentials**, refer to [n8n integration documentation](https://docs.n8n.io/integrations/builtin/credentials/slack/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal) for more information.\n5. Select your Credentials in **Load Provider Data** and **Create Booking Data.**\n6. Modify the **AI Agent** prompt to fit your need\n\n# How to adjust it to your needs\n\n1. By default, this template will use the **sys_provider** table provider information, you could change it for your own design.\n2. You can use any **AI Model** for the **AI Agent** node\n3. Include is our prompt for the taxi service provider. It is a flexible design which use the data from the **Provider Cache** to customize the prompt, so you could create more **Taxi Service Providers** by duplicate this workflow in the **Taxi Service** node.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Flow Trigger",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "role": "executeWorkflowTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Input",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Test Trigger",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Test Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "xAI @grok-2-1212",
      "type": "@n8n/n8n-nodes-langchain.lmChatXAiGrok",
      "role": "lmChatXAiGrok",
      "configDescription": "Version 1"
    },
    {
      "name": "Create Booking Data",
      "type": "n8n-nodes-base.postgresTool",
      "role": "postgresTool",
      "configDescription": "Version 2.6"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Provider Number",
      "type": "n8n-nodes-base.redis",
      "role": "redis",
      "configDescription": "Version 1"
    },
    {
      "name": "Calculator",
      "type": "@n8n/n8n-nodes-langchain.toolCalculator",
      "role": "toolCalculator",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "If Active",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Provider Cache",
      "type": "n8n-nodes-base.redis",
      "role": "redis",
      "configDescription": "Version 1"
    },
    {
      "name": "Load Provider Data",
      "type": "n8n-nodes-base.postgres",
      "role": "postgres",
      "configDescription": "Version 2.6"
    },
    {
      "name": "Save Provider Cache",
      "type": "n8n-nodes-base.redis",
      "role": "redis",
      "configDescription": "Version 1"
    },
    {
      "name": "Parse Provider",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Provider",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Error Output1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "If Score",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Output w/ Score",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Output w/o Score",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "If Valid?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Test Output",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Call Back",
      "type": "n8n-nodes-base.executeWorkflow",
      "role": "executeWorkflow",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Provider Cache Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    }
  ]
}