{
  "id": 11678,
  "slug": "11678",
  "title": "Automate invoice processing & stock management with AI, Gmail, Sheets & Slack",
  "description": "## âœ… What problem does this workflow solve?\n\nOrder processing often involves manual invoice reading, stock checking, and back-and-forth communication between procurement and operations teams. This workflow automates the **entire procurement decision flow** â€” from reading incoming order emails to extracting structured data, checking stock, and creating either a purchase requisition or a work order automatically.\n\n---\n\n## ğŸ’¡ Main Use Cases\n\n- ğŸ“¥ Auto-extract order and invoice details from incoming emails  \n- ğŸ“¦ Validate stock availability before processing orders  \n- ğŸ“ Auto-create **Purchase Requisitions** when stock is insufficient  \n- ğŸ›  Auto-create **Work Orders** when stock is available  \n- ğŸ“§ Notify procurement or operations via email & Slack  \n- ğŸ“Š Log every action in Google Sheets for tracking and audit  \n\n---\n\n## ğŸ§  How It Works â€“ Step-by-Step\n\n### 1. ğŸ“§ Gmail Trigger  \nThe workflow begins when a new email arrives at a specific email address.  \nThe invoice file is automatically downloaded for processing.\n\n---\n\n### 2. ğŸ“‘ Extract Invoice Record  \nThe attached invoice is processed using OCR or a document extraction tool.  \nRaw details such as:\n- Order ID  \n- Item code  \n- Quantity  \n- Customer information  \n\nare extracted for further processing.\n\n---\n\n### 3. ğŸ¤– AI-Powered Data Structuring  \nOpenAI structures the extracted fields into a clean and consistent format:  \n- `order_id`  \n- `item_code`  \n- `quantity`  \n- `customer_name`  \n\nThis ensures all data is normalised before stock validation.\n\n---\n\n### 4. ğŸ“¦ Stock Check  \nThe workflow checks inventory data stored in **Google Sheets**.  \nIt compares:\n- Required quantity  \n- Current stock  \n\nIf stock is **insufficient**, it triggers the purchase requisition path.  \nIf stock is **available**, it initiates the work order path.\n\n---\n\n### 5. ğŸ”€ Conditional Flow\n\n#### **If stock is insufficient:**  \n- Creates a **Purchase Requisition** record in Google Sheets  \n- Sends an **email notification** to the procurement team for approval  \n\n#### **If stock is sufficient:**  \n- Creates a **Work Order** entry in Google Sheets  \n- Sends a **Slack summary message** to the operations team  \n\nThis ensures teams are notified instantly, and work continues without delays.\n\n---\n\n## ğŸ“Š Logging & Reporting  \nEvery step â€” extracted data, PR created, WO created, notifications sent â€” is logged in Google Sheets.  \nThis provides a full audit trail for procurement and operations teams.\n\n---\n\n## ğŸ‘¤ Who can use this?\n\nIdeal for:\n- Procurement teams  \n- Operations departments  \n- Manufacturing & warehouse units  \n- Businesses processing high-volume emailed orders  \n- Any team needing structured, automated order workflows  \n\n---\n\n## ğŸš€ Benefits\n\n- â± Faster order processing  \n- ğŸ§  Fewer manual errors from invoice reading  \n- ğŸ“¦ Smarter procurement decisions based on real stock  \n- ğŸ” Automated communication loops  \n- ğŸ“Š Transparent audit logs for every order  \n\n---\n\n",
  "featuredImage": "/data/workflows/11678/11678.webp",
  "author": {
    "id": 101,
    "slug": "infyom",
    "name": "InfyOm Technologies",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 125,
  "downloads": 12,
  "createdAt": "2025-12-11T05:12:15.050Z",
  "updatedAt": "2026-01-16T09:09:39.670Z",
  "publishedAt": "2025-12-11T05:12:15.050Z",
  "nodes": 15,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11678",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate invoice processing & stock management with AI, Gmail, Sheets & Slack",
    "workflowName": "Automate invoice processing & stock management with AI, Gmail, Sheets & Slack",
    "description": "## âœ… What problem does this workflow solve?\n\nOrder processing often involves manual invoice reading, stock checking, and back-and-forth communication between procurement and operations teams. This workflow automates the **entire procurement decision flow** â€” from reading incoming order emails to extracting structured data, checking stock, and creating either a purchase requisition or a work order automatically.\n\n---\n\n## ğŸ’¡ Main Use Cases\n\n- ğŸ“¥ Auto-extract order and invoice details from incoming emails  \n- ğŸ“¦ Validate stock availability before processing orders  \n- ğŸ“ Auto-create **Purchase Requisitions** when stock is insufficient  \n- ğŸ›  Auto-create **Work Orders** when stock is available  \n- ğŸ“§ Notify procurement or operations via email & Slack  \n- ğŸ“Š Log every action in Google Sheets for tracking and audit  \n\n---\n\n## ğŸ§  How It Works â€“ Step-by-Step\n\n### 1. ğŸ“§ Gmail Trigger  \nThe workflow begins when a new email arrives at a specific email address.  \nThe invoice file is automatically downloaded for processing.\n\n---\n\n### 2. ğŸ“‘ Extract Invoice Record  \nThe attached invoice is processed using OCR or a document extraction tool.  \nRaw details such as:\n- Order ID  \n- Item code  \n- Quantity  \n- Customer information  \n\nare extracted for further processing.\n\n---\n\n### 3. ğŸ¤– AI-Powered Data Structuring  \nOpenAI structures the extracted fields into a clean and consistent format:  \n- `order_id`  \n- `item_code`  \n- `quantity`  \n- `customer_name`  \n\nThis ensures all data is normalised before stock validation.\n\n---\n\n### 4. ğŸ“¦ Stock Check  \nThe workflow checks inventory data stored in **Google Sheets**.  \nIt compares:\n- Required quantity  \n- Current stock  \n\nIf stock is **insufficient**, it triggers the purchase requisition path.  \nIf stock is **available**, it initiates the work order path.\n\n---\n\n### 5. ğŸ”€ Conditional Flow\n\n#### **If stock is insufficient:**  \n- Creates a **Purchase Requisition** record in Google Sheets  \n- Sends an **email notification** to the procurement team for approval  \n\n#### **If stock is sufficient:**  \n- Creates a **Work Order** entry in Google Sheets  \n- Sends a **Slack summary message** to the operations team  \n\nThis ensures teams are notified instantly, and work continues without delays.\n\n---\n\n## ğŸ“Š Logging & Reporting  \nEvery step â€” extracted data, PR created, WO created, notifications sent â€” is logged in Google Sheets.  \nThis provides a full audit trail for procurement and operations teams.\n\n---\n\n## ğŸ‘¤ Who can use this?\n\nIdeal for:\n- Procurement teams  \n- Operations departments  \n- Manufacturing & warehouse units  \n- Businesses processing high-volume emailed orders  \n- Any team needing structured, automated order workflows  \n\n---\n\n## ğŸš€ Benefits\n\n- â± Faster order processing  \n- ğŸ§  Fewer manual errors from invoice reading  \n- ğŸ“¦ Smarter procurement decisions based on real stock  \n- ğŸ” Automated communication loops  \n- ğŸ“Š Transparent audit logs for every order  \n\n---",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Gmail Trigger",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Extract Invoice Record",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sales Order Creation",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Stock & Shortage Check",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "If Negative",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Create Purchase Requisition",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Create  Work  Order",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Send Order Summary",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}