{
  "id": 4012,
  "slug": "4012",
  "title": "Generate knowledge base articles with GPT & Perplexity AI for Contentful CMS",
  "description": "## Workflow: Auto Knowledge Base Article Generator\n\n### ‚ö° About the Creators\nThis workflow was created by [Varritech Technologies](https://varritech.com), an innovative agency that leverages AI to engineer, design, and deliver software development projects 500% faster than traditional agencies. Based in New York City, we specialize in custom software development, web applications, and digital transformation solutions. If you need assistance implementing this workflow or have questions about content management solutions, please reach out to our team.\n\n### üèóÔ∏è Architecture Overview  \nThis workflow automates the end-to-end creation of a structured knowledge-base article from a simple chat prompt:\n\n1. **Chat Trigger** ‚Üí Receives user request  \n2. **AI Drafting Loop** ‚Üí Generates & refines JSON article via AI agents  \n3. **Perplexity Research Call** ‚Üí Deep-dive content generation  \n4. **Editorial Loop** ‚Üí Up to 3 AI-driven revisions  \n5. **Contentful Publish** ‚Üí Pushes final JSON into CMS  \n\n---\n\n### üì¶ Node-by-Node Breakdown\n\n```mermaid\nflowchart LR\n  A[Webhook: Chat Trigger] --&gt; B[AI Writer Agent]\n  B --&gt; C[HTTP Request: Perplexity Content]\n  C --&gt; D[Function: Format Output & Citations]\n  D --&gt; E[Loop Start: Initialize Count]\n  E --&gt; F[AI Editor Agent]\n  F --&gt; G{action == \"rewrite\"?}\n  G -- yes --&gt; H[Function: Merge Improvements]\n  H --&gt; I[Increment Count] --&gt; F\n  G -- no --&gt; J[Stop Loop]\n  J --&gt; K[HTTP Request: Publish to Contentful]\n```\n\n### Webhook: Chat Trigger\n\n**Type**: HTTP Webhook (POST /webhook/knowledge-article)\n\n**Payload**:\n\n```\n{ \n\t\"chatInput\": \"What topics should I write about?\" \n}\n```\n\n**Purpose**: Kicks off the workflow on that chat prompt.\n\n### AI Writer Agent\n\n**Inputs**: chatInput or existing article JSON\n\n**Outputs**:\n\n```\n{\n  \"title\": \"...\",\n  \"slug\": \"...\",\n  \"category.id\": \"...\",\n  \"description\": \"...\",\n  \"keywords\": [...],\n  \"content\": \"...\",\n  \"metaTitle\": \"...\",\n  \"metaDescription\": \"...\",\n  \"readingTime\": 5,\n  \"difficulty\": \"intermediate\"\n}\n```\n\n**Purpose**: Generates the article skeleton (metadata + initial content).\n\n# HTTP Request: Perplexity Content\n\n**Method:** POST\n\n**URL:** https://api.perplexity.ai/research\n\n**Body:**\n```json\n{\n  \"model\": \"sonar-deep-research\",\n  \"query\": \"{{ $json.title }}\",\n  \"length\": 1000\n}\n```\n\n**Purpose:** Retrieves a long-form, deeply researched draft for the article body.\n\n## Function: Format Output & Citations\n\n**Logic:**\n\n- Parse raw Perplexity response\n- Extract source URIs\n- Append them under a sources markdown list\n\n## Editorial Loop\n\n1. Initialize Counter to 0\n2. AI Editor Agent\n   - Reads draft JSON\n   - Returns either:\n     - `action: \"rewrite\" + improvements: [...]`\n     - or `action: \"submit\"`\n3. Merge Improvements (if rewriting)\n   - Applies suggested updates to JSON fields\n4. Limit Check\n   - Stops after 3 iterations or on \"submit\"\n\n## HTTP Request: Publish to Contentful\n\n**Method:** PUT\n\n**URL:** https://cdn.contentful.com/spaces/{space}/environments/master/entries/{entryId}\n\n**Headers:**\n- Authorization: Bearer &lt;token&gt;\n- Content-Type: application/vnd.contentful.management.v1+json\n\n**Body:** Maps JSON ‚Üí Contentful entry fields\n\n**Outcome:** Publishes the finalized article live.\n\n## üîç Design Rationale & Best Practices\n\n### Separation of Concerns\nWriter vs. Editor agents isolate creative drafting from quality review.\n\n### Idempotent Loop\nCounter + action flags prevent infinite retries.\n\n### Extensibility\nSwap in different research APIs or CMS targets with minimal changes.\n\n### Structured JSON\nEnsures predictable input/output for each node.",
  "featuredImage": "/data/workflows/4012/4012.webp",
  "author": {
    "id": 101,
    "slug": "varritech",
    "name": "Varritech",
    "avatar": ""
  },
  "categories": [
    "Content Creation",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 5869,
  "downloads": 586,
  "createdAt": "2025-05-13T11:31:19.601Z",
  "updatedAt": "2026-01-16T08:32:35.946Z",
  "publishedAt": "2025-05-13T11:31:19.601Z",
  "nodes": 25,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4012",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Generate knowledge base articles with GPT & Perplexity AI for Contentful CMS",
    "workflowName": "Generate knowledge base articles with GPT & Perplexity AI for Contentful CMS",
    "description": "## Workflow: Auto Knowledge Base Article Generator\n\n### ‚ö° About the Creators\nThis workflow was created by [Varritech Technologies](https://varritech.com), an innovative agency that leverages AI to engineer, design, and deliver software development projects 500% faster than traditional agencies. Based in New York City, we specialize in custom software development, web applications, and digital transformation solutions. If you need assistance implementing this workflow or have questions about content management solutions, please reach out to our team.\n\n### üèóÔ∏è Architecture Overview  \nThis workflow automates the end-to-end creation of a structured knowledge-base article from a simple chat prompt:\n\n1. **Chat Trigger** ‚Üí Receives user request  \n2. **AI Drafting Loop** ‚Üí Generates & refines JSON article via AI agents  \n3. **Perplexity Research Call** ‚Üí Deep-dive content generation  \n4. **Editorial Loop** ‚Üí Up to 3 AI-driven revisions  \n5. **Contentful Publish** ‚Üí Pushes final JSON into CMS  \n\n---\n\n### üì¶ Node-by-Node Breakdown\n\n```mermaid\nflowchart LR\n  A[Webhook: Chat Trigger] --&gt; B[AI Writer Agent]\n  B --&gt; C[HTTP Request: Perplexity Content]\n  C --&gt; D[Function: Format Output & Citations]\n  D --&gt; E[Loop Start: Initialize Count]\n  E --&gt; F[AI Editor Agent]\n  F --&gt; G{action == \"rewrite\"?}\n  G -- yes --&gt; H[Function: Merge Improvements]\n  H --&gt; I[Increment Count] --&gt; F\n  G -- no --&gt; J[Stop Loop]\n  J --&gt; K[HTTP Request: Publish to Contentful]\n```\n\n### Webhook: Chat Trigger\n\n**Type**: HTTP Webhook (POST /webhook/knowledge-article)\n\n**Payload**:\n\n```\n{ \n\t\"chatInput\": \"What topics should I write about?\" \n}\n```\n\n**Purpose**: Kicks off the workflow on that chat prompt.\n\n### AI Writer Agent\n\n**Inputs**: chatInput or existing article JSON\n\n**Outputs**:\n\n```\n{\n  \"title\": \"...\",\n  \"slug\": \"...\",\n  \"category.id\": \"...\",\n  \"description\": \"...\",\n  \"keywords\": [...],\n  \"content\": \"...\",\n  \"metaTitle\": \"...\",\n  \"metaDescription\": \"...\",\n  \"readingTime\": 5,\n  \"difficulty\": \"intermediate\"\n}\n```\n\n**Purpose**: Generates the article skeleton (metadata + initial content).\n\n# HTTP Request: Perplexity Content\n\n**Method:** POST\n\n**URL:** https://api.perplexity.ai/research\n\n**Body:**\n```json\n{\n  \"model\": \"sonar-deep-research\",\n  \"query\": \"{{ $json.title }}\",\n  \"length\": 1000\n}\n```\n\n**Purpose:** Retrieves a long-form, deeply researched draft for the article body.\n\n## Function: Format Output & Citations\n\n**Logic:**\n\n- Parse raw Perplexity response\n- Extract source URIs\n- Append them under a sources markdown list\n\n## Editorial Loop\n\n1. Initialize Counter to 0\n2. AI Editor Agent\n   - Reads draft JSON\n   - Returns either:\n     - `action: \"rewrite\" + improvements: [...]`\n     - or `action: \"submit\"`\n3. Merge Improvements (if rewriting)\n   - Applies suggested updates to JSON fields\n4. Limit Check\n   - Stops after 3 iterations or on \"submit\"\n\n## HTTP Request: Publish to Contentful\n\n**Method:** PUT\n\n**URL:** https://cdn.contentful.com/spaces/{space}/environments/master/entries/{entryId}\n\n**Headers:**\n- Authorization: Bearer &lt;token&gt;\n- Content-Type: application/vnd.contentful.management.v1+json\n\n**Body:** Maps JSON ‚Üí Contentful entry fields\n\n**Outcome:** Publishes the finalized article live.\n\n## üîç Design Rationale & Best Practices\n\n### Separation of Concerns\nWriter vs. Editor agents isolate creative drafting from quality review.\n\n### Idempotent Loop\nCounter + action flags prevent infinite retries.\n\n### Extensibility\nSwap in different research APIs or CMS targets with minimal changes.\n\n### Structured JSON\nEnsures predictable input/output for each node.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Create Perplexity Content",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "AI Writer Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.7"
    },
    {
      "name": "AI Editor Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.7"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Accept and Publish",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "role": "toolWorkflow",
      "configDescription": "Version 2"
    },
    {
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "JSON.parse1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3"
    },
    {
      "name": "Format",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "JSON.parse",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Format Perplexity Output & Add Citations",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Initialize Count",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 1"
    },
    {
      "name": "Increment Count",
      "type": "n8n-nodes-base.function",
      "role": "function",
      "configDescription": "Version 1"
    },
    {
      "name": "Check Limit",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 1"
    },
    {
      "name": "Stop Here",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Execute Workflow",
      "type": "n8n-nodes-base.executeWorkflow",
      "role": "executeWorkflow",
      "configDescription": "Version 1.2"
    },
    {
      "name": "JSON.parse3",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "should submit",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}