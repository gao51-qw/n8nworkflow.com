{
  "id": 8099,
  "slug": "8099",
  "title": "Extract Colombian invoice data from Drive to Sheets with GPT-4o",
  "description": "## Automate Colombian Cashflow Data Extraction to Google Sheets with AI\n\n## Who’s it for\nThis workflow is designed for **finance professionals, accountants, small business owners in Colombia**, or anyone needing to automate the extraction of invoice data and its entry into Google Sheets. It's particularly useful for handling Colombian tax and legal specifics.\n\n## How it works / What it does\nThis workflow automates the process of extracting critical data from invoices and receipts (PDFs and JPEGs) and organizing it in a Google Sheet:\n*   **Triggers:** The workflow initiates when a new file is created or an existing file is updated in a designated Google Drive folder.\n*   **File Handling:** It first downloads the detected file.\n*   **Routing:** A \"Switch\" node intelligently routes the file based on its extension – one path for PDFs and another for JPEGs.\n*   **Data Extraction:**\n    *   For **PDF files**, it directly extracts all text content from the document.\n    *   For **JPEG image files**, it utilizes an AI Agent (Azure OpenAI) to process the image and extract its textual content.\n*   **AI-Powered Reasoning:** Two \"Reasoning Agent\" nodes (Azure OpenAI Chat Models) act as a specialized \"Colombian Tax and Legal Extraction Agent\". They parse the extracted text from invoices to pull out structured data in JSON format, including:\n    *   Vendor name.\n    *   Modification date.\n    *   Line items with detailed description, sub_total, iva_value, total_amount, category, and sub_category.\n    *   Specific Colombian tax fields like Retefuente and ReteICA.\n    *   The number of items generated.\n*   **Output Parsing:** A \"Structured Output Parser\" node ensures that the AI's output strictly adheres to a predefined JSON schema, guaranteeing consistent data formatting.\n*   **Data Preparation:** \"Edit Field\" nodes ensure the AI's extracted data is in a valid format.\n*   **Item Splitting:** \"Split data\" nodes separate the 'items' array from the AI's output, allowing each individual line item from the invoice to be processed as a separate entry for the Google Sheet.\n*   **Google Sheet Integration:** Finally, \"Fill Template\" nodes append the fully processed invoice data (per line item) into your designated Google Sheet.\n\n## How to set up\n1.  **Google Drive Credentials:** Ensure you have configured your Google Drive OAuth2 API credentials in n8n.\n2.  **Azure OpenAI Credentials:** Set up your Azure OpenAI API credentials, ensuring access to models like `gpt-4o`. Or you can simply use your traditional OpenAI or others LLMs.\n3.  **Google Sheets Credentials:** Configure your Google Sheets OAuth2 API credentials.\n4.  **Google Drive Folder ID:** In the \"1a. Updated file trigger\" and \"1b. Created file trigger\" nodes, **update the `folderToWatch` parameter** with your specific Google Drive Folder ID.\n5.  **Google Sheet ID and Sheet Name:** In the \"8. Fill Template\" and \"8. Fill Template1\" nodes, **update the `documentId` and `sheetName` parameters** with your specific Google Sheet ID and the name of the sheet where data should be appended.\n\n## Requirements\n*   An active n8n instance.\n*   A Google Drive account for file uploads.\n*   A Google Sheets account for data storage.\n*   An Azure OpenAI account with access to chat models (e.g., `gpt-4o`) for the \"Azure OpenAI Chat Model\" nodes and \"Extract Data Agent\".\n\n## How to customize the workflow\n*   **AI Extraction Prompts:** Modify the prompt instructions in the \"5. Reasoning Agent\" and \"5. Reasoning Agent1\" nodes if you need to extract different data points or change the output format.\n*   **Google Sheet Column Mappings:** Adjust the `columns` mapping in the \"8. Fill Template\" and \"8. Fill Template1\" nodes to match your specific Google Sheet headers and data requirements.\n*   **File Types:** Extend the \"3. Route\" node to handle additional file types (e.g., DOCX, PNG) by adding new conditions and corresponding extraction nodes.",
  "featuredImage": "/data/workflows/8099/8099.webp",
  "author": {
    "id": 101,
    "slug": "caiogarvil",
    "name": "Caio Garvil",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 136,
  "downloads": 13,
  "createdAt": "2025-08-31T21:52:57.175Z",
  "updatedAt": "2026-01-16T08:54:10.186Z",
  "publishedAt": "2025-08-31T21:52:57.175Z",
  "nodes": 29,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8099",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Extract Colombian invoice data from Drive to Sheets with GPT-4o",
    "workflowName": "Extract Colombian invoice data from Drive to Sheets with GPT-4o",
    "description": "## Automate Colombian Cashflow Data Extraction to Google Sheets with AI\n\n## Who’s it for\nThis workflow is designed for **finance professionals, accountants, small business owners in Colombia**, or anyone needing to automate the extraction of invoice data and its entry into Google Sheets. It's particularly useful for handling Colombian tax and legal specifics.\n\n## How it works / What it does\nThis workflow automates the process of extracting critical data from invoices and receipts (PDFs and JPEGs) and organizing it in a Google Sheet:\n*   **Triggers:** The workflow initiates when a new file is created or an existing file is updated in a designated Google Drive folder.\n*   **File Handling:** It first downloads the detected file.\n*   **Routing:** A \"Switch\" node intelligently routes the file based on its extension – one path for PDFs and another for JPEGs.\n*   **Data Extraction:**\n    *   For **PDF files**, it directly extracts all text content from the document.\n    *   For **JPEG image files**, it utilizes an AI Agent (Azure OpenAI) to process the image and extract its textual content.\n*   **AI-Powered Reasoning:** Two \"Reasoning Agent\" nodes (Azure OpenAI Chat Models) act as a specialized \"Colombian Tax and Legal Extraction Agent\". They parse the extracted text from invoices to pull out structured data in JSON format, including:\n    *   Vendor name.\n    *   Modification date.\n    *   Line items with detailed description, sub_total, iva_value, total_amount, category, and sub_category.\n    *   Specific Colombian tax fields like Retefuente and ReteICA.\n    *   The number of items generated.\n*   **Output Parsing:** A \"Structured Output Parser\" node ensures that the AI's output strictly adheres to a predefined JSON schema, guaranteeing consistent data formatting.\n*   **Data Preparation:** \"Edit Field\" nodes ensure the AI's extracted data is in a valid format.\n*   **Item Splitting:** \"Split data\" nodes separate the 'items' array from the AI's output, allowing each individual line item from the invoice to be processed as a separate entry for the Google Sheet.\n*   **Google Sheet Integration:** Finally, \"Fill Template\" nodes append the fully processed invoice data (per line item) into your designated Google Sheet.\n\n## How to set up\n1.  **Google Drive Credentials:** Ensure you have configured your Google Drive OAuth2 API credentials in n8n.\n2.  **Azure OpenAI Credentials:** Set up your Azure OpenAI API credentials, ensuring access to models like `gpt-4o`. Or you can simply use your traditional OpenAI or others LLMs.\n3.  **Google Sheets Credentials:** Configure your Google Sheets OAuth2 API credentials.\n4.  **Google Drive Folder ID:** In the \"1a. Updated file trigger\" and \"1b. Created file trigger\" nodes, **update the `folderToWatch` parameter** with your specific Google Drive Folder ID.\n5.  **Google Sheet ID and Sheet Name:** In the \"8. Fill Template\" and \"8. Fill Template1\" nodes, **update the `documentId` and `sheetName` parameters** with your specific Google Sheet ID and the name of the sheet where data should be appended.\n\n## Requirements\n*   An active n8n instance.\n*   A Google Drive account for file uploads.\n*   A Google Sheets account for data storage.\n*   An Azure OpenAI account with access to chat models (e.g., `gpt-4o`) for the \"Azure OpenAI Chat Model\" nodes and \"Extract Data Agent\".\n\n## How to customize the workflow\n*   **AI Extraction Prompts:** Modify the prompt instructions in the \"5. Reasoning Agent\" and \"5. Reasoning Agent1\" nodes if you need to extract different data points or change the output format.\n*   **Google Sheet Column Mappings:** Adjust the `columns` mapping in the \"8. Fill Template\" and \"8. Fill Template1\" nodes to match your specific Google Sheet headers and data requirements.\n*   **File Types:** Extend the \"3. Route\" node to handle additional file types (e.g., DOCX, PNG) by adding new conditions and corresponding extraction nodes.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Azure OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "role": "lmChatAzureOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Azure OpenAI Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "role": "lmChatAzureOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Azure OpenAI Chat Model3",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "role": "lmChatAzureOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "1a. Updated file trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "1b. Created file trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "2. Download file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "3. Route",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "5. Reasoning Agent",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.5"
    },
    {
      "name": "6. Edit Field",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "7. Split data",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "8. Fill Template",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "4. Extract data from PDF",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "4. Extract Data Agent",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.5"
    },
    {
      "name": "5. Reasoning Agent1",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.5"
    },
    {
      "name": "6. Edit Field1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "7. Split Data",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "8. Fill Template1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}