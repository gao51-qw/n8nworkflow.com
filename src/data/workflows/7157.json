{
  "id": 7157,
  "slug": "7157",
  "title": "Beginner Outlook calendar summary with OpenAI",
  "description": "A step-by-step demo that shows **how to pull your Outlook calendar events for the week and ask GPT-4o to write a short summary**.  \nAlong the way you‚Äôll practice basic data-transform nodes (Code, Filter, Aggregate) and see where to attach the required API credentials.\n\n---\n\n## 1Ô∏è‚É£ Manual Trigger ‚Äî *Run Workflow*\n| Why | Lets you click ‚ÄúExecute‚Äù in the n8n editor so you can test each change. |\n| --- | --- |\n\n---\n\n## 2Ô∏è‚É£ Get Outlook Events ‚Äî *Get many events*\n1. **Node type:** `Microsoft Outlook ‚Üí Event ‚Üí Get All`  \n2. **Fields selected:** `subject`, `start`  \n3. **API setup (inside this node):**  \n   - Click **Credentials ‚ñ∏ Microsoft Outlook OAuth2 API**  \n   - If you haven‚Äôt connected before:  \n     1. Choose **‚ÄúMicrosoft Outlook OAuth2 API‚Äù ‚Üí ‚ÄúCreate New‚Äù**.  \n     2. Sign in and grant the **Calendars.Read** permission.  \n     3. Save the credential (e.g., **‚ÄúMicrosoft Outlook account‚Äù**).  \n4. **Output:** A list of events with the raw ISO start time.\n\n&gt; **Teaching moment:** Outlook returns a full `dateTime` string. We‚Äôll normalize it next so it‚Äôs easy to filter.\n\n---\n\n## 3Ô∏è‚É£ Normalize Dates ‚Äî *Convert to Date Format*  \n```js\n// Code node contents\nreturn $input.all().map(item =&gt; {\n  const startDateTime = new Date(item.json.start.dateTime);\n  const formattedDate = startDateTime.toISOString().split('T')[0]; // YYYY-MM-DD\n  return { json: { ...item.json, startDateFormatted: formattedDate } };\n});\n\n### 4Ô∏è‚É£ Filter the Events Down to *This* Week  \nAfter we‚Äôve normalised the `start` date-time into a simple `YYYY-MM-DD` string, we drop in a **Filter** node.  \nAdd one rule for every day you want to keep‚Äîfor example `2025-08-07` **or** `2025-08-08`. Rows that match any of those dates will continue through the workflow; everything else is quietly discarded.  \n\n*Why we‚Äôre doing this:* we only want to summarise tomorrow‚Äôs and the following day‚Äôs meetings, not the entire calendar.\n\n---\n\n### 5Ô∏è‚É£ Roll All Subjects Into a Single Item  \nNext comes an **Aggregate** node. Tell it to aggregate the `subject` field and choose the option *‚ÄúOnly aggregated fields.‚Äù*  \nThe result is one clean item whose `subject` property is now a tidy list of every meeting title. It‚Äôs far easier (and cheaper) to pass one prompt to GPT than dozens of small ones.\n\n---\n\n### 6Ô∏è‚É£ Turn That List Into Plain Text  \nInsert a small **Code** node right after the aggregation:\n\n```js\nreturn [{\n  json: {\n    text: items\n      .map(item =&gt; JSON.stringify(item.json))\n      .join('\\n')\n  }\n}];\n\nNeed a Hand?\nI‚Äôm always happy to chat automation, n8n, or Outlook API quirks.\n\nRobert Breen ‚Äì Automation Consultant & n8n Instructor\nüìß robert@ynteractive.com‚ÄÉ|‚ÄÉLinkedIn",
  "featuredImage": "/data/workflows/7157/7157.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Personal Productivity",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 3972,
  "downloads": 397,
  "createdAt": "2025-08-08T00:35:43.622Z",
  "updatedAt": "2026-01-16T08:48:46.425Z",
  "publishedAt": "2025-08-08T00:35:43.622Z",
  "nodes": 11,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7157",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Beginner Outlook calendar summary with OpenAI",
    "workflowName": "Beginner Outlook calendar summary with OpenAI",
    "description": "A step-by-step demo that shows **how to pull your Outlook calendar events for the week and ask GPT-4o to write a short summary**.  \nAlong the way you‚Äôll practice basic data-transform nodes (Code, Filter, Aggregate) and see where to attach the required API credentials.\n\n---\n\n## 1Ô∏è‚É£ Manual Trigger ‚Äî *Run Workflow*\n| Why | Lets you click ‚ÄúExecute‚Äù in the n8n editor so you can test each change. |\n| --- | --- |\n\n---\n\n## 2Ô∏è‚É£ Get Outlook Events ‚Äî *Get many events*\n1. **Node type:** `Microsoft Outlook ‚Üí Event ‚Üí Get All`  \n2. **Fields selected:** `subject`, `start`  \n3. **API setup (inside this node):**  \n   - Click **Credentials ‚ñ∏ Microsoft Outlook OAuth2 API**  \n   - If you haven‚Äôt connected before:  \n     1. Choose **‚ÄúMicrosoft Outlook OAuth2 API‚Äù ‚Üí ‚ÄúCreate New‚Äù**.  \n     2. Sign in and grant the **Calendars.Read** permission.  \n     3. Save the credential (e.g., **‚ÄúMicrosoft Outlook account‚Äù**).  \n4. **Output:** A list of events with the raw ISO start time.\n\n&gt; **Teaching moment:** Outlook returns a full `dateTime` string. We‚Äôll normalize it next so it‚Äôs easy to filter.\n\n---\n\n## 3Ô∏è‚É£ Normalize Dates ‚Äî *Convert to Date Format*  \n```js\n// Code node contents\nreturn $input.all().map(item =&gt; {\n  const startDateTime = new Date(item.json.start.dateTime);\n  const formattedDate = startDateTime.toISOString().split('T')[0]; // YYYY-MM-DD\n  return { json: { ...item.json, startDateFormatted: formattedDate } };\n});\n\n### 4Ô∏è‚É£ Filter the Events Down to *This* Week  \nAfter we‚Äôve normalised the `start` date-time into a simple `YYYY-MM-DD` string, we drop in a **Filter** node.  \nAdd one rule for every day you want to keep‚Äîfor example `2025-08-07` **or** `2025-08-08`. Rows that match any of those dates will continue through the workflow; everything else is quietly discarded.  \n\n*Why we‚Äôre doing this:* we only want to summarise tomorrow‚Äôs and the following day‚Äôs meetings, not the entire calendar.\n\n---\n\n### 5Ô∏è‚É£ Roll All Subjects Into a Single Item  \nNext comes an **Aggregate** node. Tell it to aggregate the `subject` field and choose the option *‚ÄúOnly aggregated fields.‚Äù*  \nThe result is one clean item whose `subject` property is now a tidy list of every meeting title. It‚Äôs far easier (and cheaper) to pass one prompt to GPT than dozens of small ones.\n\n---\n\n### 6Ô∏è‚É£ Turn That List Into Plain Text  \nInsert a small **Code** node right after the aggregation:\n\n```js\nreturn [{\n  json: {\n    text: items\n      .map(item =&gt; JSON.stringify(item.json))\n      .join('\\n')\n  }\n}];\n\nNeed a Hand?\nI‚Äôm always happy to chat automation, n8n, or Outlook API quirks.\n\nRobert Breen ‚Äì Automation Consultant & n8n Instructor\nüìß robert@ynteractive.com‚ÄÉ|‚ÄÉLinkedIn",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Get many events",
      "type": "n8n-nodes-base.microsoftOutlook",
      "role": "microsoftOutlook",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenAI Chat Model5",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Run Workflow",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert to Date Format",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Filter to This week",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Combine to one Field",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert objects to text",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Summarize Weekly Events",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2"
    }
  ]
}