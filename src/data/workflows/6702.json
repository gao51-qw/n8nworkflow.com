{
  "id": 6702,
  "slug": "6702",
  "title": "Extract data from Thai Government letters with Mistral OCR and store in Google Sheets",
  "description": "### LINE OCR Workflow to Extract and Save Thai Government Letters to Google Sheets\n\nThis template automates the extraction of structured data from Thai government letters received via LINE or uploaded to Google Drive. It uses Mistral AI for OCR and OpenAI for information extraction, saving results to a Google Sheet.\n\n---\n\n## Who’s it for?\n\n- Thai government agencies or teams receiving official documents via LINE or Google Drive\n- Automation developers working with document intake and OCR\n- Anyone needing to extract fields from Thai scanned letters and store structured info\n\n---\n\n## What it does\n\nThis n8n workflow:\n1. **Receives documents** from two sources:\n   - LINE webhook (via Messaging API)\n   - Google Drive (new file trigger)\n2. **Checks file type** (PDF or image)\n3. **Runs OCR** with Mistral AI (Document or Image model)\n4. **Uses OpenAI** to extract key metadata such as:\n   - book_id\n   - subject\n   - recipient (to)\n   - signatory\n   - date, contact info, etc.\n5. **Stores structured data** in Google Sheets\n6. **Replies to LINE user** with extracted info or moves files into archive folders (Drive)\n\n---\n\n## How to Set It Up\n\n1. Create a Google Sheet with a tab named `data` and the following columns [Example Google Sheet](https://docs.google.com/spreadsheets/d/1asLDGXnPA4K55RfLDGRkgQzOpnKezDoVibWgnGaGUJ0/edit?usp=sharing):\n   - `book_id`, `date`, `subject`, `to`, `attach`, `detail`, `signed_by`, `signed_by_position`, `contact_phone`, `contact_email`, `download_url`\n2. Set up required credentials:\n   - `googleDriveOAuth2Api`\n   - `googleSheetsOAuth2Api`\n   - `httpHeaderAuth` for LINE Messaging API\n   - `openAiApi`\n   - `mistralCloudApi`\n3. Define environment variables:\n   - `LINE_CHANNEL_ACCESS_TOKEN`\n   - `GDRIVE_INVOICE_FOLDER_ID`\n   - `GSHEET_ID`\n   - `MISTRAL_API_KEY`\n4. Deploy webhook to receive files from LINE Messaging API (Path: `/line-invoice`)\n5. Monitor Drive uploads using `Google Drive Trigger`\n\n---\n\n## How to Customize the Workflow\n\n- Adjust the **information extraction schema** in the OpenAI `Information Extractor` node to match your document layout\n- Add logic for different document types if you have more than one format\n- Modify the `LINE Reply` message format or use Flex Message\n- Update the `Move File` node if you want to archive to a different folder\n\n---\n\n## Requirements\n\n- n8n self-hosted or cloud instance\n- Google account with access to Drive and Sheets\n- LINE Developer Account\n- OpenAI API key\n- Mistral Cloud API key\n\n---\n\n## Notes\n\n- Community nodes used: `@n8n/n8n-nodes-base.mistralAi`\n- This workflow **supports both document images and PDF files**\n- File handling is done dynamically via MIME type",
  "featuredImage": "/data/workflows/6702/6702.webp",
  "author": {
    "id": 101,
    "slug": "jaruphatj",
    "name": "Jaruphat J.",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1402,
  "downloads": 140,
  "createdAt": "2025-07-30T15:02:54.622Z",
  "updatedAt": "2026-01-16T08:46:37.469Z",
  "publishedAt": "2025-07-30T15:02:54.622Z",
  "nodes": 29,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6702",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Extract data from Thai Government letters with Mistral OCR and store in Google Sheets",
    "workflowName": "Extract data from Thai Government letters with Mistral OCR and store in Google Sheets",
    "description": "### LINE OCR Workflow to Extract and Save Thai Government Letters to Google Sheets\n\nThis template automates the extraction of structured data from Thai government letters received via LINE or uploaded to Google Drive. It uses Mistral AI for OCR and OpenAI for information extraction, saving results to a Google Sheet.\n\n---\n\n## Who’s it for?\n\n- Thai government agencies or teams receiving official documents via LINE or Google Drive\n- Automation developers working with document intake and OCR\n- Anyone needing to extract fields from Thai scanned letters and store structured info\n\n---\n\n## What it does\n\nThis n8n workflow:\n1. **Receives documents** from two sources:\n   - LINE webhook (via Messaging API)\n   - Google Drive (new file trigger)\n2. **Checks file type** (PDF or image)\n3. **Runs OCR** with Mistral AI (Document or Image model)\n4. **Uses OpenAI** to extract key metadata such as:\n   - book_id\n   - subject\n   - recipient (to)\n   - signatory\n   - date, contact info, etc.\n5. **Stores structured data** in Google Sheets\n6. **Replies to LINE user** with extracted info or moves files into archive folders (Drive)\n\n---\n\n## How to Set It Up\n\n1. Create a Google Sheet with a tab named `data` and the following columns [Example Google Sheet](https://docs.google.com/spreadsheets/d/1asLDGXnPA4K55RfLDGRkgQzOpnKezDoVibWgnGaGUJ0/edit?usp=sharing):\n   - `book_id`, `date`, `subject`, `to`, `attach`, `detail`, `signed_by`, `signed_by_position`, `contact_phone`, `contact_email`, `download_url`\n2. Set up required credentials:\n   - `googleDriveOAuth2Api`\n   - `googleSheetsOAuth2Api`\n   - `httpHeaderAuth` for LINE Messaging API\n   - `openAiApi`\n   - `mistralCloudApi`\n3. Define environment variables:\n   - `LINE_CHANNEL_ACCESS_TOKEN`\n   - `GDRIVE_INVOICE_FOLDER_ID`\n   - `GSHEET_ID`\n   - `MISTRAL_API_KEY`\n4. Deploy webhook to receive files from LINE Messaging API (Path: `/line-invoice`)\n5. Monitor Drive uploads using `Google Drive Trigger`\n\n---\n\n## How to Customize the Workflow\n\n- Adjust the **information extraction schema** in the OpenAI `Information Extractor` node to match your document layout\n- Add logic for different document types if you have more than one format\n- Modify the `LINE Reply` message format or use Flex Message\n- Update the `Move File` node if you want to archive to a different folder\n\n---\n\n## Requirements\n\n- n8n self-hosted or cloud instance\n- Google account with access to Drive and Sheets\n- LINE Developer Account\n- OpenAI API key\n- Mistral Cloud API key\n\n---\n\n## Notes\n\n- Community nodes used: `@n8n/n8n-nodes-base.mistralAi`\n- This workflow **supports both document images and PDF files**\n- File handling is done dynamically via MIME type",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "LINE Webhook",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Get Line File",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Set Line Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Download File (Drive)",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Merge Data Sources",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Check File Type",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Write to Google Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.4"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Reply to LINE",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Check Source for Reply",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "role": "informationExtractor",
      "configDescription": "Version 1.2"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Set Drive Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Move file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract text IMG",
      "type": "n8n-nodes-base.mistralAi",
      "role": "mistralAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract text PDF",
      "type": "n8n-nodes-base.mistralAi",
      "role": "mistralAi",
      "configDescription": "Version 1"
    }
  ]
}