{
  "id": 7652,
  "slug": "7652",
  "title": "Estimate Construction Costs from Revit/IFC Models with GPT-4 and Claude",
  "description": "\nEstimate **material price** and **total cost** for grouped BIM/CAD elements using an **LLM-driven** analysis. The workflow accepts an existing **XLSX** (from your model) or, if missing, can trigger a local **RvtExporter.exe** to generate one. It enriches each element group with quantities, pricing, confidence, and produces a **multi-sheet Excel** report plus a polished **HTML executive report**.\n\n## What it does\n- **Reads grouped element data** (from XLSX or extracted via `RvtExporter.exe`).\n- Builds **enhanced prompts** with clear rules (volumes/areas are already aggregated per group).\n- Calls your selected **LLM** (OpenAI/Anthropic/etc.) to identify materials, pick the pricing unit, and estimate **price per unit** and **total cost**.\n- **Parses AI output**, adds per-group KPIs (cost %, rank), and aggregates **project totals** (by material, by category).\n- Exports a **multi-sheet XLSX** and an **HTML executive report** (charts, KPIs, top groups).\n\n## Prerequisites\n- **LLM credentials** for your chosen provider (e.g., OpenAI, Anthropic). Enable exactly one chat node and connect credentials.\n- **Windows host** only if you want to auto-extract from `.rvt/.ifc` via `RvtExporter.exe`. If you already have an XLSX, Windows is **not required**.\n- Optional: Internet access on the LLM side for price lookups (model/tooling dependent).\n\n## How to use\n1. **Import** this JSON into n8n.\n2. Open the **Setup** node(s) and set:\n   - `project_file` — path to your `.rvt/.ifc` or to an existing grouped `*_rvt.xlsx`\n   - `path_to_converter` — `C:\\\\DDC_Converter_Revit\\\\datadrivenlibs\\\\RvtExporter.exe` (optional)\n   - `country` — used to guide price sources/standards (e.g., `Germany`)\n3. In the canvas, **enable one LLM node** (e.g., OpenAI or Anthropic) and connect credentials; keep others disabled.\n4. **Execute workflow** (Manual Trigger). It will detect/build the XLSX, run analysis, then write the **Excel** and open the **HTML** report.\n\n## Outputs\n- **Excel**: `Price_Estimation_Report_YYYY-MM-DD.xlsx` with sheets:\n  - `Summary`, `Detailed Elements`, `Material Summary`, `Top 10 Groups`\n- **HTML**: executive report with charts (project totals, top materials, top groups).\n- Per-group fields include: *Material (EU/DE/US), Quantity & Unit, Price per Unit (EUR), Total Cost (EUR), Assumptions, Confidence*.\n\n## Notes & tips\n- Quantities in the input are **already aggregated per group** — do **not** multiply by element count.\n- If you prefer XLSX-only extraction, run your converter with a `-no-collada` flag upstream.\n- Keep ASCII-safe paths and ensure write permissions to the output folder.\n\n## Categories\nData Extraction · Files & Storage · ETL · CAD/BIM · Cost Estimation\n\n## Tags\n`cad-bim`, `price-estimation`, `cost`, `revit`, `ifc`, `xlsx`, `html-report`, `llm`, `materials`, `qto`\n\n## Author\n [DataDrivenConstruction.io ](https://DataDrivenConstruction.io )\n [info@datadrivenconstruction.io](mailto:info@datadrivenconstruction.io)\n\n## Consulting and Training\nWe work with leading construction, engineering, consulting agencies and technology firms around the world to help them implement open data principles, automate CAD/BIM processing and build robust ETL pipelines.\n\nIf you would like to test this solution with your own data, or are interested in adapting the workflow to real project tasks, feel free to contact us.\n\n\n**Docs & Issues:**  \n  [Full Readme on GitHub](https://github.com/datadrivenconstruction/cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto)",
  "featuredImage": "/data/workflows/7652/7652.webp",
  "author": {
    "id": 101,
    "slug": "datadrivenconstruction",
    "name": "Artem Boiko",
    "avatar": ""
  },
  "categories": [
    "AI Summarization",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 912,
  "downloads": 91,
  "createdAt": "2025-08-20T15:27:19.523Z",
  "updatedAt": "2026-01-16T08:51:37.672Z",
  "publishedAt": "2025-08-20T15:27:19.523Z",
  "nodes": 57,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7652",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Estimate Construction Costs from Revit/IFC Models with GPT-4 and Claude",
    "workflowName": "Estimate Construction Costs from Revit/IFC Models with GPT-4 and Claude",
    "description": "Estimate **material price** and **total cost** for grouped BIM/CAD elements using an **LLM-driven** analysis. The workflow accepts an existing **XLSX** (from your model) or, if missing, can trigger a local **RvtExporter.exe** to generate one. It enriches each element group with quantities, pricing, confidence, and produces a **multi-sheet Excel** report plus a polished **HTML executive report**.\n\n## What it does\n- **Reads grouped element data** (from XLSX or extracted via `RvtExporter.exe`).\n- Builds **enhanced prompts** with clear rules (volumes/areas are already aggregated per group).\n- Calls your selected **LLM** (OpenAI/Anthropic/etc.) to identify materials, pick the pricing unit, and estimate **price per unit** and **total cost**.\n- **Parses AI output**, adds per-group KPIs (cost %, rank), and aggregates **project totals** (by material, by category).\n- Exports a **multi-sheet XLSX** and an **HTML executive report** (charts, KPIs, top groups).\n\n## Prerequisites\n- **LLM credentials** for your chosen provider (e.g., OpenAI, Anthropic). Enable exactly one chat node and connect credentials.\n- **Windows host** only if you want to auto-extract from `.rvt/.ifc` via `RvtExporter.exe`. If you already have an XLSX, Windows is **not required**.\n- Optional: Internet access on the LLM side for price lookups (model/tooling dependent).\n\n## How to use\n1. **Import** this JSON into n8n.\n2. Open the **Setup** node(s) and set:\n   - `project_file` — path to your `.rvt/.ifc` or to an existing grouped `*_rvt.xlsx`\n   - `path_to_converter` — `C:\\\\DDC_Converter_Revit\\\\datadrivenlibs\\\\RvtExporter.exe` (optional)\n   - `country` — used to guide price sources/standards (e.g., `Germany`)\n3. In the canvas, **enable one LLM node** (e.g., OpenAI or Anthropic) and connect credentials; keep others disabled.\n4. **Execute workflow** (Manual Trigger). It will detect/build the XLSX, run analysis, then write the **Excel** and open the **HTML** report.\n\n## Outputs\n- **Excel**: `Price_Estimation_Report_YYYY-MM-DD.xlsx` with sheets:\n  - `Summary`, `Detailed Elements`, `Material Summary`, `Top 10 Groups`\n- **HTML**: executive report with charts (project totals, top materials, top groups).\n- Per-group fields include: *Material (EU/DE/US), Quantity & Unit, Price per Unit (EUR), Total Cost (EUR), Assumptions, Confidence*.\n\n## Notes & tips\n- Quantities in the input are **already aggregated per group** — do **not** multiply by element count.\n- If you prefer XLSX-only extraction, run your converter with a `-no-collada` flag upstream.\n- Keep ASCII-safe paths and ensure write permissions to the output folder.\n\n## Categories\nData Extraction · Files & Storage · ETL · CAD/BIM · Cost Estimation\n\n## Tags\n`cad-bim`, `price-estimation`, `cost`, `revit`, `ifc`, `xlsx`, `html-report`, `llm`, `materials`, `qto`\n\n## Author\n [DataDrivenConstruction.io ](https://DataDrivenConstruction.io )\n [info@datadrivenconstruction.io](mailto:info@datadrivenconstruction.io)\n\n## Consulting and Training\nWe work with leading construction, engineering, consulting agencies and technology firms around the world to help them implement open data principles, automate CAD/BIM processing and build robust ETL pipelines.\n\nIf you would like to test this solution with your own data, or are interested in adapting the workflow to real project tasks, feel free to contact us.\n\n\n**Docs & Issues:**  \n  [Full Readme on GitHub](https://github.com/datadrivenconstruction/cad2data-Revit-IFC-DWG-DGN-pipeline-with-conversion-validation-qto)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Find Category Fields1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Apply Classification to Groups1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Non-Building Elements Output1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "AI Classify Categories1",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Is Building Element1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 1"
    },
    {
      "name": "Check If All Batches Done",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Collect All Results",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Process in Batches1",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 1"
    },
    {
      "name": "Clean Empty Values1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Agent Enhanced",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.7"
    },
    {
      "name": "Accumulate Results",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Anthropic Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "role": "lmChatAnthropic",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Calculate Project Totals1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Enhance Excel Output",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Prepare Excel Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create Excel File",
      "type": "n8n-nodes-base.spreadsheetFile",
      "role": "spreadsheetFile",
      "configDescription": "Version 2"
    },
    {
      "name": "Prepare Enhanced Prompts",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Parse Enhanced Response",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Generate HTML Report",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Convert to Binary",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Group Data with AI Rules1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Extract Headers and Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Analyze All Headers",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Read Excel File1",
      "type": "n8n-nodes-base.readBinaryFile",
      "role": "readBinaryFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Parse Excel1",
      "type": "n8n-nodes-base.spreadsheetFile",
      "role": "spreadsheetFile",
      "configDescription": "Version 2"
    },
    {
      "name": "Create - Excel filename1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Check - Does Excel file exist?1",
      "type": "n8n-nodes-base.readBinaryFile",
      "role": "readBinaryFile",
      "configDescription": "Version 1"
    },
    {
      "name": "If - File exists?1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Extract - Run converter1",
      "type": "n8n-nodes-base.executeCommand",
      "role": "executeCommand",
      "configDescription": "Version 1"
    },
    {
      "name": "Info - Skip conversion1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Check - Did extraction succeed?1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "Error - Show what went wrong1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set xlsx_filename after success1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Merge - Continue workflow1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3"
    },
    {
      "name": "Set Parameters1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Process AI Response1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Price Analysis and Reporting Block1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Element Classification Block",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Material Analysis Block",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Conversion Block",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Data Loading Block1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Important Notes",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Prepare HTML Path",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Write HTML to Project Folder",
      "type": "n8n-nodes-base.writeBinaryFile",
      "role": "writeBinaryFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Open HTML in Browser",
      "type": "n8n-nodes-base.executeCommand",
      "role": "executeCommand",
      "configDescription": "Version 1"
    },
    {
      "name": "Prepare Excel Path1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Write Excel to Project Folder1",
      "type": "n8n-nodes-base.writeBinaryFile",
      "role": "writeBinaryFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Setup - Define file paths",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Conversion Block1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Setup Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "xAI Grok Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatXAiGrok",
      "role": "lmChatXAiGrok",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "On the standard 3D View",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 1"
    },
    {
      "name": "Non-3D View Elements Output",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    }
  ]
}