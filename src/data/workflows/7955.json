{
  "id": 7955,
  "slug": "7955",
  "title": "Create multi-sheet Excel workbooks by merging datasets with Google Drive & Sheets",
  "description": "### Create multi-sheet Excel workbooks in n8n to automate reporting using Google Drive + Google Sheets\n\nBuild an automated Excel file with **multiple tabs** directly in n8n. Two Code nodes generate datasets, each is converted into its own Excel **worksheet**, then combined into a single `.xlsx` and (optionally) appended to a Google Sheet for sharing‚Äîeliminating manual copy-paste and speeding up reporting.\n\n## Who‚Äôs it for\n- Teams that publish recurring reports as Excel with **multiple tabs**\n- Ops/Marketing/Data folks who want a **no-code/low-code** way to package JSON into Excel\n- n8n beginners learning the **Code ‚Üí Convert to File ‚Üí Merge** pattern\n\n## How it works\n1. **Manual Trigger** starts the run.  \n2. **Code** nodes emit JSON rows for each table (e.g., People, Locations).  \n3. **Convert to File** nodes turn each JSON list into an Excel binary, assigning **Sheet1/Sheet2** (or your names).  \n4. **Merge** combines both binaries into a single Excel workbook with **multiple tabs**.  \n5. **Google Sheets (optional)** appends the JSON rows to a live spreadsheet for collaboration.\n\n## Setup (only 2 connections)\n\n### 1Ô∏è‚É£ Connect Google Sheets (OAuth2)\n1. In **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Sheets (OAuth2)**  \n2. Sign in with your Google account and grant access  \n3. **Copy the example sheet referenced in the Google Sheets node** (open the node and duplicate the linked sheet), or select your own  \n4. In the workflow‚Äôs **Google Sheets** node, select your **Spreadsheet** and **Worksheet**\n\nhttps://docs.google.com/spreadsheets/d/1G6FSm3VdMZt6VubM6g8j0mFw59iEw9npJE0upxj3Y6k/edit?gid=1978181834#gid=1978181834\n\n\n### 2Ô∏è‚É£ Connect Google Drive (OAuth2)\n1. In **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Drive (OAuth2)**  \n2. Sign in with the Google account that will store your Excel outputs and **allow access**  \n3. In your Drive-related nodes (if used), point to the **folder** where you want the `.xlsx` saved or retrieved\n\n## Customize the workflow\n- Replace the sample arrays in the **Code** nodes with your data (APIs, DBs, CSVs, etc.)  \n- Rename **sheetName** in each **Convert to File** node to match your desired tab names  \n- Keep the **Merge** node in **Combine All** mode to produce a single workbook  \n- In **Google Sheets**, switch to **Manual mapping** for strict column order (optional)\n\n## Best practices (per template guidelines)\n- **Rename nodes** to clear, action-oriented names (e.g., ‚ÄúBuild People Sheet‚Äù, ‚ÄúBuild Locations Sheet‚Äù)  \n- Add a **yellow Sticky Note** at the top with this description so users see setup in-workflow  \n- **Do not hardcode credentials** inside HTTP nodes; always use n8n Credentials  \n- Remove personal IDs/links before publishing\n\n## Sticky Note (copy-paste)\n&gt; **Multi-Tab Excel Builder (Google Drive + Google Sheets)**  \n&gt; This workflow generates two datasets (Code ‚Üí JSON), converts each to an Excel sheet, merges them into a **single workbook with multiple tabs**, and optionally appends rows to Google Sheets.  \n&gt;  \n&gt; **Setup (2 connections):**  \n&gt; 1) **Google Sheets (OAuth2):** Create credentials ‚Üí duplicate/select your target spreadsheet ‚Üí set Spreadsheet + Worksheet in the node.  \n&gt; 2) **Google Drive (OAuth2):** Create credentials ‚Üí choose the folder for storing/retrieving the `.xlsx`.  \n&gt;  \n&gt; **Customize:** Edit the Code nodes‚Äô arrays, rename tab names in Convert to File, and adjust the Sheets node mapping as needed.\n\n## Troubleshooting\n- **Missing columns / wrong order:** Use **Manual mapping** in the Google Sheets node  \n- **Binary not found:** Ensure each **Convert to File** node‚Äôs `binaryPropertyName` matches what **Merge** expects  \n- **Permissions errors:** Re-authorize Google credentials; confirm you have edit access to the target Sheet/Drive folder\n\n## üì¨ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your PDF)?  \n\n- üìß **rbreen@ynteractive.com**  \n- üîó **https://www.linkedin.com/in/robert-breen-29429625/**  \n- üåê **https://ynteractive.com**\n",
  "featuredImage": "/data/workflows/7955/7955.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 513,
  "downloads": 51,
  "createdAt": "2025-08-27T14:58:30.397Z",
  "updatedAt": "2026-01-16T08:53:13.421Z",
  "publishedAt": "2025-08-27T14:58:30.397Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7955",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Create multi-sheet Excel workbooks by merging datasets with Google Drive & Sheets",
    "workflowName": "Create multi-sheet Excel workbooks by merging datasets with Google Drive & Sheets",
    "description": "### Create multi-sheet Excel workbooks in n8n to automate reporting using Google Drive + Google Sheets\n\nBuild an automated Excel file with **multiple tabs** directly in n8n. Two Code nodes generate datasets, each is converted into its own Excel **worksheet**, then combined into a single `.xlsx` and (optionally) appended to a Google Sheet for sharing‚Äîeliminating manual copy-paste and speeding up reporting.\n\n## Who‚Äôs it for\n- Teams that publish recurring reports as Excel with **multiple tabs**\n- Ops/Marketing/Data folks who want a **no-code/low-code** way to package JSON into Excel\n- n8n beginners learning the **Code ‚Üí Convert to File ‚Üí Merge** pattern\n\n## How it works\n1. **Manual Trigger** starts the run.  \n2. **Code** nodes emit JSON rows for each table (e.g., People, Locations).  \n3. **Convert to File** nodes turn each JSON list into an Excel binary, assigning **Sheet1/Sheet2** (or your names).  \n4. **Merge** combines both binaries into a single Excel workbook with **multiple tabs**.  \n5. **Google Sheets (optional)** appends the JSON rows to a live spreadsheet for collaboration.\n\n## Setup (only 2 connections)\n\n### 1Ô∏è‚É£ Connect Google Sheets (OAuth2)\n1. In **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Sheets (OAuth2)**  \n2. Sign in with your Google account and grant access  \n3. **Copy the example sheet referenced in the Google Sheets node** (open the node and duplicate the linked sheet), or select your own  \n4. In the workflow‚Äôs **Google Sheets** node, select your **Spreadsheet** and **Worksheet**\n\nhttps://docs.google.com/spreadsheets/d/1G6FSm3VdMZt6VubM6g8j0mFw59iEw9npJE0upxj3Y6k/edit?gid=1978181834#gid=1978181834\n\n\n### 2Ô∏è‚É£ Connect Google Drive (OAuth2)\n1. In **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Drive (OAuth2)**  \n2. Sign in with the Google account that will store your Excel outputs and **allow access**  \n3. In your Drive-related nodes (if used), point to the **folder** where you want the `.xlsx` saved or retrieved\n\n## Customize the workflow\n- Replace the sample arrays in the **Code** nodes with your data (APIs, DBs, CSVs, etc.)  \n- Rename **sheetName** in each **Convert to File** node to match your desired tab names  \n- Keep the **Merge** node in **Combine All** mode to produce a single workbook  \n- In **Google Sheets**, switch to **Manual mapping** for strict column order (optional)\n\n## Best practices (per template guidelines)\n- **Rename nodes** to clear, action-oriented names (e.g., ‚ÄúBuild People Sheet‚Äù, ‚ÄúBuild Locations Sheet‚Äù)  \n- Add a **yellow Sticky Note** at the top with this description so users see setup in-workflow  \n- **Do not hardcode credentials** inside HTTP nodes; always use n8n Credentials  \n- Remove personal IDs/links before publishing\n\n## Sticky Note (copy-paste)\n&gt; **Multi-Tab Excel Builder (Google Drive + Google Sheets)**  \n&gt; This workflow generates two datasets (Code ‚Üí JSON), converts each to an Excel sheet, merges them into a **single workbook with multiple tabs**, and optionally appends rows to Google Sheets.  \n&gt;  \n&gt; **Setup (2 connections):**  \n&gt; 1) **Google Sheets (OAuth2):** Create credentials ‚Üí duplicate/select your target spreadsheet ‚Üí set Spreadsheet + Worksheet in the node.  \n&gt; 2) **Google Drive (OAuth2):** Create credentials ‚Üí choose the folder for storing/retrieving the `.xlsx`.  \n&gt;  \n&gt; **Customize:** Edit the Code nodes‚Äô arrays, rename tab names in Convert to File, and adjust the Sheets node mapping as needed.\n\n## Troubleshooting\n- **Missing columns / wrong order:** Use **Manual mapping** in the Google Sheets node  \n- **Binary not found:** Ensure each **Convert to File** node‚Äôs `binaryPropertyName` matches what **Merge** expects  \n- **Permissions errors:** Re-authorize Google credentials; confirm you have edit access to the target Sheet/Drive folder\n\n## üì¨ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your PDF)?  \n\n- üìß **rbreen@ynteractive.com**  \n- üîó **https://www.linkedin.com/in/robert-breen-29429625/**  \n- üåê **https://ynteractive.com**",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòExecute workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Convert to File1",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Sticky Note60",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note62",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note54",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Data Set 1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Data Set 2",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Save to google sheets",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Export Excel file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    }
  ]
}