{
  "id": 9439,
  "slug": "9439",
  "title": "Automated invoice processing & filing with IMAP, AI, Google Drive & DateV",
  "description": "## This n8n template demonstrates how to automatically process incoming invoice emails using AI to extract structured data, organize files in Google Drive, log everything in Google Sheets, and forward to your accounting system, completely hands-free.\nUse cases are many: Perfect for freelancers managing client invoices, small businesses handling supplier bills, accounting departments processing high invoice volumes, or anyone who wants to eliminate manual data entry and maintain a perfectly organized invoice archive!\n\n### Good to know\n- The AI extraction works with most standard invoice formats but may require prompt adjustments for unusual layouts.\n- Ensure your IMAP email account allows external app connections and has sufficient storage for the archive folder.\n- Google Drive folder structure is automatically created if it doesn't exist yet.\n\n### How it works\n- The IMAP Email trigger monitors your inbox for new messages with attachments.\nJavaScript splits multiple attachments into separate items, ensuring each invoice is processed individually.\nPDF text extraction reads the content from each invoice file.\n- An AI model (like OpenAI or Gemini) analyzes the extracted text and identifies key fields: company name, invoice number, date, amount, VAT, and more.\n- Additional date metadata is generated (month, year, formatted dates) for smart categorization.\n- The invoice PDF is uploaded to a temporary \"Incoming Files\" folder on Google Drive for safe processing.\n- The workflow searches for or creates the correct monthly folder (e.g., \"Invoices / October 2025\") in your Drive structure.\nThe invoice is moved to the final destination with a clean, standardized filename: 2025-10-02_Company-Name_InvoiceNumber.pdf.\n- All extracted data is logged to Google Sheets for easy tracking, reporting, and audit trails.\n- The finalized invoice is forwarded to your DateV accounting email inbox.\n- The original email is automatically moved to an archive folder, keeping your inbox clean and organized.\n\n### How to use\n- The IMAP trigger is configured for continuous monitoring, but you can adjust the polling interval based on your needs.\n- Customize the AI prompt to match your specific invoice formats or extract additional fields relevant to your business.\n- The folder structure on Google Drive can be modified to match your existing organization system.\n\n### Requirements\n- IMAP-enabled email account (Gmail, Outlook, or any email provider supporting IMAP)\n- Google Drive account for file storage\n- Google Sheets for invoice logging\n- AI model access (OpenAI, Gemini, or compatible LLM for data extraction)\n- DateV email address (or replace with your preferred accounting system)\n\n### Customising this workflow\n- Replace the DateV email step with integrations to other accounting platforms like Xero, QuickBooks, or Lexoffice.\n- Add conditional logic to route different invoice types to different folders or sheets.\n- Extend the AI extraction to include line items, payment terms, or custom fields specific to your industry.\n- Connect additional notifications via Slack, Teams, or SMS when high-value invoices are received.\n\nDisclaimer: The node to move the e-mail is a community-node, so it’s only for self-hosting. ",
  "featuredImage": "/data/workflows/9439/9439.webp",
  "author": {
    "id": 101,
    "slug": "janzaiser",
    "name": "Jan Zaiser",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 584,
  "downloads": 58,
  "createdAt": "2025-10-09T19:37:39.554Z",
  "updatedAt": "2026-01-16T09:00:31.884Z",
  "publishedAt": "2025-10-09T19:37:39.554Z",
  "nodes": 23,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9439",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated invoice processing & filing with IMAP, AI, Google Drive & DateV",
    "workflowName": "Automated invoice processing & filing with IMAP, AI, Google Drive & DateV",
    "description": "## This n8n template demonstrates how to automatically process incoming invoice emails using AI to extract structured data, organize files in Google Drive, log everything in Google Sheets, and forward to your accounting system, completely hands-free.\nUse cases are many: Perfect for freelancers managing client invoices, small businesses handling supplier bills, accounting departments processing high invoice volumes, or anyone who wants to eliminate manual data entry and maintain a perfectly organized invoice archive!\n\n### Good to know\n- The AI extraction works with most standard invoice formats but may require prompt adjustments for unusual layouts.\n- Ensure your IMAP email account allows external app connections and has sufficient storage for the archive folder.\n- Google Drive folder structure is automatically created if it doesn't exist yet.\n\n### How it works\n- The IMAP Email trigger monitors your inbox for new messages with attachments.\nJavaScript splits multiple attachments into separate items, ensuring each invoice is processed individually.\nPDF text extraction reads the content from each invoice file.\n- An AI model (like OpenAI or Gemini) analyzes the extracted text and identifies key fields: company name, invoice number, date, amount, VAT, and more.\n- Additional date metadata is generated (month, year, formatted dates) for smart categorization.\n- The invoice PDF is uploaded to a temporary \"Incoming Files\" folder on Google Drive for safe processing.\n- The workflow searches for or creates the correct monthly folder (e.g., \"Invoices / October 2025\") in your Drive structure.\nThe invoice is moved to the final destination with a clean, standardized filename: 2025-10-02_Company-Name_InvoiceNumber.pdf.\n- All extracted data is logged to Google Sheets for easy tracking, reporting, and audit trails.\n- The finalized invoice is forwarded to your DateV accounting email inbox.\n- The original email is automatically moved to an archive folder, keeping your inbox clean and organized.\n\n### How to use\n- The IMAP trigger is configured for continuous monitoring, but you can adjust the polling interval based on your needs.\n- Customize the AI prompt to match your specific invoice formats or extract additional fields relevant to your business.\n- The folder structure on Google Drive can be modified to match your existing organization system.\n\n### Requirements\n- IMAP-enabled email account (Gmail, Outlook, or any email provider supporting IMAP)\n- Google Drive account for file storage\n- Google Sheets for invoice logging\n- AI model access (OpenAI, Gemini, or compatible LLM for data extraction)\n- DateV email address (or replace with your preferred accounting system)\n\n### Customising this workflow\n- Replace the DateV email step with integrations to other accounting platforms like Xero, QuickBooks, or Lexoffice.\n- Add conditional logic to route different invoice types to different folders or sheets.\n- Extend the AI extraction to include line items, payment terms, or custom fields specific to your industry.\n- Connect additional notifications via Slack, Teams, or SMS when high-value invoices are received.\n\nDisclaimer: The node to move the e-mail is a community-node, so it’s only for self-hosting.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Extract From PDF",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Extract & Format Data",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "role": "openAi",
      "configDescription": "Version 1.8"
    },
    {
      "name": "Get Additional Date Data",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Search Month Folder",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Email Trigger (IMAP)",
      "type": "n8n-nodes-base.emailReadImap",
      "role": "emailReadImap",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Send to DateV",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    },
    {
      "name": "MoveEmail email",
      "type": "n8n-nodes-imap.imap",
      "role": "imap",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Download file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Download file1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Download file2",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Download file3",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Upload file1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}