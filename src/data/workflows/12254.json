{
  "id": 12254,
  "slug": "12254",
  "title": "Monitor customer risk and AI feedback using PostgreSQL, Gmail and Discord",
  "description": "## How it works\nThis workflow monitors customer health by combining payment behavior, complaint signals, and AI-driven feedback analysis. It runs on daily and weekly schedules to evaluate risk levels, escalate high-risk customers, and generate structured product insights. High-risk cases are notified instantly, while detailed feedback and audit logs are stored for long-term analysis.\n\n## Step-by-step\n- **Step 1: Triggers & mode selection**\n  - **Daily Risk Check Trigger** – Starts the workflow on a daily schedule.\n  - **Weekly schedule1** – Triggers the workflow for weekly summary runs.\n  - **Edit Fields3** – Sets flags for daily execution.\n  - **Edit Fields2** – Sets flags for weekly execution.\n  - **Switch1** – Routes execution based on daily or weekly mode.\n\n- **Step 2: Risk evaluation & escalation**\n  - **Fetch Customer Risk Data** – Pulls customer, payment, product, and complaint data from PostgreSQL.\n  - **Is High Risk Customer?** – Evaluates payment status and complaint count.\n  - **Prepare Escalation Summary For Low Risk User** – Assigns low-risk status and no-action details.\n  - **Prepare Escalation Summary For High Risk User** – Assigns high-risk status and escalation actions.\n  - **Merge Risk Result** – Combines low-risk and high-risk customer records.\n  - **Send a message4** – Sends the customer risk summary via Gmail.\n  - **Send a message5** – Sends the same risk summary to Discord.\n  - **Code in JavaScript3** – Appends notification status and timestamps.\n  - **Append or update row in sheet3** – Logs risk evaluations and notification status in Google Sheets.\n\n- **Step 3: AI feedback & reporting**\n  - **Get row(s) in sheet1** – Fetches customer records for feedback analysis.\n  - **Loop Over Items1** – Processes customers one by one.\n  - **Prompt For Model1** – Builds a structured prompt for product feedback analysis.\n  - **HTTP Request1** – Sends data to the AI model for insight generation.\n  - **Code in JavaScript** – Merges AI feedback with original customer data.\n  - **Append or update row in sheet** – Stores AI-generated feedback in Google Sheets.\n  - **Wait1** – Controls execution pacing between records.\n  - **Merge1** – Prepares consolidated feedback data.\n  - **Send a message1** – Emails the final AI-powered feedback report.\n\n## Why use this?\n- Detect customer churn risk early using payment and complaint signals  \n- Automatically escalate high-risk customers without manual monitoring  \n- Convert raw customer issues into executive-ready product insights  \n- Keep a complete audit trail of risk, feedback, and notifications  \n- Align support, product, and leadership teams with shared visibility  \n",
  "featuredImage": "/data/workflows/12254/12254.webp",
  "author": {
    "id": 101,
    "slug": "itechnotion",
    "name": "Avkash Kakdiya",
    "avatar": ""
  },
  "categories": [
    "Market Research",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 4,
  "downloads": 0,
  "createdAt": "2025-12-29T07:27:13.537Z",
  "updatedAt": "2026-01-16T09:11:52.866Z",
  "publishedAt": "2025-12-29T07:27:13.537Z",
  "nodes": 27,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/12254",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Monitor customer risk and AI feedback using PostgreSQL, Gmail and Discord",
    "workflowName": "Monitor customer risk and AI feedback using PostgreSQL, Gmail and Discord",
    "description": "## How it works\nThis workflow monitors customer health by combining payment behavior, complaint signals, and AI-driven feedback analysis. It runs on daily and weekly schedules to evaluate risk levels, escalate high-risk customers, and generate structured product insights. High-risk cases are notified instantly, while detailed feedback and audit logs are stored for long-term analysis.\n\n## Step-by-step\n- **Step 1: Triggers & mode selection**\n  - **Daily Risk Check Trigger** – Starts the workflow on a daily schedule.\n  - **Weekly schedule1** – Triggers the workflow for weekly summary runs.\n  - **Edit Fields3** – Sets flags for daily execution.\n  - **Edit Fields2** – Sets flags for weekly execution.\n  - **Switch1** – Routes execution based on daily or weekly mode.\n\n- **Step 2: Risk evaluation & escalation**\n  - **Fetch Customer Risk Data** – Pulls customer, payment, product, and complaint data from PostgreSQL.\n  - **Is High Risk Customer?** – Evaluates payment status and complaint count.\n  - **Prepare Escalation Summary For Low Risk User** – Assigns low-risk status and no-action details.\n  - **Prepare Escalation Summary For High Risk User** – Assigns high-risk status and escalation actions.\n  - **Merge Risk Result** – Combines low-risk and high-risk customer records.\n  - **Send a message4** – Sends the customer risk summary via Gmail.\n  - **Send a message5** – Sends the same risk summary to Discord.\n  - **Code in JavaScript3** – Appends notification status and timestamps.\n  - **Append or update row in sheet3** – Logs risk evaluations and notification status in Google Sheets.\n\n- **Step 3: AI feedback & reporting**\n  - **Get row(s) in sheet1** – Fetches customer records for feedback analysis.\n  - **Loop Over Items1** – Processes customers one by one.\n  - **Prompt For Model1** – Builds a structured prompt for product feedback analysis.\n  - **HTTP Request1** – Sends data to the AI model for insight generation.\n  - **Code in JavaScript** – Merges AI feedback with original customer data.\n  - **Append or update row in sheet** – Stores AI-generated feedback in Google Sheets.\n  - **Wait1** – Controls execution pacing between records.\n  - **Merge1** – Prepares consolidated feedback data.\n  - **Send a message1** – Emails the final AI-powered feedback report.\n\n## Why use this?\n- Detect customer churn risk early using payment and complaint signals  \n- Automatically escalate high-risk customers without manual monitoring  \n- Convert raw customer issues into executive-ready product insights  \n- Keep a complete audit trail of risk, feedback, and notifications  \n- Align support, product, and leadership teams with shared visibility",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Get row(s) in sheet1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "HTTP Request1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Prompt For Model1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Send a message1",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Loop Over Items1",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Wait1",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Append or update row in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Weekly schedule1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Edit Fields2",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Switch1",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Edit Fields3",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Fetch Customer Risk Data",
      "type": "n8n-nodes-base.postgres",
      "role": "postgres",
      "configDescription": "Version 2.6"
    },
    {
      "name": "Is High Risk Customer?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Send a message4",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Merge Risk Result",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Prepare Escalation Summary For Low Risk User",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Prepare Escalation Summary For High Risk User",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Code in JavaScript3",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Append or update row in sheet3",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.7"
    },
    {
      "name": "Send a message5",
      "type": "n8n-nodes-base.discord",
      "role": "discord",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Daily Risk Check Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}