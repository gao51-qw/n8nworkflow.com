{
  "id": 12399,
  "slug": "12399",
  "title": "Email reports on expiring Microsoft Entra ID app secrets and certificates with Microsoft Graph",
  "description": "\n## Monitor expiring EntraID application secrets and notify responsible\n\nStay ahead of credential expirations by automatically detecting Entra ID application client secrets and certificates that are about to expire, and sending a neatly formatted email report.\n\n### What this workflow solves\n\nExpired client secrets and certificates are a common cause of unexpected outages and failed integrations. Manually checking expiration dates across many Entra ID applications is tedious and easy to miss. This workflow automates the discovery and reporting of credentials that will expire within a configurable time window.\n\n### Key features\n\n-   Fetches all **Microsoft Entra ID applications** along with:\n    \n    -   **Client secrets** (`passwordCredentials`)\n        \n    -   **Certificates** (`keyCredentials`)\n        \n-   Splits credentials into individual entries for easier processing\n    \n-   Filters credentials expiring **within the next _N_ days** (configurable)\n    \n-   Normalizes results into a consistent structure including:\n    \n    -   Application name\n        \n    -   App ID\n        \n    -   Credential type (Client Secret / Certificate)\n        \n    -   Credential name + ID\n        \n    -   Days remaining until expiration\n        \n-   Generates an **HTML table report**, sorted by application name\n    \n-   Sends an email **only when expiring items are found** (otherwise does nothing)\n    \n\n### How it works\n\n1. Fetches all Entra ID applications and their credential metadata via Microsoft Graph  \n2. Separates client secrets and certificates into individual entries  \n3. Filters entries that expire within the configured time window  \n4. Builds a normalized list of expiring items with days remaining  \n5. Emails an HTML table report (only if results exist)    \n\n### Setup requirements\n\n-   **Microsoft Entra ID app registration** with Microsoft Graph **Application permissions**:\n    \n    -   `Application.Read.All`\n        \n-   In n8n:\n    \n    -   Create **Microsoft Graph OAuth2** credentials (Client Credentials flow recommended)\n        \n    -   Assign those credentials to the **Get EntraID Applications and Secrets** HTTP Request node\n        \n-   Update the **Set Variables** node:\n    \n    -   `notificationEmail`: where to send the report\n        \n    -   `daysBeforeExpiry`: alert window in days (e.g., 14)\n        \n\n### Notes\n\n-   The email table highlights soon-to-expire credentials more prominently (based on remaining days).\n    \n-   For automation, replace the manual trigger with a **Schedule Trigger** (e.g., daily/weekly).\n    \n-   The workflow accesses **metadata only** (names/IDs/expiry), not secret values.",
  "featuredImage": "/data/workflows/12399/12399.webp",
  "author": {
    "id": 101,
    "slug": "alexschnabl",
    "name": "Alexander Schnabl",
    "avatar": ""
  },
  "categories": [
    "DevOps"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 117,
  "downloads": 11,
  "createdAt": "2026-01-02T14:17:39.276Z",
  "updatedAt": "2026-01-16T09:12:24.400Z",
  "publishedAt": "2026-01-02T14:17:39.276Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/12399",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Email reports on expiring Microsoft Entra ID app secrets and certificates with Microsoft Graph",
    "workflowName": "Email reports on expiring Microsoft Entra ID app secrets and certificates with Microsoft Graph",
    "description": "## Monitor expiring EntraID application secrets and notify responsible\n\nStay ahead of credential expirations by automatically detecting Entra ID application client secrets and certificates that are about to expire, and sending a neatly formatted email report.\n\n### What this workflow solves\n\nExpired client secrets and certificates are a common cause of unexpected outages and failed integrations. Manually checking expiration dates across many Entra ID applications is tedious and easy to miss. This workflow automates the discovery and reporting of credentials that will expire within a configurable time window.\n\n### Key features\n\n-   Fetches all **Microsoft Entra ID applications** along with:\n    \n    -   **Client secrets** (`passwordCredentials`)\n        \n    -   **Certificates** (`keyCredentials`)\n        \n-   Splits credentials into individual entries for easier processing\n    \n-   Filters credentials expiring **within the next _N_ days** (configurable)\n    \n-   Normalizes results into a consistent structure including:\n    \n    -   Application name\n        \n    -   App ID\n        \n    -   Credential type (Client Secret / Certificate)\n        \n    -   Credential name + ID\n        \n    -   Days remaining until expiration\n        \n-   Generates an **HTML table report**, sorted by application name\n    \n-   Sends an email **only when expiring items are found** (otherwise does nothing)\n    \n\n### How it works\n\n1. Fetches all Entra ID applications and their credential metadata via Microsoft Graph  \n2. Separates client secrets and certificates into individual entries  \n3. Filters entries that expire within the configured time window  \n4. Builds a normalized list of expiring items with days remaining  \n5. Emails an HTML table report (only if results exist)    \n\n### Setup requirements\n\n-   **Microsoft Entra ID app registration** with Microsoft Graph **Application permissions**:\n    \n    -   `Application.Read.All`\n        \n-   In n8n:\n    \n    -   Create **Microsoft Graph OAuth2** credentials (Client Credentials flow recommended)\n        \n    -   Assign those credentials to the **Get EntraID Applications and Secrets** HTTP Request node\n        \n-   Update the **Set Variables** node:\n    \n    -   `notificationEmail`: where to send the report\n        \n    -   `daysBeforeExpiry`: alert window in days (e.g., 14)\n        \n\n### Notes\n\n-   The email table highlights soon-to-expire credentials more prominently (based on remaining days).\n    \n-   For automation, replace the manual trigger with a **Schedule Trigger** (e.g., daily/weekly).\n    \n-   The workflow accesses **metadata only** (names/IDs/expiry), not secret values.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Split Out Applications",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Set Variables",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Filter Client Secrets",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Split Out Client Secrets",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Split Out Certificates",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Filter Client Certificates",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Build Client Secrets Report",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Build Certificates Report",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Get EntraID Applications and Secrets",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.3"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "If Expiring Secrets not empty",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.3"
    },
    {
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "HTML Table with Expiring Secrets",
      "type": "n8n-nodes-base.html",
      "role": "html",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Send email",
      "type": "n8n-nodes-base.emailSend",
      "role": "emailSend",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}