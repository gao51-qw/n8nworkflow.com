{
  "id": 6836,
  "slug": "6836",
  "title": "Monitor domains & IPs on AbuseIPDB blacklist with Slack alerts",
  "description": "### ⚙ How It Works \n\nThe automated blacklist monitor is designed to be a proactive, not reactive, tool. Here is the high-level process:\n\n1.  **Scheduled Checks**: At regular intervals (e.g., every 30 minutes or every hour), a monitoring script or service sends a request to a list of predefined DNS blacklists (DNSBLs) and real-time blackhole lists (RBLs).\n2.  **Lookup Queries**: For each check, the system performs a lookup query for our specified domains and IP addresses against the various blacklists. It essentially asks, \"Is `our-ip-address.com` on your list?\"\n3.  **Status Evaluation**: The blacklist service responds with a status: either the asset is **clean** or it is **listed**.\n4.  **Alerting Mechanism**: If a **new listing** is detected, the system immediately triggers a notification. This alert contains key information like the asset that was blacklisted (domain or IP), the specific blacklist it was found on (e.g., Spamhaus), and the time of detection.\n5.  **Status Logging**: The status of each asset (clean or listed) is logged in a central dashboard. This allows us to track the history of an IP or domain, see when a listing occurred, and when it was resolved.\n\n---\n\n### Setup Steps\n\nFollow these steps to set up the automated blacklist monitor.\n\n1.  **Select a Service**: Choose a reliable blacklist monitoring service. Services like **MXToolBox**, **HetrixTools**, or **Uptime Robot** (with custom checks) are popular options.\n2.  **Create an Account**: Sign up and create an account for your organization on the chosen platform.\n3.  **Add Monitored Assets**: Navigate to the \"Monitors\" or \"Assets\" section within the service's dashboard. Add all of the following:\n    * Your primary domain names (e.g., `yourcompany.com`).\n    * All outbound mail server IP addresses.\n    * Any other publicly facing IP addresses associated with your business.\n4.  **Configure Notification Channels**: Set up how and where you want to receive alerts. The best practice is to configure multiple channels for redundancy:\n    * **Email**: Send alerts to a group alias like `security@yourcompany.com` or `it-alerts@yourcompany.com`.\n    * **Chat/IM**: Integrate with a communication tool like Slack or Microsoft Teams and create a dedicated channel (e.g., `#blacklist-alerts`).\n    * **Ticketing System**: Configure the service to automatically open a ticket in your help desk software (e.g., Jira, ServiceNow) when a new listing is found.\n5.  **Set Up Check Frequency**: Configure how often you want the system to perform checks. A frequency of every **15 to 30 minutes** is a good starting point for a high-priority service like email.\n6.  **Create a Runbook**: A runbook is a document that outlines the steps to take when an alert is received. Create and share a runbook with your team that includes:\n    * **Confirmation**: How to verify the listing.\n    * **Investigation**: Initial steps to find the root cause (e.g., checking mail logs for spam).\n    * **Delisting**: How to submit a delisting request to the specific blacklist provider.\n7.  **Initial Testing**: Once everything is configured, perform a manual check to ensure the system is working and that all notification channels are active. You can often do this with a \"test check\" button within the monitoring service's dashboard.",
  "featuredImage": "/data/workflows/6836/6836.webp",
  "author": {
    "id": 101,
    "slug": "marth",
    "name": "Marth",
    "avatar": ""
  },
  "categories": [
    "SecOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 453,
  "downloads": 45,
  "createdAt": "2025-08-02T06:15:45.184Z",
  "updatedAt": "2026-01-16T08:47:17.498Z",
  "publishedAt": "2025-08-02T06:15:45.184Z",
  "nodes": 7,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6836",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Monitor domains & IPs on AbuseIPDB blacklist with Slack alerts",
    "workflowName": "Monitor domains & IPs on AbuseIPDB blacklist with Slack alerts",
    "description": "### ⚙ How It Works \n\nThe automated blacklist monitor is designed to be a proactive, not reactive, tool. Here is the high-level process:\n\n1.  **Scheduled Checks**: At regular intervals (e.g., every 30 minutes or every hour), a monitoring script or service sends a request to a list of predefined DNS blacklists (DNSBLs) and real-time blackhole lists (RBLs).\n2.  **Lookup Queries**: For each check, the system performs a lookup query for our specified domains and IP addresses against the various blacklists. It essentially asks, \"Is `our-ip-address.com` on your list?\"\n3.  **Status Evaluation**: The blacklist service responds with a status: either the asset is **clean** or it is **listed**.\n4.  **Alerting Mechanism**: If a **new listing** is detected, the system immediately triggers a notification. This alert contains key information like the asset that was blacklisted (domain or IP), the specific blacklist it was found on (e.g., Spamhaus), and the time of detection.\n5.  **Status Logging**: The status of each asset (clean or listed) is logged in a central dashboard. This allows us to track the history of an IP or domain, see when a listing occurred, and when it was resolved.\n\n---\n\n### Setup Steps\n\nFollow these steps to set up the automated blacklist monitor.\n\n1.  **Select a Service**: Choose a reliable blacklist monitoring service. Services like **MXToolBox**, **HetrixTools**, or **Uptime Robot** (with custom checks) are popular options.\n2.  **Create an Account**: Sign up and create an account for your organization on the chosen platform.\n3.  **Add Monitored Assets**: Navigate to the \"Monitors\" or \"Assets\" section within the service's dashboard. Add all of the following:\n    * Your primary domain names (e.g., `yourcompany.com`).\n    * All outbound mail server IP addresses.\n    * Any other publicly facing IP addresses associated with your business.\n4.  **Configure Notification Channels**: Set up how and where you want to receive alerts. The best practice is to configure multiple channels for redundancy:\n    * **Email**: Send alerts to a group alias like `security@yourcompany.com` or `it-alerts@yourcompany.com`.\n    * **Chat/IM**: Integrate with a communication tool like Slack or Microsoft Teams and create a dedicated channel (e.g., `#blacklist-alerts`).\n    * **Ticketing System**: Configure the service to automatically open a ticket in your help desk software (e.g., Jira, ServiceNow) when a new listing is found.\n5.  **Set Up Check Frequency**: Configure how often you want the system to perform checks. A frequency of every **15 to 30 minutes** is a good starting point for a high-priority service like email.\n6.  **Create a Runbook**: A runbook is a document that outlines the steps to take when an alert is received. Create and share a runbook with your team that includes:\n    * **Confirmation**: How to verify the listing.\n    * **Investigation**: Initial steps to find the root cause (e.g., checking mail logs for spam).\n    * **Delisting**: How to submit a delisting request to the specific blacklist provider.\n7.  **Initial Testing**: Once everything is configured, perform a manual check to ensure the system is working and that all notification channels are active. You can often do this with a \"test check\" button within the monitoring service's dashboard.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Scheduled Check",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Define Domains/IPs",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Query Blacklist API",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Is on Blacklist?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Send High-Priority Alert",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}