{
  "id": 9054,
  "slug": "9054",
  "title": "Automated financial document processing with Google Gemini OCR",
  "description": "## AI-Powered Financial Document Processing with Google Gemini\n\nThis comprehensive workflow automates the complete financial document processing pipeline using AI. Upload invoices via chat, drop expense receipts into a folder, or add bank statements - the system automatically extracts, categorizes, and organizes all your financial data into structured Google Sheets.\n\n## What this workflow does\n\n**Processes three types of financial documents automatically:**\n\n- **Invoice Processing**: Upload PDF invoices through a chat interface and get structured data extraction with automatic file organization\n- **Expense Management**: Monitor a Google Drive folder for new receipts and automatically categorize expenses using AI\n- **Bank Statement Processing**: Extract and organize transaction data from bank statements with multi-transaction support\n- **Financial Analysis**: Query all your financial data using natural language with an AI agent\n\n## Key Features\n\n- **Multi-AI Persona System**: Four specialized AI personas (Mark, Donna, Victor, Andrew) handle different financial functions\n- **Google Gemini Integration**: Advanced document understanding and data extraction from PDFs\n- **Smart Expense Categorization**: Automatic classification into 17 business expense categories using LLM\n- **Real-time Monitoring**: Continuous folder watching for new documents with automatic processing\n- **Natural Language Queries**: Ask questions about your financial data in plain English\n- **Automatic File Management**: Intelligent file naming and organization in Google Drive\n- **Comprehensive Error Handling**: Robust processing that continues even when individual documents fail\n\n## How it works\n\n### Invoice Processing Flow\n1. User uploads PDF invoice via chat interface\n2. File is saved to Google Drive \"Invoices\" folder\n3. Google Gemini extracts structured data (vendor, amounts, line items, dates)\n4. Data is parsed and saved to \"Invoice Records\" Google Sheet\n5. File is renamed as \"{Vendor Name} - {Invoice Number}\"\n6. Confirmation message sent to user\n\n### Expense Processing Flow\n1. User drops receipt PDF into \"Expense Receipts\" Google Drive folder\n2. System detects new file within 1 minute\n3. Google Gemini extracts expense data (merchant, amount, payment method)\n4. OpenRouter LLM categorizes expense into appropriate business category\n5. All data saved to \"Expenses Recording\" Google Sheet\n\n### Bank Statement Processing Flow\n1. User uploads bank statement to \"Bank Statements\" folder\n2. Google Gemini extracts multiple transactions from statement\n3. Custom JavaScript parser handles various bank formats\n4. Individual transactions saved to \"Bank Transactions Record\" Google Sheet\n\n### Financial Analysis\n1. Enable the analysis trigger when needed\n2. Ask questions in natural language about your financial data\n3. AI agent accesses all three spreadsheets to provide insights\n4. Get reports, summaries, and trend analysis\n\n## What you need to set up\n\n### Required APIs and Credentials\n- **Google Drive API** - For file storage and monitoring\n- **Google Sheets API** - For data storage and retrieval\n- **Google Gemini API** - For document processing and data extraction\n- **OpenRouter API** - For expense categorization (supports multiple LLM providers)\n\n### Google Drive Folder Structure\nCreate these folders in your Google Drive:\n- \"Invoices\" - Processed invoice storage\n- \"Expense Receipts\" - Drop zone for expense receipts (monitored)\n- \"Bank Statements\" - Drop zone for bank statements (monitored)\n\n### Google Sheets Setup\nCreate three spreadsheets with these column headers:\n\n**Invoice Records Sheet:**\nVendor Name, Invoice Number, Invoice Date, Due Date, Total Amount, VAT Amount, Line Item Description, Quantity, Unit Price, Total Price\n\n**Expenses Recording Sheet:**\nMerchant Name, Transaction Date, Total Amount, Tax Amount, Payment Method, Line Item Description, Quantity, Unit Price, Total Price, Category\n\n**Bank Transactions Record Sheet:**\nTransaction ID, Date, Description/Payee, Debit (-), Credit (+), Currency, Running Balance, Notes/Category\n\n## Use Cases\n\n- **Small Business Accounting**: Automate invoice and expense tracking for bookkeeping\n- **Freelancer Financial Management**: Organize client invoices and business expenses\n- **Corporate Expense Management**: Streamline employee expense report processing\n- **Financial Data Analysis**: Generate insights from historical financial data\n- **Bank Reconciliation**: Automate transaction recording and account reconciliation\n- **Tax Preparation**: Maintain organized records with proper categorization\n\n## Technical Highlights\n\n- **Expense Categories**: 17 predefined business expense categories (Cost of Goods Sold, Marketing, Payroll, etc.)\n- **Multi-format Support**: Handles various PDF layouts and bank statement formats\n- **Scalable Processing**: Processes multiple documents simultaneously\n- **Error Recovery**: Continues processing even when individual documents fail\n- **Natural Language Interface**: No technical knowledge required for financial queries\n- **Real-time Processing**: Documents processed within minutes of upload\n\n## Benefits\n\n- **Time Savings**: Eliminates manual data entry from financial documents\n- **Accuracy**: AI-powered extraction reduces human error\n- **Organization**: Automatic file naming and categorization\n- **Insights**: Query financial data using natural language\n- **Compliance**: Maintains organized records for accounting and audit purposes\n- **Scalability**: Handles growing document volumes without additional overhead\n\nThis workflow transforms tedious financial document processing into an automated, intelligent system that grows with your business needs.",
  "featuredImage": "/data/workflows/9054/9054.webp",
  "author": {
    "id": 101,
    "slug": "didac-fg",
    "name": "Didac Fernandez",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 937,
  "downloads": 93,
  "createdAt": "2025-09-28T18:00:36.795Z",
  "updatedAt": "2026-01-16T08:58:51.844Z",
  "publishedAt": "2025-09-28T18:00:36.795Z",
  "nodes": 76,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9054",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated financial document processing with Google Gemini OCR",
    "workflowName": "Automated financial document processing with Google Gemini OCR",
    "description": "## AI-Powered Financial Document Processing with Google Gemini\n\nThis comprehensive workflow automates the complete financial document processing pipeline using AI. Upload invoices via chat, drop expense receipts into a folder, or add bank statements - the system automatically extracts, categorizes, and organizes all your financial data into structured Google Sheets.\n\n## What this workflow does\n\n**Processes three types of financial documents automatically:**\n\n- **Invoice Processing**: Upload PDF invoices through a chat interface and get structured data extraction with automatic file organization\n- **Expense Management**: Monitor a Google Drive folder for new receipts and automatically categorize expenses using AI\n- **Bank Statement Processing**: Extract and organize transaction data from bank statements with multi-transaction support\n- **Financial Analysis**: Query all your financial data using natural language with an AI agent\n\n## Key Features\n\n- **Multi-AI Persona System**: Four specialized AI personas (Mark, Donna, Victor, Andrew) handle different financial functions\n- **Google Gemini Integration**: Advanced document understanding and data extraction from PDFs\n- **Smart Expense Categorization**: Automatic classification into 17 business expense categories using LLM\n- **Real-time Monitoring**: Continuous folder watching for new documents with automatic processing\n- **Natural Language Queries**: Ask questions about your financial data in plain English\n- **Automatic File Management**: Intelligent file naming and organization in Google Drive\n- **Comprehensive Error Handling**: Robust processing that continues even when individual documents fail\n\n## How it works\n\n### Invoice Processing Flow\n1. User uploads PDF invoice via chat interface\n2. File is saved to Google Drive \"Invoices\" folder\n3. Google Gemini extracts structured data (vendor, amounts, line items, dates)\n4. Data is parsed and saved to \"Invoice Records\" Google Sheet\n5. File is renamed as \"{Vendor Name} - {Invoice Number}\"\n6. Confirmation message sent to user\n\n### Expense Processing Flow\n1. User drops receipt PDF into \"Expense Receipts\" Google Drive folder\n2. System detects new file within 1 minute\n3. Google Gemini extracts expense data (merchant, amount, payment method)\n4. OpenRouter LLM categorizes expense into appropriate business category\n5. All data saved to \"Expenses Recording\" Google Sheet\n\n### Bank Statement Processing Flow\n1. User uploads bank statement to \"Bank Statements\" folder\n2. Google Gemini extracts multiple transactions from statement\n3. Custom JavaScript parser handles various bank formats\n4. Individual transactions saved to \"Bank Transactions Record\" Google Sheet\n\n### Financial Analysis\n1. Enable the analysis trigger when needed\n2. Ask questions in natural language about your financial data\n3. AI agent accesses all three spreadsheets to provide insights\n4. Get reports, summaries, and trend analysis\n\n## What you need to set up\n\n### Required APIs and Credentials\n- **Google Drive API** - For file storage and monitoring\n- **Google Sheets API** - For data storage and retrieval\n- **Google Gemini API** - For document processing and data extraction\n- **OpenRouter API** - For expense categorization (supports multiple LLM providers)\n\n### Google Drive Folder Structure\nCreate these folders in your Google Drive:\n- \"Invoices\" - Processed invoice storage\n- \"Expense Receipts\" - Drop zone for expense receipts (monitored)\n- \"Bank Statements\" - Drop zone for bank statements (monitored)\n\n### Google Sheets Setup\nCreate three spreadsheets with these column headers:\n\n**Invoice Records Sheet:**\nVendor Name, Invoice Number, Invoice Date, Due Date, Total Amount, VAT Amount, Line Item Description, Quantity, Unit Price, Total Price\n\n**Expenses Recording Sheet:**\nMerchant Name, Transaction Date, Total Amount, Tax Amount, Payment Method, Line Item Description, Quantity, Unit Price, Total Price, Category\n\n**Bank Transactions Record Sheet:**\nTransaction ID, Date, Description/Payee, Debit (-), Credit (+), Currency, Running Balance, Notes/Category\n\n## Use Cases\n\n- **Small Business Accounting**: Automate invoice and expense tracking for bookkeeping\n- **Freelancer Financial Management**: Organize client invoices and business expenses\n- **Corporate Expense Management**: Streamline employee expense report processing\n- **Financial Data Analysis**: Generate insights from historical financial data\n- **Bank Reconciliation**: Automate transaction recording and account reconciliation\n- **Tax Preparation**: Maintain organized records with proper categorization\n\n## Technical Highlights\n\n- **Expense Categories**: 17 predefined business expense categories (Cost of Goods Sold, Marketing, Payroll, etc.)\n- **Multi-format Support**: Handles various PDF layouts and bank statement formats\n- **Scalable Processing**: Processes multiple documents simultaneously\n- **Error Recovery**: Continues processing even when individual documents fail\n- **Natural Language Interface**: No technical knowledge required for financial queries\n- **Real-time Processing**: Documents processed within minutes of upload\n\n## Benefits\n\n- **Time Savings**: Eliminates manual data entry from financial documents\n- **Accuracy**: AI-powered extraction reduces human error\n- **Organization**: Automatic file naming and categorization\n- **Insights**: Query financial data using natural language\n- **Compliance**: Maintains organized records for accounting and audit purposes\n- **Scalability**: Handles growing document volumes without additional overhead\n\nThis workflow transforms tedious financial document processing into an automated, intelligent system that grows with your business needs.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Confirmation",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Parsed Data",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Upload PDF to Google Gemini",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Download Data from Google Gemini",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Table ERP",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "When Executed by Another Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "role": "executeWorkflowTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "Update File Name",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Save Invoice",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Parsed Data1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Upload PDF to Google Gemini1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Download Data from Google Gemini1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Drive Trigger1",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "role": "googleDriveTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload PDF to Google Gemini2",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Download Data from Google Gemini2",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Google Sheets1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Google Drive1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Edit Fields1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Basic LLM Chain",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "role": "chainLlm",
      "configDescription": "Version 1.6"
    },
    {
      "name": "OpenRouter Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    },
    {
      "name": "OpenRouter Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "Invoices",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Expenses",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Transactions",
      "type": "n8n-nodes-base.googleSheetsTool",
      "role": "googleSheetsTool",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Edit Fields2",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note25",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìÑ Invoice Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Mark - Accountant",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üíæ Save File Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "ü§ñ Upload to AI Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üß† Data Extraction Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìã JSON Parsing Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìë Split Items Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìä Save to Sheet Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üîó Merge Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìù Rename Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "‚úÖ Confirmation Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üßæ Expense Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìÅ Expense Trigger Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üè∑Ô∏è Categorization Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üè¶ Bank Statement Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Victor - Controller",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üîÑ Bank Parser Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìà Financial Analysis Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Andrew - CFO",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üìä Analysis Trigger Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "üóÉÔ∏è Data Tools Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Donna - Accountant",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note26",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note27",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}