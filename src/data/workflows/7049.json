{
  "id": 7049,
  "slug": "7049",
  "title": "Automated email replies with GPT-4o, Outlook, and GoToHuman approval",
  "description": "This n8n workflow reads emails from your Outlook inbox, drafts AI-powered replies using OpenAI, and routes them through the **gotoHuman** node for human approval before replying automatically.\n\n---\n\n## ‚úÖ Key Features\n\n- **Reads Outlook emails** from today only (excluding those from your own address).\n- **AI-generated replies** crafted using OpenAI based on the subject and body of the email.\n- **Community node integration**: Uses the `gotoHuman` node for human review and approval of replies before sending.\n- **Safe sending**: Only approved responses are automatically sent back via Outlook.\n- **Expandable**: Can be easily modified to:\n  - Send drafts instead of full replies\n  - Include additional email filters\n  - Trigger at intervals or via webhook\n\n---\n\n## üß† Nodes Used\n\n- `Microsoft Outlook` ‚Äì Fetch and reply to emails\n- `OpenAI` ‚Äì Generates smart reply text\n- `gotoHuman` ‚Äì Human-in-the-loop approval system\n- `Loop Over Items`, `IF`, `Code`, and `Set` nodes for processing logic\n- `Manual Trigger` ‚Äì For testing\n\n---\n\n## üîß Setup Instructions\n\n### 1. Connect APIs\n- **Outlook OAuth2**:\n  - Go to [Azure Portal](https://portal.azure.com)\n  - Register an app\n  - Add **Mail.Read**, **Mail.Send** scopes\n  - Set redirect URI: `https://api.n8n.cloud/oauth2-credential/callback`\n  - Paste credentials in n8n credential manager\n\n- **OpenAI API**:\n  - Create account at [OpenAI](https://platform.openai.com/)\n  - Create an API Key\n  - Add it to n8n credentials\n\n- **gotoHuman API**:\n  - Go to [https://gotoHuman.ai](https://gotoHuman.ai) and sign in\n  - Create a review template (e.g., ‚ÄúEmail Responses‚Äù)\n  - Copy the Template ID and API key into n8n credentials\n\n---\n\n## ü™ú Workflow Steps Overview\n\n### 1. **Trigger**  \nUse the Manual Trigger to test or schedule execution with a cron node.\n\n### 2. **Filter Emails from Today**\nA Code node outputs today's date in the proper `yyyy-mm-dd` format.\n\n```javascript\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\nreturn [{ json: { searchQuery: `received:${today.toISOString().split('T')[0]}` } }];\n```\n\n### 3. **Search and Filter Outlook Messages**\n- Uses the Outlook node with a search query like:  \n  `received:2025-08-06 -from:rbreen@ynteractive.com` (Update to your email)\n\n### 4. **Generate AI Response**\n- Text prompt to OpenAI:  \n  ```\n  subject: {{ $json.subject }}  \n  body: {{ $json.body.content }}\n  ```\n\n- System prompt:  \n  &gt; You are a personal assistant helping respond to emails. I am an AI automation expert specializing in helping small and medium-size businesses automate processes. Create a short response to the email. Sign the email as Robert Breen.\n\n### 5. **Review with gotoHuman**\n- Submit AI output for human approval using the `gotoHuman` node.\n- The output schema should match the Review Template fields (e.g., \"email\", \"OriginalEmail\").\n\n### 6. **IF Node Decision**\n- If status is `approved`, send reply\n- If not, return to loop for revision or skip\n\n---\n\n## ‚úèÔ∏è Customization Ideas\n\n- ‚úâÔ∏è Send only drafts by skipping the \"reply\" step and storing results.\n- üïí Schedule the workflow with a Cron trigger for automation.\n- üîé Add label filters or subject keywords for advanced targeting.\n\n---\n\n## üîó External Links\n\n- [gotoHuman Community Node](https://n8n.io/integrations/gotohuman)\n- [OpenAI](https://platform.openai.com/)\n- [Microsoft Outlook API Setup](https://learn.microsoft.com/en-us/graph/auth-v2-user)\n\n---\n\n## üí¨ Need More Help?\n\nIf you'd like help customizing this or building similar automations, reach out:\n\n**Robert Breen**  \nAI & Automation Consultant  \nüåê [https://ynteractive.com](https://ynteractive.com)  \nüìß robert.j.breen@gmail.com  \nüîó [LinkedIn](https://www.linkedin.com/in/robert-breen-29429625/)\n\n---\n",
  "featuredImage": "/data/workflows/7049/7049.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Ticket Management",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1315,
  "downloads": 131,
  "createdAt": "2025-08-06T12:49:54.675Z",
  "updatedAt": "2026-01-16T08:48:22.695Z",
  "publishedAt": "2025-08-06T12:49:54.675Z",
  "nodes": 15,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7049",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automated email replies with GPT-4o, Outlook, and GoToHuman approval",
    "workflowName": "Automated email replies with GPT-4o, Outlook, and GoToHuman approval",
    "description": "This n8n workflow reads emails from your Outlook inbox, drafts AI-powered replies using OpenAI, and routes them through the **gotoHuman** node for human approval before replying automatically.\n\n---\n\n## ‚úÖ Key Features\n\n- **Reads Outlook emails** from today only (excluding those from your own address).\n- **AI-generated replies** crafted using OpenAI based on the subject and body of the email.\n- **Community node integration**: Uses the `gotoHuman` node for human review and approval of replies before sending.\n- **Safe sending**: Only approved responses are automatically sent back via Outlook.\n- **Expandable**: Can be easily modified to:\n  - Send drafts instead of full replies\n  - Include additional email filters\n  - Trigger at intervals or via webhook\n\n---\n\n## üß† Nodes Used\n\n- `Microsoft Outlook` ‚Äì Fetch and reply to emails\n- `OpenAI` ‚Äì Generates smart reply text\n- `gotoHuman` ‚Äì Human-in-the-loop approval system\n- `Loop Over Items`, `IF`, `Code`, and `Set` nodes for processing logic\n- `Manual Trigger` ‚Äì For testing\n\n---\n\n## üîß Setup Instructions\n\n### 1. Connect APIs\n- **Outlook OAuth2**:\n  - Go to [Azure Portal](https://portal.azure.com)\n  - Register an app\n  - Add **Mail.Read**, **Mail.Send** scopes\n  - Set redirect URI: `https://api.n8n.cloud/oauth2-credential/callback`\n  - Paste credentials in n8n credential manager\n\n- **OpenAI API**:\n  - Create account at [OpenAI](https://platform.openai.com/)\n  - Create an API Key\n  - Add it to n8n credentials\n\n- **gotoHuman API**:\n  - Go to [https://gotoHuman.ai](https://gotoHuman.ai) and sign in\n  - Create a review template (e.g., ‚ÄúEmail Responses‚Äù)\n  - Copy the Template ID and API key into n8n credentials\n\n---\n\n## ü™ú Workflow Steps Overview\n\n### 1. **Trigger**  \nUse the Manual Trigger to test or schedule execution with a cron node.\n\n### 2. **Filter Emails from Today**\nA Code node outputs today's date in the proper `yyyy-mm-dd` format.\n\n```javascript\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\nreturn [{ json: { searchQuery: `received:${today.toISOString().split('T')[0]}` } }];\n```\n\n### 3. **Search and Filter Outlook Messages**\n- Uses the Outlook node with a search query like:  \n  `received:2025-08-06 -from:rbreen@ynteractive.com` (Update to your email)\n\n### 4. **Generate AI Response**\n- Text prompt to OpenAI:  \n  ```\n  subject: {{ $json.subject }}  \n  body: {{ $json.body.content }}\n  ```\n\n- System prompt:  \n  &gt; You are a personal assistant helping respond to emails. I am an AI automation expert specializing in helping small and medium-size businesses automate processes. Create a short response to the email. Sign the email as Robert Breen.\n\n### 5. **Review with gotoHuman**\n- Submit AI output for human approval using the `gotoHuman` node.\n- The output schema should match the Review Template fields (e.g., \"email\", \"OriginalEmail\").\n\n### 6. **IF Node Decision**\n- If status is `approved`, send reply\n- If not, return to loop for revision or skip\n\n---\n\n## ‚úèÔ∏è Customization Ideas\n\n- ‚úâÔ∏è Send only drafts by skipping the \"reply\" step and storing results.\n- üïí Schedule the workflow with a Cron trigger for automation.\n- üîé Add label filters or subject keywords for advanced targeting.\n\n---\n\n## üîó External Links\n\n- [gotoHuman Community Node](https://n8n.io/integrations/gotohuman)\n- [OpenAI](https://platform.openai.com/)\n- [Microsoft Outlook API Setup](https://learn.microsoft.com/en-us/graph/auth-v2-user)\n\n---\n\n## üí¨ Need More Help?\n\nIf you'd like help customizing this or building similar automations, reach out:\n\n**Robert Breen**  \nAI & Automation Consultant  \nüåê [https://ynteractive.com](https://ynteractive.com)  \nüìß robert.j.breen@gmail.com  \nüîó [LinkedIn](https://www.linkedin.com/in/robert-breen-29429625/)\n\n---",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Tool: Inject Creativity",
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "role": "toolThink",
      "configDescription": "Version 1"
    },
    {
      "name": "Parser: Extract JSON from Idea",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "openai",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "role": "lmChatOpenAi",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Test",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Output Today's Date",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Agent: Create caption for linkedin",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.9"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Microsoft Outlook",
      "type": "n8n-nodes-base.microsoftOutlook",
      "role": "microsoftOutlook",
      "configDescription": "Version 2"
    },
    {
      "name": "gotoHuman",
      "type": "@gotohuman/n8n-nodes-gotohuman.gotoHuman",
      "role": "gotoHuman",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Microsoft Outlook1",
      "type": "n8n-nodes-base.microsoftOutlook",
      "role": "microsoftOutlook",
      "configDescription": "Version 2"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    }
  ]
}