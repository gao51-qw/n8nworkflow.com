{
  "id": 4697,
  "slug": "4697",
  "title": "Segment PDFs by table of contents with Gemini AI and Chunkr.ai",
  "description": "## Intelligently Segment PDFs by Table of Contents\n\nThis workflow empowers you to automatically process PDF documents, intelligently identify or generate a hierarchical Table of Contents (ToC), and then segment the entire document's content based on these ToC headings. It effectively breaks down a large PDF into its constituent sections, each paired with its corresponding heading and hierarchical level.\n\n### Why It's Useful\n\nUnlock the true structure of your PDFs for granular access and advanced processing:\n\n* **AI Agent Tool:** A key use case is to provide this workflow as a tool to an AI agent. The agent can then use the segmented output to \"read\" and navigate to specific sections of a document to answer questions, extract information, or perform tasks with much greater accuracy and efficiency.\n* **Targeted Content Extraction:** Programmatically pull out specific chapters or subsections for focused analysis, summarization, reporting, or repurposing content.\n* **Enhanced RAG Systems:** Improve your Retrieval Augmented Generation (RAG) pipelines by feeding them well-defined, contextually relevant document sections instead of entire, monolithic PDFs. This leads to more precise AI-generated responses.\n* **Modular Document Processing:** Process different parts of a document using distinct logic in subsequent n8n workflows by acting on individual sections.\n* **Data Preparation:** Seamlessly convert lengthy PDFs into a structured format where each section (including its heading, level, and content in multiple formats) becomes a distinct, manageable item.\n\n### How It Works\n\n1.  **Ingestion & Advanced Parsing:** The workflow ingests a PDF (via a provided URL or a pre-set one for manual runs). It then utilizes **Chunkr.ai** to perform Optical Character Recognition (OCR) and parse the document into detailed structural elements, extracting text, HTML, and Markdown for each segment.\n2.  **AI-Powered Table of Contents Generation:** A **Google Gemini** AI model analyzes the initial pages of the document (where a ToC often resides) along with section headers extracted by Chunkr as a fallback. This allows it to construct an accurate, hierarchical Table of Contents in a structured JSON format, even if the PDF lacks an explicit ToC or if it's poorly formatted.\n3.  **Precise Content Segmentation:** Sophisticated custom code then meticulously maps the AI-generated ToC headings to their corresponding content within the parsed document from Chunkr. It intelligently determines the precise start and end of each section.\n4.  **Structured & Flexible Output:**\n    * The primary output provides each identified section as an individual n8n item. Each item includes the heading text, its hierarchical level (e.g., 1, 1.1, 2), and the full content of that section in Text, HTML, and Markdown formats.\n    * Optionally, the workflow can also reconstruct the entire document into a single, navigable HTML file or a clean Markdown file.\n\n### What You Need\n\nTo run this workflow, you'll need:\n\n* **Input PDF:**\n    * When triggered by another workflow: A `URL` pointing to the PDF document.\n    * When triggered manually: The workflow uses a pre-configured sample PDF from Google Drive for demonstration (this can be customized).\n* **Chunkr.ai API Key:** Required for the initial parsing and OCR of the PDF document. You'll need to insert this into the relevant HTTP Request nodes.\n* **Google Gemini API Credentials:** Necessary for the AI model to intelligently generate the Table of Contents. This should be configured in the Google Gemini Chat Model nodes.\n\n### Outputs\n\nThe workflow primarily generates:\n\n* **Individual Document Sections:** A series of n8n items. Each item represents a distinct section of the PDF and contains:\n    * `heading`: The text of the section heading.\n    * `headingLevel`: The hierarchical level of the heading (e.g., 1 for H1, 2 for H2).\n    * `sectionText`: The plain text content of the section.\n    * `sectionHTML`: The HTML content of the section.\n    * `sectionMarkdown`: The Markdown content of the section.\n\nAlternatively, you can configure the workflow to output:\n\n* **Full Reconstructed Document:**\n    * A single HTML file representing the entire processed document.\n    * A single Markdown file representing the entire processed document.\n\nThis workflow is ideal for anyone looking to deconstruct PDFs into meaningful, manageable parts for advanced automation, AI integration, or detailed content analysis.",
  "featuredImage": "/data/workflows/4697/4697.webp",
  "author": {
    "id": 101,
    "slug": "lukaskunhardt",
    "name": "Lukas Kunhardt",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 590,
  "downloads": 59,
  "createdAt": "2025-06-05T15:46:55.497Z",
  "updatedAt": "2026-01-16T08:35:44.974Z",
  "publishedAt": "2025-06-05T15:46:55.497Z",
  "nodes": 36,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4697",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Segment PDFs by table of contents with Gemini AI and Chunkr.ai",
    "workflowName": "Segment PDFs by table of contents with Gemini AI and Chunkr.ai",
    "description": "## Intelligently Segment PDFs by Table of Contents\n\nThis workflow empowers you to automatically process PDF documents, intelligently identify or generate a hierarchical Table of Contents (ToC), and then segment the entire document's content based on these ToC headings. It effectively breaks down a large PDF into its constituent sections, each paired with its corresponding heading and hierarchical level.\n\n### Why It's Useful\n\nUnlock the true structure of your PDFs for granular access and advanced processing:\n\n* **AI Agent Tool:** A key use case is to provide this workflow as a tool to an AI agent. The agent can then use the segmented output to \"read\" and navigate to specific sections of a document to answer questions, extract information, or perform tasks with much greater accuracy and efficiency.\n* **Targeted Content Extraction:** Programmatically pull out specific chapters or subsections for focused analysis, summarization, reporting, or repurposing content.\n* **Enhanced RAG Systems:** Improve your Retrieval Augmented Generation (RAG) pipelines by feeding them well-defined, contextually relevant document sections instead of entire, monolithic PDFs. This leads to more precise AI-generated responses.\n* **Modular Document Processing:** Process different parts of a document using distinct logic in subsequent n8n workflows by acting on individual sections.\n* **Data Preparation:** Seamlessly convert lengthy PDFs into a structured format where each section (including its heading, level, and content in multiple formats) becomes a distinct, manageable item.\n\n### How It Works\n\n1.  **Ingestion & Advanced Parsing:** The workflow ingests a PDF (via a provided URL or a pre-set one for manual runs). It then utilizes **Chunkr.ai** to perform Optical Character Recognition (OCR) and parse the document into detailed structural elements, extracting text, HTML, and Markdown for each segment.\n2.  **AI-Powered Table of Contents Generation:** A **Google Gemini** AI model analyzes the initial pages of the document (where a ToC often resides) along with section headers extracted by Chunkr as a fallback. This allows it to construct an accurate, hierarchical Table of Contents in a structured JSON format, even if the PDF lacks an explicit ToC or if it's poorly formatted.\n3.  **Precise Content Segmentation:** Sophisticated custom code then meticulously maps the AI-generated ToC headings to their corresponding content within the parsed document from Chunkr. It intelligently determines the precise start and end of each section.\n4.  **Structured & Flexible Output:**\n    * The primary output provides each identified section as an individual n8n item. Each item includes the heading text, its hierarchical level (e.g., 1, 1.1, 2), and the full content of that section in Text, HTML, and Markdown formats.\n    * Optionally, the workflow can also reconstruct the entire document into a single, navigable HTML file or a clean Markdown file.\n\n### What You Need\n\nTo run this workflow, you'll need:\n\n* **Input PDF:**\n    * When triggered by another workflow: A `URL` pointing to the PDF document.\n    * When triggered manually: The workflow uses a pre-configured sample PDF from Google Drive for demonstration (this can be customized).\n* **Chunkr.ai API Key:** Required for the initial parsing and OCR of the PDF document. You'll need to insert this into the relevant HTTP Request nodes.\n* **Google Gemini API Credentials:** Necessary for the AI model to intelligently generate the Table of Contents. This should be configured in the Google Gemini Chat Model nodes.\n\n### Outputs\n\nThe workflow primarily generates:\n\n* **Individual Document Sections:** A series of n8n items. Each item represents a distinct section of the PDF and contains:\n    * `heading`: The text of the section heading.\n    * `headingLevel`: The hierarchical level of the heading (e.g., 1 for H1, 2 for H2).\n    * `sectionText`: The plain text content of the section.\n    * `sectionHTML`: The HTML content of the section.\n    * `sectionMarkdown`: The Markdown content of the section.\n\nAlternatively, you can configure the workflow to output:\n\n* **Full Reconstructed Document:**\n    * A single HTML file representing the entire processed document.\n    * A single Markdown file representing the entire processed document.\n\nThis workflow is ideal for anyone looking to deconstruct PDFs into meaningful, manageable parts for advanced automation, AI integration, or detailed content analysis.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Status is:",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Auto-fixing Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "role": "outputParserAutofixing",
      "configDescription": "Version 1"
    },
    {
      "name": "Set File Name",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "When Executed by Another Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "role": "executeWorkflowTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Extract Sections headers as fallback",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Take beginning of Document to look for Table of contents",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Stop and Error",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "Google Gemini Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Convert the PDF to base64",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Download PDF from URL",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Download PDF from Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Wait Before Polling the Chunkr Result",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Return each section individually",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Table of Content Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2"
    },
    {
      "name": "Return the whole document",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Create HTML document",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "HTML",
      "type": "n8n-nodes-base.html",
      "role": "html",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Move Binary Data",
      "type": "n8n-nodes-base.moveBinaryData",
      "role": "moveBinaryData",
      "configDescription": "Version 1"
    },
    {
      "name": "Create Markdown Document",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile",
      "role": "convertToFile",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "GET Chunkr Task",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "POST Chunkr Task",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    }
  ]
}