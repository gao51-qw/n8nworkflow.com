{
  "id": 7912,
  "slug": "7912",
  "title": "Ga4 anomaly detection with automated Slack & email alerts",
  "description": "## Who’s it for\n\nTeams that monitor traffic, signups, or conversions in Google Analytics 4 and want automatic Slack/email alerts when a channel suddenly spikes or drops.\n\n## What it does\n\nThis n8n template pulls daily GA4 metrics, detects outliers with a rolling mean and z-score, and sends alerts with a sparkline chart. It supports per-channel analysis (e.g., `sessionDefaultChannelGroup`) and consolidates multiple anomalies into a single email while posting each one to Slack.\n\n## How it works\n\n* **HTTP Request (GA4 Data API)** fetches `sessions`, `newUsers`, `conversions`, `bounceRate` by `date` + channel.\n* **Code** calculates 7-day moving average and z-scores, flags anomalies, and builds QuickChart links.\n* **If** filters on `alert === true` and optional `ALERT_ME` toggle.\n* **Slack** posts an alert + chart.\n* **Email** sends one summary email (subject + HTML table + charts).\n\n## Requirements\n\n* GA4 OAuth2 credential in n8n.\n* Slack API credential (bot with chat\\:write).\n* Email credential (SMTP or service).\n* GA4 property ID and at least several recent days of data.\n\n## Where to find your GA4 Property ID\n\n* **In the GA UI:**\n\n  1. Open **Google Analytics** → bottom-left **Admin** (gear).\n  2. In the **Property** column, click **Property settings**.\n  3. Copy **Property ID** — it’s a **numeric** value (e.g., `481356553`).\n\n* **From the URL (quick way):**\n  When you’re inside the GA4 property, the URL looks like:\n  `…/analytics/web/#/p123456789/…` → the digits after **`p`** are your **Property ID** (`123456789` in this example).\n\n* **What *not* to use:**\n\n  * **Measurement ID** (looks like `G-XXXXXXX`) — that’s the data stream ID, **not** the property ID.\n  * **Universal Analytics IDs** (`UA-XXXXX-Y`) — those are legacy and won’t work with GA4 Data API.\n\n* **In this template:**\n  Put that numeric ID into the **Set → `PROPERTY_ID`** field. The HTTP node path `properties/{{ $json.PROPERTY_ID }}:runReport` expects **only the number**, no prefixes.\n\n\n## How to set up\n\n1. Open the **Set (Define variables)** node and fill: `PROPERTY_ID`, `LOOKBACK_DAYS`, `ALERT_PCT`, `Z_THRESHOLD`, `CHANNEL_DIM`, `ALERT_ME`.\n2. Connect your **Google Analytics OAuth2**, **Slack**, and **Email** credentials.\n3. In **Email Send**, map `Subject` → `{{$json.emailSubject}}` and **HTML** body → `{{$json.emailHtml}}`. Keep **Execute once** enabled.\n4. Run the workflow.\n\n## How to customize\n\n* Change the moving-average window (`WINDOW/MA_WINDOW`) and chart range (`LAST_N_DAYS_CHART`).\n* Swap `CHANNEL_DIM` (e.g., source/medium) to analyze different dimensions.\n* Add/remove metrics in the GA4 request and the metrics list in the Code node.\n* Tweak thresholds to reduce noise: raise `Z_THRESHOLD` or `ALERT_PCT`.\n\n## Output example\n\n![Screenshot 20250826 at 18.32.15.png](fileId:2202)",
  "featuredImage": "/data/workflows/7912/7912.webp",
  "author": {
    "id": 101,
    "slug": "arlusm1",
    "name": "Artur",
    "avatar": ""
  },
  "categories": [
    "Market Research",
    "Multimodal AI"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 39,
  "downloads": 3,
  "createdAt": "2025-08-26T15:35:22.974Z",
  "updatedAt": "2026-01-16T08:52:58.556Z",
  "publishedAt": "2025-08-26T15:35:22.974Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7912",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Ga4 anomaly detection with automated Slack & email alerts",
    "workflowName": "Ga4 anomaly detection with automated Slack & email alerts",
    "description": "## Who’s it for\n\nTeams that monitor traffic, signups, or conversions in Google Analytics 4 and want automatic Slack/email alerts when a channel suddenly spikes or drops.\n\n## What it does\n\nThis n8n template pulls daily GA4 metrics, detects outliers with a rolling mean and z-score, and sends alerts with a sparkline chart. It supports per-channel analysis (e.g., `sessionDefaultChannelGroup`) and consolidates multiple anomalies into a single email while posting each one to Slack.\n\n## How it works\n\n* **HTTP Request (GA4 Data API)** fetches `sessions`, `newUsers`, `conversions`, `bounceRate` by `date` + channel.\n* **Code** calculates 7-day moving average and z-scores, flags anomalies, and builds QuickChart links.\n* **If** filters on `alert === true` and optional `ALERT_ME` toggle.\n* **Slack** posts an alert + chart.\n* **Email** sends one summary email (subject + HTML table + charts).\n\n## Requirements\n\n* GA4 OAuth2 credential in n8n.\n* Slack API credential (bot with chat\\:write).\n* Email credential (SMTP or service).\n* GA4 property ID and at least several recent days of data.\n\n## Where to find your GA4 Property ID\n\n* **In the GA UI:**\n\n  1. Open **Google Analytics** → bottom-left **Admin** (gear).\n  2. In the **Property** column, click **Property settings**.\n  3. Copy **Property ID** — it’s a **numeric** value (e.g., `481356553`).\n\n* **From the URL (quick way):**\n  When you’re inside the GA4 property, the URL looks like:\n  `…/analytics/web/#/p123456789/…` → the digits after **`p`** are your **Property ID** (`123456789` in this example).\n\n* **What *not* to use:**\n\n  * **Measurement ID** (looks like `G-XXXXXXX`) — that’s the data stream ID, **not** the property ID.\n  * **Universal Analytics IDs** (`UA-XXXXX-Y`) — those are legacy and won’t work with GA4 Data API.\n\n* **In this template:**\n  Put that numeric ID into the **Set → `PROPERTY_ID`** field. The HTTP node path `properties/{{ $json.PROPERTY_ID }}:runReport` expects **only the number**, no prefixes.\n\n\n## How to set up\n\n1. Open the **Set (Define variables)** node and fill: `PROPERTY_ID`, `LOOKBACK_DAYS`, `ALERT_PCT`, `Z_THRESHOLD`, `CHANNEL_DIM`, `ALERT_ME`.\n2. Connect your **Google Analytics OAuth2**, **Slack**, and **Email** credentials.\n3. In **Email Send**, map `Subject` → `{{$json.emailSubject}}` and **HTML** body → `{{$json.emailHtml}}`. Keep **Execute once** enabled.\n4. Run the workflow.\n\n## How to customize\n\n* Change the moving-average window (`WINDOW/MA_WINDOW`) and chart range (`LAST_N_DAYS_CHART`).\n* Swap `CHANNEL_DIM` (e.g., source/medium) to analyze different dimensions.\n* Add/remove metrics in the GA4 request and the metrics list in the Code node.\n* Tweak thresholds to reduce noise: raise `Z_THRESHOLD` or `ALERT_PCT`.\n\n## Output example\n\n![Screenshot 20250826 at 18.32.15.png](fileId:2202)",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Detect GA4 Anomalies",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Define variables",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Get GA4 Data",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Send an email",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "If anomaly is found",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}