{
  "id": 8388,
  "slug": "8388",
  "title": "Automate PDF purchase orders to sales orders in Adobe Commerce with AI",
  "description": "# ðŸ“„ PDF-to-Order Automation for Magento2 (Adobe commerce / open source)\n\n## Description\nThis n8n template demonstrates how to automatically process **PDF purchase orders** received via email and convert them into **sales orders in Adobe Commerce (Magento 2)** using **Company Credit** as the payment method.  \n\nThis is especially useful for **B2B companies** receiving structured orders from clients by email.  \n\n**Use cases include:**  \n- Automating incoming B2B orders  \n- Reducing manual entry for sales teams  \n- Ensuring fast order creation in Adobe Commerce  \n- Reliable error handling and customer validation  \n\n---\n\n## Good to know\n- This workflow is tailored for **Adobe Commerce**, using the **Company Credit** payment method.  \n- It requires that the customer already has an account in Adobe Commerce and is authorized to use Company Credit.  \n- The same flow can be easily adapted for other payment methods (e.g. Purchase Order, Bank Transfer).  \n- No third-party services are required aside from **n8n** and access to Adobe Commerce with API credentials.  \n\n---\n\n## How it works\n1. **Trigger** â†’ Monitors an email inbox for incoming emails with PDF attachments.  \n2. **Extract PDF** â†’ Downloads the attached PDF and parses order data (e.g. SKU, quantity, customer reference).  \n3. **Validate Customer** â†’ Checks if the sender matches an existing customer in Adobe Commerce and verifies Company Credit eligibility.  \n4. **Create Order** â†’ Generates a new order in Magento using the extracted product data and Company Credit.  \n5. **Handle Errors** â†’ Logs issues and can notify a designated channel (email, Slack, etc.) if something goes wrong.  \n6. **Optional Enhancements** â†’ Add logging to Airtable, send confirmations to customers, or attach parsed order data to CRM entries.  \n\n---\n\n## How to use\n- A manual trigger is included as an example, but you can replace it with an **IMAP Email Trigger**, **Gmail Trigger**, or **Webhook**, depending on your setup.  \n- Customize the **PDF parser** node to fit your specific document layout and field structure.  \n- Configure **Adobe Commerce API credentials** in the HTTP nodes (or use environment variables).  \n- Optionally connect error steps to **Slack**, **Email**, or **dashboards** for monitoring.  \n\n---\n\n## Requirements\n- âœ… n8n instance (self-hosted or cloud)  \n- âœ… Adobe Commerce (Magento 2) instance with API access and Company Credit enabled  \n- âœ… Structured PDF templates used by your customers  \n- (Optional) Slack/Email/Airtable for notifications and logs  \n\n---\n\n## Customising this workflow\nThis workflow can be adapted for:  \n- Other payment methods (e.g. **Purchase Orders**, **Online Payment**) \n- Magento open source ready. Just use your own payment method\n- Alternate order sources (e.g. uploading PDFs via a portal instead of email)  \n- Parsing other document formats (e.g. **CSV, Excel**)  \n- Direct integration into **ERP systems**  \n\n---\n",
  "featuredImage": "/data/workflows/8388/8388.webp",
  "author": {
    "id": 101,
    "slug": "jkingma",
    "name": "JKingma",
    "avatar": ""
  },
  "categories": [
    "CRM",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 474,
  "downloads": 47,
  "createdAt": "2025-09-08T18:44:05.318Z",
  "updatedAt": "2026-01-16T08:55:33.661Z",
  "publishedAt": "2025-09-08T18:44:05.318Z",
  "nodes": 96,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8388",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate PDF purchase orders to sales orders in Adobe Commerce with AI",
    "workflowName": "Automate PDF purchase orders to sales orders in Adobe Commerce with AI",
    "description": "# ðŸ“„ PDF-to-Order Automation for Magento2 (Adobe commerce / open source)\n\n## Description\nThis n8n template demonstrates how to automatically process **PDF purchase orders** received via email and convert them into **sales orders in Adobe Commerce (Magento 2)** using **Company Credit** as the payment method.  \n\nThis is especially useful for **B2B companies** receiving structured orders from clients by email.  \n\n**Use cases include:**  \n- Automating incoming B2B orders  \n- Reducing manual entry for sales teams  \n- Ensuring fast order creation in Adobe Commerce  \n- Reliable error handling and customer validation  \n\n---\n\n## Good to know\n- This workflow is tailored for **Adobe Commerce**, using the **Company Credit** payment method.  \n- It requires that the customer already has an account in Adobe Commerce and is authorized to use Company Credit.  \n- The same flow can be easily adapted for other payment methods (e.g. Purchase Order, Bank Transfer).  \n- No third-party services are required aside from **n8n** and access to Adobe Commerce with API credentials.  \n\n---\n\n## How it works\n1. **Trigger** â†’ Monitors an email inbox for incoming emails with PDF attachments.  \n2. **Extract PDF** â†’ Downloads the attached PDF and parses order data (e.g. SKU, quantity, customer reference).  \n3. **Validate Customer** â†’ Checks if the sender matches an existing customer in Adobe Commerce and verifies Company Credit eligibility.  \n4. **Create Order** â†’ Generates a new order in Magento using the extracted product data and Company Credit.  \n5. **Handle Errors** â†’ Logs issues and can notify a designated channel (email, Slack, etc.) if something goes wrong.  \n6. **Optional Enhancements** â†’ Add logging to Airtable, send confirmations to customers, or attach parsed order data to CRM entries.  \n\n---\n\n## How to use\n- A manual trigger is included as an example, but you can replace it with an **IMAP Email Trigger**, **Gmail Trigger**, or **Webhook**, depending on your setup.  \n- Customize the **PDF parser** node to fit your specific document layout and field structure.  \n- Configure **Adobe Commerce API credentials** in the HTTP nodes (or use environment variables).  \n- Optionally connect error steps to **Slack**, **Email**, or **dashboards** for monitoring.  \n\n---\n\n## Requirements\n- âœ… n8n instance (self-hosted or cloud)  \n- âœ… Adobe Commerce (Magento 2) instance with API access and Company Credit enabled  \n- âœ… Structured PDF templates used by your customers  \n- (Optional) Slack/Email/Airtable for notifications and logs  \n\n---\n\n## Customising this workflow\nThis workflow can be adapted for:  \n- Other payment methods (e.g. **Purchase Orders**, **Online Payment**) \n- Magento open source ready. Just use your own payment method\n- Alternate order sources (e.g. uploading PDFs via a portal instead of email)  \n- Parsing other document formats (e.g. **CSV, Excel**)  \n- Direct integration into **ERP systems**  \n\n---",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Create cart",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "On form submission",
      "type": "n8n-nodes-base.formTrigger",
      "role": "formTrigger",
      "configDescription": "Version 2.2"
    },
    {
      "name": "set Customer",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Quote Id",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Billing Address",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "estimate Shipping Methods",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "set Reference Number",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "set OpenAI",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Order Comment",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "get Payment Methods",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "role": "aggregate",
      "configDescription": "Version 1"
    },
    {
      "name": "check Companycredit",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "role": "chatTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Extract from File1",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "set Address",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "get Configurable",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "If companyCredit",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "set Express Shipping Method",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Limit",
      "type": "n8n-nodes-base.limit",
      "role": "limit",
      "configDescription": "Version 1"
    },
    {
      "name": "set Standard Shipping Method",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "set Feedback",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Clean Articlenumber",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "get Cart Items",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "remove From Shopping Cart",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "get Cart Items1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "remove From Shopping Cart1",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "If Default Address",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "set Feedback Default Address",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "role": "switch",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Extract from File2",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "Stop and Error1",
      "type": "n8n-nodes-base.stopAndError",
      "role": "stopAndError",
      "configDescription": "Version 1"
    },
    {
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Json error message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Combine error fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "No Operation, do nothing1",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Set successfull message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set empty email message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set empty products message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Products not empty",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Emails not empty",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "set Information",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Information 2",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Pay on account error message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set empty PO number message",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "If PO number not empty",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Vorgangsnummer",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "No Operation, do nothing3",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Split Out Products",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "get Products",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Execute Workflow",
      "type": "n8n-nodes-base.executeWorkflow",
      "role": "executeWorkflow",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "role": "wait",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.1"
    },
    {
      "name": "place Order",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "filter Emailadresses",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "remove SCH",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "No Operation, do nothing4",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "set Feedback configurable",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "get Order by PO number",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Set empty PO number message1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "IF PO number not exists",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Microsoft Outlook Trigger",
      "type": "n8n-nodes-base.microsoftOutlookTrigger",
      "role": "microsoftOutlookTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "set Text",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Move a message",
      "type": "n8n-nodes-base.microsoftOutlook",
      "role": "microsoftOutlook",
      "configDescription": "Version 2"
    },
    {
      "name": "No Operation, do nothing2",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "get Customer",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "If Customer",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Products",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Trigger & Input",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - AI Parsing",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Customer Validation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Cart Creation",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Shipping & Billing",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Finalize Order",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note - Error Handling1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Azure OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "role": "lmChatAzureOpenAi",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop until existing customer found",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "If configurable product found",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Prepare sku & quote",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "If product in cart",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Loop over products",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Combine processed skus",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Combine failed skus",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "set Feedback failed",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "set Feedback processed",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Combine feedback",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Keep 1",
      "type": "n8n-nodes-base.limit",
      "role": "limit",
      "configDescription": "Version 1"
    },
    {
      "name": "If express",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Split Emails",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "set Emails",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Email combine",
      "type": "n8n-nodes-base.noOp",
      "role": "noOp",
      "configDescription": "Version 1"
    },
    {
      "name": "If developer",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}