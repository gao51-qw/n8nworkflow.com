{
  "id": 7143,
  "slug": "7143",
  "title": "Expense organizer with Google Drive routing and Gemini AI entity detection",
  "description": "## Who's it for\n\nThis workflow is perfect for individuals, small businesses, or households who need to:\n- Automatically process and categorize expense receipts\n- Extract structured data from invoices and receipts using AI\n- Store receipts in multiple locations (Google Drive and S3)\n- Send automated email notifications with expense details\n- Send documents to accounting systems via email hooks\n\n## How it works\n\nThis comprehensive expense processing workflow combines AI-powered document analysis with automated file management and notifications. Here's the complete flow:\n\n1. **Form Submission**: Users submit expenses through a web form with receipt upload and category selection (Personal, Business, or Shared/Home)\n\n2. **AI Document Processing**: The workflow extracts text from PDF receipts using OCR, then uses Google Gemini AI to parse and structure the data into a standardized JSON format including vendor details, amounts, dates, and categorization\n\n3. **Smart Routing**: Based on the expense category, receipts are automatically routed to different processing paths with category-specific folder organization\n\n4. **Multi-Destination Storage**: Receipts are uploaded to:\n   - Google Drive (organized by year/month folders)\n   - S3 cloud storage buckets\n   - Different destinations based on expense type\n\n5. **Email Notifications**: Sends formatted HTML email notifications with complete expense details and links to stored receipts\n\n6. **Accounting System Integration**: Automatically forwards business expenses to accounting systems via email hooks (customizable per user requirements)\n\n## Requirements\n\n### Credentials needed:\n- **Google Gemini API**: For AI-powered document analysis\n- **Google Drive OAuth2**: For personal and business drive access\n- **Gmail OAuth2**: For sending email notifications\n- **S3 Storage**: For cloud backup (AWS S3, Wasabi, etc.)\n\n### Services used:\n- Google Drive (multiple accounts supported)\n- Google Gemini AI\n- Gmail\n- S3-compatible storage\n- Form trigger webhook\n\n## How to set up\n\n### Step 1: Configure Credentials\n1. Set up Google Gemini API credentials in n8n\n2. Configure Google Drive OAuth2 for both personal and business accounts\n3. Add Gmail OAuth2 credentials\n4. Set up S3 storage credentials\n\n### Step 2: Update Configuration\n1. Replace all placeholder values:\n   - `YOUR_GEMINI_CREDENTIAL_ID` with your Gemini credential ID\n   - `YOUR_PERSONAL_GDRIVE_CREDENTIAL_ID` with personal Drive credential\n   - `YOUR_BUSINESS_GDRIVE_CREDENTIAL_ID` with business Drive credential\n   - `YOUR_GMAIL_CREDENTIAL_ID` with Gmail credential\n   - `YOUR_S3_CREDENTIAL_ID` with S3 credential\n\n2. Update Google Drive folder structure:\n   - Replace `YOUR_BUSINESS_DRIVE_ID` and `YOUR_SHARED_DRIVE_ID` with actual drive IDs\n   - Update the JavaScript code in the three Code nodes with your actual folder mapping\n\n3. Configure email addresses:\n   - Replace `user@example.com` with your notification email\n   - Replace `receipts@paperless-service.com` with your accounting system's email hook (this is a mail hook for uploading documents to small business accounting systems - can be modified per user requirements)\n\n4. Update S3 bucket names:\n   - Replace `business-expenses`, `personal-expenses`, and `shared-expenses` with your bucket names\n\n### Step 3: Set Up Folder Structure\nCreate organized folder structures in your Google Drives:\n```\nDrive Root/\n├── 2024/\n│   ├── January/\n│   ├── February/\n│   └── ... (all months)\n├── 2025/\n│   ├── January/\n│   └── ... (all months)\n└── 2026/\n    └── ... (all months)\n```\n\n### Step 4: Test the Workflow\n1. Activate the workflow\n2. Submit a test expense through the form\n3. Verify files are uploaded to correct locations\n4. Check email notifications are received\n\n## How to customize the workflow\n\n### Expense Categories\nModify the form dropdown options and conditional logic to add/remove expense categories:\n- Edit the \"On form submission\" node form fields\n- Update the IF condition nodes for routing\n- Add new processing paths as needed\n\n### AI Processing Schema\nCustomize the structured output parser schema to extract different fields:\n- Modify the JSON schema in the \"Structured Output Parser\" node\n- Update the AI system prompt for different extraction requirements\n- Add new fields for specific business needs\n\n### Storage Destinations\nAdd or modify storage locations:\n- Duplicate upload nodes for additional cloud services\n- Modify folder organization logic in Code nodes\n- Add new conditional routing for different storage rules\n\n### Email Templates\nCustomize the HTML email template:\n- Edit the email message content in the Gmail node\n- Add/remove expense fields in the table\n- Modify styling and branding\n\n### Folder Organization\nUpdate the JavaScript code in Code nodes to match your folder structure:\n- Modify the CSV data with your actual folder IDs\n- Change the date-based organization logic\n- Add custom folder naming conventions\n\n### Integration Extensions\nExtend the workflow with additional integrations:\n- Add Slack notifications\n- Connect to accounting software (QuickBooks, Xero)\n- Integrate with expense management platforms\n- Add approval workflows for business expenses\n\n\n",
  "featuredImage": "/data/workflows/7143/7143.webp",
  "author": {
    "id": 101,
    "slug": "danielrosehill",
    "name": "Daniel Rosehill",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 524,
  "downloads": 52,
  "createdAt": "2025-08-07T16:55:41.031Z",
  "updatedAt": "2026-01-16T08:48:42.404Z",
  "publishedAt": "2025-08-07T16:55:41.031Z",
  "nodes": 24,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7143",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Expense organizer with Google Drive routing and Gemini AI entity detection",
    "workflowName": "Expense organizer with Google Drive routing and Gemini AI entity detection",
    "description": "## Who's it for\n\nThis workflow is perfect for individuals, small businesses, or households who need to:\n- Automatically process and categorize expense receipts\n- Extract structured data from invoices and receipts using AI\n- Store receipts in multiple locations (Google Drive and S3)\n- Send automated email notifications with expense details\n- Send documents to accounting systems via email hooks\n\n## How it works\n\nThis comprehensive expense processing workflow combines AI-powered document analysis with automated file management and notifications. Here's the complete flow:\n\n1. **Form Submission**: Users submit expenses through a web form with receipt upload and category selection (Personal, Business, or Shared/Home)\n\n2. **AI Document Processing**: The workflow extracts text from PDF receipts using OCR, then uses Google Gemini AI to parse and structure the data into a standardized JSON format including vendor details, amounts, dates, and categorization\n\n3. **Smart Routing**: Based on the expense category, receipts are automatically routed to different processing paths with category-specific folder organization\n\n4. **Multi-Destination Storage**: Receipts are uploaded to:\n   - Google Drive (organized by year/month folders)\n   - S3 cloud storage buckets\n   - Different destinations based on expense type\n\n5. **Email Notifications**: Sends formatted HTML email notifications with complete expense details and links to stored receipts\n\n6. **Accounting System Integration**: Automatically forwards business expenses to accounting systems via email hooks (customizable per user requirements)\n\n## Requirements\n\n### Credentials needed:\n- **Google Gemini API**: For AI-powered document analysis\n- **Google Drive OAuth2**: For personal and business drive access\n- **Gmail OAuth2**: For sending email notifications\n- **S3 Storage**: For cloud backup (AWS S3, Wasabi, etc.)\n\n### Services used:\n- Google Drive (multiple accounts supported)\n- Google Gemini AI\n- Gmail\n- S3-compatible storage\n- Form trigger webhook\n\n## How to set up\n\n### Step 1: Configure Credentials\n1. Set up Google Gemini API credentials in n8n\n2. Configure Google Drive OAuth2 for both personal and business accounts\n3. Add Gmail OAuth2 credentials\n4. Set up S3 storage credentials\n\n### Step 2: Update Configuration\n1. Replace all placeholder values:\n   - `YOUR_GEMINI_CREDENTIAL_ID` with your Gemini credential ID\n   - `YOUR_PERSONAL_GDRIVE_CREDENTIAL_ID` with personal Drive credential\n   - `YOUR_BUSINESS_GDRIVE_CREDENTIAL_ID` with business Drive credential\n   - `YOUR_GMAIL_CREDENTIAL_ID` with Gmail credential\n   - `YOUR_S3_CREDENTIAL_ID` with S3 credential\n\n2. Update Google Drive folder structure:\n   - Replace `YOUR_BUSINESS_DRIVE_ID` and `YOUR_SHARED_DRIVE_ID` with actual drive IDs\n   - Update the JavaScript code in the three Code nodes with your actual folder mapping\n\n3. Configure email addresses:\n   - Replace `user@example.com` with your notification email\n   - Replace `receipts@paperless-service.com` with your accounting system's email hook (this is a mail hook for uploading documents to small business accounting systems - can be modified per user requirements)\n\n4. Update S3 bucket names:\n   - Replace `business-expenses`, `personal-expenses`, and `shared-expenses` with your bucket names\n\n### Step 3: Set Up Folder Structure\nCreate organized folder structures in your Google Drives:\n```\nDrive Root/\n├── 2024/\n│   ├── January/\n│   ├── February/\n│   └── ... (all months)\n├── 2025/\n│   ├── January/\n│   └── ... (all months)\n└── 2026/\n    └── ... (all months)\n```\n\n### Step 4: Test the Workflow\n1. Activate the workflow\n2. Submit a test expense through the form\n3. Verify files are uploaded to correct locations\n4. Check email notifications are received\n\n## How to customize the workflow\n\n### Expense Categories\nModify the form dropdown options and conditional logic to add/remove expense categories:\n- Edit the \"On form submission\" node form fields\n- Update the IF condition nodes for routing\n- Add new processing paths as needed\n\n### AI Processing Schema\nCustomize the structured output parser schema to extract different fields:\n- Modify the JSON schema in the \"Structured Output Parser\" node\n- Update the AI system prompt for different extraction requirements\n- Add new fields for specific business needs\n\n### Storage Destinations\nAdd or modify storage locations:\n- Duplicate upload nodes for additional cloud services\n- Modify folder organization logic in Code nodes\n- Add new conditional routing for different storage rules\n\n### Email Templates\nCustomize the HTML email template:\n- Edit the email message content in the Gmail node\n- Add/remove expense fields in the table\n- Modify styling and branding\n\n### Folder Organization\nUpdate the JavaScript code in Code nodes to match your folder structure:\n- Modify the CSV data with your actual folder IDs\n- Change the date-based organization logic\n- Add custom folder naming conventions\n\n### Integration Extensions\nExtend the workflow with additional integrations:\n- Add Slack notifications\n- Connect to accounting software (QuickBooks, Xero)\n- Integrate with expense management platforms\n- Add approval workflows for business expenses",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "personal",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "business",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "shared",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "On form submission",
      "type": "n8n-nodes-base.formTrigger",
      "role": "formTrigger",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "role": "extractFromFile",
      "configDescription": "Version 1"
    },
    {
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Google Gemini Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Upload file",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Upload file1",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Code1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Code2",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Upload file2",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Merge2",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Send a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Send a message1",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Upload a file",
      "type": "n8n-nodes-base.s3",
      "role": "s3",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload a file1",
      "type": "n8n-nodes-base.s3",
      "role": "s3",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload a file2",
      "type": "n8n-nodes-base.s3",
      "role": "s3",
      "configDescription": "Version 1"
    }
  ]
}