{
  "id": 10539,
  "slug": "10539",
  "title": "Generate empathetic customer replies with Claude AI and auto-escalation",
  "description": "\n## üß† Overview\nGenerate empathetic, professional reply drafts for customer or user messages.  \nThe workflow detects **sentiment**, **tone**, and **risk level**, drafts a concise response, sanitizes PII/links/emojis, and **auto-escalates** risky or low-confidence cases to human review.\n\n---\n\n## ‚öôÔ∏è How It Works\n1. **Input** ‚Äî Manual Test or Webhook Trigger  \n2. **AI Agent (Empathy)** ‚Äî returns `{ sentiment, tone, reply, confidence, needs_handover }`  \n3. **Post-Process & Sanitize** ‚Äî removes URLs/hashtags, masks PII, caps length  \n4. **Risk & Handover Rules** ‚Äî checks confidence threshold, risk words, and negativity  \n5. **Routing** ‚Äî auto-send safe replies or flag to **Needs Review**\n\n---\n\n## üß© Setup Instructions (3‚Äì5 min)\n- Open **Set Config1** and adjust:\n  - `MAX_LEN` (default 600)\n  - `ADD_FOLLOWUP_QUESTION` (true/false)\n  - `FORMALITY` (`auto | casual | polite`)\n  - `EMOJI_ALLOWED` (true/false), `BLOCK_LINKS` (true/false)\n  - `RISK_WORDS` (e.g., `refund, lawsuit, self-harm`)\n- Connect **Anthropic credential** to **Anthropic Chat Model**\n- *(Optional)* Replace **Manual Trigger** with **Webhook Trigger** for real-time use\n\n&gt; Tip: If you need to show literal angle brackets in messages, use backticks like ``&lt;example&gt;`` (no HTML entities needed).\n\n---\n\n## üìö Use Cases\n### 1) SaaS Billing Complaints\n- **Input:** ‚ÄúI was billed after canceling. This is unacceptable.‚Äù  \n- **Output:** Calm, apologetic reply with refund steps; escalates if `refund` is in `RISK_WORDS` or `confidence &lt; 0.45`.\n\n### 2) Product Bug Reports\n- **Input:** ‚ÄúUpload fails on large files since yesterday.‚Äù  \n- **Output:** Acknowledges impact, requests logs, offers workaround; routes to auto-send if low risk and high confidence.\n\n### 3) Delivery/Logistics Delays\n- **Input:** ‚ÄúMy order is late again. Should I file a complaint?‚Äù  \n- **Output:** Empathetic apology, ETA guidance, partial credit policy note; escalates if language indicates legal action.\n\n### 4) Community Moderation / Abuse\n- **Input:** ‚ÄúSupport is useless‚Äîyou‚Äôre all scammers.‚Äù  \n- **Output:** De-escalating, policy-aligned response; auto-flags due to negative sentiment + risk keyword match.\n\n### 5) Safety / Self-harm Mentions\n- **Input:** ‚ÄúI feel like hurting myself if this isn‚Äôt fixed.‚Äù  \n- **Output:** **Immediate escalation**, inserts approved resources; never auto-sends.\n\n---\n\n## üö® Auto-Escalation Rules (defaults)\n- **Negative** sentiment\n- Message matches any `RISK_WORDS`\n- `confidence &lt; 0.45`\n- Mentions of **legal**, **harassment**, or **self-harm** context\n\n---\n\n## üß™ Notes & Best Practices\n- üîê No hardcoded API keys ‚Äî use **n8n Credentials**\n- üß≠ Tune thresholds and `RISK_WORDS` to your org policy\n- üß© Works on self-hosted or cloud n8n\n- ‚úÖ Treat outputs as **drafts**; ship after human/policy review\n\n---\n\n## üîó Resources\n- **GitHub (template JSON):** https://github.com/yskmtb0714/n8n-workflows/blob/main/empathy-reply-assistant.json",
  "featuredImage": "/data/workflows/10539/10539.webp",
  "author": {
    "id": 101,
    "slug": "yusuke-matsuba",
    "name": "Yusuke",
    "avatar": ""
  },
  "categories": [
    "Ticket Management",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 32,
  "downloads": 3,
  "createdAt": "2025-11-05T15:11:52.947Z",
  "updatedAt": "2026-01-16T09:05:24.348Z",
  "publishedAt": "2025-11-05T15:11:52.947Z",
  "nodes": 21,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/10539",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Generate empathetic customer replies with Claude AI and auto-escalation",
    "workflowName": "Generate empathetic customer replies with Claude AI and auto-escalation",
    "description": "## üß† Overview\nGenerate empathetic, professional reply drafts for customer or user messages.  \nThe workflow detects **sentiment**, **tone**, and **risk level**, drafts a concise response, sanitizes PII/links/emojis, and **auto-escalates** risky or low-confidence cases to human review.\n\n---\n\n## ‚öôÔ∏è How It Works\n1. **Input** ‚Äî Manual Test or Webhook Trigger  \n2. **AI Agent (Empathy)** ‚Äî returns `{ sentiment, tone, reply, confidence, needs_handover }`  \n3. **Post-Process & Sanitize** ‚Äî removes URLs/hashtags, masks PII, caps length  \n4. **Risk & Handover Rules** ‚Äî checks confidence threshold, risk words, and negativity  \n5. **Routing** ‚Äî auto-send safe replies or flag to **Needs Review**\n\n---\n\n## üß© Setup Instructions (3‚Äì5 min)\n- Open **Set Config1** and adjust:\n  - `MAX_LEN` (default 600)\n  - `ADD_FOLLOWUP_QUESTION` (true/false)\n  - `FORMALITY` (`auto | casual | polite`)\n  - `EMOJI_ALLOWED` (true/false), `BLOCK_LINKS` (true/false)\n  - `RISK_WORDS` (e.g., `refund, lawsuit, self-harm`)\n- Connect **Anthropic credential** to **Anthropic Chat Model**\n- *(Optional)* Replace **Manual Trigger** with **Webhook Trigger** for real-time use\n\n&gt; Tip: If you need to show literal angle brackets in messages, use backticks like ``&lt;example&gt;`` (no HTML entities needed).\n\n---\n\n## üìö Use Cases\n### 1) SaaS Billing Complaints\n- **Input:** ‚ÄúI was billed after canceling. This is unacceptable.‚Äù  \n- **Output:** Calm, apologetic reply with refund steps; escalates if `refund` is in `RISK_WORDS` or `confidence &lt; 0.45`.\n\n### 2) Product Bug Reports\n- **Input:** ‚ÄúUpload fails on large files since yesterday.‚Äù  \n- **Output:** Acknowledges impact, requests logs, offers workaround; routes to auto-send if low risk and high confidence.\n\n### 3) Delivery/Logistics Delays\n- **Input:** ‚ÄúMy order is late again. Should I file a complaint?‚Äù  \n- **Output:** Empathetic apology, ETA guidance, partial credit policy note; escalates if language indicates legal action.\n\n### 4) Community Moderation / Abuse\n- **Input:** ‚ÄúSupport is useless‚Äîyou‚Äôre all scammers.‚Äù  \n- **Output:** De-escalating, policy-aligned response; auto-flags due to negative sentiment + risk keyword match.\n\n### 5) Safety / Self-harm Mentions\n- **Input:** ‚ÄúI feel like hurting myself if this isn‚Äôt fixed.‚Äù  \n- **Output:** **Immediate escalation**, inserts approved resources; never auto-sends.\n\n---\n\n## üö® Auto-Escalation Rules (defaults)\n- **Negative** sentiment\n- Message matches any `RISK_WORDS`\n- `confidence &lt; 0.45`\n- Mentions of **legal**, **harassment**, or **self-harm** context\n\n---\n\n## üß™ Notes & Best Practices\n- üîê No hardcoded API keys ‚Äî use **n8n Credentials**\n- üß≠ Tune thresholds and `RISK_WORDS` to your org policy\n- üß© Works on self-hosted or cloud n8n\n- ‚úÖ Treat outputs as **drafts**; ship after human/policy review\n\n---\n\n## üîó Resources\n- **GitHub (template JSON):** https://github.com/yskmtb0714/n8n-workflows/blob/main/empathy-reply-assistant.json",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Test Input (Change Me)1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Set Config1",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Ensure Session1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Agent (Empathy)1",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 1.6"
    },
    {
      "name": "Anthropic Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "role": "lmChatAnthropic",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Memory (Recent 4)",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "role": "memoryBufferWindow",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Post-Process & Sanitize1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Risk & Handover Rules1",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "If needs_handover1",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Draft (Needs Review)",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Draft (Auto-OK)",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "for real-time replies",
      "type": "n8n-nodes-base.webhook",
      "role": "webhook",
      "configDescription": "Version 2.1"
    },
    {
      "name": "(5‚Äì10 min) for missed or queued",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Update a message",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "Save to Google Sheets1",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "for testing",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}