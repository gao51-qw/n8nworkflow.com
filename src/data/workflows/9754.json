{
  "id": 9754,
  "slug": "9754",
  "title": "Extract business card data from Telegram to Google Sheets with OpenRouter AI Vision",
  "description": "## **Title (suggested):**\nExtract business card data from Telegram to Google Sheets\n\n## **Who’s it for**\n\nTeams that receive business cards digitally (sales, marketing, back-office) and want a plug-and-play way to capture contacts into a sheet without manual typing.\n\n## **What it does / How it works**\n\nThis workflow ingests a business card sent to your Telegram bot, detects whether the message contains an image or text, extracts key fields with an AI Vision Agent (company, full name, department, job title, postal code, address, phone, mobile, fax, email, website), and appends or updates a contact row in Google Sheets automatically.\n\n## **How to set up**\n\nConnect Telegram (bot token) and enable file download.\n\nConnect your AI provider (OpenRouter or equivalent) used by the AI Vision Agent.\n\nConnect Google Sheets and select your spreadsheet + sheet tab.\n\nRename nodes clearly and keep sticky notes: one overview note (this description) + step notes.\n\nTest by sending a sample card image to your bot and verify the row is appended/updated.\n\nRequirements\n\nTelegram Bot API credential\n\nAI chat/vision credential\n\nGoogle Sheets OAuth credential and an accessible spreadsheet\n\nHow to customize the workflow\n\nMap fields to your sheet headers (add/remove columns as needed).\n\nAdjust the system prompt to prefer your locale or specific field formats.\n\nChange the matching key for update logic (e.g., company name or email).\n\nAdd downstream steps (CRM push, dedupe rules, notifications).\n\nSecurity note: Do not hardcode API keys or include real IDs/emails. Use credentials and environment configs only.\n\n## **JSON**\n[\n{\n  \"company_name\": \"Example Company Ltd.\",\n  \"department\": \"Sales\",\n  \"job_title\": \"Sales Manager\",\n  \"full_name\": \"Taro Yamada\",\n  \"postal_code\": \"100-0001\",\n  \"address\": \"1-1-1 Marunouchi, Chiyoda-ku, Tokyo\",\n  \"phone_number\": \"+81-3-0000-0000\",\n  \"mobile_phone_number\": \"+81-90-0000-0000\",\n  \"fax_number\": \"+81-3-1111-1111\",\n  \"email\": \"example@company.com\",\n  \"website_url\": \"https://example.com\"\n}\n]\n\n## **Troubleshooting**\n**Nothing appears in Google Sheets**\n\n**Solution:**\nVerify that your Google Sheets credentials are correctly authorized.\n\nConfirm the Spreadsheet ID and Sheet Name in the node match your target file.\n\nMake sure the Google Sheets node is connected downstream of the AI Vision Agent.\n\nIf the workflow runs successfully but nothing is added, check whether the matching column (company_name) already exists — in appendOrUpdate mode it will only update that row.\n\n**AI returns incomplete or invalid data**\n\n**Solution:**\nReview the system prompt in the AI Vision Agent to ensure it instructs the model to return a structured JSON object with all required fields (company name, full name, department, job title, address, etc.).\n\nIf the result is partial, verify the image quality of the uploaded business card — low contrast or skewed images can reduce OCR accuracy.\n\nYou can reduce temperature in the AI node to make output more deterministic.\n\n**Workflow doesn’t start automatically**\n\n**Solution:**\nCheck that the workflow is activated (toggle is ON in the top right of n8n).\n\nVerify the Webhook URL is correctly registered in Telegram’s bot settings.\n\nRun manually once to ensure all credentials and nodes are configured correctly.",
  "featuredImage": "/data/workflows/9754/9754.webp",
  "author": {
    "id": 101,
    "slug": "harukikuwai8098",
    "name": "Haruki Kuwai",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "AI Summarization"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 357,
  "downloads": 35,
  "createdAt": "2025-10-16T06:40:26.734Z",
  "updatedAt": "2026-01-16T09:01:46.840Z",
  "publishedAt": "2025-10-16T06:40:26.734Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9754",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Extract business card data from Telegram to Google Sheets with OpenRouter AI Vision",
    "workflowName": "Extract business card data from Telegram to Google Sheets with OpenRouter AI Vision",
    "description": "## **Title (suggested):**\nExtract business card data from Telegram to Google Sheets\n\n## **Who’s it for**\n\nTeams that receive business cards digitally (sales, marketing, back-office) and want a plug-and-play way to capture contacts into a sheet without manual typing.\n\n## **What it does / How it works**\n\nThis workflow ingests a business card sent to your Telegram bot, detects whether the message contains an image or text, extracts key fields with an AI Vision Agent (company, full name, department, job title, postal code, address, phone, mobile, fax, email, website), and appends or updates a contact row in Google Sheets automatically.\n\n## **How to set up**\n\nConnect Telegram (bot token) and enable file download.\n\nConnect your AI provider (OpenRouter or equivalent) used by the AI Vision Agent.\n\nConnect Google Sheets and select your spreadsheet + sheet tab.\n\nRename nodes clearly and keep sticky notes: one overview note (this description) + step notes.\n\nTest by sending a sample card image to your bot and verify the row is appended/updated.\n\nRequirements\n\nTelegram Bot API credential\n\nAI chat/vision credential\n\nGoogle Sheets OAuth credential and an accessible spreadsheet\n\nHow to customize the workflow\n\nMap fields to your sheet headers (add/remove columns as needed).\n\nAdjust the system prompt to prefer your locale or specific field formats.\n\nChange the matching key for update logic (e.g., company name or email).\n\nAdd downstream steps (CRM push, dedupe rules, notifications).\n\nSecurity note: Do not hardcode API keys or include real IDs/emails. Use credentials and environment configs only.\n\n## **JSON**\n[\n{\n  \"company_name\": \"Example Company Ltd.\",\n  \"department\": \"Sales\",\n  \"job_title\": \"Sales Manager\",\n  \"full_name\": \"Taro Yamada\",\n  \"postal_code\": \"100-0001\",\n  \"address\": \"1-1-1 Marunouchi, Chiyoda-ku, Tokyo\",\n  \"phone_number\": \"+81-3-0000-0000\",\n  \"mobile_phone_number\": \"+81-90-0000-0000\",\n  \"fax_number\": \"+81-3-1111-1111\",\n  \"email\": \"example@company.com\",\n  \"website_url\": \"https://example.com\"\n}\n]\n\n## **Troubleshooting**\n**Nothing appears in Google Sheets**\n\n**Solution:**\nVerify that your Google Sheets credentials are correctly authorized.\n\nConfirm the Spreadsheet ID and Sheet Name in the node match your target file.\n\nMake sure the Google Sheets node is connected downstream of the AI Vision Agent.\n\nIf the workflow runs successfully but nothing is added, check whether the matching column (company_name) already exists — in appendOrUpdate mode it will only update that row.\n\n**AI returns incomplete or invalid data**\n\n**Solution:**\nReview the system prompt in the AI Vision Agent to ensure it instructs the model to return a structured JSON object with all required fields (company name, full name, department, job title, address, etc.).\n\nIf the result is partial, verify the image quality of the uploaded business card — low contrast or skewed images can reduce OCR accuracy.\n\nYou can reduce temperature in the AI node to make output more deterministic.\n\n**Workflow doesn’t start automatically**\n\n**Solution:**\nCheck that the workflow is activated (toggle is ON in the top right of n8n).\n\nVerify the Webhook URL is correctly registered in Telegram’s bot settings.\n\nRun manually once to ensure all credentials and nodes are configured correctly.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Add to Google Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Check Input Type",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2"
    },
    {
      "name": "AI Vision Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2"
    },
    {
      "name": "OpenAI Vision Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "role": "lmChatOpenRouter",
      "configDescription": "Version 1"
    },
    {
      "name": "Ingredient Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "role": "outputParserStructured",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "role": "telegramTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}