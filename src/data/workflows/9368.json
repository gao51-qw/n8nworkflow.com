{
  "id": 9368,
  "slug": "9368",
  "title": "Automate monthly CrUX report transfer from BigQuery to NocoDB with data cleanup",
  "description": "## **Overview**\n\nThis n8n workflow automatically **retrieves the monthly CrUX (Chrome User Experience) Report from Google BigQuery** and updates the data in **NocoDB**.  \nIt removes the previous month‚Äôs data before inserting the new dataset, ensuring your database always contains the latest CrUX rankings for website origins.  \nThe flow is fully automated, using schedule triggers to handle both data cleanup and data insertion each month.\n\n---\n\n## ‚úÖ **Tasks**\n\n* ‚è∞ Runs automatically on a **monthly schedule**  \n* üî¢ Converts the **month name to a numeric value** for table selection  \n* üßπ Deletes last month‚Äôs CrUX data from **NocoDB**  \n* üåê Queries **Google BigQuery** for the latest monthly dataset  \n* üíæ Inserts the new CrUX rankings into **NocoDB**  \n* ‚öôÔ∏è Keeps your database up to date with **zero manual effort**\n\n---\n\n## **üõ† How to Use**\n\n1Ô∏è‚É£ **Set Up BigQuery Access**  \n   - Connect your **Google BigQuery** credentials.  \n   - Make sure your project includes access to the **chrome-ux-report** public dataset.  \n\n2Ô∏è‚É£ **Adjust the Query**  \n   - In the **Google BigQuery** node, change the `LIMIT` value to control how many top-ranked sites are retrieved.  \n   - Ensure the `{{ $json.table }}` field correctly references the dataset for the desired month (e.g., `202509`).  \n\n3Ô∏è‚É£ **Prepare NocoDB Table**  \n   - Create a table in **NocoDB** with fields: `origin`, `crux_rank`, and any additional metadata you wish to track.  \n\n4Ô∏è‚É£ **Schedule Automation**  \n   - The workflow includes two **Schedule Trigger** nodes:\n     - One runs the **data cleanup** process (deletes last month).  \n     - One runs the **data insertion** for the new month.  \n\n5Ô∏è‚É£ **Run or Activate the Workflow**  \n   - Activate it to run automatically each month.  \n   - You can also run it manually to refresh data on demand.\n\n## **üìã Prerequisites**\n\nBefore running this workflow, make sure you complete the following setup steps:\n\n* üß± **Enable BigQuery API**  \n  - Go to [Google Cloud Console ‚Üí APIs & Services](https://console.cloud.google.com/apis/library/bigquery.googleapis.com)  \n  - Enable the **BigQuery API** for your project.\n\n* üìä **Access the Chrome UX Report Dataset**  \n  - In BigQuery, search for **‚ÄúChrome UX Report‚Äù** in the Marketplace or go directly to:  \n    [https://console.cloud.google.com/marketplace/product/chrome-ux-report/chrome-ux-report](https://console.cloud.google.com/marketplace/product/chrome-ux-report/chrome-ux-report)  \n  - Click **‚ÄúView Dataset‚Äù** and add it to your BigQuery project.\n\n* üîë **Connect BigQuery to n8n**  \n  - In n8n, create credentials for your Google BigQuery account using **Service Account Authentication**.  \n  - Ensure the account has permission to query the `chrome-ux-report` dataset.\n\n* üóÑÔ∏è **Create a NocoDB Table**  \n  - In NocoDB, create a new table to store your CrUX data with the following fields:  \n    - **origin** ‚Üí Short text  \n    - **crux_rank** ‚Üí Number  \n\n* ‚öôÔ∏è **Connect NocoDB to n8n**  \n  - Use your **NocoDB API Token** to connect and allow the workflow to read/write data.\n\n\n## **What is CrUX Rank?**\n\n**CrUX Rank** (Chrome User Experience Rank) is a metric from Google‚Äôs **Chrome UX Report (CrUX)** dataset that indicates a website‚Äôs **popularity based on real user visits**.  \nIt reflects how frequently an origin (website) is loaded by Chrome users around the world.\n\n- A **lower rank number** means the site is **more popular** (e.g., rank 1 = top site).  \n- The data is collected from **anonymized Chrome usage statistics**, aggregated monthly.  \n- This rank helps you **track site popularity trends** and compare your domain‚Äôs visibility over time.",
  "featuredImage": "/data/workflows/9368/9368.webp",
  "author": {
    "id": 101,
    "slug": "salimi",
    "name": "Nima Salimi",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 45,
  "downloads": 4,
  "createdAt": "2025-10-08T07:39:19.752Z",
  "updatedAt": "2026-01-16T09:00:11.591Z",
  "publishedAt": "2025-10-08T07:39:19.752Z",
  "nodes": 14,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9368",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate monthly CrUX report transfer from BigQuery to NocoDB with data cleanup",
    "workflowName": "Automate monthly CrUX report transfer from BigQuery to NocoDB with data cleanup",
    "description": "**\n\nThis n8n workflow automatically **retrieves the monthly CrUX (Chrome User Experience) Report from Google BigQuery** and updates the data in **NocoDB**.  \nIt removes the previous month‚Äôs data before inserting the new dataset, ensuring your database always contains the latest CrUX rankings for website origins.  \nThe flow is fully automated, using schedule triggers to handle both data cleanup and data insertion each month.\n\n---\n\n## ‚úÖ **Tasks**\n\n* ‚è∞ Runs automatically on a **monthly schedule**  \n* üî¢ Converts the **month name to a numeric value** for table selection  \n* üßπ Deletes last month‚Äôs CrUX data from **NocoDB**  \n* üåê Queries **Google BigQuery** for the latest monthly dataset  \n* üíæ Inserts the new CrUX rankings into **NocoDB**  \n* ‚öôÔ∏è Keeps your database up to date with **zero manual effort**\n\n---\n\n## **üõ† How to Use**\n\n1Ô∏è‚É£ **Set Up BigQuery Access**  \n   - Connect your **Google BigQuery** credentials.  \n   - Make sure your project includes access to the **chrome-ux-report** public dataset.  \n\n2Ô∏è‚É£ **Adjust the Query**  \n   - In the **Google BigQuery** node, change the `LIMIT` value to control how many top-ranked sites are retrieved.  \n   - Ensure the `{{ $json.table }}` field correctly references the dataset for the desired month (e.g., `202509`).  \n\n3Ô∏è‚É£ **Prepare NocoDB Table**  \n   - Create a table in **NocoDB** with fields: `origin`, `crux_rank`, and any additional metadata you wish to track.  \n\n4Ô∏è‚É£ **Schedule Automation**  \n   - The workflow includes two **Schedule Trigger** nodes:\n     - One runs the **data cleanup** process (deletes last month).  \n     - One runs the **data insertion** for the new month.  \n\n5Ô∏è‚É£ **Run or Activate the Workflow**  \n   - Activate it to run automatically each month.  \n   - You can also run it manually to refresh data on demand.\n\n## **üìã Prerequisites**\n\nBefore running this workflow, make sure you complete the following setup steps:\n\n* üß± **Enable BigQuery API**  \n  - Go to [Google Cloud Console ‚Üí APIs & Services](https://console.cloud.google.com/apis/library/bigquery.googleapis.com)  \n  - Enable the **BigQuery API** for your project.\n\n* üìä **Access the Chrome UX Report Dataset**  \n  - In BigQuery, search for **‚ÄúChrome UX Report‚Äù** in the Marketplace or go directly to:  \n    [https://console.cloud.google.com/marketplace/product/chrome-ux-report/chrome-ux-report](https://console.cloud.google.com/marketplace/product/chrome-ux-report/chrome-ux-report)  \n  - Click **‚ÄúView Dataset‚Äù** and add it to your BigQuery project.\n\n* üîë **Connect BigQuery to n8n**  \n  - In n8n, create credentials for your Google BigQuery account using **Service Account Authentication**.  \n  - Ensure the account has permission to query the `chrome-ux-report` dataset.\n\n* üóÑÔ∏è **Create a NocoDB Table**  \n  - In NocoDB, create a new table to store your CrUX data with the following fields:  \n    - **origin** ‚Üí Short text  \n    - **crux_rank** ‚Üí Number  \n\n* ‚öôÔ∏è **Connect NocoDB to n8n**  \n  - Use your **NocoDB API Token** to connect and allow the workflow to read/write data.\n\n\n## **What is CrUX Rank?**\n\n**CrUX Rank** (Chrome User Experience Rank) is a metric from Google‚Äôs **Chrome UX Report (CrUX)** dataset that indicates a website‚Äôs **popularity based on real user visits**.  \nIt reflects how frequently an origin (website) is loaded by Chrome users around the world.\n\n- A **lower rank number** means the site is **more popular** (e.g., rank 1 = top site).  \n- The data is collected from **anonymized Chrome usage statistics**, aggregated monthly.  \n- This rank helps you **track site popularity trends** and compare your domain‚Äôs visibility over time.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Google BigQuery",
      "type": "n8n-nodes-base.googleBigQuery",
      "role": "googleBigQuery",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Get Last Month Data",
      "type": "n8n-nodes-base.nocoDb",
      "role": "nocoDb",
      "configDescription": "Version 3"
    },
    {
      "name": "Delete in NocoDB",
      "type": "n8n-nodes-base.nocoDb",
      "role": "nocoDb",
      "configDescription": "Version 3"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Append Crux Data into NocoDB",
      "type": "n8n-nodes-base.nocoDb",
      "role": "nocoDb",
      "configDescription": "Version 3"
    },
    {
      "name": "Convert month name to number",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "role": "set",
      "configDescription": "Version 3.4"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Monthly Trigger1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Monthly Trigger2",
      "type": "n8n-nodes-base.scheduleTrigger",
      "role": "scheduleTrigger",
      "configDescription": "Version 1.2"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}