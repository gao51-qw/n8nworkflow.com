{
  "id": 9610,
  "slug": "9610",
  "title": "Automatic Gmail invoice PDF upload to Google Drive with spreadsheet logging",
  "description": "## Sort invoice PDFs from Gmail to Google Drive and Google Sheets\n\n## Who’s it for\n\nFreelancers, finance teams, and small businesses that receive invoice PDFs by email and want them automatically saved to Google Drive and logged in Google Sheets—without manual downloading or copy-pasting.\n\n## How it works / What it does\n\nThis workflow watches your Gmail inbox for unread messages that match an invoice pattern (e.g., `subject:invoice filename:pdf`). For each email, it checks for attachments, uploads each PDF to a chosen Google Drive folder, and appends a new row to a Google Sheet with useful metadata: received time, sender, subject, filename, Drive link, and IDs. Finally, it marks the original email as read to avoid duplicates.\n\n## How to set up\n\n1. Open the **Config (Set)** node and fill in:\n\n   * `drive_folder_id` (or leave blank for root)\n   * `spreadsheet_id` (from the Sheet URL)\n   * `sheet_name` (e.g., `Invoices`)\n2. Connect credentials for **Gmail**, **Google Drive**, and **Google Sheets** in each node.\n3. Adjust the Gmail search query if needed (language/vendor terms).\n4. Run once manually to verify data mapping, then activate.\n\n## Requirements\n\n* n8n with valid credentials for Gmail, Google Drive, and Google Sheets.\n* A Google Sheet with appropriate headers (or let the workflow write new columns).\n\n## How to customize the workflow\n\n* Replace Gmail with **IMAP** or **Microsoft Outlook** if you don’t use Gmail; remove the “mark as read” step accordingly.\n* Add parsing (e.g., extract invoice totals or vendor names via PDF/AI nodes) before the Sheets step.\n* Route based on vendor: create subfolders dynamically in Drive and write to different tabs.\n* Notify your team by adding Slack/Email nodes after logging to Sheets.\n",
  "featuredImage": "/data/workflows/9610/9610.webp",
  "author": {
    "id": 101,
    "slug": "minami",
    "name": "Toshiya Minami",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 557,
  "downloads": 55,
  "createdAt": "2025-10-14T09:34:25.816Z",
  "updatedAt": "2026-01-16T09:01:12.172Z",
  "publishedAt": "2025-10-14T09:34:25.816Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9610",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automatic Gmail invoice PDF upload to Google Drive with spreadsheet logging",
    "workflowName": "Automatic Gmail invoice PDF upload to Google Drive with spreadsheet logging",
    "description": "## Sort invoice PDFs from Gmail to Google Drive and Google Sheets\n\n## Who’s it for\n\nFreelancers, finance teams, and small businesses that receive invoice PDFs by email and want them automatically saved to Google Drive and logged in Google Sheets—without manual downloading or copy-pasting.\n\n## How it works / What it does\n\nThis workflow watches your Gmail inbox for unread messages that match an invoice pattern (e.g., `subject:invoice filename:pdf`). For each email, it checks for attachments, uploads each PDF to a chosen Google Drive folder, and appends a new row to a Google Sheet with useful metadata: received time, sender, subject, filename, Drive link, and IDs. Finally, it marks the original email as read to avoid duplicates.\n\n## How to set up\n\n1. Open the **Config (Set)** node and fill in:\n\n   * `drive_folder_id` (or leave blank for root)\n   * `spreadsheet_id` (from the Sheet URL)\n   * `sheet_name` (e.g., `Invoices`)\n2. Connect credentials for **Gmail**, **Google Drive**, and **Google Sheets** in each node.\n3. Adjust the Gmail search query if needed (language/vendor terms).\n4. Run once manually to verify data mapping, then activate.\n\n## Requirements\n\n* n8n with valid credentials for Gmail, Google Drive, and Google Sheets.\n* A Google Sheet with appropriate headers (or let the workflow write new columns).\n\n## How to customize the workflow\n\n* Replace Gmail with **IMAP** or **Microsoft Outlook** if you don’t use Gmail; remove the “mark as read” step accordingly.\n* Add parsing (e.g., extract invoice totals or vendor names via PDF/AI nodes) before the Sheets step.\n* Route based on vendor: create subfolders dynamically in Drive and write to different tabs.\n* Notify your team by adding Slack/Email nodes after logging to Sheets.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Gmail Trigger",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1.1"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Has PDF Attachments?",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Upload to Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Log to Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.5"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Mark Email as Read",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "If",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    }
  ]
}