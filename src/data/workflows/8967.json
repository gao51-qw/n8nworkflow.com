{
  "id": 8967,
  "slug": "8967",
  "title": "AI email reply based on HubSpot data + Slack approval",
  "description": "This n8n template drafts customer-ready email replies using Google Gemini, enriched with HubSpot context (contact, deals, companies, tickets). Each draft is routed to Slack for one-click approval before it’s sent from Gmail—so you move fast without losing control.\n\nIdeal for support and sales teams that want speedy, personalized responses while keeping humans in the loop.\n\n---\n\n## How it works\n\n* **Gmail Trigger** watches for new inbound emails.\n* **Sender filter** excludes internal domains (e.g., `n8n.io`) to avoid auto-replying to teammates.\n* **HubSpot contact lookup** finds the sender and fetches associated **deals/companies/tickets** via association + batch read.\n* **CRM context is normalized** into clean, LLM-friendly fields (no IDs or sensitive noise).\n* **Gemini (Google AI Studio)** generates a concise, friendly reply using:\n\n  * Sender name, subject, and message snippet\n  * Safe, relevant HubSpot context (e.g., top 1–2 deals or an open ticket)\n  * Style constraints (≤ \\~150 words, single CTA, optional clarifying question)\n* **Slack approval** posts the draft to a channel; if **approved**, n8n **replies via Gmail** in the original thread.\n\n---\n\n## How to use\n\n1. **Gmail:** Connect the same account for the trigger and reply nodes.\n2. **HubSpot:** Connect OAuth on the search + HTTP request nodes.\n3. **Gemini:** Add your **Google AI Studio** API key to the **Google Gemini Chat Model** node.\n4. **Slack:** Connect and select the channel for draft approvals.\n5. (Optional) **Filter:** Adjust the Allowed Sender filter before going live.\n6. (Optional) **Prompt:** Edit “Draft Reply (AI Agent)” tone/length or how much CRM detail to include.\n7. Activate the workflow. New emails will produce Slack-approved replies automatically.\n\n---\n\n## Requirements\n\n* **Gmail** (trigger + send)\n* **HubSpot** (OAuth2) for contact + associations\n* **Slack** for approval step\n* **Google Gemini** (Google AI Studio API key)\n\n---\n\n## Notes & customization\n\n* **Safety rails:** The prompt avoids exposing IDs/raw JSON and caps CRM details to what’s useful.\n* **Auto-send mode:** Skip Slack if you want fully automated replies for specific senders/labels.\n* **Richer context:** Extend the batch read to pull more properties (e.g., next step, renewal date).\n* **Triage:** Branch on subject/labels to route billing vs. technical requests to different prompts.\n* **QA queue:** If the model asks a clarifying question, keep it to **one**—the node enforces that.",
  "featuredImage": "/data/workflows/8967/8967.webp",
  "author": {
    "id": 101,
    "slug": "miha",
    "name": "Miha",
    "avatar": ""
  },
  "categories": [
    "Lead Nurturing",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2214,
  "downloads": 221,
  "createdAt": "2025-09-26T15:48:45.383Z",
  "updatedAt": "2026-01-16T08:58:35.408Z",
  "publishedAt": "2025-09-26T15:48:45.383Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8967",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "AI email reply based on HubSpot data + Slack approval",
    "workflowName": "AI email reply based on HubSpot data + Slack approval",
    "description": "This n8n template drafts customer-ready email replies using Google Gemini, enriched with HubSpot context (contact, deals, companies, tickets). Each draft is routed to Slack for one-click approval before it’s sent from Gmail—so you move fast without losing control.\n\nIdeal for support and sales teams that want speedy, personalized responses while keeping humans in the loop.\n\n---\n\n## How it works\n\n* **Gmail Trigger** watches for new inbound emails.\n* **Sender filter** excludes internal domains (e.g., `n8n.io`) to avoid auto-replying to teammates.\n* **HubSpot contact lookup** finds the sender and fetches associated **deals/companies/tickets** via association + batch read.\n* **CRM context is normalized** into clean, LLM-friendly fields (no IDs or sensitive noise).\n* **Gemini (Google AI Studio)** generates a concise, friendly reply using:\n\n  * Sender name, subject, and message snippet\n  * Safe, relevant HubSpot context (e.g., top 1–2 deals or an open ticket)\n  * Style constraints (≤ \\~150 words, single CTA, optional clarifying question)\n* **Slack approval** posts the draft to a channel; if **approved**, n8n **replies via Gmail** in the original thread.\n\n---\n\n## How to use\n\n1. **Gmail:** Connect the same account for the trigger and reply nodes.\n2. **HubSpot:** Connect OAuth on the search + HTTP request nodes.\n3. **Gemini:** Add your **Google AI Studio** API key to the **Google Gemini Chat Model** node.\n4. **Slack:** Connect and select the channel for draft approvals.\n5. (Optional) **Filter:** Adjust the Allowed Sender filter before going live.\n6. (Optional) **Prompt:** Edit “Draft Reply (AI Agent)” tone/length or how much CRM detail to include.\n7. Activate the workflow. New emails will produce Slack-approved replies automatically.\n\n---\n\n## Requirements\n\n* **Gmail** (trigger + send)\n* **HubSpot** (OAuth2) for contact + associations\n* **Slack** for approval step\n* **Google Gemini** (Google AI Studio API key)\n\n---\n\n## Notes & customization\n\n* **Safety rails:** The prompt avoids exposing IDs/raw JSON and caps CRM details to what’s useful.\n* **Auto-send mode:** Skip Slack if you want fully automated replies for specific senders/labels.\n* **Richer context:** Extend the batch read to pull more properties (e.g., next step, renewal date).\n* **Triage:** Branch on subject/labels to route billing vs. technical requests to different prompts.\n* **QA queue:** If the model asks a clarifying question, keep it to **one**—the node enforces that.",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "role": "lmChatGoogleGemini",
      "configDescription": "Version 1"
    },
    {
      "name": "Reply to a message",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Watch Gmail (New Inbound)",
      "type": "n8n-nodes-base.gmailTrigger",
      "role": "gmailTrigger",
      "configDescription": "Version 1.3"
    },
    {
      "name": "Filter: Allowed Sender",
      "type": "n8n-nodes-base.filter",
      "role": "filter",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Draft Reply (AI Agent)",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "role": "agent",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Find Contact by Email",
      "type": "n8n-nodes-base.hubspot",
      "role": "hubspot",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Set Record Types",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "List Contact Associations",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Build Batch Read Requests",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Batch Read Objects",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Normalize CRM Context for LLM",
      "type": "n8n-nodes-base.code",
      "role": "code",
      "configDescription": "Version 2"
    },
    {
      "name": "Wait for Response - Approve Auto-Reply",
      "type": "n8n-nodes-base.slack",
      "role": "slack",
      "configDescription": "Version 2.3"
    },
    {
      "name": "If Approved?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Workflow Overview",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}