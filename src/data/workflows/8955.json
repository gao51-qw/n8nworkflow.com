{
  "id": 8955,
  "slug": "8955",
  "title": "Automate payment receipts: Email, archive, and track with Stripe and Google Workspace",
  "description": "## Description\nThis workflow automates the process of retrieving Stripe invoices, validating API responses, generating payment receipts, sending them via email, storing PDFs in Google Drive, and appending details to a Google Sheet ledger. It also includes an error logging system to capture and record workflow issues, ensuring financial operations are both automated and reliable.\n\n## What This Template Does (Step-by-Step)\n- üìã Manual Trigger ‚Äì Start the workflow manually by clicking Execute workflow.\n-  üîó Fetch Invoices ‚Äì Authenticates with Stripe and retrieves the 5 most recent invoices (includes customer info, amounts, statuses, and invoice URLs).\n-  ‚úÖ Check API Response ‚Äì Ensures the Stripe API response contains a valid data[] array. If not, errors are logged.\n-  üìÇ Expand List ‚Äì Splits Stripe‚Äôs bundled invoice list into individual invoice records for independent processing.\n-  üí≥ IF (Paid?) ‚Äì Routes invoices based on payment status; only paid invoices move forward.\n-  üìß IF (Already Receipted?) ‚Äì Skips invoices where a receipt has already been generated (receipt_sent = true).\n-  üìë Download File ‚Äì Downloads the hosted invoice PDF from Stripe for use in emails and archiving.\n-  ‚úâÔ∏è Send Receipt Email ‚Äì Emails the customer a payment receipt with the PDF attached, using invoice details (number, amount, customer name).\n-  ‚òÅÔ∏è Upload Invoice PDF ‚Äì Uploads the invoice PDF to a specific Google Drive folder, named by invoice number.\n-  üìä Append to Ledger ‚Äì Updates a Google Sheet with invoice metadata (date, invoice number, Drive file ID, link, size).\n-  ‚ö†Ô∏è Error Logging ‚Äì Logs workflow issues (failed API calls, missing data, etc.) into a dedicated error tracking sheet.\n\n## Prerequisites\n- Stripe API key (with invoice read permissions)\n- Google Drive (destination folder for invoices)\n- Google Sheets with:\n- Receipts Ledger Sheet\n- Error Logging Sheet\n- Gmail OAuth2 account for sending receipts\n\n## Key Benefits\n ‚úÖ Automates customer receipt delivery with attached PDFs\n ‚úÖ Builds a permanent ledger in Google Sheets for finance\n ‚úÖ Archives invoices in Google Drive for easy retrieval\n ‚úÖ Prevents duplicates by checking receipt_sent metadata\n ‚úÖ Includes error logging for smooth monitoring and debugging\n\n## Perfect For\n- Finance/accounting teams needing automated receipt handling\n- SaaS businesses managing recurring Stripe invoices\n- Operations teams requiring error-proof automation\n- Any business needing audit-ready receipts + logs\n",
  "featuredImage": "/data/workflows/8955/8955.webp",
  "author": {
    "id": 101,
    "slug": "rahul08",
    "name": "Rahul Joshi",
    "avatar": ""
  },
  "categories": [
    "Invoice Processing"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 182,
  "downloads": 18,
  "createdAt": "2025-09-26T11:41:44.805Z",
  "updatedAt": "2026-01-16T08:58:32.263Z",
  "publishedAt": "2025-09-26T11:41:44.805Z",
  "nodes": 21,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8955",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Automate payment receipts: Email, archive, and track with Stripe and Google Workspace",
    "workflowName": "Automate payment receipts: Email, archive, and track with Stripe and Google Workspace",
    "description": "## Description\nThis workflow automates the process of retrieving Stripe invoices, validating API responses, generating payment receipts, sending them via email, storing PDFs in Google Drive, and appending details to a Google Sheet ledger. It also includes an error logging system to capture and record workflow issues, ensuring financial operations are both automated and reliable.\n\n## What This Template Does (Step-by-Step)\n- üìã Manual Trigger ‚Äì Start the workflow manually by clicking Execute workflow.\n-  üîó Fetch Invoices ‚Äì Authenticates with Stripe and retrieves the 5 most recent invoices (includes customer info, amounts, statuses, and invoice URLs).\n-  ‚úÖ Check API Response ‚Äì Ensures the Stripe API response contains a valid data[] array. If not, errors are logged.\n-  üìÇ Expand List ‚Äì Splits Stripe‚Äôs bundled invoice list into individual invoice records for independent processing.\n-  üí≥ IF (Paid?) ‚Äì Routes invoices based on payment status; only paid invoices move forward.\n-  üìß IF (Already Receipted?) ‚Äì Skips invoices where a receipt has already been generated (receipt_sent = true).\n-  üìë Download File ‚Äì Downloads the hosted invoice PDF from Stripe for use in emails and archiving.\n-  ‚úâÔ∏è Send Receipt Email ‚Äì Emails the customer a payment receipt with the PDF attached, using invoice details (number, amount, customer name).\n-  ‚òÅÔ∏è Upload Invoice PDF ‚Äì Uploads the invoice PDF to a specific Google Drive folder, named by invoice number.\n-  üìä Append to Ledger ‚Äì Updates a Google Sheet with invoice metadata (date, invoice number, Drive file ID, link, size).\n-  ‚ö†Ô∏è Error Logging ‚Äì Logs workflow issues (failed API calls, missing data, etc.) into a dedicated error tracking sheet.\n\n## Prerequisites\n- Stripe API key (with invoice read permissions)\n- Google Drive (destination folder for invoices)\n- Google Sheets with:\n- Receipts Ledger Sheet\n- Error Logging Sheet\n- Gmail OAuth2 account for sending receipts\n\n## Key Benefits\n ‚úÖ Automates customer receipt delivery with attached PDFs\n ‚úÖ Builds a permanent ledger in Google Sheets for finance\n ‚úÖ Archives invoices in Google Drive for easy retrieval\n ‚úÖ Prevents duplicates by checking receipt_sent metadata\n ‚úÖ Includes error logging for smooth monitoring and debugging\n\n## Perfect For\n- Finance/accounting teams needing automated receipt handling\n- SaaS businesses managing recurring Stripe invoices\n- Operations teams requiring error-proof automation\n- Any business needing audit-ready receipts + logs",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‚ÄòExecute workflow‚Äô",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Fetch Invoices",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Expand List",
      "type": "n8n-nodes-base.splitOut",
      "role": "splitOut",
      "configDescription": "Version 1"
    },
    {
      "name": "IF (Paid?)",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "IF (Already Receipted?)",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Download File",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Send Receipt Email",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    },
    {
      "name": "Upload Invoice PDF",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Append to Ledger",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": " Error Logging",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Check API Response",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    }
  ]
}