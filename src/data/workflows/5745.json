{
  "id": 5745,
  "slug": "5745",
  "title": "Auto-generate and auto-fill business documents with Google Sheets & Gmail",
  "description": "This workflow automates the generation and delivery of personalized business documents (e.g., **contracts, job offers, invoices, pay slips**) in **PDF format**. The data source is a **Google Sheet**, and the documents are created using CraftMyPDF, then uploaded to Google Drive and optionally sent via email.\n\nThis workflow **is ideal for bulk document generation (contracts, invoices, etc.) with minimal manual intervention**.\n\n---\n\n###  Benefits\n\n* **Fully Automated**: Once triggered, it handles the whole pipeline end-to-end—no manual editing or document creation needed.\n* **Customizable**: Works with any type of business document as long as you provide a CraftMyPDF template.\n* **Scalable**: Processes multiple entries in batch, ideal for HR departments or finance teams.\n* **Integrated**: Seamlessly connects Google Sheets, CraftMyPDF, Google Drive, and Gmail.\n* **Trackable**: Updates the original spreadsheet to keep track of which documents have been processed.\n\n---\n\n###  Requirements\n\n* Self-hosted n8n instance (required for some advanced node usage).\n* Google Sheet template with columns like: `FIRST NAME`, `LAST NAME`, `ADDRESS`, etc.\n* A CraftMyPDF account with a ready-made template.\n* Google OAuth2 credentials for Sheets, Drive, and Gmail integrations.\n\n---\n\n### **How It Works**  \n1. **Trigger & Data Fetch**:  \n   - The workflow starts with a manual trigger (\"When clicking ‘Execute workflow’\").  \n   - It retrieves employee data from a Google Sheet (\"Get employees\"), filtering rows where the \"DONE\" column is empty.  \n\n2. **PDF Generation & Processing**:  \n   - The \"Loop Over Items\" node processes each employee record individually.  \n   - The \"Create agreement\" node uses CraftMyPDF to generate a PDF contract, populating it with employee details (name, address, email, etc.).  \n   - A conditional node (\"Success?\") checks if PDF creation was successful.  \n\n3. **PDF Handling & Notifications**:  \n   - The PDF is fetched (\"Get agreement\") and uploaded to Google Drive (\"Upload agreement\") with a filename like `[First-Name]-[Last-Name].pdf`.  \n   - An email with the PDF attachment is sent to the employee via Gmail (\"Send email with PDF\").  \n\n4. **Tracking & Completion**:  \n   - The Google Sheet row is updated with \"x\" in the \"DONE\" column (\"Update row\") to mark completion.  \n   - The workflow merges results and loops until all records are processed.  \n\n---  \n\n### **Set Up Steps**  \n1. **Prerequisites**:  \n   - Use the **self-hosted version of n8n** (required for this workflow).  \n   - Clone the provided [Google Sheet template](https://docs.google.com/spreadsheets/d/1YQPuoEubRHJepRKdquks69Iqf2XdGVKfpWOdYwk3RMg/edit?usp=sharing).  \n\n2. **Configure CraftMyPDF**:  \n   - Create an account on [CraftMyPDF](https://app.craftmypdf.com/).  \n   - Design a PDF template and note its **Template ID**. Insert this ID in the \"Create agreement\" node.  \n\n3. **Credentials Setup**:  \n   - Connect nodes to:  \n     - Google Sheets (to fetch/update data).  \n     - Google Drive (to store PDFs).  \n     - Gmail (to send emails).  \n     - CraftMyPDF (for PDF generation).  \n\n4. **Customization**:  \n   - Adjust field mappings in the \"Create agreement\" node to match your PDF template placeholders.  \n   - Modify the email template in \"Send email with PDF\" as needed.  \n\n5. **Execution**:  \n   - Run the workflow manually. It will process all rows lacking a \"DONE\" marker, generating PDFs, sending emails, and updating the sheet automatically.  \n\n---\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/). ",
  "featuredImage": "/data/workflows/5745/5745.webp",
  "author": {
    "id": 101,
    "slug": "n3witalia",
    "name": "Davide",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 2335,
  "downloads": 233,
  "createdAt": "2025-07-07T10:59:29.201Z",
  "updatedAt": "2026-01-16T08:41:13.172Z",
  "publishedAt": "2025-07-07T10:59:29.201Z",
  "nodes": 12,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/5745",
  "disclaimer": "This workflow is provided as-is. Please review and test before using in production.",
  "overview": {
    "title": "Auto-generate and auto-fill business documents with Google Sheets & Gmail",
    "workflowName": "Auto-generate and auto-fill business documents with Google Sheets & Gmail",
    "description": "This workflow automates the generation and delivery of personalized business documents (e.g., **contracts, job offers, invoices, pay slips**) in **PDF format**. The data source is a **Google Sheet**, and the documents are created using CraftMyPDF, then uploaded to Google Drive and optionally sent via email.\n\nThis workflow **is ideal for bulk document generation (contracts, invoices, etc.) with minimal manual intervention**.\n\n---\n\n###  Benefits\n\n* **Fully Automated**: Once triggered, it handles the whole pipeline end-to-end—no manual editing or document creation needed.\n* **Customizable**: Works with any type of business document as long as you provide a CraftMyPDF template.\n* **Scalable**: Processes multiple entries in batch, ideal for HR departments or finance teams.\n* **Integrated**: Seamlessly connects Google Sheets, CraftMyPDF, Google Drive, and Gmail.\n* **Trackable**: Updates the original spreadsheet to keep track of which documents have been processed.\n\n---\n\n###  Requirements\n\n* Self-hosted n8n instance (required for some advanced node usage).\n* Google Sheet template with columns like: `FIRST NAME`, `LAST NAME`, `ADDRESS`, etc.\n* A CraftMyPDF account with a ready-made template.\n* Google OAuth2 credentials for Sheets, Drive, and Gmail integrations.\n\n---\n\n### **How It Works**  \n1. **Trigger & Data Fetch**:  \n   - The workflow starts with a manual trigger (\"When clicking ‘Execute workflow’\").  \n   - It retrieves employee data from a Google Sheet (\"Get employees\"), filtering rows where the \"DONE\" column is empty.  \n\n2. **PDF Generation & Processing**:  \n   - The \"Loop Over Items\" node processes each employee record individually.  \n   - The \"Create agreement\" node uses CraftMyPDF to generate a PDF contract, populating it with employee details (name, address, email, etc.).  \n   - A conditional node (\"Success?\") checks if PDF creation was successful.  \n\n3. **PDF Handling & Notifications**:  \n   - The PDF is fetched (\"Get agreement\") and uploaded to Google Drive (\"Upload agreement\") with a filename like `[First-Name]-[Last-Name].pdf`.  \n   - An email with the PDF attachment is sent to the employee via Gmail (\"Send email with PDF\").  \n\n4. **Tracking & Completion**:  \n   - The Google Sheet row is updated with \"x\" in the \"DONE\" column (\"Update row\") to mark completion.  \n   - The workflow merges results and loops until all records are processed.  \n\n---  \n\n### **Set Up Steps**  \n1. **Prerequisites**:  \n   - Use the **self-hosted version of n8n** (required for this workflow).  \n   - Clone the provided [Google Sheet template](https://docs.google.com/spreadsheets/d/1YQPuoEubRHJepRKdquks69Iqf2XdGVKfpWOdYwk3RMg/edit?usp=sharing).  \n\n2. **Configure CraftMyPDF**:  \n   - Create an account on [CraftMyPDF](https://app.craftmypdf.com/).  \n   - Design a PDF template and note its **Template ID**. Insert this ID in the \"Create agreement\" node.  \n\n3. **Credentials Setup**:  \n   - Connect nodes to:  \n     - Google Sheets (to fetch/update data).  \n     - Google Drive (to store PDFs).  \n     - Gmail (to send emails).  \n     - CraftMyPDF (for PDF generation).  \n\n4. **Customization**:  \n   - Adjust field mappings in the \"Create agreement\" node to match your PDF template placeholders.  \n   - Modify the email template in \"Send email with PDF\" as needed.  \n\n5. **Execution**:  \n   - Run the workflow manually. It will process all rows lacking a \"DONE\" marker, generating PDFs, sending emails, and updating the sheet automatically.  \n\n---\n### **Need help customizing?**  \n[Contact me](mailto:info@n3w.it) for consulting and support or add me on [Linkedin](https://www.linkedin.com/in/davideboizza/).",
    "features": [],
    "useCases": []
  },
  "logicalBlocks": [],
  "nodeDetails": [
    {
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "role": "manualTrigger",
      "configDescription": "Version 1"
    },
    {
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "role": "splitInBatches",
      "configDescription": "Version 3"
    },
    {
      "name": "Get employees",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Create agreement",
      "type": "n8n-nodes-craftmypdf.craftMyPdf",
      "role": "craftMyPdf",
      "configDescription": "Version 1"
    },
    {
      "name": "Get agreement",
      "type": "n8n-nodes-base.httpRequest",
      "role": "httpRequest",
      "configDescription": "Version 4.2"
    },
    {
      "name": "Upload agreement",
      "type": "n8n-nodes-base.googleDrive",
      "role": "googleDrive",
      "configDescription": "Version 3"
    },
    {
      "name": "Update row",
      "type": "n8n-nodes-base.googleSheets",
      "role": "googleSheets",
      "configDescription": "Version 4.6"
    },
    {
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Success?",
      "type": "n8n-nodes-base.if",
      "role": "if",
      "configDescription": "Version 2.2"
    },
    {
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "role": "stickyNote",
      "configDescription": "Version 1"
    },
    {
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "role": "merge",
      "configDescription": "Version 3.2"
    },
    {
      "name": "Send email with PDF",
      "type": "n8n-nodes-base.gmail",
      "role": "gmail",
      "configDescription": "Version 2.1"
    }
  ]
}