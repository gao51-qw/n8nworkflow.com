---
/**
 * NewsletterSubscribe ç»„ä»¶
 * è·¯å¾„: src/components/common/NewsletterSubscribe.astro
 * 
 * ç”¨é€”: Newsletter è®¢é˜…è¡¨å•ï¼ˆæ”¯æŒå¤šç§å¸ƒå±€å˜ä½“ï¼‰
 * ä¼˜å…ˆçº§: P1
 * 
 * Props æ¥å£:
 * - variant?: 'hero' | 'footer' | 'sidebar'
 * 
 * ç‰¹æ€§:
 * - å®æ—¶é‚®ç®±éªŒè¯
 * - é¢‘ç‡é€‰æ‹©
 * - åˆ†ç±»é€‰æ‹©ï¼ˆå¯é€‰ï¼‰
 * - æˆåŠŸ/é”™è¯¯æç¤º
 * - éšç§æ”¿ç­–é“¾æ¥
 */

interface Props {
  variant?: 'hero' | 'footer' | 'sidebar';
}

const { variant = 'hero' } = Astro.props;

const containerClasses = {
  hero: 'bg-gradient-to-r from-primary-50 to-primary-100 dark:from-primary-900 dark:to-primary-800 p-8 rounded-lg max-w-md mx-auto',
  footer: 'bg-gray-100 dark:bg-gray-800 p-6 rounded',
  sidebar: 'bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 p-6 rounded-lg',
};
---

<div class={containerClasses[variant]}>
  <!-- æ ‡é¢˜ -->
  <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white mb-2">
    {variant === 'hero' ? 'ğŸ’¬ è®¢é˜…æˆ‘ä»¬çš„ç®€æŠ¥' : 'ğŸ“¬ è®¢é˜…æ›´æ–°'}
  </h2>
  <p class="text-sm text-gray-700 dark:text-gray-300 mb-6">
    {variant === 'hero'
      ? 'è·å–æ¯å‘¨æœ€æ–°çš„ N8N å·¥ä½œæµå’Œè‡ªåŠ¨åŒ–æŠ€å·§'
      : 'åŠæ—¶äº†è§£æœ€æ–°çš„å·¥ä½œæµå’Œç¤¾åŒºåŠ¨æ€'}
  </p>

  <!-- è®¢é˜…è¡¨å• -->
  <form id="newsletter-form" class="space-y-4">
    <!-- é‚®ç®±è¾“å…¥ -->
    <div>
      <label for="newsletter-email" class="sr-only">é‚®ç®±åœ°å€</label>
      <input
        type="email"
        id="newsletter-email"
        name="email"
        placeholder="your@email.com"
        required
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500"
      />
      <p class="text-xs text-red-600 dark:text-red-400 mt-1 hidden" id="email-error"></p>
    </div>

    <!-- é¢‘ç‡é€‰æ‹© -->
    <div>
      <label for="newsletter-frequency" class="sr-only">è®¢é˜…é¢‘ç‡</label>
      <select
        id="newsletter-frequency"
        name="frequency"
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm"
      >
        <option value="weekly">æ¯å‘¨</option>
        <option value="daily">æ¯å¤©</option>
        <option value="monthly">æ¯æœˆ</option>
      </select>
    </div>

    <!-- åˆ†ç±»é€‰æ‹© (ä»…åœ¨ hero å˜ä½“æ˜¾ç¤º) -->
    {
      variant === 'hero' && (
        <div class="space-y-2">
          <label class="block text-xs font-semibold text-gray-900 dark:text-white">æ„Ÿå…´è¶£çš„åˆ†ç±»</label>
          <div class="grid grid-cols-2 gap-2">
            {['AI', 'Automation', 'Data'].map((cat) => (
              <label class="flex items-center gap-2">
                <input
                  type="checkbox"
                  name="categories"
                  value={cat.toLowerCase()}
                  class="w-4 h-4 rounded"
                />
                <span class="text-xs text-gray-700 dark:text-gray-300">{cat}</span>
              </label>
            ))}
          </div>
        </div>
      )
    }

    <!-- åŒæ„æ¡æ¬¾ -->
    <label class="flex items-start gap-2">
      <input type="checkbox" name="terms" required class="w-4 h-4 mt-0.5 rounded" />
      <span class="text-xs text-gray-700 dark:text-gray-300">
        æˆ‘åŒæ„éšç§æ”¿ç­–å¹¶æ¥æ”¶é‚®ä»¶æ›´æ–°
      </span>
    </label>

    <!-- æäº¤æŒ‰é’® -->
    <button
      type="submit"
      class="w-full px-4 py-2 bg-primary-700 text-white rounded-lg font-semibold hover:bg-primary-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
    >
      è®¢é˜…
    </button>
  </form>

  <!-- æˆåŠŸ/é”™è¯¯æç¤º -->
  <div id="form-message" class="mt-4 p-3 rounded text-sm hidden"></div>

  <!-- éšç§æ”¿ç­–é“¾æ¥ -->
  <p class="text-xs text-gray-700 dark:text-gray-400 mt-4 text-center">
    <a href="/privacy" class="text-primary-700 hover:text-primary-800 dark:text-primary-400 font-medium">éšç§æ”¿ç­–</a>
  </p>
</div>

<script>
  // TODO: å®ç° Newsletter è®¢é˜…è¡¨å•é€»è¾‘
  // 1. ç›‘å¬è¡¨å•æäº¤
  // 2. å‰ç«¯é‚®ç®±éªŒè¯
  // 3. å‘é€åˆ° /api/newsletter-subscribe
  // 4. æ˜¾ç¤ºæˆåŠŸ/é”™è¯¯æç¤º
  // 5. é‡ç½®è¡¨å•

  const form = document.getElementById('newsletter-form') as HTMLFormElement;
  const messageDiv = document.getElementById('form-message') as HTMLDivElement;

  if (form) {
    form.addEventListener('submit', async (e: Event) => {
      e.preventDefault();
      console.log('Newsletter form submitted');
      // TODO: å®ç°è¡¨å•æäº¤é€»è¾‘
    });
  }
</script>
