---
/**
 * FilterSidebar 组件
 * 路径: src/components/ui/FilterSidebar.astro
 */

interface Props {
  currentFilters?: {
    timePeriod?: string | null;
    category?: string | null;
    complexity?: string | null;
    price?: string | null;
  };
  filterCounts?: {
    timePeriods: Record<string, number>;
    categories: Record<string, number>;
    complexities: Record<string, number>;
    price: Record<string, number>;
  };
}

const {
  currentFilters = {},
  filterCounts = {
    timePeriods: { all: 7947, '7d': 8, '1m': 366, '6m': 4498, '1y': 6758, '2y': 7236, '3y': 7328 },
    categories: { 'Multimodal AI': 2270, AI: 1600, 'AI Summarization': 1088 },
    complexities: { beginner: 492, intermediate: 2835, advanced: 4602 },
    price: { all: 7947, free: 6898, paid: 1049 },
  },
} = Astro.props;

const timeLabels: Record<string, string> = {
  all: 'All Time',
  '7d': 'Last 7 days',
  '1m': 'Last Month',
  '6m': 'Last 6 Months',
  '1y': 'Last Year',
  '2y': 'Last 2 Years',
  '3y': 'Last 3 Years'
};
---

<div class="space-y-8">
  <!-- Time Period -->
  <div>
    <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-4">Time Period</h3>
    <div class="space-y-1">
      {Object.entries(filterCounts.timePeriods).map(([key, count]) => (
        <a 
          href={`?time=${key}`} 
          class={`flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors ${currentFilters.timePeriod === key ? 'bg-primary-50 text-primary-700 font-bold' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'}`}
        >
          <span>{timeLabels[key] || key}</span>
          <span class="text-xs text-gray-400">{count}</span>
        </a>
      ))}
    </div>
  </div>

  <!-- Price -->
  <div>
    <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-4">Price</h3>
    <div class="space-y-1">
      {Object.entries(filterCounts.price).map(([key, count]) => (
        <a 
          href={`?price=${key}`} 
          class={`flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors ${currentFilters.price === key ? 'bg-primary-50 text-primary-700 font-bold' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'}`}
        >
          <span class="capitalize">{key === 'all' ? 'All Workflows' : key}</span>
          <span class="text-xs text-gray-400">{count}</span>
        </a>
      ))}
    </div>
  </div>

  <!-- Categories -->
  <div>
    <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-4">Categories</h3>
    <div class="space-y-1 max-h-96 overflow-y-auto pr-2 scrollbar-thin">
      <a href="/" class="flex items-center px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
        All workflows
      </a>
      {Object.entries(filterCounts.categories).map(([name, count]) => (
        <a 
          href={`/categories/${name.toLowerCase()}`} 
          class={`flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors ${currentFilters.category === name ? 'bg-primary-50 text-primary-700 font-bold' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'}`}
        >
          <span>{name}</span>
          <span class="text-xs text-gray-400">{count}</span>
        </a>
      ))}
    </div>
  </div>

  <!-- Complexity -->
  <div>
    <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-4">Complexity</h3>
    <div class="space-y-1">
      {Object.entries(filterCounts.complexities).map(([key, count]) => (
        <a 
          href={`/complexity/${key}`} 
          class={`flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors ${currentFilters.complexity === key ? 'bg-primary-50 text-primary-700 font-bold' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'}`}
        >
          <span class="capitalize">{key}</span>
          <span class="text-xs text-gray-400">{count}</span>
        </a>
      ))}
    </div>
  </div>
</div>
