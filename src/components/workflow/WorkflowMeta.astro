---
/**
 * 工作流元信息组件
 * 用于展示工作流的作者和其他元数据
 */

import type { Workflow } from '../../lib/types/workflow';

interface Props {
  workflow: Workflow;
}

const { workflow } = Astro.props;
---

<aside class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
  <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">About this Workflow</h2>
  
  <!-- Author Info -->
  <div class="mb-6">
    <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-3">Created by</h3>
    <a
      href={`/authors/${workflow.author.slug}`}
      class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group"
    >
      {workflow.author.avatar ? (
        <img
          src={workflow.author.avatar}
          alt={workflow.author.name}
          class="w-12 h-12 rounded-full object-cover ring-2 ring-gray-200 dark:ring-gray-700 group-hover:ring-primary-500 transition-all"
          loading="lazy"
        />
      ) : (
        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center ring-2 ring-gray-200 dark:ring-gray-700 group-hover:ring-primary-500 transition-all">
          <span class="text-lg font-bold text-white">
            {workflow.author.name.charAt(0).toUpperCase()}
          </span>
        </div>
      )}
      <div class="flex-1 min-w-0">
        <div class="font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
          {workflow.author.name}
        </div>
        {workflow.author.bio && (
          <div class="text-sm text-gray-500 dark:text-gray-400 truncate">
            {workflow.author.bio}
          </div>
        )}
      </div>
      <svg class="w-5 h-5 text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  </div>

  <!-- Metadata -->
  <div class="space-y-4">
    <div>
      <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Complexity Level</h3>
      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 capitalize">
        {workflow.complexityLevel}
      </span>
    </div>

    <div>
      <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Price</h3>
      <span class="text-lg font-bold text-gray-900 dark:text-white">
        {workflow.price ? `$${workflow.price}` : 'Free'}
      </span>
    </div>

    {workflow.version && (
      <div>
        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">n8n Version</h3>
        <span class="text-sm text-gray-900 dark:text-white font-mono">
          {workflow.version}
        </span>
      </div>
    )}

    <div>
      <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Published</h3>
      <time datetime={workflow.publishedAt} class="text-sm text-gray-900 dark:text-white">
        {workflow.date}
      </time>
    </div>

    {workflow.updatedAt !== workflow.publishedAt && (
      <div>
        <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Last Updated</h3>
        <time datetime={workflow.updatedAt} class="text-sm text-gray-900 dark:text-white">
          {new Date(workflow.updatedAt).toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric' 
          })}
        </time>
      </div>
    )}
  </div>

  <!-- Tags -->
  {workflow.tags && workflow.tags.length > 0 && (
    <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
      <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-3">Tags</h3>
      <div class="flex flex-wrap gap-2">
        {workflow.tags.map((tag) => (
          <span class="inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
            #{tag}
          </span>
        ))}
      </div>
    </div>
  )}
</aside>
