# 网站改版项目 - 实时监控与数据看板

**版本**: 1.0  
**最后更新**: 2026-01-10  
**所有者**: PM + QA 团队  
**更新频率**: 每日（关键指标）、每周（汇总报告）

---

## 目录

1. [项目进度指标](#项目进度指标)
2. [业务效果指标](#业务效果指标)
3. [监控看板结构](#监控看板结构)
4. [告警与升级机制](#告警与升级机制)
5. [数据采集与工具](#数据采集与工具)
6. [监控仪表板模板](#监控仪表板模板)

---

## 项目进度指标

### 1.1 功能完成度

**指标定义**: (已完成功能点 / 总功能点) × 100%

**数据源**: GitHub Projects Board（方案：P0/P1/P2 标签 + Done column）

**更新频率**: 每日（自动统计）

**计算公式**:
```
功能完成度 = 
  (Milestone 中 state:closed 的 Issue 数) 
  / (Milestone 中所有 Issue 数) 
  × 100%
```

**目标轨迹** (参考 PROJECT_MILESTONES.md):

| 周 | 预期完成度 | 关键交付物 | 检查点 |
|----|----------|---------|-------|
| Week 1 | 0% | 需求评审通过（M1） | 所有文档已评审，团队 Kickoff 完成 |
| Week 2 | 10% | UI 原型完成（M2） | Figma 设计稿完成，前端可开始编码 |
| Week 3-4 | 30-40% | P0 开发中期 | FilterSidebar 70%，详情页 50% |
| Week 5 | 60-70% | P0 代码完成（M3） | 所有 P0 功能代码 merge，进入测试 |
| Week 6 | 75-80% | P1 开发启动 | Newsletter & Submit 开始 |
| Week 7-8 | 90-95% | 全功能开发完成 | P0/P1 代码全部 merge，进入灰度前测试 |
| Week 9+ | 100% | 发布准备完成 | 所有测试通过，可进入灰度/全量 |

**告警机制**:

| 实际完成度 vs 预期 | 触发 | 行动 |
|-----------------|------|------|
| 落后 ≤5% | 黄色告警 | PM 在周会上汇报原因分析 |
| 落后 >5% | 红色告警 | PM 召集相关人员讨论，评估是否调整计划 |
| 领先 >10% | 绿色（积极） | PM 确认交付质量，规划提前的后续工作 |

**每日检查清单** (PM，早晨 09:00):
- [ ] GitHub Projects 是否同步了最新的关闭 Issue？
- [ ] 有没有卡在 In Review 的 PR 没有继续推进？
- [ ] 是否需要调整本周的预期完成度？

---

### 1.2 代码质量指标

#### 1.2.1 Lint 错误率

**指标定义**: 项目中的代码静态检查错误数量

**目标**: 0（强制要求）

**数据源**: GitHub Actions CI/CD 中的 Eslint/Prettier 检查结果

**更新频率**: 每次 commit（自动）

**规则**:
- `npm run lint` 必须 0 错误
- 如果有错误，CI/CD 自动拒绝 PR merge
- Code Review 检查时必须指出 lint 错误

**处理流程**:
1. 开发者本地运行 `npm run lint --fix` 自动修复
2. 如果无法自动修复，手动修改
3. Commit 后推送，CI 应该通过

---

#### 1.2.2 测试覆盖率

**指标定义**: 代码行被测试代码覆盖的百分比

**目标**: 
- ≥80% 整体项目
- ≥90% P0 功能（关键路径）
- ≥70% P1 功能

**数据源**: Jest / Vitest 生成的覆盖率报告（集成到 GitHub Actions）

**更新频率**: 每次 commit（自动）

**计算**:
```bash
npm run test -- --coverage
# 输出格式:
# Statements: 82%
# Branches: 75%
# Functions: 80%
# Lines: 82%
```

**告警**:
| 覆盖率 | 触发 | 行动 |
|-------|------|------|
| < 75% | 建议 | Code Review 时鼓励增加测试 |
| < 70% | 警告 | PR 可能被拒绝（对于 P0 功能） |
| 下降 > 5% vs 上次 | 红色告警 | 必须调查原因，通常需要增加测试 |

**每周检查清单** (QA，周三技术评审前):
- [ ] 当前项目覆盖率是否 ≥80%？
- [ ] P0 功能覆盖率是否 ≥90%？
- [ ] 本周是否有覆盖率下降？如果有，哪些模块？

---

#### 1.2.3 代码审核通过率

**指标定义**: 代码审核批准的 PR 数 / 总 PR 数 × 100%

**目标**: 100%（没有未审核的代码进入 main）

**数据源**: GitHub Pull Requests API（自动统计）

**规则**:
- 每个 PR 必须至少 1 个人（Code Owner）审核
- 审核人必须批准（Approve）才能 merge
- 不允许 author 自己批准自己的 PR

**更新频率**: 每次 PR 状态变化（自动）

**检查标准** (参考 EXECUTION_FRAMEWORK.md 3.2):
```
Reviewer 必须检查:
- 功能完整性 ✅
- 代码清晰性 ✅
- 性能影响 ✅
- 测试覆盖 ✅
- 文档更新 ✅
- 安全性 ✅
```

**警报**:
| 情况 | 触发 | 行动 |
|-----|------|------|
| PR 等待审核 > 24小时 | 黄色告警 | @reviewer 在 Slack 提醒 |
| PR 等待审核 > 48小时 | 红色告警 | PM/Tech Lead 干预，考虑调整 reviewer |
| 有 PR 未批准被 merge | 严重问题 | PM 立即调查，可能需要回滚 |

**每日检查清单** (Tech Lead，开发时段):
- [ ] 是否有 PR 等待审核超过 24h？
- [ ] 所有 merge 的 PR 都有审核批准吗？

---

#### 1.2.4 Critical Errors

**指标定义**: 生产环境或开发环境中捕获的严重错误数量

**目标**: 
- 生产：0 critical errors
- 开发/灰度：0 critical errors（必须立即修复）

**数据源**: Sentry 或类似错误追踪工具（如用 GitHub Actions 日志）

**错误分类**:
- **Critical**: 应用完全不可用，用户无法操作
- **High**: 主要功能无法使用，影响大多数用户
- **Medium**: 局部功能问题，影响部分用户
- **Low**: 只是体验不佳

**告警规则**:

| 环境 | Critical 错误 | 触发 | 行动 |
|-----|-------|------|------|
| 生产 | > 0 | 即刻 | 立即停止灰度/全量，回滚或修复 |
| 灰度 | > 0 | 即刻 | 降级灰度用户比例或回滚 |
| 开发 | > 0 | 当天 | Code Review 拒绝或要求修复 |

**处理流程**:
1. 错误发生 → Sentry 自动告警（@PM @Tech Lead）
2. Tech Lead 确认是否 critical
3. 如果是：
   - 开发者立即修复
   - 提交 hotfix PR
   - Code Review 加急处理（15分钟内）
   - Merge 后立即重新部署
4. 事后回顾：为什么在发布前没有发现？

**周检查清单** (QA，技术评审会):
- [ ] 本周是否有新的 critical errors？
- [ ] 历史的 critical errors 是否都已解决？
- [ ] Error tracking 系统是否正常工作？

---

### 1.3 性能指标

**追踪时间**: 从 Week 5（P0 功能代码完成）开始

**数据源**:
- 灰度环境：每日 Lighthouse CI 自动测试
- 生产环境：每周手动测试 + 真实用户监控（RUM）

**更新频率**: 
- Lighthouse CI: 每次部署后自动运行
- 真实用户数据: 每日收集（Google Analytics 4）

**关键指标目标**:

| 指标 | 目标值 | 上限 | 下限 | 告警阈值 | 数据源 |
|-----|-------|------|------|---------|-------|
| **首页 FCP** (First Contentful Paint) | < 1.8s | 2.2s | - | > 2.2s (20% margin) | Lighthouse |
| **FilterSidebar 加载** | < 500ms | 600ms | - | > 600ms | 自定义计时 |
| **详情页 LCP** (Largest Contentful Paint) | < 2.5s | 3.0s | - | > 3.0s | Lighthouse |
| **Lighthouse 综合评分** | ≥ 90 | 100 | 85 | < 85 | Lighthouse |
| **TTI** (Time To Interactive) | < 3.5s | - | - | > 3.5s | Lighthouse |
| **CLS** (Cumulative Layout Shift) | < 0.1 | - | - | > 0.1 | Lighthouse |

**每周性能基准更新** (QA，周三技术评审):
```
日期: 2026-01-17
环境: Staging / Production

FCP: 1.5s (目标: <1.8s) ✅
LCP: 2.2s (目标: <2.5s) ✅
TTI: 3.2s (目标: <3.5s) ✅
Lighthouse: 92 (目标: ≥90) ✅

FilterSidebar 加载: 420ms ✅
详情页首屏: 1.8s ✅

对比上周:
- FCP: +0.1s (可接受)
- LCP: 0.0s (保持)
- Lighthouse: -1分 (可接受)

风险: 无

优化建议:
- 预加载热点数据
- 压缩 Bundle size
```

**性能下降告警** (> 上周 20% 或超过阈值):
1. 自动 Slack 告警 → @前端 Tech Lead
2. 前端诊断原因（可能是 bundle 增大、新代码渲染问题等）
3. 如果是重大下降（>30%）：召集紧急会议讨论是否回滚

---

### 1.4 缺陷指标

**追踪工具**: GitHub Issues（标签：`bug`, 优先级标签）

**更新频率**: 每日（由 QA 统计）

**缺陷生命周期**:
```
Open (新报告)
  ↓
Assigned (指派给开发者)
  ↓
In Progress (开发中)
  ↓
In Review (等待 Code Review)
  ↓
Fixed (PR merge)
  ↓
Verified (QA 验证)
  ↓
Closed
```

**缺陷指标**:

| 指标 | 定义 | 目标 | 告警 |
|-----|------|------|------|
| **打开缺陷数** | state:open 的 bug | 逐周递减→0 | > 前一周 |
| **高优缺陷（P0/P1）** | critical/high 优先级 | 每周递减 | > 前一周或 age > 2 天 |
| **缺陷年龄** | Open 时间最长的 bug | 最多 7 天 | > 7 天 |
| **已验证通过率** | Fixed & Verified / Fixed × 100% | ≥ 95% | < 90% |

**缺陷目标轨迹** (参考 PROJECT_MILESTONES.md):

| 周 | P0 缺陷 | P1 缺陷 | P2 缺陷 | 总计 | 说明 |
|----|--------|--------|--------|------|------|
| Week 1 | 0 | 0 | 0 | 0 | 需求评审期，无开发代码 |
| Week 3 | 0 | 3-5 | 5-8 | 8-13 | 开发早期，发现集成问题 |
| Week 4 | 0 | 2-3 | 3-5 | 5-8 | Bug fix 进行中 |
| Week 5 | 0 | 1-2 | 2-3 | 3-5 | 测试期，接近稳定 |
| Week 6 | 0 | 0 | 1-2 | 1-2 | 灰度前冲刺期 |
| Week 7-8 | 0 | 0 | 0 | 0 | 发布准备，无未解决 bug |

**高优缺陷处理 SLA**:

| 优先级 | 定义 | 响应时间 | 解决时间 | 处理 |
|-------|------|---------|---------|------|
| P0 | 应用崩溃，用户无法操作 | 15 分钟 | 2 小时 | 即时修复+紧急部署 |
| P1 | 主要功能不可用 | 2 小时 | 24 小时 | 次日 sprint 优先 |
| P2 | 部分功能问题 | 24 小时 | 一周内 | 正常 sprint 排序 |

**每日缺陷检查清单** (QA，09:30 Daily Standup 前):
- [ ] GitHub Issues 中的打开 bug 数是否增加？
- [ ] 有没有 P0 缺陷超期未解决？
- [ ] 有没有待验证的 Fixed bug？

---

### 1.5 团队协作指标

**数据源**: GitHub API + 人工记录

**更新频率**: 每周五汇总

**指标**:

#### Code Review 响应时间

**定义**: PR 创建 → 收到第一条 review 评论的时间

**目标**: ≤ 24 小时（平均）

**计算**:
```
平均 CR 响应时间 = 
  Σ(第一条 review 时间 - PR 创建时间) 
  / PR 总数
```

**告警**:
- > 24h: 黄色（应该改进）
- > 36h: 红色（Code Owner 需要调整分配）
- > 48h: 阻碍项（自动升级为 P1）

---

#### PR 合并周期

**定义**: PR 创建 → merge 到 main 的时间

**目标**: ≤ 48 小时

**计算**: 
```
平均周期 = 
  Σ(merge 时间 - 创建时间) 
  / merged PR 数
```

**分布目标**:
- ≤ 24h: 70% 的 PR
- 24-48h: 25% 的 PR
- > 48h: 5% 的 PR（大型 PR）

**告警**:
- > 60h（平均）: 流程改进需要

---

#### 会议到勤率

**定义**: (实际出席人数 / 计划出席人数) × 100%

**目标**: 100%

**规则**:
- 必须参会的人缺席 → PM 记录原因
- 如果同一个人连续 2 周缺席 → PM 吹哨（assess 是否有冲突）

**追踪**:
- 每周五 retrospective 检查
- 如果到勤率 < 90% → 讨论是否调整会议时间

---

#### Slack/钉钉 回应率

**定义**: 在发送后 2 小时内收到回复的消息占比

**目标**: ≥ 90%

**规则**:
- 只统计工作时间内的消息（UTC+8 早 08:00-晚 20:00）
- 紧急消息（tagged @person）应该 30 分钟内回复
- 普通消息（FYI）可以延迟

**告警**:
- < 80%: 团队协作有问题，PM 调查原因

**周检查清单** (PM，周五汇总):
- [ ] 平均 CR 响应时间: ___ (目标 ≤24h)
- [ ] 平均 PR 合并周期: ___ (目标 ≤48h)
- [ ] 会议到勤率: ___ (目标 100%)
- [ ] Slack 回应率: ___ (目标 ≥90%)

---

## 业务效果指标

**追踪时间**: 灰度发布期间及之后

**数据源**: Google Analytics 4, Mixpanel（或自定义事件追踪）, 内部反馈表

**更新频率**: 
- 灰度期间: 每日
- 全量期间: 每周

---

### 2.1 功能使用率

#### FilterSidebar 使用率

**定义**: (使用过筛选 / 总访客) × 100%

**目标轨迹**:

| 阶段 | 周期 | 目标 | 触发降级 |
|-----|------|------|---------|
| 灰度 Phase 1 | Week 6 (内部) | 80% (内部员工) | N/A |
| 灰度 Phase 2 | Week 6-7 (20%) | 20-30% | < 10% |
| 灰度 Phase 3 | Week 7-8 (50%) | 30-40% | < 20% |
| 全量 Phase 4 | Week 8+ (100%) | 40-50% | < 25% (回顾) |
| 3 个月后 | Week 12+ | 60%+ | - |

**含义**:
- 如果灰度期间使用率过低 → 可能是功能发现不易、需要优化 UX 或教程
- 如果全量后使用率下降 → 可能是有严重 bug 或性能问题
- 目标是帮助用户更好地发现工作流

**数据追踪**:
```javascript
// 在 FilterSidebar 使用时发送事件
analytics.track('filter_sidebar_used', {
  timePeriod: selected_value,
  categories: [list],
  complexity: selected_value,
  timestamp: now
})
```

**周报查询** (GA4):
```
Filter: 灰度维度 = 'phase_2'
Metrics: Event count 'filter_sidebar_used'
Segment: 新访客 vs 回访客
```

---

#### Newsletter 订阅率

**定义**: (新订阅 / 首页访客) × 100%

**目标轨迹**:

| 阶段 | 周期 | 目标 | 说明 |
|-----|------|------|------|
| 灰度 Phase 1-2 | Week 6-7 | 1-2% | 首页 Newsletter 订阅表单新增 |
| 灰度 Phase 3 | Week 7-8 | 2-3% | 50% 用户可见，优化副本 |
| 全量 | Week 8+ | 3-5% | 所有用户可见，目标是长期稳定 |
| 6 个月后 | Week 24+ | 8-10% | 基于用户数增长预期 |

**相关指标**:
- 订阅后打开率 (open_rate): 目标 > 25%
- 点击率 (click_rate): 目标 > 5%
- 退订率 (unsubscribe_rate): 目标 < 2%

**告警**:
- 订阅率 < 目标 50%: 调查原因（表单位置、副本、CTA 按钮）
- 打开率 < 15%: 邮件质量问题或发送时机问题
- 退订率 > 5%: 内容不符合用户期望

---

#### 工作流下载/操作率

**定义**: 
- 下载率: (工作流下载 / 详情页访问) × 100%
- 操作率: (用户操作工作流 / 详情页访问) × 100%（如复制、分享等）

**基线** (改版前): 
- 下载率: ~8%
- 操作率: (不追踪)

**目标轨迹**:

| 阶段 | 下载率 | 操作率 | 说明 |
|-----|--------|--------|------|
| 改版前 (baseline) | 8% | - | 参考点 |
| 灰度 Phase 2-3 | +20% (9.6%) | +30% | 新的详情页和查看器提升了操作 |
| 全量后 1 个月 | +35% (10.8%) | +50% | 持续改进 |
| 全量后 3 个月 | +50% (12%) | +65% | 用户熟悉新功能 |

**追踪代码**:
```javascript
// 下载按钮点击
analytics.track('workflow_downloaded', {
  workflow_id: id,
  from_page: 'detail_page',
  user_is_new: is_new_user
})

// 查看器操作
analytics.track('workflow_viewer_action', {
  action: 'zoom_in / zoom_out / fit_canvas / download / fullscreen',
  workflow_id: id
})
```

---

### 2.2 用户参与度

#### 详情页停留时间

**定义**: 用户在工作流详情页的平均停留时间

**基线**: ~45 秒

**目标轨迹**:

| 阶段 | 目标 | 与基线比 | 说明 |
|-----|------|---------|------|
| 灰度 Phase 2-3 | 90-120s | +100-167% | 新内容吸引力 |
| 全量 1 个月 | 150-180s | +233-300% | 用户探索更多细节 |
| 全量 3 个月 | 180s+ | +300%+ | 稳定在新水平 |

**相关指标**:
- 滚动深度 (scroll_depth): 目标 > 70%（用户看完详情页）
- 返回率 (bounce_rate): 目标 < 15%（用户不会立即离开）

**告警**:
- 停留时间下降 vs 上周: 可能是性能问题或内容问题
- 滚动深度 < 30%: 内容不够引人入胜

---

#### 页面回访率

**定义**: (在详情页返回过来的用户 / 首次访问该详情页的用户) × 100%

**基线**: ~35%

**目标轨迹**:

| 阶段 | 目标 | 与基线比 | 说明 |
|-----|------|---------|------|
| 灰度 Phase 2-3 | 40-45% | +14-29% | 用户更倾向于回访 |
| 全量 1 个月 | 50-55% | +43-57% | 工作流收藏功能帮助回访 |
| 全量 3 个月 | 55% | +57% | 稳定 |

**追踪方式**:
```javascript
// 虚拟用户 ID（通过 cookie/localStorage）
const userId = getOrCreateUserId()
analytics.track('workflow_detail_page_viewed', {
  workflow_id: id,
  user_id: userId,
  is_return_visit: checkIfPreviouslyVisited(userId, workflow_id)
})
```

---

#### 平均 Session 时长

**定义**: 用户在网站上停留的平均时间

**基线**: ~2.5 分钟

**目标轨迹**:

| 阶段 | 目标 | 与基线比 | 说明 |
|-----|------|---------|------|
| 灰度 Phase 2-3 | 3-3.5 min | +20-40% | 新功能留住用户 |
| 全量 1 个月 | 4-4.5 min | +60-80% | 用户探索更多功能 |
| 全量 3 个月 | 4.5 min+ | +80%+ | 稳定 |

**警告**:
- Session 时长下降 > 10% vs 基线: 可能有严重问题（性能、UX）
- Session 时长增加不如预期: 需要检查新功能是否有用

---

### 2.3 内容质量

#### 用户提交审核通过率

**定义**: (审核通过的提交 / 总提交数) × 100%

**目标**: ≥ 70%（优质内容比例）

**数据源**: workflow_submissions 表中 status 统计

**分类**:

| 提交类型 | 目标通过率 | 说明 |
|---------|----------|------|
| 工作流文件 JSON | ≥ 80% | 大多数用户提交的是有效工作流 |
| 描述/文档 | ≥ 60% | 内容质量标准较高 |
| 总体 | ≥ 70% | 平衡审核成本 vs 社区参与 |

**质量问题分类**:
- 无效 JSON (拒绝原因 1): 工作流文件格式不对
- 不完整文档 (拒绝原因 2): 缺少必要说明
- 垃圾/重复 (拒绝原因 3): 明显垃圾或重复已有工作流
- 合规问题 (拒绝原因 4): 违反社区准则

**审核 SLA**:
- 收到提交后 3-5 个工作日内完成审核
- 被拒提交应给出明确理由，方便用户重新提交

**每周检查清单** (PM/编辑，周五):
- [ ] 本周新提交数: ___
- [ ] 已审核通过: ___ (通过率: __%)
- [ ] 待审核: ___ 
- [ ] 需要加急审核的？

---

#### 用户反馈评分

**定义**: 用户对工作流的评分 (1-5 星) + 评论

**数据源**: workflow_reviews 表

**目标**: ≥ 4.0/5.0（平均分）

**分布目标**:
```
5 星: 60%
4 星: 25%
3 星: 10%
2 星: 3%
1 星: 2%
```

**警告条件**:
- 平均分下降 > 0.3 分 vs 上周: 可能有严重问题
- 单个工作流评分 < 3.0: PM 调查是否需要接入团队支持
- 差评中提到的常见问题：需要发布 FAQ 或改进工作流

**改进循环**:
1. 识别低分工作流
2. 分析评论中的常见问题
3. 联系工作流作者，提出改进建议
4. 跟踪改进后的评分变化

**每周报告** (PM，周五):
```
用户评分概览:
- 总工作流数: 100
- 平均评分: 4.1/5.0 ✅
- 5 星: 60% ✅
- 1-2 星: 5% ✅ (在目标范围内)

低分工作流 (< 3.5):
- 工作流 A: 3.2⭐ (10 个评价) → 原因: [常见问题]
- 工作流 B: 3.0⭐ (5 个评价) → 原因: [常见问题]

改进建议:
- [ ] 联系工作流 A 的作者
- [ ] 发布 FAQ: [常见问题]
```

---

## 监控看板结构

### 3.1 推荐工具

**选项对比**:

| 工具 | 易用性 | 实时性 | 成本 | 推荐 |
|-----|-------|--------|------|------|
| **Google Sheets** | ⭐⭐⭐⭐⭐ | ⭐⭐ (手动) | 免费 | ✅ 快速开始 |
| **Notion** | ⭐⭐⭐⭐ | ⭐⭐ (手动/集成) | 免费 | ✅ 推荐长期 |
| **GitHub Projects** | ⭐⭐⭐ | ⭐⭐⭐⭐ (自动) | 免费 | ✅ 已用（可补充） |
| **Datadog / Grafana** | ⭐⭐ | ⭐⭐⭐⭐⭐ | $$$ | - 可选未来 |

**推荐方案**: 
- **主看板**: Notion（手动更新，汇总所有指标）
- **开发跟踪**: GitHub Projects（自动同步）
- **实时告警**: 脚本 + Slack 通知

---

### 3.2 监控看板示意 (Notion 模板)

**页面名**: 📊 项目总览看板

```
┌────────────────────────────────────────────────────────────┐
│ 网站改版项目 - 实时监控看板                                 │
│ 最后更新: 2026-01-17 10:30 UTC+8                           │
└────────────────────────────────────────────────────────────┘

┌─ 核心指标速览 ───────────────────────────────────────────┐
│                                                            │
│  📈 整体进度      ██████░░░░ 60%  (19/32 issues)          │
│                  vs 目标: 55% (on track) ✅               │
│                                                            │
│  🚧 关键风险      3 项                                     │
│     • P0: 设计稿延期 2 天 (Owner: 设计师, ETA: 明天)     │
│     • P1: 邮件集成未验证 (Owner: 后端, ETA: 2天)          │
│     • P1: 性能基准未达标 (Owner: 前端2, 在处理中)         │
│                                                            │
│  🎯 下一个里程碑  M4: Week 5 完成 P0 功能开发             │
│                  预计 2026-02-07                          │
│                                                            │
│  ⭐ 本周焦点     1. FilterSidebar 测试                     │
│                  2. 性能优化冲刺                          │
│                  3. 内容迁移 50% 进度                     │
│                                                            │
└────────────────────────────────────────────────────────────┘

┌─ 代码质量度量 ─────────────────────────────────────────────┐
│                                                             │
│  Lint 错误:           0 ✅ (强制)                           │
│  测试覆盖率:          82% ✅ (目标 ≥80%)                    │
│  Code Review 通过率:  100% ✅ (无未审代码)                 │
│  Critical Errors:     0 ✅ (零容忍)                        │
│  CR 平均响应:         18h ✅ (目标 ≤24h)                   │
│  PR 合并周期:         36h ✅ (目标 ≤48h)                   │
│                                                             │
│  历史趋势:                                                  │
│  • Test Coverage: Week 1: 75% → Week 2: 78% → Week 3: 82% │
│  • CR 响应: Week 1: 24h → Week 2: 20h → Week 3: 18h        │
│                                                             │
└────────────────────────────────────────────────────────────┘

┌─ 功能进度面板 ─────────────────────────────────────────────┐
│                                                             │
│  P0 功能 (核心)                                              │
│  ├─ FilterSidebar           ████░░░░░░ 40% IN PROGRESS     │
│  │  完成: 架构、筛选逻辑、样式 60%                          │
│  │  待做: 性能优化、E2E 测试                                │
│  │  Owner: 前端1                                           │
│  │  ETA: 2026-01-31                                        │
│  │                                                         │
│  ├─ WorkflowDetailedView    ██░░░░░░░░ 20% IN PROGRESS     │
│  │  完成: 数据模型、组件架构                                │
│  │  待做: 内容展示逻辑、样式                                │
│  │  Owner: 前端2                                           │
│  │  ETA: 2026-02-03                                        │
│  │                                                         │
│  └─ WorkflowViewer          ░░░░░░░░░░ 0% PLANNED          │
│     完成: 无                                                │
│     待做: 全部开发                                          │
│     Owner: 前端2 (申请资源)                                 │
│     ETA: 2026-02-07                                        │
│                                                             │
│  P1 功能 (增强)                                              │
│  ├─ Newsletter              ░░░░░░░░░░ 0% PLANNED           │
│  │  只在所有 P0 完成后启动                                  │
│  │  预计: 2026-02-05                                        │
│  │                                                         │
│  └─ SubmitWorkflow          ░░░░░░░░░░ 0% PLANNED           │
│     只在所有 P0 完成后启动                                  │
│     预计: 2026-02-10                                        │
│                                                             │
└────────────────────────────────────────────────────────────┘

┌─ 缺陷库概览 ───────────────────────────────────────────────┐
│                                                             │
│  打开的缺陷:     8 个 (vs 上周: 10) 📉                      │
│  ├─ P0 Critical: 0 ✅                                      │
│  ├─ P1 High:     2 (FilterSidebar 交互, 性能)             │
│  └─ P2 Medium:   6                                         │
│                                                             │
│  本周解决:       5 个缺陷 ✅                               │
│  ├─ P1: 3 个                                               │
│  └─ P2: 2 个                                               │
│                                                             │
│  缺陷年龄:       最长 5 天 ✅ (目标 ≤7 天)                  │
│                                                             │
│  需要立即关注:                                              │
│  • Bug #45: FilterSidebar 在 Safari 崩溃                   │
│    Owner: 前端1 | Age: 2 天 | ETA: 今天                   │
│  • Bug #52: 详情页加载缓慢 (> 3s)                          │
│    Owner: 前端2 | Age: 1 天 | ETA: 3 天                    │
│                                                             │
└────────────────────────────────────────────────────────────┘

┌─ 灰度期指标 (Week 6+) ────────────────────────────────────┐
│                                                             │
│ 🟢 FilterSidebar 使用率:   28% (目标 20-30%) ✅ ON TARGET │
│                           vs 上周: 22% (+6pp)             │
│                                                             │
│ 🟡 Newsletter 订阅率:       1.8% (目标 1-2%) SLIGHTLY LOW  │
│                           vs 上周: 1.5% (+0.3pp)          │
│                           [Action: 优化 CTA 按钮文案]     │
│                                                             │
│ 🟢 工作流下载率:            +35% (vs baseline) ✅           │
│                           baseline: 8% → 现在: 10.8%       │
│                                                             │
│ 🟢 详情页停留时间:          +45% (vs baseline)  ✅           │
│                           baseline: 45s → 现在: 65s        │
│                                                             │
│ 关键决策:                                                   │
│ ✅ Phase 2 灰度成功，继续 Phase 3 (25% → 50%)              │
│ 📝 Action Item: 改进 Newsletter CTA, ETA: 明天             │
│                                                             │
└────────────────────────────────────────────────────────────┘

[底部链接]
📄 GitHub Projects: https://github.com/...projects/...
📊 详细数据: [Notion Database Link]
🔧 查看告警: [Slack Channel #改版-监控]
```

---

### 3.3 更新频率与负责人

| 指标 | 更新频率 | 负责人 | 工具 | 自动化 |
|-----|--------|--------|------|--------|
| 功能完成度 | 每日 | QA | GitHub Projects | 自动 ✅ |
| Lint/测试 | 每次 commit | CI/CD | GitHub Actions | 自动 ✅ |
| Critical Errors | 实时 | Sentry/错误追踪 | Error Tracking | 自动告警 ✅ |
| 缺陷数 | 每日 | QA | GitHub Issues | 半自动 |
| CR 响应时间 | 每周 | Tech Lead | GitHub API | 脚本统计 |
| 灰度指标 | 每日 (灰度期) | PM/Analytics | GA4 | 脚本导入 |
| 总览看板 | 每周 (周五) | PM | Notion | 手动汇总 |

---

## 告警与升级机制

### 4.1 自动告警 (实时)

**使用工具**: GitHub Actions + Slack 机器人

**告警规则**:

| 事件 | 触发条件 | 接收人 | 优先级 | 响应时间 |
|-----|--------|--------|--------|----------|
| **Critical Error** | Sentry 捕获 critical error | @PM @Tech Lead @关联开发者 | 🔴 立即 | 15分钟 |
| **未审 PR > 24h** | PR created_at + 24h 无 review | @reviewer | 🟡 提醒 | 2小时 |
| **测试覆盖率下降** | coverage < 上次 - 5% | @PM 技术 | 🟡 通知 | 当天 |
| **CI/CD 失败** | GitHub Actions 失败 | @PR Author | 🔴 阻止 | 立即fix |

**Slack 消息格式**:
```
🚨 CRITICAL ERROR
Service: FilterSidebar
Error: "TypeError: Cannot read property 'map' of undefined"
Environment: production | Staging
Affected Users: ~150
Error Link: https://sentry.io/issues/...
Context: 
  Browser: Chrome 120
  Page: /workflows
  Action: Applied filter

Action: @前端1 please investigate ASAP
```

---

### 4.2 人工告警 (会议期间)

**在以下会议检查**:

**每日站会** (09:30):
- [ ] 是否有新的 P0 阻碍？
- [ ] 昨日的 bug 是否在处理中？

**周一规划会** (14:00):
- [ ] 功能完成度是否落后 > 5%？
- [ ] 是否需要调整本周目标？

**周三技术评审** (14:00):
- [ ] 性能有没有突然下降？
- [ ] 测试覆盖率是否达标？
- [ ] Critical errors 是否已解决？

**周五总结会** (17:30):
- [ ] 本周完成度 vs 计划
- [ ] 是否有风险上升到 P0？
- [ ] 下周风险预判

---

### 4.3 升级流程

**触发升级的条件**:

```
[Issue Found]
    ↓
[自动告警或人工检测]
    ↓
[分类优先级: P0/P1/P2]
    ↓
[指定 owner 和时限]
    ↓
[是否在时限内解决?]
    ├─ YES → 记录，监控解决方案
    └─ NO → [升级]
    ↓
[升级流程]
├─ PM 通知受影响人员
├─ 考虑调整其他任务优先级
├─ 必要时召集紧急会议
├─ 调动自有资源或外部支持
└─ 记录升级决策和理由
    ↓
[确认解决并复盘]
```

**升级示例**:

**场景 1: P0 Bug 持续 30+ 分钟未解决**
```
09:15 → 发现 Bug：FilterSidebar 在 Safari 完全不可用
09:20 → Slack 紧急告警 @PM @前端1 @前端2
09:25 → 前端1 开始调查（reproduce issue）
09:45 → 30分钟已过，Bug 仍未修复
09:50 → 升级: PM 召集前端1/2/后端，可能需要临时 workaround
10:00 → 前端2 加入协助诊断
10:15 → 找到根本原因，前端1 编写修复
10:30 → 修复 PR created, code review 加急
10:40 → PR merge + deploy to staging
10:50 → 验证修复有效，部署到生产
11:00 → Bug 解决，事后复盘 (30 分钟会议分析为什么未在发布前发现)
```

**场景 2: 功能完成度连续 2 周落后 > 5%**
```
Week 3 结束 → 完成度 55% (vs 目标 40%) ✅ 超前
Week 4 结束 → 完成度 65% (vs 目标 70%) 🔴 落后 5%

周四: PM 在 Slack 通知: "本周落后 5%, 原因分析中..."

Week 5 周一规划会:
  PM 汇报: "FilterSidebar 因为 XX 原因延期了"
  → 决议1: 增派一名前端帮助 (从 P1 功能抽取)
  → 决议2: 简化 FilterSidebar MVP 功能 (去掉 YY 功能)
  → 新目标: Week 5 完成 P0 (将 P1 推迟到 Week 6)

Week 5 结束 → 完成度 82% ✅ 恢复或超前
```

---

## 数据采集与工具

### 5.1 实现监控脚本

**文件位置**: `scripts/monitoring-dashboard.js` (自动执行)

**功能**:
1. 每日早 08:00 运行
2. 收集 GitHub API 数据（功能完成度、PR 数据）
3. 收集开发环境 CI/CD 数据（测试覆盖率、Lint 结果）
4. 合并数据到 Google Sheets / Notion API
5. 生成 Slack 每日简报

**脚本示例**:
```javascript
// scripts/monitoring-dashboard.js
const github = require('@octokit/rest')();
const notion = require('@notionhq/client');

async function collectMetrics() {
  // 1. GitHub 项目进度
  const milestone = await github.issues.listForRepo({
    owner: 'repo-owner',
    repo: 'repo-name',
    milestone: '改版 v2.0',
    state: 'all'
  });
  
  const completed = milestone.data.filter(i => i.state === 'closed').length;
  const total = milestone.data.length;
  const completionRate = (completed / total * 100).toFixed(1);
  
  // 2. 发送到 Notion
  const notionClient = new notion.Client({ auth: NOTION_TOKEN });
  await notionClient.databases.query({
    database_id: MONITORING_DB_ID,
    // 更新 completion_rate
  });
  
  // 3. 发送 Slack 通知
  const slackClient = new (require('@slack/web-api')).WebClient(SLACK_TOKEN);
  await slackClient.chat.postMessage({
    channel: '#改版-监控',
    text: `📊 每日指标: 完成度 ${completionRate}%, 覆盖率 XX%, Critical Errors 0`,
    blocks: [...]
  });
}

collectMetrics().catch(console.error);
```

---

### 5.2 工具集成检查清单

**设置 Notion 看板**:
- [ ] 创建 Notion Database：项目监控面板
- [ ] 添加字段：日期、完成度、覆盖率、Bug 数、关键风险等
- [ ] 设置自动化：每周五自动提醒更新
- [ ] 共享给全体团队设置查看权限

**配置 GitHub Actions**:
- [ ] 创建 workflow：每天 08:00 运行 metric collection script
- [ ] 输出覆盖率、Lint 结果到 artifacts
- [ ] 失败时自动 Slack 告警

**连接 Sentry 或错误追踪**:
- [ ] 集成 Sentry（或选择替代方案）
- [ ] 配置告警规则：critical errors → Slack
- [ ] 设置与 GitHub Issues 的自动关联

**设置 Google Analytics 4**:
- [ ] 添加自定义事件：filter_sidebar_used, workflow_downloaded 等
- [ ] 创建 GA4 Report：灰度期指标追踪
- [ ] 每日导出数据到 Google Sheets（可用 Data Studio）

---

## 监控仪表板模板

### 6.1 Google Sheets 模板（快速开始）

**Sheet 1: 每日指标**
```
日期       | 完成度  | 覆盖率  | Bug数 | CR平均 | 关键风险 | 备注
2026-01-10 | 45%     | 82%     | 8     | 18h    | 3项      | 性能优化进行中
2026-01-11 | 48%     | 83%     | 7     | 16h    | 3项      | 
...
```

**Sheet 2: 灰度期指标**
```
日期       | FilterSidebar使用率 | Newsletter订阅 | WorkflowDL率 | 停留时间 | 决策
2026-01-15 | 18%                | 1.2%           | +20%         | 50s      | Phase 2 继续
2026-01-16 | 22%                | 1.5%           | +28%         | 58s      | 
...
```

**Sheet 3: 周汇总**
```
周 | 完成度 vs 计划 | 覆盖率达成 | Bug解决数 | 关键决策 | 下周预告
1  | 95% (on target) | ✅ 80%+ | 0 (无开发) | M1通过启动 | P0开发正式启动
2  | 110% (超前) | ✅ 82% | 5 (集成Bug) | 进度加快 | 继续 P0小
...
```

---

### 6.2 Notion 数据库模板（长期维护）

**Database 1：项目总览**
- Title: 项目监控面板
- 字段：
  - 日期 (Date)
  - 完成度 (%)
  - 覆盖率 (%)
  - Bug 数 (Number)
  - 关键风险 (Relation to Risks DB)
  - 状态 (Select: On Track / At Risk / Behind)
  - 备注 (Text)

**Database 2：风险追踪**
- Title: 项目风险
- 字段：
  - 风险名称
  - 优先级 (P0/P1/P2)
  - 监控指标
  - 触发阈值
  - 当前状态 (1=低, 2=中, 3=高)
  - 所有者
  - 应对措施
  - 状态 (Open / Mitigated / Resolved)

---

**文档版本**: 1.0  
**最后修改**: 2026-01-10  
**维护者**: PM + QA 团队  
**下次审核**: 灰度发布期间（Week 6）
