This workflow automates the process of reading EDI files generated by Sabre, parsing them using an AI Agent, and producing structured accounting reports like:

ğŸ“Œ Accounts Receivable (AR) Summary
ğŸ“Œ Tax and Surcharges Report

It also uses Retrieval-Augmented Generation (RAG) to vectorize the Sabre Interface User Record (IUR)â€”a 154-page technical documentâ€”so that the AI agent can reference it when clarification is required while generating reports.

**âš™ï¸ Tools & Integrations Used**
Component:Tool/Service:Purpose:Workflow Engine:n8n:Automation & orchestration
LLM Model:OpenAI GPT-4 / Chat Model:Natural language understanding and parsing
Embeddings Model:OpenAI Embeddings:Convert text into semantic vector format
Vector Database:Pinecone:Store and retrieve document chunks semantically
Storage:Google Drive:Source of raw EDI text files and PDF documentation
DataLoader + Splitter:n8n Node + Recursive Splitter:Loads and prepares documents for embedding
AI Agents:n8n AI Agent Node:Runs context-aware prompts and parses reports

**ğŸ§± Workflow Breakdown**
**ğŸ§  1. Vectorizing the Sabre IUR Document (RAG Setup)**
ğŸ“˜ Objective: Enable the AI Agent to refer to the IUR document (154 pages) for detailed explanations of EDI terms, formats, and rules.

Flow Steps:

Google Drive Search + Download â€“ Find and pull the IUR PDF file.

Default Data Loader â€“ Load the file and preprocess it for semantic splitting.

Recursive Character Splitter â€“ Break down large pages into meaningful chunks.

OpenAI Embeddings â€“ Vectorize each chunk.

Pinecone Vector Store â€“ Save into a Pinecone namespace for future retrieval.

âœ… Result: The IUR is now searchable via semantic queries from the AI Agent.

**ğŸ“ 2. Reading and Extracting Data from EDI Files**
ğŸ“˜ Objective: Parse raw EDI files for financial records and summaries.

Flow Steps:

**Trigger** â€“ Manual or scheduled execution of the workflow.

**Google Drive Search** â€“ Finds all new .edi or .txt files.

**Download File Contents** â€“ Loads content of each file into memory.

**Extract from File** â€“ Raw text extraction.

**ğŸ“Š 3. Report Generation Using AI Agents**
**ğŸ“˜ Objective:** AI Agents parse the extracted data to generate structured accounting reports.

**a. Accounts Receivable Report Agent**
The extracted text is passed to an AI Agent.

Model is connected to:

OpenAI Chat Model (LLM)

Pinecone Vector DB (IUR reference)

Outputs a structured AR Summary Report.

**b. Tax and Surcharges Report Agent**
Same steps as above.

Prompts adjusted to extract tax, fees, surcharges, and amounts.

âœ… Output Format: Can be mapped to columns and inserted into a Google Sheet or exported as a CSV/JSON.

ğŸ“‘ Sample Reports You Can Build
Already implemented:

âœ… Accounts Receivable (AR) Summary Report

âœ… Tax and Surcharges Report

Can be extended to:
3. Accounts Payable (AP)
4. Passenger Revenue
5. Daily Sales
6. Commission Report
7. Net Profit Margin (if supplier cost + commission is available)

**ğŸ’¡ Key Advantages**
âœ… No-code automation with n8n

âœ… Semantic reasoning using AI + Vector DB (RAG)

âœ… Can work with various Sabre outputs without manual parsing

âœ… Modular: Easy to add new report types

âœ… Cloud-integrated (Drive, Pinecone, OpenAI)

**ğŸ§ª Potential Improvements**
Area	Suggestions
Testing	Add a â€œPreviewâ€ step to validate extracted data before writing
Scalability	Batch mode + Google Sheet batching for multiple reports
Audit Trail	Log every file name, timestamp, report type in a Google Sheet
Notification	Send Slack/Email when a new report is generated
Multi-model support	Add Claude/Gemini fallback if OpenAI usage limit is hit

