{
  "id": 2379,
  "slug": "2379",
  "title": "Validate TOTP token (without creating a credential)",
  "description": "## TOTP Validation with Function Node\n\nThis template allows you to verify if a 6-digit TOTP code is valid using the corresponding TOTP secret. It can be used in an authentication system.\nThe inputs need to be: \n- a base32 totp secret (String)\n- a 6 digits code (String)\n\n++Important:++ The 6-digit code must be in text format. If the code starts with zeros and is treated as a number, it could cause validation issues.\n\nThe function node will generate a 6-digit code from the TOTP secret, then compare it with the provided code. If they match, it will return `1` otherwise, it will return `0`.\n## Example usage:\n\n- You retrieve the user's TOTP secret from a database, then you want to verify if the 2FA code provided by the user is valid.\n\n## Setup Guidelines\nYou only need the ==`TOTP VALIDATION`== node.\n==You will need to modify lines `39` and `40`== of the node with the correct values for your specific context.\n\n## Testing the Template\nYou can define a sample secret and code in the `EXAMPLE FIELDS` node of the template, then click `\"Test Workflow\"`.\nIf the code is valid for the provided secret, the flow will proceed to the `true` branch of the `IF CODE IS VALID` node. Otherwise, it will go to the `false` branch.",
  "featuredImage": "/data/workflows/2379/2379.webp",
  "author": {
    "id": 101,
    "slug": "bazhard",
    "name": "Bazhard",
    "avatar": ""
  },
  "categories": [
    "SecOps"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 603,
  "downloads": 60,
  "createdAt": "2024-08-14T18:06:42.138Z",
  "updatedAt": "2026-01-16T08:24:19.334Z",
  "publishedAt": "2024-08-14T18:06:42.138Z",
  "nodes": 5,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/2379"
}