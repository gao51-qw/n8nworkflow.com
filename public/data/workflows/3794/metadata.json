{
  "id": 3794,
  "slug": "3794",
  "title": "Automate solar lead qualification & follow-ups with Google Sheets and Gmail",
  "description": "# Automate Solar Lead Qualification & Follow-ups with Google Sheets and Gmail\n\nNote: This template is designed for both self-hosted and cloud-based n8n instances. The workflow image above shows the complete automation flow.\n\nThis n8n workflow automates the entire solar lead qualification process - from capturing lead information through a webhook, storing data in Google Sheets, evaluating qualification criteria, and sending personalized email follow-ups based on qualification status.\n\n## Who is this for?\n\nThis workflow is designed for:\n\n* Solar installation companies\n* Solar sales teams\n* Renewable energy consultants\n* Lead generation specialists in the solar industry\n\n## What problem does this workflow solve?\n\nManaging solar leads efficiently can be challenging. This workflow solves several key pain points:\n\n* Time-consuming manual lead qualification: Automatically evaluates leads against predefined criteria\n* Inconsistent follow-up: Ensures every lead receives a timely, personalized response\n* Document management: Securely stores and shares utility bill documents\n* Lead tracking inefficiency: Centralizes lead data in Google Sheets with qualification status\n\n## What this workflow does\n\nThis workflow creates a complete solar lead management system that:\n\n1. Captures lead information through a webhook endpoint\n2. Securely stores utility bill uploads in Google Drive\n3. Records all lead data in Google Sheets\n4. Automatically evaluates leads based on three qualification criteria:\n   * Homeownership status\n   * Credit score (must be 650+)\n   * Absence of trees on roof\n5. Updates qualification status in the Google Sheet\n6. Sends personalized email follow-ups based on qualification status:\n   * Qualified leads receive a congratulatory email with next steps\n   * Disqualified leads receive helpful information about why they didn't qualify and suggestions for remediation\n\n## Setup\n\n### Prerequisites\n\nBefore setting up this workflow, you'll need:\n\n1. A self-hosted n8n instance\n2. Google account with access to:\n   * Google Sheets\n   * Google Drive\n   * Gmail\n3. A form on your website that can make POST requests to a webhook\n\n### Step 1: Google Sheets Setup\n\n1. Create a new Google Sheet for storing leads\n2. Add the following columns in the first row (exact naming is important):\n   * Name\n   * Address\n   * Has Trees on Roof\n   * credit score\n   * phone\n   * Zip code\n   * Email\n   * Homeowner\n   * utility bill\n   * Qualification status\n   * Disqualification reason\n\n### Step 2: Google Drive Setup\n\n1. Sign in to your Google Drive account\n2. Create a folder named \"Solar Lead Utility Bills\" (or your preferred name)\n3. Right-click on the folder and select \"Share\"\n4. Set permissions to \"Anyone with the link can view\"\n5. Note the folder ID from the URL for configuration (the long string after /folders/ in the URL)\n\n### Step 3: Configure Google Credentials in n8n\n\n1. In your n8n instance, go to Settings → Credentials\n2. Add credentials for:\n   * Google Sheets: Create new credentials, follow OAuth2 authentication\n   * Google Drive: Create new credentials, follow OAuth2 authentication\n   * Gmail: Create new credentials, follow OAuth2 authentication\n3. Ensure all credentials have the necessary scopes:\n   * Google Sheets: .../auth/spreadsheets\n   * Google Drive: .../auth/drive\n   * Gmail: .../auth/gmail.send\n\n### Step 4: Import and Configure the Workflow\n\n1. In n8n, go to Workflows → Import from File\n2. Upload the workflow JSON file\n3. Update all Google Sheets nodes with your Google Sheet document ID:\n   * Open your Google Sheet\n   * Copy the ID from the URL (long string between /d/ and /edit)\n   * Update the document ID field in the Google Sheets nodes\n4. In the \"[STEP 2] Upload Utility Bill\" node, set the folder destination to your created folder\n\n### Step 5: Configure the Webhook\n\n1. Activate the \"[STEP 1] Receive Form Submission\" webhook node\n2. Copy the generated webhook URL\n3. Configure your website form to send data to this URL\n4. Ensure your form submits the following fields with exact naming:\n   * firstName\n   * lastName\n   * address\n   * hasTreesOnRoof\n   * creditScore\n   * phone\n   * zipCode\n   * email\n   * homeOwnership\n   * utilityBill (file upload)\n\n### Step 6: Customize Email Templates\n\n1. Open the \"[STEP 10A] Send Acceptance Email\" node\n2. Customize the email subject and message to match your company's branding\n3. Open the \"[STEP 10B] Send Rejection Email\" node\n4. Customize the rejection email to reflect your company's voice\n\n### Step 7: Activate and Test\n\n1. Click \"Save\" on the workflow\n2. Toggle the \"Active\" switch to activate the workflow\n3. Submit a test lead through your form\n4. Check that:\n   * The data appears in your Google Sheet\n   * The qualification status is updated correctly\n   * The appropriate email is sent\n\n## How to customize this workflow to your needs\n\n### Adjusting Qualification Criteria\n\nYou can modify the qualification logic in the \"[STEP 7] Check Qualification Criteria\" node:\n\n1. Open the node and click the \"Edit Code\" button\n2. Locate the criteria sections (homeowner, credit score, trees on roof)\n3. Modify the conditions as needed:\n\n```javascript\n// Example: Change credit score threshold\nif (creditScoreRaw.includes(\"600 - 649\") ||\n    creditScoreRaw.includes(\"650 - 689\") ||\n    creditScoreRaw.includes(\"690 - 719\") ||\n    creditScoreRaw.includes(\"720+\")) {\n    creditQualified = true;\n}\n```\n\n4. Add additional criteria if needed\n\n### Customizing Email Templates\n\nPersonalize your emails further:\n\n1. Open the email nodes\n2. Use variable references to include more customer data:\n\n```\nDear {{ $json.Name }},\n\nWe noticed your utility bill shows an average of {{ $json.monthlyBill }} per month.\nWith solar, you could save approximately {{ $json.monthlySavings }}.\n```\n\n### Adding Integration with CRM Systems\n\nExtend this workflow by connecting it to your CRM:\n\n1. Add a Hubspot/Salesforce/etc. node after the \"[STEP 8] Update Qualification Status\" node\n2. Configure the node to create or update contacts in your CRM\n3. Map the lead data fields to your CRM fields\n\n## Troubleshooting\n\n### Common Issues\n\n1. Webhook not receiving data\n   * Verify your form is correctly configured to send POST requests\n   * Check CORS settings on your website\n   * Ensure all required fields are being sent\n\n2. Google Drive upload failing\n   * Check Google Drive permissions\n   * Verify your OAuth scopes include drive.file\n   * Ensure your Drive has sufficient storage space\n\n3. Email not sending\n   * Verify Gmail credentials\n   * Check if Gmail API is enabled in your Google Cloud Console\n   * Look for Send Rate Exceeded errors in execution logs\n\n### Google Sheets Column Format\n\nIf you're having issues with data not appearing correctly:\n\n1. Make sure the column names exactly match those in the code\n2. Check that the Google Sheet permissions allow editing\n3. Verify the sheet name is correctly referenced in the nodes\n\n## Getting Help\n\nIf you encounter issues with this template, you can:\n\n* Check the n8n documentation on webhooks\n* Review Google Sheets integration documentation\n* Post in the n8n community forum\n\nThis template was created by David Olusola. If you find it helpful, please consider giving it a star in the n8n template library!",
  "featuredImage": "/data/workflows/3794/3794.webp",
  "author": {
    "id": 101,
    "slug": "dae221",
    "name": "David Olusola",
    "avatar": ""
  },
  "categories": [
    "Lead Generation"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 864,
  "downloads": 86,
  "createdAt": "2025-04-29T22:42:19.778Z",
  "updatedAt": "2026-01-16T08:31:30.141Z",
  "publishedAt": "2025-04-29T22:42:19.778Z",
  "nodes": 19,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3794"
}