{
  "id": 9192,
  "slug": "9192",
  "title": "Smart message batching AI-powered Facebook Messenger chatbot",
  "description": "# ğŸ¤– Facebook Messenger Smart Chatbot - Smart Batch, Format & History with n8n Data Table v3\n## Version 2026 - Adaptable to n8n v1.113+ and v2.x\n**by Nguyen Thieu Toan (Jay Nguyen)**\n\n---\n![bananapro20251218T102041765Z1.png](fileId:3772)\n\n## ğŸ“– Overview\n\nA **production-ready, enterprise-grade chatbot solution** for Facebook Messenger built entirely in n8n. Features intelligent message batching, session-aware conversation tracking, multi-page support, and natural AI-powered responses.\n\n**Perfect for:**\n- ğŸ’¼ Customer support automation\n- ğŸ›’ E-commerce product inquiries\n- ğŸ“… Appointment scheduling & consultation booking\n- ğŸ“ Educational assistants & training\n- ğŸ¤ Lead qualification & sales automation\n\n**Requirements:** n8n v1.113.0+, Facebook App with Messenger, Google Gemini API key (or compatible LLM)\n\n## ğŸ”— Complementary Workflow\n\n**Facebook Messenger Chatbot â€“ Smart Human Takeover, Auto Pause & Context-Aware**\n\nAdds intelligent human agent detection and automatic AI pause. When a human joins, AI pauses for configurable duration, then resumes automatically.\n\n**Why combine?**\n- Smart Batch (v3): Multi-message batching, spam reduction\n- Human Takeover: AI pauses for humans, smooth collaboration\n\nğŸ‘‰ [Access workflow](https://n8n.io/workflows/11920)\n\n---\n![Screenshot_18122025_154423_n8n.nguyenthieutoan.com.jpeg](fileId:3771)\n\n## âš¡ What's New in Version 3\n\n### **Major Upgrades**\n\n| Feature | Impact |\n|---------|--------|\n| ğŸ¢ **Multi-Page Support** | Manage multiple pages within one workflow |\n| â±ï¸ **Flexible Timing** | Adjustable wait times instead of fixed delays |\n| ğŸ”’ **Improved Detection** | More reliable identification of system vs. user messages |\n| ğŸ“¦ **Smart Delivery** | Sequential message handling to avoid overload |\n| ğŸ§¹ **Automatic Cleanup** | Removes outdated records to keep storage efficient |\n| ğŸ“Š **Better Context** | Clear separation of past vs. current sessions |\n| ğŸ”„ **Ordered Updates** | Ensures actions run in the right sequence |\n| ğŸ“ **Simplified Naming** | Clearer labels for easier understanding |\n\n**Architecture Comparison**:  \nPrevious version had fixed timing, parallel updates, no multi-page handling, and no cleanup.  \nNew version introduces flexibility, sequential processing, and scalability for real-world use.\n\n---\n\n## ğŸ¯ Key Features\n\n- **ğŸ”„ Smart Batching**: Groups consecutive messages within configurable window (default 7s)\n- **ğŸ§  Session-Aware Context**: Distinguishes old vs. current sessions for temporal awareness\n- **ğŸ“‹ Full History**: Stores complete chat logs with both user and page responses\n- **ğŸ‘€ Natural UX**: \"Seen\" marker and \"Typing...\" indicator for human-like feel\n- **ğŸ¯ AI Integration**: Extensible prompts for domain-specific consulting (Gemini, Groq, or any LLM)\n- **ğŸŒ Multi-Language**: Handles Vietnamese (anh/chá»‹/em) with customizable settings\n- **ğŸ¢ Multi-Page Ready**: Single workflow serves multiple Facebook Pages simultaneously\n\n**Technical Highlights**: Idempotent processing, timezone-aware timestamps (Asia/Ho_Chi_Minh), Facebook API v24.0 compatible, sequential delivery with rate limiting protection, auto cleanup (keeps last 15 rows)\n\n---\n\n## ğŸ—ï¸ How It Works\n\n```\n### ğŸ”„ General Flow\n\nReception & Validation â†’ Batching & Storage â†’ Context Aggregation  \n        â†“                      â†“                      â†“  \n   Identify input        Store for later use     Combine with history  \n   Filter duplicates     Apply short delay       Build conversation context  \n\n                              â†“  \n\n                AI Processing â†’ Delivery & Cleanup  \n                         â†“                â†“  \n                 Generate response     Format & send  \n                 Add signals           Maintain records  \n                 Ensure continuity     Clean old data  \n\n```\n\n---\n\n## ğŸ› ï¸ Setup Guide\n\n### Step 1: Facebook App  \nCreate app, add Messenger, set webhook, get token, subscribe page  \n\n### Step 2: Data Table  \nPrepare tables for messages batching\n\n### Step 3: Workflow  \nImport template, set context, link tables, connect AI \n\n### Step 4: Test  \nActivate workflow, send test messages, verify pause/resume  \n\n---\n\n## ğŸ‘¤ About the Author\n\n**Nguyen Thieu Toan (Nguyá»…n Thiá»‡u ToÃ n / Jay Nguyen)**\n\n*AI Automation Specialist | n8n Workflow Expert | Business Optimization Consultant*\n\n**Services**: AI Automation Solutions, n8n Workflow Development, Custom Chatbot Implementation, Training Programs\n\n**Contact**:\n- ğŸŒ [nguyenthieutoan.com](https://nguyenthieutoan.com)\n- ğŸ“˜ [Facebook](https://www.facebook.com/nguyenthieutoan)\n- ğŸ’¼ [LinkedIn](https://www.linkedin.com/in/nguyenthieutoan)\n- ğŸ¦ [X (Twitter)](https://www.x.com/nguyenthieutoan)\n- ğŸ“º [YouTube](https://www.youtube.com/@NguyenThieuToan)\n- ğŸ“§ me@nguyenthieutoan.com\n\n**GenStaff Company**: [genstaff.net](https://genstaff.net) | contact@genstaff.net\n\n---\n\n## ğŸ“„ License\n\nAfter purchase, use in commercial/personal projects. No redistribution or resale. Keep author attribution when sharing.\n\n---\n\n**Last Updated**: December 18, 2025 | **Version**: 3.0 | **n8n Compatibility**: v1.123.0+ and v2.0.0+ | **Facebook API**: v24.0\n\n---\n\n**Ready to transform your Facebook Messenger into an intelligent AI assistant? Import this workflow and start automating today! ğŸš€**",
  "featuredImage": "/data/workflows/9192/9192.webp",
  "author": {
    "id": 101,
    "slug": "nguyenthieutoan",
    "name": "Nguyá»…n Thiá»‡u ToÃ n (Jay Nguyen)",
    "avatar": ""
  },
  "categories": [
    "Support Chatbot",
    "AI Chatbot"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2065,
  "downloads": 206,
  "createdAt": "2025-10-02T12:42:39.709Z",
  "updatedAt": "2026-01-16T08:59:24.171Z",
  "publishedAt": "2025-10-02T12:42:39.709Z",
  "nodes": 33,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/9192"
}