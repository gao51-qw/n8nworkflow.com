{
  "id": 8095,
  "slug": "8095",
  "title": "Email new leads from Google Sheets via Outlook on a schedule",
  "description": "Send a templated outreach email to **new leads** in a Google Sheet on a **daily schedule**, then **mark each lead as contacted** so they won‚Äôt be emailed twice. Built with: **Schedule Trigger ‚Üí Google Sheets ‚Üí Filter ‚Üí Outlook Send Email ‚Üí Google Sheets (append/update)**.\n\n---\n\n## Who‚Äôs it for\n- Teams that collect leads in Sheets and want automatic, once-per-lead outreach  \n- Solo founders/consultants running simple top-of-funnel follow-ups  \n- Anyone prototyping CRM-lite flows in n8n\n\n---\n\n## How it works / What it does\n1. **Schedule Trigger** runs daily (e.g., 09:00).\n2. **Get rows (Google Sheets)** pulls leads from your sheet.\n3. **Filter** keeps only rows where `Contacted` is **empty**.\n4. **Outlook ‚Äì Send a message** emails each remaining lead (`to = {{$json.Email}}`).\n5. **Google Sheets (appendOrUpdate)** writes back `Contacted = Yes` (match on `Email`) to prevent re-sending.\n\n\n---\n\n## How to set up\n### 1) Google Sheets (OAuth2)\n- In **n8n ‚Üí Credentials ‚Üí New ‚Üí Google Sheets (OAuth2)**, sign in and grant access.  \n- In **Get rows**: select your **Lead Source** sheet (e.g., ‚ÄúNew Leads‚Äù).  \n- In **Append/Update**: select the sheet you want to mark as contacted (can be the same sheet or a CRM sheet).  \n- Make sure your sheet has at least: `Email`, `Contacted` (blank for new).\n\n### 2) Outlook (Microsoft Graph) OAuth2\n- **n8n Cloud (quick connect):**  \n  - In **Credentials ‚Üí New ‚Üí Microsoft Outlook OAuth2**, choose **Connect**, sign in with your Microsoft account, and accept permissions.\n- **Self-hosted (Azure App Registration):**  \n  1) Azure Portal ‚Üí **App registrations** ‚Üí **New registration**.  \n  2) Add redirect URL: `https://YOUR_N8N_URL/rest/oauth2-credential/callback`.  \n  3) **API permissions (Delegated):** `offline_access`, `Mail.Send`, `User.Read`. Grant admin consent if required.  \n  4) Create a **Client secret**; copy **Application (client) ID** and **Directory (tenant) ID**.  \n  5) In n8n, create **Microsoft Outlook OAuth2** credential with those values and scopes: `offline_access Mail.Send openid email profile`.  \n- In the **Send a message** node, select that credential and keep `To` mapped to `{{$json.Email}}`.  \n- Customize **Subject** and **Body** to your brand (default provided).\n\n---\n\n## Requirements\n- A Google Sheet of leads with an **Email** column (and an optional **Contacted** column).  \n- A Microsoft account with permission to send mail via **Microsoft Graph** (Outlook).\n\n---\n\n## How to customize the workflow\n- **Email content:** Edit subject/body (add variables like `{{$json.FirstName}}`).  \n- **Send window:** Change Schedule Trigger time/interval.  \n- **Idempotency:** Use the same sheet for read+write (match on `Email`) or separate source/CRM sheets.  \n- **Logging:** Add a Sheet or Notion append step after send for an audit trail.\n\n---\n\n## Security & best practices\n- **No hardcoded secrets:** Always use **OAuth2 credentials** (Sheets & Outlook).  \n- **Sanitize PII:** If publishing, **remove real spreadsheet IDs/URLs** and personal emails/phone numbers.  \n- **Sticky notes are mandatory:** Add a **yellow sticky note** in the workflow with this description and a short setup checklist. Use neutral sticky notes for per-node tips.\n\n---\n\n## Troubleshooting\n- **No emails sent:** Ensure `Contacted` is blank for new rows and the Filter checks ‚Äúis empty.‚Äù  \n- **Auth errors (Outlook):** Reconnect credential; confirm Graph scopes and tenant consent.  \n- **Sheets errors:** Re-select spreadsheet/tab; verify headers (`Email`, `Contacted`).  \n- **Duplicates:** Confirm **Append/Update** uses **matching column = Email**.\n\n---\n\n## Tags & category\n**Category:** Sales & CRM  \n**Tags:** outreach, follow-up, google-sheets, outlook, schedule, dedupe, cold-email\n\n---\n\n## Changelog\n**v1.0.0** ‚Äî Initial release: scheduled outreach, Outlook email, de-dupe via `Contacted = Yes`.\n\n---\n\n## Contact\nNeed help customizing (personalization, rate-limits, CRM sync, bounce checks)?\n\n- üìß rbreen@ynteractive.com  \n- üîó Robert Breen ‚Äî https://www.linkedin.com/in/robert-breen-29429625/  \n- üåê ynteractive.com ‚Äî https://ynteractive.com\n",
  "featuredImage": "/data/workflows/8095/8095.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Lead Nurturing"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 2572,
  "downloads": 257,
  "createdAt": "2025-08-31T21:09:22.082Z",
  "updatedAt": "2026-01-16T08:54:06.598Z",
  "publishedAt": "2025-08-31T21:09:22.082Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8095"
}