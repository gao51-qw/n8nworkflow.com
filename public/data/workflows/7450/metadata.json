{
  "id": 7450,
  "slug": "7450",
  "title": "Natural language Google Sheets data analysis with Gemini AI",
  "description": "\nThis n8n workflow template creates an efficient data analysis system that uses Google Gemini AI to interpret user questions about spreadsheet data and processes them through a specialized sub-workflow for optimized token usage and faster responses.\n\n## What This Workflow Does\n\n- **Smart Query Parsing**: Uses Gemini AI to understand natural language questions about your data\n- **Efficient Processing**: Routes calculations through a dedicated sub-workflow to minimize token consumption\n- **Structured Output**: Automatically identifies the column, aggregation type, and grouping levels from user queries\n- **Multiple Aggregation Types**: Supports sum, average, count, count distinct, min, and max operations\n- **Flexible Grouping**: Can aggregate data by single or multiple dimensions\n- **Token Optimization**: Processes large datasets without overwhelming AI context limits\n\n## Tools Used\n\n- **Google Gemini Chat Model** - Natural language query understanding and response formatting\n- **Google Sheets Tool** - Data access and column metadata extraction\n- **Execute Workflow** - Sub-workflow processing for data calculations\n- **Structured Output Parser** - Converts AI responses to actionable parameters\n- **Memory Buffer Window** - Basic conversation context management\n- **Switch Node** - Routes to appropriate aggregation method\n- **Summarize Nodes** - Performs various data aggregations\n\n## üìã MAIN WORKFLOW - Query Parser\n\n### What This Workflow Does\nThe main workflow receives natural language questions from users and converts them into structured parameters that the sub-workflow can process. It uses Google Gemini AI to understand the intent and extract the necessary information.\n\n### Prerequisites for Main Workflow\n- Google Cloud Platform account with Gemini API access\n- Google account with access to Google Sheets\n- n8n instance (cloud or self-hosted)\n\n### Main Workflow Setup Instructions\n\n#### 1. Import the Main Workflow\n1. Copy the main workflow JSON provided\n2. In your n8n instance, go to **Workflows** ‚Üí **Import from JSON**\n3. Paste the JSON and click **Import**\n4. Save with name: \"Gemini Data Query Parser\"\n\n#### 2. Set Up Google Gemini Connection\n1. Go to [Google AI Studio](https://aistudio.google.com/)\n2. Sign in with your Google account\n3. Go to **Get API Key** section\n4. Create a new API key or use an existing one\n5. Copy the API key\n\n**Configure in n8n:**\n1. Click on **Google Gemini Chat Model** node\n2. Click **Create New Credential**\n3. Select **Google PaLM API**\n4. Paste your API key\n5. Save the credential\n\n#### 3. Set Up Google Sheets Connection for Main Workflow\n1. Go to [Google Cloud Console](https://console.cloud.google.com/)\n2. Create a new project or select existing one\n3. Enable the **Google Sheets API**\n4. Create OAuth 2.0 Client ID credentials\n5. In n8n, click on **Get Column Info** node\n6. Create **Google Sheets OAuth2 API** credential\n7. Complete OAuth flow\n\n#### 4. Configure Your Data Source\n**Option A: Use Sample Data**\n- The workflow is pre-configured for: [Sample Marketing Data](https://docs.google.com/spreadsheets/d/19aUQYZq02qHsCelO4eeV4sx_MTJJupC5qe0gDLQBtRA/edit?usp=drivesdk)\n- Make a copy to your Google Drive\n\n**Option B: Use Your Own Sheet**\n1. Update **Get Column Info** node with your Sheet ID\n2. Ensure you have a \"Columns\" sheet for metadata\n3. Update sheet references as needed\n\n#### 5. Set Up Workflow Trigger\n1. Configure how you want to trigger this workflow (webhook, manual, etc.)\n2. The workflow will output structured JSON for the sub-workflow\n\n---\n\n## ‚öôÔ∏è SUB-WORKFLOW - Data Processor\n\n### What This Workflow Does\nThe sub-workflow receives structured parameters from the main workflow and performs the actual data calculations. It handles fetching data, routing to appropriate aggregation methods, and formatting results.\n\n### Sub-Workflow Setup Instructions\n\n#### 1. Import the Sub-Workflow\n1. Create a new workflow in n8n\n2. Copy the sub-workflow JSON (embedded in the Execute Workflow node)\n3. Import as a separate workflow\n4. Save with name: \"Data Processing Sub-Workflow\"\n\n#### 2. Configure Google Sheets Connection for Sub-Workflow\n1. Apply the same Google Sheets OAuth2 credential you created for the main workflow\n2. Update the **Get Data** node with your Sheet ID\n3. Ensure it points to your data sheet (e.g., \"Data\" sheet)\n\n#### 3. Configure Google Gemini for Output Formatting\n1. Apply the same Gemini API credential to the **Google Gemini Chat Model1** node\n2. This handles final result formatting\n\n#### 4. Link Workflows Together\n1. In the main workflow, find the **Execute Workflow - Summarize Data** node\n2. Update the workflow reference to point to your sub-workflow\n3. Ensure the sub-workflow is set to accept execution from other workflows\n\n### Sub-Workflow Components\n- **When Executed by Another Workflow**: Trigger that receives parameters\n- **Get Data**: Fetches all data from Google Sheets\n- **Type of Aggregation**: Switch node that routes based on aggregation type\n- **Multiple Summarize Nodes**: Handle different aggregation types (sum, avg, count, etc.)\n- **Bring All Data Together**: Combines results from different aggregation paths\n- **Write into Table Output**: Formats final results using Gemini AI\n\n### Example Usage\n\nOnce both workflows are set up, you can ask questions like:\n\n**Overall Metrics:**\n- \"Show total Spend ($)\"\n- \"Show total Clicks\"\n- \"Show average Conversions\"\n\n**Single Dimension:**\n- \"Show total Spend ($) by Channel\"\n- \"Show total Clicks by Campaign\"\n\n**Two Dimensions:**\n- \"Show total Spend ($) by Channel and Campaign\"\n- \"Show average Clicks by Channel and Campaign\"\n\n### Data Flow Between Workflows\n1. **Main Workflow**: User question ‚Üí Gemini AI ‚Üí Structured JSON output\n2. **Sub-Workflow**: Receives JSON ‚Üí Fetches data ‚Üí Performs calculations ‚Üí Returns formatted table\n\n\n\n---\n\n## Contact Information\n\n\nFor support, customization, or questions about this template:\n\n- **Email**: robert@ynteractive.com\n- **LinkedIn**: [Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)\n\n*Need help implementing these workflows, want to remove limitations, or require custom modifications? Reach out for professional n8n automation services and AI integration support.*",
  "featuredImage": "/data/workflows/7450/7450.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Document Extraction",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1299,
  "downloads": 129,
  "createdAt": "2025-08-15T18:11:40.313Z",
  "updatedAt": "2026-01-16T08:50:23.027Z",
  "publishedAt": "2025-08-15T18:11:40.313Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7450"
}