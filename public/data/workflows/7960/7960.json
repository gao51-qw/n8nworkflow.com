{
  "workflow": {
    "id": 7960,
    "name": "Automate WHMCS support ticket creation with Gemini AI chatbot",
    "views": 497,
    "recentViews": 0,
    "totalViews": 497,
    "createdAt": "2025-08-27T18:02:11.671Z",
    "description": "## This n8n template implements an AI-Powered Chatbot for Automated WHMCS Support Ticket Creation\n\n## Who's it for\n\nThis template is designed for **web hosting companies, domain registrars, and IT service providers** who want to automate their customer support ticket creation process. It's perfect for businesses looking to streamline support operations by automatically converting customer chat conversations into structured WHMCS support tickets while maintaining professional, empathetic customer interactions.\n\n## How it works / What it does\n\nThis workflow creates an **AI-powered chatbot** that automatically converts customer chat messages into structured support tickets within the WHMCS system. The AI agent automatically:\n\n1. **Receives customer queries** through a webhook endpoint\n2. **Processes natural language requests** using Google Gemini AI\n3. **Extracts key information** from customer conversations:\n   - Customer name and email\n   - Issue description and subject\n   - Appropriate support department\n   - Priority level (Low, Medium, High)\n4. **Fetches valid support departments** from WHMCS using the GetSupportDepartments API\n5. **Creates structured support tickets** via WHMCS OpenTicket API\n6. **Maintains conversation context** with session-based memory\n7. **Provides professional responses** while gathering necessary information\n\nThe system ensures **100% accuracy** by always mapping to valid WHMCS departments and never inventing ticket fields, maintaining data integrity and proper ticket routing.\n\n## How to set up\n\n### 1. Configure Google Gemini API\n- Set up your Google Gemini API credentials in the Google Gemini Chat Model node\n- Ensure you have sufficient API quota for your expected usage\n\n### 2. Configure WHMCS API\n- Update the WHMCS API credentials in both HTTP Request Tool nodes\n- Replace `https://WHMCS_URL.com/includes/api.php` with your actual WHMCS API endpoint\n- Ensure your WHMCS API has the necessary permissions for:\n  - `GetSupportDepartments` action\n  - `OpenTicket` action\n\n### 3. Customize AI Agent Behavior\n- Modify the system message in the AI Agent node to match your company's tone and policies\n- Adjust the agent's response style and ticket creation workflow\n- Customize department mapping and priority assignment logic\n\n### 4. Set up the Webhook\n- The workflow creates a unique webhook endpoint for receiving customer queries\n- Use this endpoint URL in your customer-facing chat interface\n- Ensure proper security measures for webhook access\n\n### 5. Test Department Integration\n- Verify that the `GetSupportDepartments` API call returns your actual support departments\n- Test ticket creation with various customer scenarios\n- Ensure proper error handling for API failures\n\n## Requirements\n\n- **Google Gemini API account** with appropriate credentials\n- **n8n instance** (self-hosted or cloud)\n- **WHMCS installation** with API access enabled\n- **Support department structure** already configured in WHMCS\n- **Customer chat interface** or messaging system\n\n## How to customize the workflow\n\n### Modify AI Agent Behavior\n- Edit the system message in the AI Agent node to change the bot's personality and response style\n- Adjust ticket creation logic and required field validation\n- Customize priority assignment algorithms based on keywords or urgency indicators\n\n### Enhance Ticket Creation\n- Add custom fields to the ticket creation process\n- Implement ticket categorization based on conversation content\n- Add automatic assignment to specific support staff members\n\n### Improve Customer Experience\n- Add ticket confirmation and tracking information\n- Implement follow-up message scheduling\n- Add customer satisfaction surveys after ticket resolution\n\n### Security Enhancements\n- Implement API key rotation and monitoring\n- Add request validation and sanitization\n- Set up usage analytics and abuse prevention\n\n## Key Features\n\n- **Automatic ticket creation** from natural language conversations\n- **Intelligent department mapping** using WHMCS API\n- **Professional customer interaction** with empathetic responses\n- **Session-based memory** for contextual conversations\n- **Structured ticket data** with proper validation\n- **Priority assignment** based on conversation analysis\n- **Scalable webhook architecture** for high-volume usage\n- **Direct WHMCS integration** for seamless ticket management\n\n## Use Cases\n\n- **24/7 automated support ticket creation** for web hosting companies\n- **Customer service automation** with human-like interaction\n- **Support team efficiency** by reducing manual ticket entry\n- **Consistent ticket formatting** across all customer interactions\n- **Improved response times** through immediate ticket creation\n- **Customer self-service** with professional guidance\n\n## Chat Session Management\n\nThe workflow automatically manages chat sessions with the following features:\n\n- **Unique Session IDs** for each customer conversation\n- **Automatic information extraction** from customer messages\n- **Conversation history tracking** with chronological message storage\n- **Session persistence** across multiple interactions\n- **Contextual responses** based on conversation history\n\n## Example Customer Interactions\n\nThe AI agent can handle various customer scenarios:\n\n- **Technical Issues**: \"My website is down\" → Creates ticket in Technical Support department\n- **Billing Questions**: \"I need help with my invoice\" → Creates ticket in Billing department\n- **Domain Services**: \"I want to transfer my domain\" → Creates ticket in Domain Services department\n- **General Support**: \"I have a question about my hosting plan\" → Creates ticket in General Support department\n\n## Ticket Creation Process\n\nThe workflow follows a structured approach:\n\n1. **Information Gathering**: The AI agent identifies missing required information (email, name, etc.)\n2. **Department Selection**: Fetches available departments from WHMCS and maps customer needs appropriately\n3. **Priority Assessment**: Determines ticket priority based on urgency indicators in the conversation\n4. **Ticket Creation**: Generates a well-structured ticket with clear subject and detailed message\n5. **Confirmation**: Provides customer with ticket creation confirmation and next steps\n\nThis template transforms your web hosting business by providing instant, automated support ticket creation while maintaining the personal touch that customers expect from professional service providers. The AI agent becomes an extension of your support team, handling routine inquiries and ensuring no customer request goes unaddressed.\n",
    "workflow": {
      "id": "4xCipKcgJSWkvMU5",
      "meta": {
        "instanceId": "50631c03cbd88440965b74e5a58aada5437cbc43e90372b516e36154908ad374",
        "templateCredsSetupCompleted": true
      },
      "name": "AI-Powered Chatbot for Automated WHMCS Support Ticket Creation",
      "tags": [],
      "nodes": [
        {
          "id": "3aa08f6f-1515-4112-967c-2b5f7f16c929",
          "name": "AI Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            -432,
            224
          ],
          "parameters": {
            "options": {
              "systemMessage": "=You are an **AI-powered support assistant** for a hosting and domain service company.  \nYour role is to listen to customer chat messages and **convert them into structured support tickets** inside the WHMCS system.\n\n---\n\n## Core Responsibilities\n1. Understand the user’s request from the chat conversation.  \n2. Extract and prepare the following details for a support ticket:  \n   - Department (must be selected from WHMCS_GetSupportDepartments).  \n   - Subject (concise, clear summary of the issue).  \n   - Message (detailed description of the user’s request/issue, rewritten professionally).  \n   - Name (from the user’s chat identity, or ask if missing).  \n   - Email (from the user’s chat identity, or ask if missing).  \n   - Priority (Low, Medium, High → based on urgency of the request).  \n3. Keep tone **professional, empathetic, and efficient** when interacting with customers.  \n4. If any critical details are missing (e.g., email, department choice), politely ask the user to provide them.  \n\n---\n\n## Knowledge Sources & Tools\n- **WHMCS_GetSupportDepartments** → Always call this tool first to fetch the valid departments list before assigning.  \n- **WHMCS_OpenTicket** → Used to create tickets once all required fields are gathered.  \n\n---\n\n## Strict Guidelines\n- **Do not invent or guess ticket fields.**  \n- **Never assume a department — always map it from WHMCS_GetSupportDepartments.**  \n- **Ensure the subject is short and descriptive.**  \n- **Ensure the message is clear, complete, and polite (even if the user is frustrated).**  \n- If priority is not stated, default to **Medium**.  \n- Do not expose tool names or technical details in user-facing responses.  \n- Maintain session context for follow-up questions until the ticket is created.  \n\n---\n\n## Example Interactions\n\n### 1. Missing Information\n**User**: \"My website is down and I can’t access my email.\"  \n**AI**: \"I can create a support ticket for you. Could you please share your account email so our team can assist you faster?\"\n\n---\n\n### 2. Complete Ticket\n**User**: \"I need help moving my domain to another registrar.\"  \n**AI**: \"Got it — I’ll open a ticket for our Support team.  \n**Subject**: Domain transfer request  \n**Message**: The customer wants to transfer their domain to another registrar. Please provide transfer instructions.  \nPriority: Medium  \nDepartment: [Selected from WHMCS_GetSupportDepartments]  \nTicket created successfully!\"\n\n---\n\n## Reminder\n- Always remain helpful, polite, and professional.  \n- Your goal is to **transform chat into a well-structured support ticket**.  \n- Today’s date: **{{ $now }}**  \n"
            }
          },
          "typeVersion": 2.1
        },
        {
          "id": "6c870916-a47b-4d2d-8ee3-47ec0e44ac40",
          "name": "Google Gemini Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "position": [
            -576,
            432
          ],
          "parameters": {
            "options": {}
          },
          "credentials": {
            "googlePalmApi": {
              "id": "credential-id",
              "name": "googlePalmApi Credential"
            }
          },
          "typeVersion": 1
        },
        {
          "id": "21ebca8d-1432-413f-a793-c92fc3b4d166",
          "name": "Simple Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "position": [
            -416,
            448
          ],
          "parameters": {
            "contextWindowLength": 15
          },
          "typeVersion": 1.3
        },
        {
          "id": "7c841b5b-85db-490d-b078-d0ebbda7c677",
          "name": "When chat message received",
          "type": "@n8n/n8n-nodes-langchain.chatTrigger",
          "position": [
            -768,
            224
          ],
          "webhookId": "ee828ae8-61b7-4e79-9316-8b3a62a96d88",
          "parameters": {
            "options": {}
          },
          "typeVersion": 1.3
        },
        {
          "id": "22aef3f3-8382-4d96-866a-7952020c8192",
          "name": "WHMCS_OpenTicket",
          "type": "n8n-nodes-base.httpRequestTool",
          "position": [
            -240,
            432
          ],
          "parameters": {
            "url": "https://WHMCS_URL.com/includes/api.php",
            "method": "POST",
            "options": {},
            "sendBody": true,
            "contentType": "form-urlencoded",
            "sendHeaders": true,
            "authentication": "genericCredentialType",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "action",
                  "value": "OpenTicket"
                },
                {
                  "name": "deptid",
                  "value": "=2"
                },
                {
                  "name": "subject",
                  "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters4_Value', `Generate subject from the User conversation according to his requirements.`, 'string') }}"
                },
                {
                  "name": "message",
                  "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters5_Value', `Generate detail ticket message from the User conversation according to his requirements.`, 'string') }}"
                },
                {
                  "name": "name",
                  "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters6_Value', `Get the user from the Chat`, 'string') }}"
                },
                {
                  "name": "email",
                  "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters7_Value', `Get email from the chat`, 'string') }}"
                },
                {
                  "name": "priority",
                  "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters8_Value', `The priority of the ticket (‘Low’, ‘Medium’, ‘High’)\t`, 'string') }}"
                }
              ]
            },
            "genericAuthType": "httpCustomAuth",
            "toolDescription": "Makes an HTTP request to check the Domain Avaialbility",
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ]
            }
          },
          "credentials": {
            "httpCustomAuth": {
              "id": "credential-id",
              "name": "httpCustomAuth Credential"
            }
          },
          "typeVersion": 4.2
        },
        {
          "id": "0e34b87c-9c06-4b75-96bb-272a98bd0a4f",
          "name": "WHMCS_GetSupportDepartments",
          "type": "n8n-nodes-base.httpRequestTool",
          "position": [
            -48,
            432
          ],
          "parameters": {
            "url": "https://WHMCS_URL.com/includes/api.php",
            "method": "POST",
            "options": {},
            "sendBody": true,
            "contentType": "form-urlencoded",
            "sendHeaders": true,
            "authentication": "genericCredentialType",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "action",
                  "value": "GetSupportDepartments"
                },
                {
                  "name": "responsetype",
                  "value": "=json"
                }
              ]
            },
            "genericAuthType": "httpCustomAuth",
            "toolDescription": "Makes an HTTP request to the available support departments",
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ]
            }
          },
          "credentials": {
            "httpCustomAuth": {
              "id": "credential-id",
              "name": "httpCustomAuth Credential"
            }
          },
          "typeVersion": 4.2
        }
      ],
      "active": false,
      "pinData": {},
      "settings": {
        "timezone": "Asia/Karachi",
        "callerPolicy": "workflowsFromSameOwner",
        "executionOrder": "v1"
      },
      "versionId": "172752c3-6c9e-46dc-9c16-6a529a8abea4",
      "connections": {
        "AI Agent": {
          "main": [
            []
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "AI Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "WHMCS_OpenTicket": {
          "ai_tool": [
            [
              {
                "node": "AI Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "When chat message received": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "WHMCS_GetSupportDepartments": {
          "ai_tool": [
            [
              {
                "node": "AI Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        }
      }
    },
    "lastUpdatedBy": 29,
    "workflowInfo": {
      "nodeCount": 6,
      "nodeTypes": {
        "@n8n/n8n-nodes-langchain.agent": {
          "count": 1
        },
        "n8n-nodes-base.httpRequestTool": {
          "count": 2
        },
        "@n8n/n8n-nodes-langchain.chatTrigger": {
          "count": 1
        },
        "@n8n/n8n-nodes-langchain.lmChatGoogleGemini": {
          "count": 1
        },
        "@n8n/n8n-nodes-langchain.memoryBufferWindow": {
          "count": 1
        }
      }
    },
    "status": "published",
    "user": {
      "name": "Omer Fayyaz",
      "username": "omerfayyaz",
      "bio": "n8n Expert with deep experience in designing and implementing automation workflows that optimize business processes, reduce manual effort, and improve scalability. Skilled in integrating n8n with diverse platforms, APIs, and enterprise systems to deliver end-to-end automation solutions. With 13+ years of background in web development (PHP & JavaScript), I bring strong technical expertise to create custom, reliable, and efficient workflows.",
      "verified": true,
      "links": [
        "https://omerfayyaz.com/"
      ],
      "avatar": "https://gravatar.com/avatar/5ba82ebcfff353e2cd7732613829dc3df56cbb5d73264d57f4ee38a664a96af1?r=pg&d=retro&size=200"
    },
    "nodes": [
      {
        "id": 1119,
        "icon": "fa:robot",
        "name": "@n8n/n8n-nodes-langchain.agent",
        "codex": {
          "data": {
            "alias": [
              "LangChain",
              "Chat",
              "Conversational",
              "Plan and Execute",
              "ReAct",
              "Tools"
            ],
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Agents",
                "Root Nodes"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "AI Agent",
          "color": "#404040"
        },
        "iconData": {
          "icon": "robot",
          "type": "icon"
        },
        "displayName": "AI Agent",
        "typeVersion": 3,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1163,
        "icon": "fa:database",
        "name": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "codex": {
          "data": {
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.memorybufferwindow/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Memory"
              ],
              "Memory": [
                "For beginners"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Simple Memory"
        },
        "iconData": {
          "icon": "database",
          "type": "icon"
        },
        "displayName": "Simple Memory",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1247,
        "icon": "fa:comments",
        "name": "@n8n/n8n-nodes-langchain.chatTrigger",
        "codex": {
          "data": {
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.chattrigger/"
                }
              ]
            },
            "categories": [
              "Core Nodes",
              "Langchain"
            ]
          }
        },
        "group": "[\"trigger\"]",
        "defaults": {
          "name": "When chat message received"
        },
        "iconData": {
          "icon": "comments",
          "type": "icon"
        },
        "displayName": "Chat Trigger",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 9,
            "name": "Core Nodes"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      },
      {
        "id": 1262,
        "icon": "file:google.svg",
        "name": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "codex": {
          "data": {
            "resources": {
              "primaryDocumentation": [
                {
                  "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatgooglegemini/"
                }
              ]
            },
            "categories": [
              "AI",
              "Langchain"
            ],
            "subcategories": {
              "AI": [
                "Language Models",
                "Root Nodes"
              ],
              "Language Models": [
                "Chat Models (Recommended)"
              ]
            }
          }
        },
        "group": "[\"transform\"]",
        "defaults": {
          "name": "Google Gemini Chat Model"
        },
        "iconData": {
          "type": "file",
          "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgNDggNDgiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJNNDQuNSAyMEgyNHY4LjVoMTEuOEMzNC43IDMzLjkgMzAuMSAzNyAyNCAzN2MtNy4yIDAtMTMtNS44LTEzLTEzczUuOC0xMyAxMy0xM2MzLjEgMCA1LjkgMS4xIDguMSAyLjlsNi40LTYuNEMzNC42IDQuMSAyOS42IDIgMjQgMiAxMS44IDIgMiAxMS44IDIgMjRzOS44IDIyIDIyIDIyYzExIDAgMjEtOCAyMS0yMiAwLTEuMy0uMi0yLjctLjUtNCIvPjwvZGVmcz48Y2xpcFBhdGggaWQ9ImIiPjx1c2UgeGxpbms6aHJlZj0iI2EiIG92ZXJmbG93PSJ2aXNpYmxlIi8+PC9jbGlwUGF0aD48cGF0aCBmaWxsPSIjRkJCQzA1IiBkPSJNMCAzN1YxMWwxNyAxM3oiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im0wIDExIDE3IDEzIDctNi4xTDQ4IDE0VjBIMHoiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiMzNEE4NTMiIGQ9Im0wIDM3IDMwLTIzIDcuOSAxTDQ4IDB2NDhIMHoiIGNsaXAtcGF0aD0idXJsKCNiKSIvPjxwYXRoIGZpbGw9IiM0Mjg1RjQiIGQ9Ik00OCA0OCAxNyAyNGwtNC0zIDM1LTEweiIgY2xpcC1wYXRoPSJ1cmwoI2IpIi8+PC9zdmc+"
        },
        "displayName": "Google Gemini Chat Model",
        "typeVersion": 1,
        "nodeCategories": [
          {
            "id": 25,
            "name": "AI"
          },
          {
            "id": 26,
            "name": "Langchain"
          }
        ]
      }
    ],
    "categories": [
      {
        "id": 47,
        "name": "AI Chatbot"
      },
      {
        "id": 51,
        "name": "Multimodal AI"
      }
    ],
    "image": []
  }
}