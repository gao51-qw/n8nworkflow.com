{
  "id": 3903,
  "slug": "3903",
  "title": "Conversational PostgreSQL agent with visuals, multi-KPI, and data editing (MCP)",
  "description": "![ChatGPT Image 6 mai 2025, 17_58_38.png](fileId:1286)\n\nAsk your PostgreSQL database complex questions and receive clear summaries, charts, and even update or insert data â€” all through one smart agent powered by n8nâ€™s Model Context Protocol (MCP).\n\nSupports:\n- Multi-KPI insights in one prompt  \n- Auto-generated QuickChart bar/pie charts  \n- Natural-language inserts and updates  \n- Markdown-friendly output for dashboards\n\n\n---\n\n## ğŸš€ Why This Version Stands Out\n\nThis version goes beyond reporting:\n- ğŸ“ˆ Auto-generates charts (QuickChart)\n- ğŸ§® Answers multiple KPIs in one message\n- âœï¸ Add and update records securely\n- ğŸ§  Uses up to 30 planned steps for smart reasoning\n\nğŸ’° Estimated cost per run: ~$0.02\n\n---\n\n## ğŸ’¬ Example Output\n\n![withvisual_sql.png](fileId:1287)\n---\n\n## ğŸ§° Key Components\n\n- MCP Server Trigger â†’ Receives natural queries  \n- Claude 3.5 Haiku â†’ Plans, reasons, splits tasks  \n- DeepSeek â†’ SQL and QuickChart generation  \n- checkdatabase subflow â†’ Validates SQL  \n- Plot Tool â†’ Converts data to QuickChart URLs  \n- Insert/Update nodes â†’ Edits PostgreSQL records  \n- Markdown Formatter â†’ Combines output into readable message\n\n---\n\n## ğŸ¤– Model Configuration Notes\n\nThis workflow uses two models:\n\n1. **Claude 3.5 Haiku (Anthropic)**  \nUsed as the MCP agent for reasoning, planning, and tool calling. Claude is the native model for MCP and delivers reliable results in fewer steps.\n\n2. **DeepSeek**  \nUsed in:\n- `checkdatabase` for SQL generation  \n- `Plot Tool` for QuickChart JSON generation\n\nğŸ§  All models are modular â€” you can plug in OpenAI, Gemini, or Mistral if desired.\n\n---\n\n## ğŸ” Security by Design\n\n- No raw SQL from user input  \n- Fully parameterized queries  \n- Structured tool calling with validation  \n- Safe output format (text + chart links)\n\n---\n\n## ğŸ§ª Try This Prompt\n\n&gt; â€œShow me top 5 products by revenue, revenue per month chart, and best customers.â€\n\nExpected output:\n- 3 KPIs\n- Multiple SQL queries\n- 2â€“3 QuickChart links\n- Markdown summary for dashboard/Slack\n\n---\n\n## ğŸ›  How to Use\n\n1. Import:\n   - `Build_your_own_PostgreSQL_MCP_server__visuals_capable_.json`\n   - `checkdatabase.json`\n   - `Plot_tool.json`\n\n2. Create your **PostgreSQL credential** under â€œCredentialsâ€ in n8n:\n   - Must match the name used in the workflow (e.g., `Postgres account 3`)\n\n3. Assign AI models:\n   - Claude 3.5 Haiku â†’ MCP agent (`Claude 3.5 MCP Agent`)\n   - DeepSeek â†’ LLM nodes inside `checkdatabase` and `Plot Tool`\n\n4. Trigger the workflow using the URL from the **MCP Server Trigger** node  \n   (e.g., in a chatbot, HTTP request, or Webhook UI)\n\n---\n\n## ğŸ“¦ End-User Setup Guide\n\nIf you're using this template for the first time, follow these exact steps:\n\n1. Go to your n8n dashboard and import all three workflows (main + subflows)\n2. Create a PostgreSQL credential using your host, database, user, and password\n3. Go to the Claude and DeepSeek nodes, and connect them to your account(s)\n4. Use the Webhook URL in the `MCP Server Trigger` to connect your chatbot or frontend\n5. Send a prompt like:  \n   â€œShow me revenue per month, top 5 products, and a chart of best customers.â€\n\nOptional:  \n- You can increase the MCP Agentâ€™s `MaxIterations` to go deeper (default is 30)\n- You can use Switch nodes to limit access to certain tables or actions\n- Insert/Update nodes are already included and can be safely enabled\n\nâœ… Once this is done, your AI assistant will:\n- Read from your database  \n- Visualize data via QuickChart  \n- Insert or update rows  \n- Respond in clear, markdown-formatted summaries\n\n---\n\n## ğŸ”— More Templates by the Same Creator\n\n1. [PostgreSQL Conversational Agent with Claude & DeepSeek (Multi-KPI, Secure)](https://n8n.io/workflows/3892-postgresql-conversational-agent-with-claude-and-deepseek-multi-kpi-secure/)\n\n2. [Conversing with Data: Transforming Text into SQL Queries and Visual Curves](https://n8n.io/workflows/3497-conversing-with-data-transforming-text-into-sql-queries-and-visual-curves/)\n\n3. [Customer Feedback Analysis with AI, QuickChart & HTML Report Generator](https://n8n.io/workflows/3642-customer-feedback-analysis-with-ai-quickchart-and-html-report-generator/)\n",
  "featuredImage": "/data/workflows/3903/3903.webp",
  "author": {
    "id": 101,
    "slug": "hippolyte-hu",
    "name": "hippolyte-hu",
    "avatar": ""
  },
  "categories": [
    "Engineering",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 2176,
  "downloads": 217,
  "createdAt": "2025-05-06T15:59:21.804Z",
  "updatedAt": "2026-01-16T08:32:04.851Z",
  "publishedAt": "2025-05-06T15:59:21.804Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3903"
}