{
  "id": 8069,
  "slug": "8069",
  "title": "Aggregate marketing spend data with custom pivots & VLOOKUPs in Google Sheets",
  "description": "This workflow transforms raw marketing data from Google Sheets into a **pivot-like summary table**. It merges lookup data, groups spend by name, and appends the results into a clean reporting tab â€” all automatically, without needing to manually build pivot tables in Sheets.\n\n---\n\n## ğŸ§‘â€ğŸ’» Whoâ€™s it for\n- Marketing analysts who track **channel spend** across campaigns  \n- Small businesses that rely on **Google Sheets** for reporting  \n- Teams that need **automated daily rollups** without rebuilding pivot tables manually  \n\n---\n\n## âš™ï¸ How it works\n1. **Get Marketing Data (Google Sheets)** â€“ Pulls raw spend data.  \n2. **Vlookup Data (Google Sheets)** â€“ Brings in reference/lookup fields (e.g., channel labels).  \n3. **Merge Tables** â€“ Joins marketing data and lookup data on the `Channel` column.  \n4. **Summarize** â€“ Groups data by `Name` and sums up **Spend ($)**.  \n5. **Clear Sheet** â€“ Wipes the reporting tab to avoid duplicates.  \n6. **Append to Pivot Sheet** â€“ Writes the aggregated results into the \"render pivot\" sheet.  \n\nThe result: a pivot-style summary table inside Google Sheets, automatically refreshed by n8n.\n\n---\n\n## ğŸ”‘ Setup Instructions\n\n### 1) Connect Google Sheets (OAuth2)\n1. In **n8n â†’ Credentials â†’ New â†’ Google Sheets (OAuth2)**  \n2. Sign in with your Google account and grant access  \n3. In each Google Sheets node, select your **Spreadsheet** and the appropriate **Worksheet**:  \n   - **data** (raw spend)  \n   - **Lookup** (channel reference table)  \n   - **render pivot** (output tab)  \n\n### 2) Configure Summarize Node\n- Group by: `Name`  \n- Summarize: `Spend ($)` â†’ `sum`  \n\n### 3) Test the Workflow\n1. Execute the workflow manually  \n2. Check your \"render pivot\" tab â€” it should display aggregated spend by Name  \n\n---\n\n## ğŸ› ï¸ How to customize\n- Change grouping fields (e.g., by **Channel**, **Campaign**, or **Region**)  \n- Add more aggregations (e.g., **average CPC**, **max impressions**)  \n- Use the **Merge node** to join extra data sources before summarizing  \n- Schedule execution to run **daily** for fresh rollups  \n\n---\n\n## ğŸ“‹ Requirements\n- n8n (Cloud or self-hosted)  \n- Google Sheets account with structured data in `data` and `Lookup` tabs  \n\n---\n\n## ğŸ“¬ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your pivot)?  \n\n- ğŸ“§ **rbreen@ynteractive.com**  \n- ğŸ”— **[Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)**  \n- ğŸŒ **[ynteractive.com](https://ynteractive.com)**  \n",
  "featuredImage": "/data/workflows/8069/8069.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Document Extraction"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 173,
  "downloads": 17,
  "createdAt": "2025-08-30T17:53:06.822Z",
  "updatedAt": "2026-01-16T08:53:59.090Z",
  "publishedAt": "2025-08-30T17:53:06.822Z",
  "nodes": 10,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8069"
}