{
  "id": 6330,
  "slug": "6330",
  "title": "Extract local business contacts with Google Sheets, SerpAPI, Apify & GPT-4o",
  "description": "### Extract Local Business Contacts with Google Sheets, SerpAPIÂ &Â GPTâ€‘4o\n\n**Status:** Ready for Useâ€¯âœ…  \n**Disclaimer:** This workflow relies on **community nodes** that are not part of n8nâ€™s core package.  \nInstall the following from **n8nâ€¯â†’â€¯CommunityÂ Nodes** before running:\n\n- **n8n-nodes-langchain**  \n- **n8n-nodes-openai** (StructuredÂ OutputÂ Parser)  \n- **n8n-nodes-apify**\n\n---\n\n### ğŸ“Â Description\nThis **n8n workflow** automates discovery of localâ€‘business contact details by search term and location, then enriches the results with publicly listed email addresses using **GPTâ€‘4oÂ AI**.\n\n---\n\n### ğŸ”‘Â Key Features\n\n#### ğŸ”—Â GoogleÂ SheetsÂ Integration\n- Reads search terms and locations from a Google Sheet.  \n- Processes only rows that are **not** markedÂ `Complete`, preventing duplicates.\n\n#### ğŸ—ºï¸Â GoogleÂ Maps Search viaâ€¯SerpAPI\n- Queries GoogleÂ Maps through **SerpAPI** for every searchâ€‘termâ€‘andâ€‘location pair.  \n- Retrieves the following fields: **business name, website, street address, and phone number**.\n\n#### ğŸ§ Â WebsiteÂ ScrapingÂ &Â EmailÂ Extraction\n1. Scrapes the business homepage content with **Apifyâ€™s Fast Website Content Crawler**.  \n2. Sends the scraped HTML to a **GPTâ€‘4oÂ AIÂ Agent**.  \n3. Extracts any publicly listed **email address**.  \n4. Returns a clean, structured JSON object for downstream use.\n\n#### ğŸ’¾Â DataÂ StorageÂ &Â Tracking\n- Writes every result to a **Results** tab in the same Google Sheet.  \n- Marks the corresponding row in the **Searches** tab as `Complete` once finished.\n\n#### ğŸ§±Â ExtensibleÂ Design\nThe workflow uses modular subâ€‘workflows and AI agents.  \nYou can easily extend it to add:\n\n- Phoneâ€‘number verification with Twilio  \n- Socialâ€‘media enrichment with Clearbit  \n- Exports to **HubSpot**, **Salesforce**, **Airtable**, **PostgreSQL**, or CSV files\n\n---\n\n### ğŸ“„Â GoogleÂ SheetÂ Setup\nCreate a **Searches** tab with these exact columns (one header row):\n\nSearch | Area | Area Name | Complete\n\nCreate a results tab with these columns\n\ntitle | website | address | phone | Search | Search Name | Area | email (Manual Entry)\n\n\n\n---\n\n### âš™ï¸Â Prerequisites\n1. **GoogleÂ CloudÂ Project** with **Google Sheets API** and **Google Drive API** enabled  \n2. **SerpAPI** account (free trial or paid) â€“ obtain an API key  \n3. **Apify** account (free trial or paid) with the **FastÂ WebsiteÂ ContentÂ Crawler** actor installed  \n4. **OpenAI** account with an API key that can access GPTâ€‘4o models\n\n---\n\n### ğŸš€Â SetupÂ Instructions\n\n1. **Copy the GoogleÂ Sheet**  \n   - Make a personal copy of the template sheet.  \n   - Ensure the tab names are **Searches** and **Results**.  \n   - https://docs.google.com/spreadsheets/d/1QgcVMlXRlM_5ZFFUHr6bVK-93Tzia9XseTX03ZYnowI/edit?usp=sharing\n\n2. **Configure GoogleÂ SheetsÂ nodes in n8n**  \n   - Open the workflow.  \n   - Update the nodes **ExtractÂ SearchÂ Terms** and **SaveÂ EmailsÂ toÂ Sheet** to point at your copied sheet.  \n   - Authenticate using Google OAuth2 credentials that have access to the sheet.\n\n3. **Add SerpAPI credentials**  \n   - Sign in at &lt;https://serpapi.com&gt;.  \n   - Copy your API key.  \n   - In the **SearchÂ GoogleÂ Maps** node, create a new credential and paste the key.\n\n4. **Set upÂ Apify**  \n   - Sign up at &lt;https://apify.com&gt;.  \n   - Add the **FastÂ WebsiteÂ ContentÂ Crawler** actor to your account.  \n   - In the **ScrapeÂ WebÂ Page** HTTP node, append `?token=YOUR_API_KEY` to the actor URL.\n\n5. **Add your OpenAIÂ API key**  \n   - Go to &lt;https://platform.openai.com&gt;.  \n   - Generate an API key.  \n   - Add it to the **AIÂ Agent** and **OpenAIÂ ChatÂ Model** node credentials.\n\n---\n\n### âœ…Â RunningÂ theÂ Workflow\n1. Click **Executeâ€¯Workflow** in n8n.  \n2. For each unprocessed row in the **Searches** tab, the automation will:  \n   1. Retrieve business information from GoogleÂ Maps viaâ€¯SerpAPI.  \n   2. Scrape the business website using Apify.  \n   3. Use GPTâ€‘4o to extract a public email address.  \n   4. Write all collected data to the **Results** tab.  \n   5. Mark the original row as `Complete`.\n\n---\n\n### ğŸ§©Â ExampleÂ UseÂ Cases\n- Build highly targeted lead lists for **sales** and **marketing** outreach.  \n- Compile local business directories for regional websites or apps.  \n- Automate contactâ€‘information collection for **leadâ€‘generation** campaigns and reduce manual data entry.\n\n## ğŸ¤ Connect with Me\n\n## Description  \nIâ€™m Robert Breen, founder of Ynteractive â€” a consulting firm that helps businesses automate operations using **n8n**, **AI agents**, and custom workflows. Iâ€™ve helped clients build everything from intelligent chatbots to complex sales automations, and Iâ€™m always excited to collaborate or support new projects.\n\nIf you found this workflow helpful or want to talk through an idea, Iâ€™d love to hear from you.\n\n## Links  \nğŸŒ Website: [https://www.ynteractive.com](https://www.ynteractive.com)  \nğŸ“º YouTube: [@ynteractivetraining](https://www.youtube.com/@ynteractivetraining)  \nğŸ’¼ LinkedIn: [https://www.linkedin.com/in/robert-breen](https://www.linkedin.com/in/robert-breen)  \nğŸ“¬ Email: rbreen@ynteractive.com",
  "featuredImage": "/data/workflows/6330/6330.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1440,
  "downloads": 144,
  "createdAt": "2025-07-23T17:25:59.562Z",
  "updatedAt": "2026-01-16T08:44:28.484Z",
  "publishedAt": "2025-07-23T17:25:59.562Z",
  "nodes": 18,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6330"
}