{
  "id": 6264,
  "slug": "6264",
  "title": "Auto expense tracker from LINE messages with GPT-4 and Google Sheets",
  "description": "![截圖 20250723 14.35.00.png](fileId:1839)\n# Overview\nDo you often forget to record expenses?\n\n你是不是會常常忘記紀錄花費?\n\nLet Spending Tracker Bot help you!\n\n讓 Spending Tracker Bot 來幫你!\n\nThis AI image/text Spending Tracker LINE Bot Workflow allows you to quickly create a customized spending tracker robot without writing a line of code. At any time, you can speak or send a photo, and the AI will parse it and automatically log the expense to your cloud ledger.\n\n這套 AI 圖片文字記帳 LINE Bot Workflow ，讓你不用寫一行程式碼，就能快速打造一個量身訂製的記帳機器人。無論何時，只需要口述或發送一張照片，AI 就會幫你整理好自動計入雲端帳本\n\n<br />\n\n# Preparation\n① Enable the Google Sheets API in GCP and complete the OAuth setup\n② Create the Google Sheet and populate the field names (Feel free to modify based on your own needs)\n③ Configure the Webhook URL in the LINE Developers Console\n④ OpenAI API Key\n\n① 在 GCP 啟用 Google Sheets API，並完成 OAuth \n② 建立並填好 Google Sheet 欄名 (按照自己的需求做更動）\n③ 於 LINE Developers 控制台設定 Webhook URL\n④ OpenAI API Key\n\n<br />\n\n# Node Configurations\n\n## Webhook\n![1753178215306.jpg](fileId:1829)\n![1753178274098.jpg](fileId:1831)\nPurpose: The URL is used to receive incoming requests from LINE.\nConfiguration: Paste this URL into the Webhook URL field in your LINE Developers Console.\n\n用途: 要接收 Line 的 URL\n設定: 將 URL 放到 Line Webhook URL\n\n## Switch based on Expense Type & Set/Https\n![截圖 20250723 14.35.05.png](fileId:1837)\nPurpose: To distinguish whether the incoming message is text or an image.\nConfiguration: Use a Switch node to route the flow accordingly.\n\n用途: 區分 text 或 image\n設定: switch 分流\n\n## AI Agent\n![截圖 20250722 17.55.27.png](fileId:1826)\nPurpose: To extract and organize the required fields.\nConfiguration: Chat Model & Structured Output Parser.\n\n用途: 整理出需要的欄位\n設定: Chat Model & Structured Output Parser\n\n## Create a deduplication field\nPurpose: To prevent duplicate entries by creating a unique \"for_deduplication\" field.\nConfiguration: Join multiple field names using hyphens (-) as separators.\n\n用途: 確保不會重複寫入，先創建一個\"去重使用\"欄位\n設定: 用 - 連接多個欄位\n\n## Aggregrate & Merge_all\n![截圖 20250722 17.53.55.png](fileId:1827)\nPurpose: To prevent duplicate entries in the data table.\nConfiguration: Read the Google sheet, extract the existing \"for_deduplication\" column into a dedupeList, and compare it against the newly generated \"for_deduplication\" value from the previous step.\n\n用途: 防止重複寫入資料表\n設定：讀取雲端表，將原本的\"去重使用欄位\"整理成dedupeList，與前一步整理好的\"去重使用\"欄位做比對\n\n## Response Switch\n![截圖 20250723 14.33.55.png](fileId:1838)\nPurpose: To route data and send appropriate replies based on the content.\nConfiguration: Use the replyToken to respond after branching logic. Depending on the result, either write to the data table or return a message:\n1. ✅ Expense recorded successfully: &lt;for_deduplication&gt;\n2. Irrelevant details or images will not be logged.\n3. ⚠️ This entry has already been logged and will not be duplicated.\n\n用途: 資料分流，回應訊息\n設定：使用 replyToken ，資料分流後，寫入資料表或回應訊息\n1. ✅ 記帳成功 : &lt;去重使用欄位&gt;\n2. 不相關明細或圖片，不會計入\n3. ⚠️ 此筆資料已記錄過，不會重複記帳 \n![截圖 20250723 14.29.32.png](fileId:1835)\n![截圖 20250723 14.29.41.png](fileId:1834)\n![截圖 20250723 14.29.08.png](fileId:1836)\n\n<br />\n\n## Step by step teaching notes\n[【Auto Expense Tracker from LINE Messages with GPT-4 and Google Sheets】](https://hackmd.io/@workcata/r1g-6TpUxe)\n\n[【AI 圖片文字記帳 Line Bot，自動記帳寫入 Google Sheet】](https://hackmd.io/@workcata/Hkz3O7PLxl)",
  "featuredImage": "/data/workflows/6264/6264.webp",
  "author": {
    "id": 101,
    "slug": "catalinakuowork",
    "name": "Catalina Kuo",
    "avatar": ""
  },
  "categories": [
    "Personal Productivity",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 482,
  "downloads": 48,
  "createdAt": "2025-07-22T09:48:44.224Z",
  "updatedAt": "2026-01-16T08:44:08.046Z",
  "publishedAt": "2025-07-22T09:48:44.224Z",
  "nodes": 25,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6264"
}