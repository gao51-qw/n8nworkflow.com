{
  "id": 11977,
  "slug": "11977",
  "title": "Automate customer retention with AI risk prediction, Stripe coupons & personalized Gmail",
  "description": "# Predict churn risk from customer data and send retention emails via OpenAI\n\n\n## üë• Who‚Äôs it for\nThis workflow is designed for **Customer Success Managers**, **Growth Teams**, and **SaaS Business Owners** who want to proactively reduce churn using AI. It automates the analysis of customer health and the delivery of personalized retention offers without manual intervention.\n\n\n## üöÄ What it does\nThis template acts as an intelligent retention system that connects your data, AI, and communication channels.\n1. **Aggregates Data:** Pulls customer profiles from your **CRM**, support ticket history via API, and product usage logs from **PostgreSQL**.\n2. **Predicts Risk:** Uses **OpenAI** to analyze the combined data and calculate a \"Churn Risk Score\" for each customer.\n3. **Automates Action:** For customers identified as high-risk (score &gt; 0.7):\n    - Generates a unique, dynamic discount coupon via **Stripe**.\n    - Drafts a highly personalized retention email using OpenAI.\n    - Sends the email via **Gmail**.\n4. **Tracks Effectiveness:** Logs all actions to **Google Sheets**. It also checks back (via **SendGrid** and CRM data) to track email opens and verify if the customer was retained after 30 days.\n\n\n## ‚öôÔ∏è How to set up\n1. **Prepare Google Sheet:** Create a sheet with columns for `customer_id`, `risk_score`, `offer_type`, `email_status`, and `retention_result`.\n2. **Configure Credentials:** Set up your credentials for OpenAI, Stripe, Gmail, Google Sheets, SendGrid, and PostgreSQL.\n3. **API Endpoints:** Update the **HTTP Request** nodes to point to your specific CRM and Support tool APIs (replace the placeholder URLs).\n4. **Customize Logic:**\n    - In the **Postgres node**, adjust the SQL query to match your product's event table.\n    - In the **Code node** (Offer Decision), define your rules for discounts (e.g., \"Give 20% off if MRR &gt; $10k\").\n5. **Activate:** The workflow is set to run daily at 3:00 AM. Toggle the **Schedule Trigger** to `Active` when ready.\n\n\n## üì¶ Requirements\n- **n8n** (v1.0 or later)\n- **OpenAI** API Key\n- **Google Workspace** (Gmail, Sheets)\n- **Stripe** Account (for coupon generation)\n- **SendGrid** Account (for email tracking)\n- **PostgreSQL** (or similar database)\n- Access to CRM and Support Tool APIs\n\n\n## üé® How to customize the workflow\n- **Adjust the AI Prompt:** Edit the **OpenAI node** system message to match your brand's tone of voice.\n- **Change the Threshold:** Modify the **If node** to target customers with a risk score higher or lower than 0.7.\n- **Internal Alerts:** Instead of emailing the customer directly, replace the **Gmail node** with a **Slack node** to notify your CSM team to reach out manually.\n- **Swap Database:** If you use MySQL or Snowflake, simply replace the PostgreSQL node with the corresponding n8n node.",
  "featuredImage": "/data/workflows/11977/11977.webp",
  "author": {
    "id": 101,
    "slug": "hayatofujita",
    "name": "HayatoFujita/Ëó§Áî∞Èöº‰∫∫",
    "avatar": ""
  },
  "categories": [
    "Lead Nurturing",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 35,
  "downloads": 3,
  "createdAt": "2025-12-20T05:29:01.939Z",
  "updatedAt": "2026-01-16T09:10:52.003Z",
  "publishedAt": "2025-12-20T05:29:01.939Z",
  "nodes": 27,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11977"
}