{
  "id": 6253,
  "slug": "6253",
  "title": "OAuth token management system with Airtable storage",
  "description": "*This workflow contains community nodes that are only compatible with the self-hosted version of n8n.*\n\n## OAuth Token Generator and Validator\n\nThis **n8n template** helps you generate, validate, and store tokens for your customers securely using:\n\n- **n8n** as your backend automation engine  \n- **Airtable** as your lightweight client and token store\n\n---\n\n### ðŸš€ What It Does\n\n- Accepts `client_id` and `client_secret` via **POST webhook**.\n- Validates client credentials against Airtable.\n- Generates a **long token** on success.\n- Stores the generated token in Airtable with metadata.\n- Responds with a JSON containing the token, expiry, and type.\n- Returns clear error messages if validation fails.\n\n---\n\n### How It Works\n\n1. **Webhook node** receives `client_id` and `client_secret`.\n2. **Validator (Code node)** checks:\n   - Body contains only `client_id` and `client_secret`.\n   - Rejects missing or extra fields.\n3. **Airtable search**:\n   - Looks up the `client_id`.\n   - Rejects if not found.\n4. **Secret validation (If node)**:\n   - Compares provided `client_secret` with stored value.\n   - Rejects if incorrect.\n5. **Token generation (Code node)**:\n   - Generates a 128-character secure token.\n6. **Airtable create**:\n   - Stores token, client ID, creation date, and type.\n7. **Webhook response**:\n   - Returns JSON `{ access_token, expires_in, token_type }` on success.\n   - Returns appropriate JSON error messages on failure.\n\n---\n\n### Related Workflow\n\nYou can also use it with the published **Bearer Token Validation** workflow:\n\nðŸ‘‰ [Validate API Requests with Bearer Token Authentication and Airtable](https://n8n.io/workflows/6184-validate-api-requests-with-bearer-token-authentication-and-airtable)\n\nto securely validate tokens you generate with this workflow across your protected endpoints.\n\n---\n\n### Why Use This\n\n- Provides **OAuth-like flows** without a complex backend.\n- Uses **n8n + Airtable** for client management and token storage.\n- Clean, modular, and ready for your SaaS or internal API automations.\n- Extendable for token expiry, refresh, and rotation handling.\n\n---\n\nEnjoy building secure token-based APIs using **n8n + Airtable**! ðŸš€\n\n### Built by:\n[Nazmy](https://n8n.io/creators/islamnazmi/)\n",
  "featuredImage": "/data/workflows/6253/6253.webp",
  "author": {
    "id": 101,
    "slug": "islamnazmi",
    "name": "Nazmy",
    "avatar": ""
  },
  "categories": [
    "Engineering"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 100,
  "downloads": 10,
  "createdAt": "2025-07-22T03:18:55.006Z",
  "updatedAt": "2026-01-16T08:44:03.681Z",
  "publishedAt": "2025-07-22T03:18:55.006Z",
  "nodes": 20,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/6253"
}