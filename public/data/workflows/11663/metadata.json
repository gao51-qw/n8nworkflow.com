{
  "id": 11663,
  "slug": "11663",
  "title": "Template-based Google Drive folder generation with Forms and Apps Script",
  "description": "### Overview\nStop manually creating folder structures for every new client or project. This workflow provides a simple form where users enter a name, and automatically duplicates your template folder structure in Google Drive‚Äîreplacing all placeholders with the submitted name.\n\n### What This Workflow Does\n1. Displays a form where users enter a name (client, project, event, etc.)\n2. Creates a new main folder in Google Drive\n3. Calls Google Apps Script to duplicate your entire template structure\n4. Replaces all `{{NAME}}` placeholders in files and folder names\n\n### Key Features\n- **Simple form interface** ‚Äî No technical knowledge required to use\n- **Recursive duplication** ‚Äî Copies all subfolders and files\n- **Smart placeholders** ‚Äî Automatically replaces `{{NAME}}` everywhere\n- **Production-ready** ‚Äî Works immediately after setup\n\n### Prerequisites\n- Google Drive account with OAuth2 credentials in n8n\n- Google Apps Script deployment (code below)\n- Template folder in Drive using `{{NAME}}` as placeholder\n\n### Setup\n\n**Step 1: Create your template folder**\n```\nüìÅ {{NAME}} - Project Files\n‚îú‚îÄ‚îÄ üìÅ 01. {{NAME}} - Documents\n‚îú‚îÄ‚îÄ üìÅ 02. {{NAME}} - Assets\n‚îú‚îÄ‚îÄ üìÅ 03. Deliverables\n‚îî‚îÄ‚îÄ üìÑ {{NAME}} - Brief.gdoc\n```\n\n**Step 2: Deploy Apps Script**\n1. Go to [script.google.com](https://script.google.com)\n2. Create new project ‚Üí Paste code below\n3. Deploy ‚Üí New deployment ‚Üí Web app\n4. Execute as: `Me` | Access: `Anyone`\n5. Copy the deployment URL\n\n**Step 3: Configure workflow**\nReplace these placeholders:\n- `DESTINATION_PARENT_FOLDER_ID` ‚Äî Where new folders are created\n- `YOUR_APPS_SCRIPT_URL` ‚Äî URL from Step 2\n- `YOUR_TEMPLATE_FOLDER_ID` ‚Äî Folder to duplicate\n\n**Step 4: Test**\nActivate workflow ‚Üí Open form URL ‚Üí Submit a name ‚Üí Check Drive!\n\n---\n\n### Apps Script Code\n\n```javascript\nfunction doPost(e) {\n  try {\n    var params = e.parameter;\n    var templateFolderId = params.templateFolderId;\n    var name = params.name;\n    var destinationFolderId = params.destinationFolderId;\n    \n    if (!templateFolderId || !name) {\n      return jsonResponse({\n        success: false,\n        error: 'Missing required parameters: templateFolderId and name are required'\n      });\n    }\n    \n    var templateFolder = DriveApp.getFolderById(templateFolderId);\n    \n    if (destinationFolderId) {\n      var destinationFolder = DriveApp.getFolderById(destinationFolderId);\n      copyContentsRecursively(templateFolder, destinationFolder, name);\n      \n      return jsonResponse({\n        success: true,\n        id: destinationFolder.getId(),\n        url: destinationFolder.getUrl(),\n        name: destinationFolder.getName(),\n        mode: 'copied_to_existing',\n        timestamp: new Date().toISOString()\n      });\n    } else {\n      var parentFolder = templateFolder.getParents().next();\n      var newFolderName = replacePlaceholders(templateFolder.getName(), name);\n      var newFolder = parentFolder.createFolder(newFolderName);\n      copyContentsRecursively(templateFolder, newFolder, name);\n      \n      return jsonResponse({\n        success: true,\n        id: newFolder.getId(),\n        url: newFolder.getUrl(),\n        name: newFolder.getName(),\n        mode: 'created_new',\n        timestamp: new Date().toISOString()\n      });\n    }\n  } catch (error) {\n    return jsonResponse({\n      success: false,\n      error: error.toString()\n    });\n  }\n}\n\nfunction replacePlaceholders(text, name) {\n  var result = text;\n  result = result.replace(/\\{\\{NAME\\}\\}/g, name);\n  result = result.replace(/\\{\\{name\\}\\}/g, name.toLowerCase());\n  result = result.replace(/\\{\\{Name\\}\\}/g, name);\n  return result;\n}\n\nfunction copyContentsRecursively(sourceFolder, destinationFolder, name) {\n  var files = sourceFolder.getFiles();\n  while (files.hasNext()) {\n    try {\n      var file = files.next();\n      var newFileName = replacePlaceholders(file.getName(), name);\n      file.makeCopy(newFileName, destinationFolder);\n      Utilities.sleep(150);\n    } catch (error) {\n      Logger.log('Error copying file: ' + error.toString());\n    }\n  }\n  \n  var subfolders = sourceFolder.getFolders();\n  while (subfolders.hasNext()) {\n    try {\n      var subfolder = subfolders.next();\n      var newSubfolderName = replacePlaceholders(subfolder.getName(), name);\n      var newSubfolder = destinationFolder.createFolder(newSubfolderName);\n      Utilities.sleep(200);\n      copyContentsRecursively(subfolder, newSubfolder, name);\n    } catch (error) {\n      Logger.log('Error copying subfolder: ' + error.toString());\n    }\n  }\n}\n\nfunction jsonResponse(data) {\n  return ContentService\n    .createTextOutput(JSON.stringify(data))\n    .setMimeType(ContentService.MimeType.JSON);\n}\n```\n\n---\n\n### Use Cases\n- **Agencies** ‚Äî Client folder structure on new signup\n- **Freelancers** ‚Äî Project folders from intake form\n- **HR Teams** ‚Äî Employee onboarding folders\n- **Schools** ‚Äî Student portfolio folders\n- **Event Planners** ‚Äî Event documentation folders\n\n### Notes\n- Apps Script may take +60 seconds for large structures\n- Timeout is set to 5 minutes for complex templates\n- Your Google account needs edit access to template and destination folders",
  "featuredImage": "/data/workflows/11663/11663.webp",
  "author": {
    "id": 101,
    "slug": "akav",
    "name": "Antonio Gasso",
    "avatar": ""
  },
  "categories": [
    "File Management"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 73,
  "downloads": 7,
  "createdAt": "2025-12-10T18:04:25.926Z",
  "updatedAt": "2026-01-16T09:09:35.003Z",
  "publishedAt": "2025-12-10T18:04:25.926Z",
  "nodes": 9,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11663"
}