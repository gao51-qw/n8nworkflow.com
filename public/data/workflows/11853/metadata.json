{
  "id": 11853,
  "slug": "11853",
  "title": "Automate S3 video transcoding, thumbnail generation & CDN distribution",
  "description": "# Video Processing Pipeline with Thumbnail Generation and CDN Distribution\n\n## Summary\nAutomated video processing system that monitors S3 for new uploads, generates thumbnails and preview clips, extracts metadata, transcodes to multiple formats, and distributes to CDN with webhook notifications.\n\n## Detailed Description\nA comprehensive video processing workflow that receives S3 events or manual triggers, validates video files, extracts metadata via FFprobe, generates thumbnails at key frames, creates animated GIF previews, transcodes to multiple resolutions, invalidates CDN cache, and sends completion notifications.\n\n### Key Features\n- **S3 Event Monitoring**: Automatic detection of new video uploads\n- **Thumbnail Generation**: Multiple sizes at key frame intervals\n- **Video Metadata**: FFprobe extraction of duration, resolution, codec info\n- **Preview GIF**: Animated preview clips for video galleries\n- **Multi-Format Transcoding**: Convert to 1080p, 720p, 480p\n- **CDN Distribution**: Cloudflare cache invalidation and signed URLs\n- **Webhook Callbacks**: Notify origin system on completion\n\n### Use Cases\n- Video hosting platforms\n- Media asset management systems\n- Content delivery networks\n- Video streaming services\n- Social media platforms\n- E-learning video processing\n- User-generated content platforms\n\n### Required Credentials\n- AWS S3 Credentials (for video storage)\n- FFmpeg API credentials (via HTTP)\n- Cloudflare API Token (for CDN)\n- Slack Bot Token (for notifications)\n- Google Sheets OAuth (for logging)\n\n### Node Count: 24 (19 functional + 5 sticky notes)\n\n### Unique Aspects\n- Uses **Webhook** for S3 event notifications\n- Uses **Code** nodes for S3 info extraction and URL generation\n- Uses **If** node for video format validation\n- Uses **HTTP Request** nodes for FFprobe, FFmpeg, and CDN APIs\n- Uses **Aggregate** node for collecting parallel processing results\n- Uses **Merge** nodes for multiple workflow path consolidation\n- Implements **parallel processing** for thumbnails, GIF, and transcoding\n\n### Workflow Architecture\n```\n[S3 Event Webhook]    [Manual Webhook]\n        |                   |\n        +--------+----------+\n                 |\n                 v\n         [Merge Triggers]\n                 |\n                 v\n         [Extract S3 Info] (Code)\n                 |\n                 v\n         [Check Is Video] (If)\n              /         \\\n           Yes           No\n            |             |\n            v             v\n[Get Video Metadata]  [Invalid Response]\n    (FFprobe)              |\n            |              |\n            v              |\n[Parse Video Metadata]     |\n    (Code)                 |\n       /|\\                 |\n      / | \\                |\n     v  v  v               |\n[Thumbs][GIF][Transcode]   |\n     \\  |  /               |\n      \\ | /                |\n       v v                 |\n[Aggregate Results]        |\n         |                 |\n         v                 |\n[Invalidate CDN Cache]     |\n         |                 |\n         v                 |\n[Generate Signed URLs]     |\n        / \\                |\n       /   \\               |\n      v     v              |\n[Log Sheet] [Slack]        |\n      \\   /                |\n       \\ /                 |\n        v                  |\n[Merge Output Paths]       |\n         |                 |\n         +---------+-------+\n                   |\n                   v\n         [Merge All Paths]\n                   |\n                   v\n         [Respond to Webhook]\n```\n\n### Configuration Guide\n1. **S3 Event**: Configure S3 bucket notification to send events to webhook\n2. **FFmpeg API**: Use a hosted FFmpeg service (e.g., api.ffmpeg-service.com)\n3. **Cloudflare**: Set zone ID and API token for cache invalidation\n4. **Slack Channel**: Set `#video-processing` for notifications\n5. **Google Sheets**: Connect for processing metrics logging\n\n### Supported Video Formats\n| Extension | MIME Type |\n|-----------|----------|\n| .mp4 | video/mp4 |\n| .mov | video/quicktime |\n| .avi | video/x-msvideo |\n| .mkv | video/x-matroska |\n| .webm | video/webm |\n| .m4v | video/x-m4v |\n\n### Thumbnail Generation\n| Size | Dimensions | Suffix |\n|------|------------|--------|\n| Large | 1280x720 | _large |\n| Medium | 640x360 | _medium |\n| Small | 320x180 | _small |\n\nThumbnails generated at: 10%, 30%, 50%, 70%, 90% of video duration\n\n### Transcoding Presets\n| Preset | Resolution | Bitrate | Codec |\n|--------|------------|---------|-------|\n| 1080p | 1920x1080 | 5000k | H.264 |\n| 720p | 1280x720 | 2500k | H.264 |\n| 480p | 854x480 | 1000k | H.264 |\n\n### Output Structure\n```json\n{\n  \"job_id\": \"job_1705312000_abc123\",\n  \"status\": \"completed\",\n  \"original\": {\n    \"filename\": \"video.mp4\",\n    \"resolution\": \"1920x1080\",\n    \"duration\": \"00:05:30\"\n  },\n  \"thumbnails\": {\n    \"large\": \"https://cdn/thumbnails/job_id/thumb_0_large.jpg\",\n    \"medium\": \"https://cdn/thumbnails/job_id/thumb_0_medium.jpg\",\n    \"small\": \"https://cdn/thumbnails/job_id/thumb_0_small.jpg\"\n  },\n  \"preview_gif\": \"https://cdn/previews/job_id/preview.gif\",\n  \"transcoded\": {\n    \"1080p\": \"https://cdn/transcoded/job_id/video_1080p.mp4\",\n    \"720p\": \"https://cdn/transcoded/job_id/video_720p.mp4\",\n    \"480p\": \"https://cdn/transcoded/job_id/video_480p.mp4\"\n  }\n}\n```",
  "featuredImage": "/data/workflows/11853/11853.webp",
  "author": {
    "id": 101,
    "slug": "tomoki",
    "name": "Tomoki",
    "avatar": ""
  },
  "categories": [
    "Content Creation",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 24,
  "downloads": 2,
  "createdAt": "2025-12-16T08:42:54.324Z",
  "updatedAt": "2026-01-16T09:10:22.280Z",
  "publishedAt": "2025-12-16T08:42:54.324Z",
  "nodes": 24,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/11853"
}