# Automate hotel booking requests from Gmail to Google Sheets with GPT-5-mini

> ## Whoâ€™s it for
This workflow is for hotel managers, travel agencies, and hospitality teams who receive booking requests via email. It eliminates the need for manual data entry by automatically parsing emails and attachments, assigning booking cases to the right teams, and tracking performance metrics.

## What it does
This workflow goes beyond simple automation by including enterprise-grade logic and security:

* **ğŸ›¡ï¸ Gatekeeper:** Watches your Gmail and filters irrelevant emails before spending money on AI tokens.
* **ğŸ§  AI Brain:** Uses OpenAI (GPT-5-mini) to extract structured data from unstructured email bodies and PDF attachments.
* **âš–ï¸ Business Logic:** Automatically routes tasks to different teams based on urgency, room count, and VIP status.
* **ğŸ”’ Security:** Catches PII (like credit card numbers) and scrubs them before they hit your database.
* **ğŸš¨ Safety Net:** If anything breaks, a dedicated error handling path logs the issue immediately so no booking is lost.
* **ğŸ“ˆ ROI Tracking:** Calculates the time saved per booking to prove the value of automation.

## How to set up
1.  **Create your Google Sheet:** Create a new sheet and rename the tabs to: **Cases**, **Team Assignments**, **Error Logs**, **Success Metrics**.
2.  **Add Credentials:** Go to n8n Settings â†’ Credentials and add your Gmail (OAuth2), Google Sheets, and OpenAI API keys.
3.  **Configure User Settings:** Open the **"Configuration: User Settings"** node at the start of the workflow. Paste your specific Google Sheet ID and Admin Email there.
4.  **Adjust Business Rules:** Open the **"Apply Business Rules"** node (Code node) to adjust the logic for team assignment (e.g., defining what counts as a "VIP" booking).
5.  **Customize Templates:** Modify the email templates in the Gmail nodes to match your hotel's branding.
6.  **Test:** Send a sample booking email to yourself to verify the filters and data extraction.

## Setup requirements
* Gmail account (OAuth2 connected)
* Google Sheets (with the 4 tabs listed below)
* OpenAI API key (GPT-5-mini recommended)
* n8n Cloud or self-hosted instance

## How to customize
* **Filter Booking Emails:** Update the trigger node keywords to match your specific email subjects (e.g., "Reservation", "Booking Request").
* **Apply Business Rules:** Edit the Javascript in the Code node to fit your companyâ€™s internal logic (e.g., changing priority thresholds).
* **New Metrics:** Add new columns in the Google Sheet (e.g., â€œRevenue Metricsâ€) and map them in the "Update Sheet" node.
* **AI Model:** Switch to GPT-5 if you need higher reasoning capabilities for complex PDF layouts.

## Google Sheets Structure Description
This workflow uses a Google Sheets document with four main tabs to track and manage hotel booking requests.

### 1. Cases
This is the **main data log** for all incoming booking requests.
* **case_id:** Unique identifier generated by the workflow.
* **processed_date:** Timestamp when the workflow processed the booking.
* **travel_agency / contact_details:** Extracted from the email.
* **number_of_rooms / check_in_date:** Booking details parsed by the AI.
* **special_requests:** Optional notes (e.g., airport transfer).
* **assigned_team / priority:** Automatically set based on business rules.
* **days_until_checkin:** Dynamic field showing urgency.

### 2. Team Assignments
Stores internal routing and assignment details.
* **timestamp:** When the case was routed.
* **case_id:** Link to the corresponding record in the Cases tab.
* **assigned_team / team_email:** Which department handles this request.
* **priority:** Auto-set based on room count or urgency.

### 3. Error Log
A critical audit trail that captures details about any failed processing steps.
* **error_type:** Categorization of the failure (e.g., MISSING_REQUIRED_FIELDS).
* **error_message:** Detailed technical explanation for debugging.
* **original_sender / snippet:** Context to help you manually process the request if needed.

### 4. Success Metrics
Tracks the results of your automation to prove its value.
* **processing_time_seconds:** The time savings achieved by the automation (run time vs. human time).
* **record_updated:** Confirmation that the database was updated.

## ğŸ™‹ Support
If you encounter any issues during setup or have questions about customization, please reach out to our dedicated support email: **foivosautomationhelp@gmail.com**





## ğŸ“Š Basic Information

- **Workflow ID:** 10578
- **Complexity:** advanced
- **Node Count:** 37
- **Views:** 699
- **Downloads:** 69
- **Created:** 2025/11/7
- **Last Updated:** 2026/1/16
- **Source:** [View on n8n.io](https://n8n.io/workflows/10578)

## ğŸ‘¤ Author

- **Name:** Gtaras
- **Username:** @tarasidis

## ğŸ·ï¸ Categories

- Document Extraction
- AI Summarization

## ğŸ”— Nodes Used

- **if** (Ã—3)
- **set** (Ã—3)
- **googleSheets** (Ã—5)
- **gmail** (Ã—4)
- **@n8n/n8n-nodes-langchain.agent** (Ã—2)
- **@n8n/n8n-nodes-langchain.guardrails** (Ã—2)
- **filter** 
- **extractFromFile** 
- **gmailTrigger** 
- **code** (Ã—2)
- **stickyNote** (Ã—11)
- **@n8n/n8n-nodes-langchain.lmChatGoogleGemini** 
- **@n8n/n8n-nodes-langchain.lmChatOpenAi** 

## ğŸš€ How to Use

1. Download the workflow JSON file
2. Import it into your n8n instance
3. Configure the credentials for the nodes
4. Activate and test the workflow

## ğŸ”€ Workflow Structure

This workflow contains 37 nodes with 22 node connections.

---

*This workflow was sourced from [n8n.io](https://n8n.io) community templates.*
