{
  "id": 8269,
  "slug": "8269",
  "title": "Automate B2B lead generation & email campaigns with Google Maps, SendGrid & AI",
  "description": "## ğŸ“Œ Overview\nThis **n8n-powered workflow** automates the entire lifecycle of **lead generation** and **email workflows/campaign**. It combines six specialized workflows into one seamless system that **scrapes fresh leads**, **sends personalized emails**, **tracks engagements**, **detects replies**, **classifies responses**, **handles follow-ups**, and **keeps a live CRM updated** â€” all in one loop.\nDesigned for B2B cold outreach and follow-up nurturing, this system integrates with **Apify**, **Google Sheets**, **SendGrid**, **Gmail**, and **OpenAI** for AI summarization and real-time alerts.\n\n\n## ğŸ§  What It Does\nThis workflow automates the **entire lifecycle of B2B cold campaign**. It:\n- Scrapes targeted leads directly from **Google Maps** (via Apify).\n- Extracts verified emails from business websites with **anti-blocking safeguards**.\n- Stores everything in a centralized **Google Sheets CRM**.\n- Sends **personalized emails** via **SendGrid**, with unique embedded IDs for tracking.\n- Tracks delivery, opens, clicks, and bounces in real time through **webhook events**.\n- Detects replies from **Gmail**, matches them to the right campaign stage, and updates the CRM.\n- Uses **AI classification** to label replies (Interested, Not Interested, Miscellaneous).\n- Routes qualified replies directly to your **sales team or Slack/Telegram channel**.\n- Automates **follow-up emails** (5-day & 10-day intervals) for non-responders.\n- Provides **light analytics & reporting** in Google Sheets for quick insights (with deeper logs available in SendGrid).\n\n\n## ğŸ’¡ Why This Workflow\n- **All-in-One Solution**: Instead of juggling multiple tools, this workflow handles lead gen, outreach, tracking, and CRM updates in one place.\n- **Smart Reply Handling**: Never lose a lead â€” every reply is tracked, classified, and routed intelligently.\n- **Scalable & Modular**: Each workflow (lead gen, email sending, webhook, replies, routing, follow-ups) can run independently or as part of the full system.\n- **Time-Saving**: Reduces manual lead collection, email follow-up, and CRM updating by **90%+**.\n- **Client-Ready**: Built with reliability in mind â€” randomized delays, duplicate prevention, priority logic for status updates, and AI-powered classification.\n\n\n## ğŸ‘¤ Who Itâ€™s For\nThis workflow is ideal for:\n- **Agencies** running cold campaigns for clients.\n- **B2B Businesses** looking to automate lead generation and follow-ups.\n- **Freelancers / Consultants** who need a plug-and-play outreach system without expensive SaaS subscriptions.\n- **Sales Teams** that want structured, real-time leads routed directly to their inbox or Slack.\n- **Startups** who want a scalable, low-cost alternative to tools like Apollo, Firecrawl, Bright Data or Reply.io.\n\n\n## âš™ï¸ How It Works\n### ğŸ§© 1. Lead Generation Workflow\n#### ğŸ¯ Purpose\nScrape fresh B2B leads from Google Maps, crawl their websites to extract verified email addresses, and upload structured, clean lead data into a Google Sheets CRM.\n#### ğŸ›  How It Works\n**1. User Input via Form Trigger**\n- The workflow begins with a form asking for:\n  - Business keyword (e.g. \"Dentist\")\n  - Location (e.g. \"Florida\")\n  - Lead limit (e.g. 50)\n  \n**2. Scrape Google Maps via Apify**\n- Calls the Apify Google Maps Scraper Actor\n- Extracts structured business data like:\n`Business Name`, `Website`, `Phone`, `Category`, `Rating`, `Address`.\n\n**3. Website Filtering & Normalization**\n- Filters out businesses with no website\n- Cleans up URLs\n\n**4. Website Email Extraction**\n- Sends direct **HTTP GET requests** to the homepage of each business\n- Parses the raw HTML for public-facing email addresses using regex\n- Implements **anti-blocking techniques**:\n  - Random delays between requests\n  - Custom headers / User-Agent spoofing\n  - Graceful skip on failures\n  \n**5. Final Filtering & Data Structuring**\n- Keeps only businesses with a valid email address\n- Constructs lead objects with:\n`Business Name`, `Category`, `Email`, `Website`, `Phone`, `Rating`, `Location`.\n\n**6. Upload to Google Sheets CRM**\n- Pushes leads to a connected Google Sheet that acts as the systemâ€™s central CRM\n- This CRM becomes the source for the email sending workflow\n\n### ğŸ§© 2. Send an Email Workflow\n#### ğŸ¯ Purpose\nAutomatically sends personalized emails to verified leads using rotating templates, embedded ID tracking, and campaign-stage tagging.\n#### ğŸ›  How It Works\n**1. Pull Active Leads from CRM**\n- Retrieves fresh leads from the Google Sheet where\n  \n**2. Select a Random Template**\n- Pulls from a template library stored in a separate Google Sheet\n- Injects lead-specific variables into placeholders like:\n`[Business Name]`, `[Category]`, `[Location]`, etc.\n\n**3. Embed Unique Tracking ID**\n- Appends an embedded **ID token** to the email. This enables **accurate reply source tracking** across all email stages\n\n**4. Send Email via SendGrid**\n- Sends the message using SendGrid's transactional API\n- Emails are tagged internally according to email type.\n\n### ğŸ§© 3. Webhook Event Workflow\n#### ğŸ¯ Purpose\nProcesses SendGrid webhook events (e.g., delivered, opened, clicked, bounced) and updates the CRM with **prioritized delivery status** and **engagement tracking** â€” using clean classification and smart update logic.\n#### ğŸ›  How It Works\n**1. Receive Events via Webhook Trigger**\n- Listens for real-time webhook events from SendGrid, including:\n  - delivered, bounce, deferred, processed, open, click, unsubscribe, spamreport, etc.\n \n**2. Classify Each Event Type**\n- A custom code node adds a **route** label:\n  - **status**: delivery-level events\n  - **engagement**: recipient interaction events\n  - **others**: uncategorized or unsupported\n \n**3. Switch-Based Routing**\n- **Status Events**:\n  - Applies **priority logic**\n  - If multiple status events are received for the same lead, only the **highest-priority event** is stored\n  - Updates corresponding CRM fields:\n- **Engagement Events**:\n  - Detects interactions like:\n    - Opened, Clicked, Unsubscribed, Spam Reported\n  - Updates CRM fields:\n    - Opened, Clicked, Unsubscribed, Spam Reported, Engaged At\n  - Preserve first-time interaction records and avoiding regressions\n- **Others Branch**:\n  - Logs or gracefully skips events not explicitly supported\n \n**4. CRM Synchronization**\n- Merges event data with the correct lead by matching Email\n- Ensures all updates are timestamped and consistent across systems\n\n### ğŸ§© 4. Reply Update Database Workflow\n#### ğŸ¯ Purpose\nPolls Gmail inbox, extracts replies, determines their source, and logs them in both the CRM and a message tracker sheet.\n#### ğŸ›  How It Works\n**1. Poll Gmail for New Replies**\n- Uses Gmail API to fetch recent messages\n- Filters out auto-replies, no-reply addresses, or irrelevant responses\n\n**2. Prevent Duplicate Processing**\n- Checks each message against a \"Processed Message IDs\" Google Sheet\n- Skips if the message has been handled before\n\n**3. Extract Reply Metadata**\n**4. Match to Lead & Update CRM**\n- Determines the original email stage based on ID\n- Updates necessary fields\n\n### ğŸ§© 5. Email Routing Workflow\n#### ğŸ¯ Purpose\nUses AI to classify replies by intent (Interested, Not Interested, or Miscellaneous) and automatically routes, labels, and logs them accordingly.\n#### ğŸ›  How It Works\n**1. Receive Cleaned Reply**\n- Triggered after a set time interval\n\n**2. Classify Using AI (LangChain / OpenAI)**\n- The reply is analyzed and categorized as:\n  - Interested: wants to talk, asks for more info\n  - Not Interested: says no or unsubscribes\n  - Miscellaneous: unclear or unrelated response\n\n**3. Gmail Label Assignment**\n- Adds Gmail label based on classification\n\n**4. Handle â€œInterestedâ€ Replies**\n- If Interested:\n  - Adds label in Gmail\n  - Forwards message to a sales or response channel\n  - Updates Google Sheet CRM\n\n### ğŸ§© 6. Follow-Up Email Workflow\n#### ğŸ¯ Purpose\nAutomatically sends up to two follow-up emails to leads who showed interest (opened or clicked) but havenâ€™t replied yet.\n#### ğŸ›  How It Works\n**1. Scheduled Execution**\n- Runs daily or at set intervals\n\n**2. Filter Leads for Follow-Up**\n- Checks that desired conditions are met:\n  - Required number of days have passed:\n    - 5 days â†’ Follow-Up 1\n    - 10 days â†’ Follow-Up 2\n\n**3. Choose and Personalize Template**\n- Injects lead-specific data\n- Embeds corresponding for reply tracking\n\n**4. Send via SendGrid**\n- Message is tagged by stage\n- Sent using the same logic as the original email\n\n**5. Update CRM**\n- Increments:\n  - Follow-Up Sent flag\n  - Follow-Up Count\n  - Follow-Up Time field\n\n\n## âœ… Setup Requirements (Before You Start)\nPrepare these items to avoid interruptions during setup:\n- **ğŸŒ Domain DNS Access**\n  - Youâ€™ll need to add TXT/CNAME records in your registrar (GoDaddy, Namecheap, Cloudflare, etc.) to authenticate your domain with SendGrid.\n- **ğŸ“§ Domain Email Address or Single Sender Authentication (e.g., hello@yourbusiness.com)**\n  - Needed for SendGrid domain authentication (donâ€™t use Gmail/Yahoo).\n  - This step ensures emails are not flagged as spam.\nTip: If you donâ€™t own a domain, you can use a single sender email to test, but for production you **MUST** authenticate a domain.\n- **ğŸ”‘ API Keys / Credentials**\n  - **Apify API Key** â†’ for Google Maps scraping.\n  - **SendGrid API Key** â†’ for sending emails + webhook events.\n  - **Google Sheets OAuth Credentials** â†’ for CRM integration.\n  - **Gmail API Credentials** â†’ for reply detection.\n  - **OpenAI API Key** â†’ for AI-based reply classification.\n- **ğŸ“Š Google Sheet (CRM)**\n  - Add desired columns: Business Name, Email, Website, Phone, Category, Status, Reply, Follow-Up Count.\n- **ğŸŒ n8n Environment (Cloud or Self-Hosted)**\n  - Must allow Apify node installation.\n\n\n## ğŸ›  How to Set It Up\n1. **Open n8n (Cloud or Self-Hosted)**.\n2. **Install Apify node before importing**.\n   - Search **Apify**  â†’ click **Install**.\n3. Import the provided **.json** workflow file into your n8n editor.\n4. **Set up the required credentials**:\n   - ğŸ”‘ Apify API Key,\n   - ğŸ”‘ SendGrid API Key,\n   - ğŸ”‘ Google Sheets OAuth,\n   - ğŸ”‘ Gmail API,\n   - ğŸ”‘ OpenAI API Key.\n5. **Prepare your Google Sheet (CRM)**.\n   - Verify column names match your workflow fields.\n   - Adjust **â€œGet Desired Fieldsâ€** node in n8n **â€œLead generation workflowâ€** if you add/remove columns.\n6. **Enable SendGrid Webhook Events**.\n   - Go to **SendGrid** â†’ **Settings** â†’ **Mail Settings** â†’ **Event Webhook**.\n   - Paste the webhook URL from your n8n **â€œWebhook Event Workflowâ€**.\n   - Select: Delivered, Opened, Clicked, Bounced, Unsubscribed, Spam Report.\n7. **Run a test**.\n   - Trigger the **Lead Generation workflow** â†’ check Google Sheets for leads.\n   - Send a **test email** â†’ verify delivery + engagement updates in CRM.\n   - Reply from a **test inbox** â†’ confirm Gmail polling + AI classification.\n\n#### ğŸ“‚ Additional Provided Resources.\nTo help you get started faster, youâ€™ll also receive:\n- SendGrid **Setup** and **Troubleshooting document**.\n- **Two ready-to-use Google Sheets example templates** which can be modified to suit your business needs:\n  - **Email Workflow DB CRM**\n    - **Includes**:\n      - **Leads Tab** â†’ structured space for scraped businesses and contact details.\n      - **Email Templates Tab** â†’ pre-written templates for the main email, 1st follow-up, and 2nd follow-up (with placeholders for personalization).\n      - **Analytics Tab** â†’ light reporting on sends, opens, clicks, and replies to give quick campaign insights.\n  - **Processed Gmails IDs**\n    - A simpler sheet designed for **Gmail reply handling**.\n    - Useful for tracking processed messages and avoiding duplicates while you familiarize yourself with how reply updates work.\n\n\n## ğŸ¨ Customization Tips\n- **Templates**: Update the Google Sheets Templates tab with your own outreach copy. Use placeholders like `[Business Name]`, `[Location]`, `[Category]` so each email feels personalized.\n- **CRM Fields**: Add or remove CRM columns depending on your business needs (e.g., Industry, Revenue, Sales Owner, Notes). Just make sure the field names match in n8nâ€™s **â€œGrab Desired Fieldsâ€** nodes in the **Lead generation workflow**.\n- **Follow-Up Logic**: Adjust the timing for follow-ups. Default is **5 days (Follow-Up 1)** and **10 days (Follow-Up 2)**, but you can easily change this to **3/7/14 days** or any schedule your sales process requires.\n- **Reply Routing**: Customize how AI classification works. For example, rename labels (â€œHot Leadâ€, â€œNot Interestedâ€, â€œOut of Scopeâ€) and route replies differently (e.g., forward â€œInterestedâ€ to your sales inbox, Slack channel, or Telegram bot).\n- **Analytics & Reporting**: Expand the Google Sheets reporting tab. You can add pivot tables for deeper campaign insights. \n***For more advanced analytics, SendGrid also keeps full logs.***\n- **Scalability**:\n  - Add **proxy handling** for higher-volume scraping.\n  - Switch to a database (Postgres, Supabase, MongoDB) instead of Google Sheets if managing thousands of leads.\n  - Use multiple SendGrid accounts or IP warm-up strategies for large-scale sending.\n- **Scraping Alternatives**:\n  - If you prefer not to use direct HTTP requests for email extraction, you can integrate with external scrapers like:\n    - Firecrawl â€“ lightweight scraper for web/email extraction.\n    - Bright Data â€“ residential proxies + scraping tools.\n    - Apify Website Scrapers â€“ customizable actors for deep site scraping.\n  - These can plug into the workflow instead of (or alongside) the built-in email scraper.\n\n#### âœ¨ Predefined Templates vs. AI-Generated Emails\nBy default, this workflow uses **predefined templates** stored in Google Sheets. This design choice was intentional, and hereâ€™s why:\n  - **âœ… Reliability**: Alway work, no prompt issues.\n  - **âœ… Cost Savings**: no API token usage.\n  - **âœ… Total Control, Consistent & Customizable**: You control tone and can tweak anytime.\n\nâš¡ That said, you can absolutely **swap out the template system for AI-based generation** if you prefer dynamic messaging. The workflow is flexible â€” just keep in mind the trade-offs in cost, reliability, and control.\nâš¡ Best approach: start with templates for stability, then add AI if you want more variety.\n\n",
  "featuredImage": "/data/workflows/8269/8269.webp",
  "author": {
    "id": 101,
    "slug": "kingsley",
    "name": "Ezema Kingsley Chibuzo",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "AI Summarization"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 110,
  "downloads": 11,
  "createdAt": "2025-09-04T23:39:28.681Z",
  "updatedAt": "2026-01-16T08:55:02.904Z",
  "publishedAt": "2025-09-04T23:39:28.681Z",
  "nodes": 141,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8269"
}