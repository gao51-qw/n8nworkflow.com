{
  "id": 8229,
  "slug": "8229",
  "title": "Research business leads with Perplexity AI & save to Google Sheets using OpenAI",
  "description": "Automatically research new leads in your target area, structure the results with AI, and append them into Google Sheets â€” all orchestrated in n8n.\n\n---\n\n## âœ… What this template does\n- Uses **Perplexity** to research businesses (coffee shops in this example) with company name + email  \n- Cleans and structures the output into proper JSON using **OpenAI**  \n- Appends the new leads directly into **Google Sheets**, skipping duplicates  \n\n&gt; **Trigger:** Manual â€” â€œStart Workflowâ€\n\n---\n\n## ğŸ‘¤ Whoâ€™s it for\n- **Sales & marketing teams** who need to prospect local businesses  \n- **Agencies** running outreach campaigns  \n- **Freelancers** and consultants looking to automate lead research  \n\n---\n\n## âš™ï¸ How it works\n1. **Set Location** â†’ define your target area (e.g., *Hershey PA*)  \n2. **Get Current Leads** â†’ pull existing data from your Google Sheet to avoid duplicates  \n3. **Research Leads** â†’ query Perplexity for 20 businesses, excluding already-scraped ones  \n4. **Write JSON** â†’ OpenAI converts Perplexity output into structured Company/Email arrays  \n5. **Split & Merge** â†’ align Companies with Emails row-by-row  \n6. **Send Leads to Google Sheets** â†’ append or update leads in your sheet  \n\n---\n\n## ğŸ› ï¸ Setup instructions\nFollow these sticky-note setup steps (already included in the workflow):\n\n### 1) Connect Google Sheets (OAuth2)\n1. In **n8n â†’ Credentials â†’ New â†’ Google Sheets (OAuth2)**  \n2. Sign in with your Google account and grant access  \n3. In the Google Sheets node, select your **Spreadsheet** and **Worksheet**  \n\nExample sheet:  \nhttps://docs.google.com/spreadsheets/d/1MnaU8hSi8PleDNVcNnyJ5CgmDYJSUTsr7X5HIwa-MLk/edit#gid=0  \n\n---\n\n### 2) Connect Perplexity (API Key)\n1. Sign in at https://www.perplexity.ai/account  \n2. Generate an API key: https://docs.perplexity.ai/guides/getting-started  \n3. In **n8n â†’ Credentials â†’ New â†’ Perplexity API**, paste your key  \n\n---\n\n### 3) Connect OpenAI (API Key)\n1. In **n8n â†’ Credentials â†’ New â†’ OpenAI API**  \n2. Paste your **OpenAI API key**  \n3. In the **OpenAI Chat Model** node, select your credential and a **vision-capable model** (e.g., `gpt-4o-mini`, `gpt-4o`)  \n\n---\n\n## ğŸ”§ Requirements\n- A free **Google account**  \n- An **OpenAI API key** (https://platform.openai.com)  \n- A **Perplexity API key** (https://docs.perplexity.ai)  \n- n8n self-hosted or cloud instance  \n\n---\n\n## ğŸ¨ How to customize\n- Change the **Search Area** in the `Set Location` node  \n- Modify the **Perplexity system prompt** to target different business types (e.g., gyms, salons, restaurants)  \n- Expand the Google Sheet schema to include more fields (phone, website, etc.)  \n\n---\n\n## ğŸ“¬ Contact  \nNeed help customizing this (e.g., filtering by campaign, sending reports by email, or formatting your Google Sheet)?  \n\n- ğŸ“§ **robert@ynteractive.com**  \n- ğŸ”— **[Robert Breen](https://www.linkedin.com/in/robert-breen-29429625/)**  \n- ğŸŒ **[ynteractive.com](https://ynteractive.com)**  \n",
  "featuredImage": "/data/workflows/8229/8229.webp",
  "author": {
    "id": 101,
    "slug": "rbreen",
    "name": "Robert Breen",
    "avatar": ""
  },
  "categories": [
    "Lead Generation",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 740,
  "downloads": 74,
  "createdAt": "2025-09-03T17:34:55.588Z",
  "updatedAt": "2026-01-16T08:54:47.352Z",
  "publishedAt": "2025-09-03T17:34:55.588Z",
  "nodes": 18,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/8229"
}