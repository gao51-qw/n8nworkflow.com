{
  "id": 7674,
  "slug": "7674",
  "title": "Create a secure MongoDB data retrieval API with input validation and HTTP responses",
  "description": "**Data Extraction from MongoDB**\n\n**Overview**\nThis workflow exposes a public HTTP GET endpoint to read all documents from a MongoDB collection, with:\n\n- Strict validation of the collection name\n\n- Error handling with proper 4xx codes\n\n- Response formatting (e.g., _id → id) and a consistent 2XX JSON envelope\n\n\n**Workflow Steps**\n1. **Webhook Trigger: *A public GET endpoint receives requests with the collection name as a parameter***. \n\nThe workflow begins with a webhook that listens for incoming HTTP GET requests.\n\nThe endpoint follows this pattern:\n\n```\nhttps://{{your-n8n-instance}}/webhook-test/{{uuid&gt}}/:nameCollection\n```\n\n\n\nThe **:nameCollection** parameter is passed directly in the URL and specifies the MongoDB collection to be queried.\n\nExample:\n```\nhttps://yourdomain.com/webhook-test/abcd1234/orders\n```\n\nwould attempt to fetch all documents from the orders collection.\n\n2. **Validation: *The collection name is checked against a set of rules to prevent invalid or unsafe queries***.\n\nBefore querying the database, the collection name undergoes validation using a regular expression:\n\n```\n^(?!system\\.)[a-zA-Z0-9._]{1,120}$\n```\n\n**Purpose of validation:**\n\nBlocks access to MongoDB’s reserved system.* collections.\n\nPrevents injection attacks by ensuring only alphanumeric characters, underscores, and dots are allowed.\n\nEnforces MongoDB’s length restrictions (max 120 characters).\n\nThis step ensures the workflow cannot be exploited with malicious input.\n\n3. **Conditional Check: *If the validation fails, the workflow stops and returns an error message. If it succeeds, it continues.***\n\nThe workflow checks if the collection name passes validation.\n\nIf valid ✅: proceeds to query MongoDB.\n\nIf invalid ❌: immediately returns a structured HTTP 400 response, adhering to RESTful standards:\n\n```\n{\n  \"code\": 400,\n  \"message\": \"{{ $json.message }}\"\n}\n```\n\n\n4. **MongoDB Query: *The workflow connects to MongoDB and retrieves all documents from the specified collection.***\n\nTo use the MongoDB node, a proper database connection must be configured in n8n. This is done through MongoDB Credentials in the node settings:\n\nCreate MongoDB Credentials in n8n\n\n**Go to n8n → Credentials → New.**\n\nSelect MongoDB and Fill in the following fields:\n\n**Host:** The MongoDB server hostname or IP (e.g., cluster0.mongodb.net).\n\n**Port:** Default is 27017 for local deployments.\n\n**Database:** Name of the database (e.g., myDatabase).\n\n**User:** MongoDB username with read permissions.\n\n**Password:** Corresponding password.\n\n**Connection Type:** Standard for most cases, or Connection String if using a full URI.\n\n**Replica Set / SRV Record:** Enable if using MongoDB Atlas or a replica cluster. \n\n**Using a Connection String (recommended for MongoDB Atlas)**\n\nExample URI:\n\n```\nmongodb+srv://&lt;username&gt;:&lt;password&gt;@cluster0.mongodb.net/myDatabase?retryWrites=true&w=majority\n```\n\nPaste this into the Connection String field when selecting *\"Connection String\"* as the type.\n\n**Verify the Connection**\n\nAfter saving, test the credentials to confirm n8n can connect successfully to your MongoDB instance.\n\nConfigure the MongoDB Node in the Workflow\n\n**Operation:** Find (to fetch documents).\n\n**Collection:** Dynamic value passed from the workflow *(e.g., {{$json[\"nameCollection\"]}}).*\n\n**Query:** Leave empty to fetch all documents, or define filters if needed.\n\n**Result:**\nThe MongoDB node will retrieve all documents from the specified collection and pass the dataset as JSON to the next node for processing.\n\n\n5. **Data Formatting: *The retrieved documents are processed to adjust field names.***\n\nBy default, MongoDB returns its unique identifier as _id.\n\nTo align with common API conventions, this step renames _id → id.\n\nThis small transformation simplifies downstream usage, making responses more intuitive for client applications.\n\n\n6. **Response: *The cleaned dataset is returned as a structured JSON response to the original request.***\n\nThe processed dataset is returned as the response to the original HTTP request.\n\nClients receive a clean JSON payload with the expected format and renamed identifiers.\n\n**Example response:**\n```\n[\n  {\n    \"id\": \"64f13c1e2f1a5e34d9b3e7f0\",\n    \"name\": \"John Doe\",\n    \"email\": \"john@example.com\"\n  },\n  {\n    \"id\": \"64f13c1e2f1a5e34d9b3e7f1\",\n    \"name\": \"Jane Smith\",\n    \"email\": \"jane@example.com\"\n  }\n]\n```\n\n**Workflow Summary**\n\nWebhook (GET) \n   → Code (Validation) \n       → IF (Validation Check) \n           → MongoDB (Query) \n               → Code (Transform IDs) \n                   → Respond to Webhook\n\n**Key Benefits**\n✅ Security-first design: prevents unauthorized access or injection attacks.\n\n✅ Standards compliance: uses HTTP status codes (400) for invalid requests.\n\n✅ Clean API response: transforms MongoDB’s native _id into a more user-friendly id.\n\n✅ Scalability: ready for integration with any frontend, third-party service, or analytics pipeline.",
  "featuredImage": "/data/workflows/7674/7674.webp",
  "author": {
    "id": 101,
    "slug": "sheredia",
    "name": "Samuel Heredia",
    "avatar": ""
  },
  "categories": [
    "Engineering",
    "Multimodal AI"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 383,
  "downloads": 38,
  "createdAt": "2025-08-21T00:03:13.986Z",
  "updatedAt": "2026-01-16T08:51:45.114Z",
  "publishedAt": "2025-08-21T00:03:13.986Z",
  "nodes": 22,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/7674"
}