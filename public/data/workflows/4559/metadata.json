{
  "id": 4559,
  "slug": "4559",
  "title": "Intelligent web & local search with Brave Search API and Google Gemini MCP Server",
  "description": "## Summary\nThis n8n workflow implements an AI-powered agent that intelligently uses the Brave Search API (via an external MCP service like Smithery) to perform both web and local searches. It understands natural language queries, selects the appropriate search tool, and exposes this enhanced capability as a single, callable MCP tool.\n\n## Key Features\n*   ü§ñ **Intelligent Tool Selection:** AI agent decides between Brave's web search and local search tools based on user query context.\n*   üåê **MCP Microservice:** Exposes complex search logic as a single, easy-to-integrate MCP tool (`call_brave_search_agent`).\n*   üß† **Powered by Google Gemini:** Utilizes the `gemini-2.5-flash-preview-05-20` LLM for advanced reasoning.\n*   üó£Ô∏è **Conversational Memory:** Remembers context within a single execution flow.\n*   üìù **Customizable System Prompt:** Tailor the AI's behavior and responses.\n*   üß© **Modular Design:** Connects to external Brave Search MCP tools (e.g., from Smithery).\n\n## Benefits\n*   üîå **Simplified Integration:** Easily add advanced, AI-driven search capabilities to other applications or agent systems.\n*   üí∏ **Reduced Client-Side LLM Costs:** Offloads complex prompting and tool orchestration to n8n, minimizing token usage for client-side LLMs.\n*   üîß **Centralized Logic:** Manage and update search strategies and AI behavior in one place.\n*   üöÄ **Extensible:** Can be adapted to use other search tools or incorporate more complex decision-making.\n\n## Nodes Used\n*   `@n8n/n8n-nodes-langchain.mcpTrigger` (MCP Server Trigger)\n*   `@n8n/n8n-nodes-langchain.toolWorkflow`\n*   `@n8n/n8n-nodes-langchain.agent` (AI Agent)\n*   `@n8n/n8n-nodes-langchain.lmChatGoogleGemini` (Google Gemini Chat Model)\n*   `n8n-nodes-mcp.mcpClientTool` (MCP Client Tool - for Brave Search)\n*   `@n8n/n8n-nodes-langchain.memoryBufferWindow` (Simple Memory)\n*   `n8n-nodes-base.executeWorkflowTrigger` (Workflow Start - for direct execution/testing)\n\n## Prerequisites\n*   An active n8n instance (v1.22.5+ recommended).\n*   A Google AI API key for using the Gemini LLM.\n*   Access to an external MCP service that provides Brave Search tools (e.g., a Smithery account configured with their Brave Search MCP). This includes the MCP endpoint URL and any necessary authentication (like an API key for Smithery).\n\n## Setup Instructions\n1.  **Import Workflow:** Download the `Brave_Search_Smithery_AI_Agent_MCP_Server.json` file and import it into your n8n instance.\n2.  **Configure LLM Credential:**\n    *   Locate the **'Google Gemini Chat Model'** node.\n    *   Select or create an n8n credential for \"Google Palm API\" (used for Gemini), providing your Google AI API key.\n3.  **Configure Brave Search MCP Credential:**\n    *   Locate the **'brave_web_search'** and **'brave_local_search'** (MCP Client) nodes.\n    *   Create a new n8n credential of type \"MCP Client HTTP API\".\n        *   **Name:** e.g., `Smithery Brave Search Access`\n        *   **Base URL:** Enter the URL of your Brave Search MCP endpoint from your provider (e.g., `https://server.smithery.ai/@YOUR_PROFILE/brave-search/mcp`).\n        *   **Authentication:** If your MCP provider requires an API key, select \"Header Auth\". Add a header with the name (e.g., `X-API-Key`) and value provided by your MCP service.\n    *   Assign this newly created credential to both the 'brave_web_search' and 'brave_local_search' nodes.\n4.  **Note MCP Trigger Path:**\n    *   Open the **'Brave Search MCP Server Trigger'** node.\n    *   Copy its unique 'Path' (e.g., `/cc8cc827-3e72-4029-8a9d-76519d1c136d`). You will combine this with your n8n instance's base URL to get the full endpoint URL for clients.\n\n## How to Use\nThis workflow exposes an MCP tool named `call_brave_search_agent`. External clients can call this tool via the URL derived from the 'Brave Search MCP Server Trigger'.\n\n**Example Client MCP Configuration (e.g., for Roo Code):**\n```json\n\"n8n-brave-search-agent\": {\n  \"url\": \"https://YOUR_N8N_INSTANCE/mcp/cc8cc827-3e72-4029-8a9d-76519d1c136d/sse\",\n  \"alwaysAllow\": [\n    \"call_brave_search_agent\"\n  ]\n}\n```\n*Replace `YOUR_N8N_INSTANCE` with your n8n's public URL and ensure the path matches your trigger node.*\n\n**Example Request:**\nSend a `POST` request to the trigger URL with a JSON body:\n```json\n{\n  \"input\": { \"query\": \"best coffee shops in London\" }\n}\n```\n\n\n\nThe agent will stream its response, including the summarized search results.\n\n## Customization\n*   **AI Behavior:** Modify the System Prompt within the **'Brave Search AI Agent'** node to fine-tune its decision-making, response style, or how it uses the search tools.\n*   **LLM Choice:** Replace the **'Google Gemini Chat Model'** node with any other compatible LLM node supported by n8n.\n*   **Search Tools:** Adapt the workflow to use different or additional search tools by modifying the MCP Client nodes and updating the AI Agent's system prompt and tool definitions.\n\n## Further Information\n*   GitHub Repository: https://github.com/jezweb/n8n\n*   The workflow includes extensive sticky notes for in-canvas documentation.\n\n## Author\nJeremy Dawes (Jezweb)",
  "featuredImage": "/data/workflows/4559/4559.webp",
  "author": {
    "id": 101,
    "slug": "jez",
    "name": "Jez",
    "avatar": ""
  },
  "categories": [
    "Engineering",
    "AI RAG"
  ],
  "complexityLevel": "advanced",
  "price": 0,
  "visitors": 1701,
  "downloads": 170,
  "createdAt": "2025-06-01T12:10:43.912Z",
  "updatedAt": "2026-01-16T08:34:59.451Z",
  "publishedAt": "2025-06-01T12:10:43.912Z",
  "nodes": 26,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/4559"
}