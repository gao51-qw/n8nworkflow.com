{
  "id": 3680,
  "slug": "3680",
  "title": "Query PostgreSQL database with natural language using Groq AI chatbot",
  "description": "This guide shows you how to deploy a chatbot that lets you query your **PostgreSQL** database using natural language. You will build a system that accepts chat messages, retains conversation history, constructs dynamic SQL queries, and returns responses generated by an AI model. By following these instructions, you will have a working solution that integrates n8nâ€™s AI Agent capabilities with **PostgreSQL**.\n\n![AI Chatbot PostgreSQL.png](fileId:1161)\n\n### Prerequisites\n\nBefore you begin, ensure that you have the following:\n\n* An active n8n instance (self-hosted or cloud) running version 1.50.0 or later.\n* Valid **PostgreSQL** credentials configured in n8n.\n* API credentials for the Groq Chat Model (or your preferred AI language model).\n* Basic familiarity with SQL (specifically **PostgreSQL** syntax) and n8n node concepts such as chat triggers and memory buffers.\n* Access to the n8n Docs on AI Agents for further reference.\n\n### Workflow Setup\n\n1.  **Chat Interface & Trigger**\n    * **When Chat Message Received:** This node listens for incoming chat messages via a webhook. When a message arrives, it triggers the workflow immediately.\n\n2.  **Conversation Memory**\n    * **Chat History:** This memory buffer node stores the last 10 interactions. It supplies conversation context to the AI Agent, ensuring that responses consider previous messages.\n\n3.  **AI Agent Core**\n    * **AI Agent (Tools Agent):** The AI Agent node orchestrates the conversation by receiving the chat input and conversation history. It dynamically generates **PostgreSQL**-compatible SQL queries based on your requests and coordinates calls to external tools (such as **PostgreSQL** nodes).\n\n4.  **Database Interactions**\n    * **PostgreSQL Node (Query Execution):** This node executes the SQL query generated by the AI Agent against your **PostgreSQL** database. You reference the query using an expression (e.g., `{{$node[\"AI Agent\"].json.sql_query}}`), allowing the agentâ€™s output to control data retrieval.\n    * **PostgreSQL Node (Schema Retrieval):** This node (or a dedicated step using the **PostgreSQL** node) retrieves a list of relevant tables from your **PostgreSQL** database (e.g., from the `public` schema, excluding system schemas like `pg_catalog` or `information_schema`). The agent uses this information to understand the available tables. This typically involves executing a query like `SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';`.\n    * **PostgreSQL Node (Table Definition Retrieval):** This node (or another dedicated step using the **PostgreSQL** node) fetches detailed metadata (such as column names, data types, and potentially relationships using foreign keys) for a specific table. The table name (and schema if necessary) is supplied dynamically by the AI Agent. This often involves querying `information_schema.columns`, e.g., `SELECT column_name, data_type FROM information_schema.columns WHERE table_name = '{{dynamic_table_name}}' AND table_schema = 'public';`.\n\n5.  **Language Model Processing**\n    * **Groq Chat Model:** This node connects to the Groq Chat API to generate text completions. It processes the combined input (chat message, context, and data fetched from **PostgreSQL**) and produces the final response.\n\n6.  **Guidance & Customization**\n    * **Sticky Notes:** These nodes provide guidance on:\n        * Switching the chat model if you wish to use another provider (e.g., OpenAI or Anthropic).\n        * Adjusting the maximum token count per interaction.\n        * Customizing the SQL queries (ensuring **PostgreSQL** compatibility) and the context window size.\n    * They help you modify the workflow to suit your environment and requirements.\n\n### Workflow Connections\n\n* The **Chat Trigger** passes the incoming message to the **AI Agent**.\n* The **Chat History** node supplies conversation context to the AI Agent.\n* The **AI Agent** calls the **PostgreSQL** nodes as external tools, generating and sending dynamic SQL queries.\n* The **Groq Chat Model** processes the consolidated input from the agent and outputs the natural language response delivered to the user.\n\n### Testing the Workflow\n\n1.  Send a chat message using the chat interface.\n2.  Observe how the AI Agent processes the input and generates a corresponding **PostgreSQL** SQL query.\n3.  Verify that the **PostgreSQL** nodes execute the query correctly against your database and return data.\n4.  Confirm that the Groq Chat Model produces a coherent natural language response based on the query results.\n5.  Refer to the sticky notes for guidance if you need to fine-tune any node settings or SQL queries.\n\n### Next Steps and References\n\n* **Customize Your AI Model:** Replace the Groq Chat Model with another language model (such as the OpenAI Chat Model) by updating the node credentials and configuration.\n* **Enhance Memory Settings:** Adjust the Chat History nodeâ€™s context window to retain more or fewer messages based on your needs.\n* **Modify SQL Queries:** Update the SQL queries within the **PostgreSQL** nodes or refine the prompts for the AI Agent to ensure they match your specific database schema and desired data, adhering to **PostgreSQL** syntax.\n* **Further Reading:** Consult the n8n Docs on AI Agents for additional details and examples to expand your workflowâ€™s capabilities.\n* **Set Up a Website Chatbot:** Copy & Paste and replace the placeholders in the following code to embed the chatbot into your personal or companyâ€™s website: [View in CodePen ðŸ¡¥](https://codepen.io/olemai/pen/RNwPdVp)\n\nBy following these steps, you will deploy a robust AI chatbot workflow that integrates with your **PostgreSQL** database, allowing you to query data using natural language.",
  "featuredImage": "/data/workflows/3680/3680.webp",
  "author": {
    "id": 101,
    "slug": "gegenfeld",
    "name": "Gegenfeld",
    "avatar": ""
  },
  "categories": [
    "Internal Wiki",
    "AI Chatbot"
  ],
  "complexityLevel": "intermediate",
  "price": 0,
  "visitors": 1016,
  "downloads": 101,
  "createdAt": "2025-04-23T23:07:27.296Z",
  "updatedAt": "2026-01-16T08:31:01.538Z",
  "publishedAt": "2025-04-23T23:07:27.296Z",
  "nodes": 11,
  "version": "1.0.0",
  "sourceUrl": "https://n8n.io/workflows/3680"
}